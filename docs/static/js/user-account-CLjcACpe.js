import{u as ge}from"./useTable-DHoJP-Dx.js";import{g as ve}from"./user.api-BfnWVVZ4.js";import{g as R}from"./depart.api-B-HKCQpD.js";import{u as Ve}from"./useForm-DYvnCR5B.js";import{n as $}from"./chunk-bin-ui-design-DOxaRq58.js";import{B as ye}from"./index-CtCeQG2m.js";import{r as b,m as Ce,n as ke,o as f,j as we,w as l,Q as o,K as e,L as r,a as V,R as q,F as k,i as F,f as s,t as E,b as xe}from"./vendor-B29aizbt.js";import"./chunk-brace-BklEY0pF.js";import"./chunk-mockjs-CGXE1Baq.js";const Ne={key:0},qe=Object.assign({name:"SysUserAccount"},{__name:"user-account",setup(Ue){const j=b(null),A=b({}),u=Ce({page:1,size:10,name:"",roles:"",status:"",date:"",email:""}),c=b(!1),w=b([]),n=b({}),{treeData:x,getTreeData:K}=ye(R);K().then(()=>console.log(x.value));const{loading:N,list:M,total:O,getListData:g,pageChange:Q,pageSizeChange:W}=ge(ve,u),{formRef:G,pageStatus:U,editLoading:H,openCreate:I,openEdit:J,backNormal:h,submitForm:P,setBtnLoading:S,modalVisible:z}=Ve();ke(M,i=>{w.value=i.map(a=>({...a,expand:!1}))});function X(i){i.selected&&(A.value=i)}function Y(){n.value={realName:"",username:"",email:"",roles:"",depart:""},I()}function Z(i){n.value={...i,depart:""},J()}function T(){n.value={},h()}function ee(){$.success("删除成功！"),g()}function le(){P(()=>{S(!0);const i=U.value;setTimeout(()=>{$.success(`${i.isCreate?"新增":"修改"}成功！`),S(!1),h(),g()},1e3)})}g();const y={admin:"管理员",user:"普通用户",op:"实施人员"},te=[{title:"姓名",key:"realName"},{title:"登录名",key:"username"},{title:"邮箱",key:"email"},{title:"角色",slot:"roles"},{title:"出生日期",key:"createDate"},{title:"操作",width:100,align:"center",slot:"action"}],ae={realName:[{required:!0,message:"真实名称必填",trigger:"blur"}],username:[{required:!0,message:"用户名必填",trigger:"blur"}]};return(i,a)=>{const oe=o("base-tree"),_=o("b-input"),d=o("b-form-item"),v=o("b-option"),C=o("b-select"),ne=o("b-date-picker"),m=o("b-button"),D=o("b-form"),ue=o("b-icon"),L=o("b-dropdown-item"),re=o("b-dropdown-menu"),de=o("b-dropdown"),B=o("action-button"),se=o("b-divider"),ie=o("b-table"),me=o("b-page"),pe=o("base-table"),ce=o("b-layout"),_e=o("b-tree-select"),be=o("b-modal"),fe=o("page-wrapper");return f(),we(fe,null,{default:l(()=>[e(ce,{"has-sider":"",collapsedWidth:24},{sider:l(()=>[e(oe,{ref_key:"treeRef",ref:j,"tree-title":"部门列表","show-filter":"",fetch:r(R),onSelectChange:X},null,8,["fetch"])]),default:l(()=>[e(pe,null,{filter:l(()=>[e(D,{"label-width":"95px"},{default:l(()=>[e(d,{label:"用户名称"},{default:l(()=>[e(_,{modelValue:u.name,"onUpdate:modelValue":a[0]||(a[0]=t=>u.name=t),clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"用户角色"},{default:l(()=>[e(C,{modelValue:u.roles,"onUpdate:modelValue":a[1]||(a[1]=t=>u.roles=t),clearable:""},{default:l(()=>[(f(),V(k,null,q(y,(t,p)=>e(v,{key:p,label:t,value:p},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),c.value?(f(),V(k,{key:0},[e(d,{label:"状态"},{default:l(()=>[e(C,{modelValue:u.status,"onUpdate:modelValue":a[2]||(a[2]=t=>u.status=t),clearable:""},{default:l(()=>[e(v,{label:"启用",value:"1"}),e(v,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"邮箱"},{default:l(()=>[e(_,{modelValue:u.email,"onUpdate:modelValue":a[3]||(a[3]=t=>u.email=t),clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"日期"},{default:l(()=>[e(ne,{modelValue:u.date,"onUpdate:modelValue":a[4]||(a[4]=t=>u.date=t),clearable:""},null,8,["modelValue"])]),_:1})],64)):F("",!0),e(d,null,{default:l(()=>[e(m,{type:"primary",loading:r(N),onClick:r(g)},{default:l(()=>[s("查询")]),_:1},8,["loading","onClick"]),e(m,null,{default:l(()=>[s("重置")]),_:1}),e(m,{type:"text",icon:c.value?"up":"down",onClick:a[5]||(a[5]=t=>c.value=!c.value)},{default:l(()=>[s(E(c.value?"收起":"展开"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),action:l(()=>[e(m,{type:"primary",icon:"plus",onClick:Y},{default:l(()=>[s("新增")]),_:1})]),actionRight:l(()=>[e(de,{style:{"margin-left":"20px"}},{dropdown:l(()=>[e(re,null,{default:l(()=>[e(L,null,{default:l(()=>[s("刷新")]),_:1}),e(L,null,{default:l(()=>[s("删除")]),_:1})]),_:1})]),default:l(()=>[e(m,null,{default:l(()=>[s(" 更多操作 "),e(ue,{name:"down"})]),_:1})]),_:1})]),page:l(()=>[e(me,{total:r(O),current:u.page,"page-size":u.size,"show-total":"",onChange:r(Q),onSizeChange:r(W)},null,8,["total","current","page-size","onChange","onSizeChange"])]),default:l(()=>[e(ie,{columns:te,data:w.value,loading:r(N),size:"small"},{roles:l(({row:t})=>[s(E(y[t.roles]),1)]),action:l(({row:t})=>[e(B,{type:"text",icon:"edit-square","is-icon":"",tooltip:"编辑",onClick:p=>Z(t)},null,8,["onClick"]),e(se,{type:"vertical"}),e(B,{type:"text",icon:"delete",color:"danger","is-icon":"",tooltip:"删除",confirm:"",onClick:p=>ee(t)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1})]),_:1}),e(be,{"model-value":r(z),title:`${r(U).isCreate?"新增":"修改"}用户`,onClosed:T},{footer:l(()=>[xe("div",null,[e(m,{onClick:T},{default:l(()=>[s("取 消")]),_:1}),e(m,{type:"primary",loading:r(H),onClick:le},{default:l(()=>[s("确 定")]),_:1},8,["loading"])])]),default:l(()=>[r(z)?(f(),V("div",Ne,[e(D,{ref_key:"formRef",ref:G,model:n.value,rules:ae,"label-width":"100px","label-suffix":":"},{default:l(()=>[e(d,{label:"所属部门"},{default:l(()=>[e(_e,{modelValue:n.value.depart,"onUpdate:modelValue":a[6]||(a[6]=t=>n.value.depart=t),data:r(x),"title-key":"text"},null,8,["modelValue","data"])]),_:1}),e(d,{label:"姓名",prop:"realName"},{default:l(()=>[e(_,{modelValue:n.value.realName,"onUpdate:modelValue":a[7]||(a[7]=t=>n.value.realName=t),placeholder:"输入姓名",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"用户名",prop:"username"},{default:l(()=>[e(_,{modelValue:n.value.username,"onUpdate:modelValue":a[8]||(a[8]=t=>n.value.username=t),placeholder:"输入登录名",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"邮箱"},{default:l(()=>[e(_,{modelValue:n.value.email,"onUpdate:modelValue":a[9]||(a[9]=t=>n.value.email=t),placeholder:"输入邮箱",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"角色"},{default:l(()=>[e(C,{modelValue:n.value.roles,"onUpdate:modelValue":a[10]||(a[10]=t=>n.value.roles=t),placeholder:"选择角色",clearable:""},{default:l(()=>[(f(),V(k,null,q(y,(t,p)=>e(v,{key:p,label:t,value:p},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])):F("",!0)]),_:1},8,["model-value","title"])]),_:1})}}});export{qe as default};
