import{r as b,o as v,j as N,w as t,K as o,L as p,f as i,b as c,g as I,v as J,T as Q,a as X,t as Y,i as Z,R as l}from"./vendor-COsJffew.js";import{e as ee}from"./mock.api-B0TQ_Vwh.js";import{d as te}from"./index-DlSIhdb0.js";import{u as oe}from"./useForm-Uovr2fiU.js";import{n as ae}from"./chunk-bin-ui-design-55yTQV6H.js";import"./chunk-brace-DF1jSkZr.js";import"./avatar04-C-sfeKu8.js";const le={flex:"main:justify cross:center",style:{"font-weight":"normal"}},ne={class:"top"},re={style:{position:"relative","min-height":"100px",overflow:"hidden"}},se={style:{position:"absolute",width:"100%"}},ue={key:0,class:"pt-8"},ve=Object.assign({name:"SysMenu"},{__name:"menu",setup(de){const h=b(null),r=b(null),a=b({}),y=b({}),{formRef:R,editStatus:T,pageStatus:f,editLoading:g,openCreate:B,openEdit:F,backNormal:k,submitForm:K,resetForm:U}=oe();function j(n,e){n.selected?(r.value=n,y.value=e,P()):E()}function D(n){if(n==="root"&&C(),n==="child"){C();const e=r.value;a.value.parentPath=e.path,a.value.parentName=e.title}}function w(n="edit"){if(n==="edit"){const e=y.value,u=r.value,d=e[u.nodeKey].parent,_=d||d===0?e[d].node:{};a.value=u?{...te(u),parentPath:d===0?"":_.path,parentName:_.title}:{};return}a.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function E(){r.value=null,y.value=null,a.value={},k()}function C(){w("create"),B()}function P(){w("edit"),F()}function q(){K(()=>{g.value=!0;const n=f.value;setTimeout(()=>{ae.success(`${n.isCreate?"新增":"修改"}成功！`),k();const e=r.value?[r.value.nodeKey]:[];h.value&&h.value.reloadTree(e),g.value=!1},1e3)})}function L(){w(T.value),U()}const M={path:[{required:!0,message:"菜单路径必填",trigger:"blur"}],title:[{required:!0,message:"菜单名称必填",trigger:"blur"}]};return(n,e)=>{const u=l("b-dropdown-item"),d=l("base-tree"),_=l("iconfont"),S=l("b-alert"),V=l("b-input"),m=l("b-form-item"),O=l("b-icon-select"),x=l("b-button"),W=l("b-form"),$=l("b-col"),z=l("b-row"),A=l("b-card"),G=l("b-layout"),H=l("page-wrapper");return v(),N(H,null,{default:t(()=>[o(G,{"has-sider":"",collapsedWidth:24},{sider:t(()=>[o(d,{ref_key:"treeRef",ref:h,"tree-title":"菜单列表","show-filter":"","title-key":"title",fetch:p(ee),onSelectChange:j,onCommand:D},{ctrl:t(()=>[o(u,{name:"root",divided:""},{default:t(()=>e[4]||(e[4]=[i("增加根节点")])),_:1}),o(u,{name:"child",disabled:!r.value},{default:t(()=>e[5]||(e[5]=[i("增加子节点")])),_:1},8,["disabled"])]),_:1},8,["fetch"])]),default:t(()=>[o(A,{bordered:!1,class:"card-panel",shadow:"never"},{header:t(()=>[c("div",le,[c("div",ne,[o(_,{icon:"menu",color:"primary",bg:"",round:""}),e[6]||(e[6]=c("span",{class:"ml-5"},"编辑菜单",-1))])])]),default:t(()=>[c("div",re,[c("div",se,[I(o(S,null,{default:t(()=>e[7]||(e[7]=[i("点选左侧部门，进行编辑操作")])),_:1},512),[[J,p(f).isNormal]])]),o(Q,{name:"fade-transverse"},{default:t(()=>[p(f).isNormal?Z("",!0):(v(),X("div",ue,[a.value.path!=="root"?(v(),N(z,{key:0},{default:t(()=>[o($,{span:"14"},{default:t(()=>[o(W,{ref_key:"formRef",ref:R,model:a.value,rules:M,"label-width":"100px","label-suffix":":"},{default:t(()=>[o(m,{label:"父级菜单"},{default:t(()=>[o(V,{modelValue:a.value.parentName,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.parentName=s),disabled:""},null,8,["modelValue"])]),_:1}),o(m,{label:"菜单名称",prop:"title"},{default:t(()=>[o(V,{modelValue:a.value.title,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.title=s),placeholder:"输入菜单名称",clearable:""},null,8,["modelValue"])]),_:1}),o(m,{label:"菜单路径",prop:"path"},{default:t(()=>[o(V,{modelValue:a.value.path,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.path=s),placeholder:"输入菜单路径",clearable:""},null,8,["modelValue"])]),_:1}),o(m,{label:"菜单图标"},{default:t(()=>[o(O,{modelValue:a.value.icon,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.icon=s)},null,8,["modelValue"])]),_:1}),o(m,null,{default:t(()=>[o(x,{type:"primary",onClick:q,loading:p(g)},{default:t(()=>[i(Y(p(f).isCreate?"提交数据":"更新数据"),1)]),_:1},8,["loading"]),o(x,{onClick:L},{default:t(()=>e[8]||(e[8]=[i("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})):(v(),N(S,{key:1,type:"error","show-icon":""},{default:t(()=>e[9]||(e[9]=[i("系统菜单根节点不可编辑")])),_:1}))]))]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{ve as default};
