import{j as U,m as j}from"./index-81afa469.js";import{a9 as K,m as C,E as n,o as V,f as R,w as t,c as o,b as u,T as M,k as P,v as q,a as L,e as m,t as z,j as A}from"./vendor-23852376.js";import{u as G}from"./useForm-0126ab8a.js";import{a as H}from"./chunk-bin-ui-next-2203239f.js";import"./chunk-brace-bd816051.js";function I(){return U({url:"/menu/tree",method:"get"})}const J={name:"Menu",setup(){const h=C(null),a=C(null),i=C({}),e=C({}),{formRef:B,editStatus:D,pageStatus:_,editLoading:p,openCreate:w,openEdit:b,backNormal:s,submitForm:c,resetForm:v}=G();function y(r,d){r.selected?(a.value=r,e.value=d,x()):k()}function S(r){if(r==="root"&&g(),r==="child"){g();const d=a.value;i.value.parentPath=d.path,i.value.parentName=d.title}}function f(r="edit"){if(r==="edit"){const d=e.value,F=a.value,N=d[F.nodeKey].parent,E=N||N===0?d[N].node:{};i.value=F?{...j(F),parentPath:N===0?"":E.path,parentName:E.title}:{};return}i.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function k(){a.value=null,e.value=null,i.value={},s()}function g(){f("create"),w()}function x(){f("edit"),b()}function T(){c(()=>{p.value=!0;const r=_.value;setTimeout(()=>{H.success(`${r.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),s();const d=a.value?[a.value.nodeKey]:[];h.value&&h.value.reloadTree(d),p.value=!1},1e3)})}function l(){f(D.value),v()}return{treeRef:h,getMenuTree:I,currentNode:a,copyNode:i,handleSelect:y,handleSubmit:T,handleResetForm:l,handleCommand:S,formRef:B,pageStatus:_,editLoading:p,submitForm:c,resetForm:v,ruleValidate:{path:[{required:!0,message:"\u83DC\u5355\u8DEF\u5F84\u5FC5\u586B",trigger:"blur"}],title:[{required:!0,message:"\u83DC\u5355\u540D\u79F0\u5FC5\u586B",trigger:"blur"}]}}}},O=m("\u589E\u52A0\u6839\u8282\u70B9"),Q=m("\u589E\u52A0\u5B50\u8282\u70B9"),W={class:"pl-16"},X={flex:"main:justify cross:center",style:{"font-weight":"normal"}},Y={class:"top"},Z=u("span",{class:"ml-5"},"\u7F16\u8F91\u83DC\u5355",-1),$={style:{position:"relative","min-height":"100px",overflow:"hidden"}},ee={style:{position:"absolute",width:"100%"}},te=m("\u70B9\u9009\u5DE6\u4FA7\u90E8\u95E8\uFF0C\u8FDB\u884C\u7F16\u8F91\u64CD\u4F5C"),oe={key:0,class:"pt-8"},ae=m("\u91CD\u7F6E"),ne=m("\u7CFB\u7EDF\u83DC\u5355\u6839\u8282\u70B9\u4E0D\u53EF\u7F16\u8F91");function le(h,a,i,e,B,D){const _=n("b-dropdown-item"),p=n("base-tree"),w=n("iconfont"),b=n("b-alert"),s=n("b-input"),c=n("b-form-item"),v=n("b-icon-select"),y=n("b-button"),S=n("b-form"),f=n("b-col"),k=n("b-row"),g=n("b-card"),x=n("page-cube-wrapper"),T=n("page-container");return V(),R(T,{"inner-scroll":"","hide-header":""},{default:t(()=>[o(x,null,{left:t(()=>[o(p,{ref:"treeRef","tree-title":"\u83DC\u5355\u5217\u8868","show-filter":"","title-key":"title",fetch:e.getMenuTree,onSelectChange:e.handleSelect,onCommand:e.handleCommand},{ctrl:t(()=>[o(_,{name:"root",divided:""},{default:t(()=>[O]),_:1}),o(_,{name:"child",disabled:!e.currentNode},{default:t(()=>[Q]),_:1},8,["disabled"])]),_:1},8,["fetch","onSelectChange","onCommand"])]),default:t(()=>[u("div",W,[o(g,{bordered:!1,class:"card-panel",shadow:"never"},{header:t(()=>[u("div",X,[u("div",Y,[o(w,{icon:"menu",color:"primary",bg:"",round:""}),Z])])]),default:t(()=>[u("div",$,[o(M,{name:"fade-in"},{default:t(()=>[u("div",ee,[P(o(b,null,{default:t(()=>[te]),_:1},512),[[q,e.pageStatus.isNormal]])])]),_:1}),o(M,{name:"fade-transverse"},{default:t(()=>[e.pageStatus.isNormal?A("",!0):(V(),L("div",oe,[e.copyNode.path!=="root"?(V(),R(k,{key:0},{default:t(()=>[o(f,{span:"14"},{default:t(()=>[o(S,{ref:"formRef",model:e.copyNode,rules:e.ruleValidate,"label-width":"100px","label-suffix":":"},{default:t(()=>[o(c,{label:"\u7236\u7EA7\u83DC\u5355"},{default:t(()=>[o(s,{modelValue:e.copyNode.parentName,"onUpdate:modelValue":a[0]||(a[0]=l=>e.copyNode.parentName=l),disabled:""},null,8,["modelValue"])]),_:1}),o(c,{label:"\u83DC\u5355\u540D\u79F0",prop:"title"},{default:t(()=>[o(s,{modelValue:e.copyNode.title,"onUpdate:modelValue":a[1]||(a[1]=l=>e.copyNode.title=l),placeholder:"\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),o(c,{label:"\u83DC\u5355\u8DEF\u5F84",prop:"path"},{default:t(()=>[o(s,{modelValue:e.copyNode.path,"onUpdate:modelValue":a[2]||(a[2]=l=>e.copyNode.path=l),placeholder:"\u8F93\u5165\u83DC\u5355\u8DEF\u5F84",clearable:""},null,8,["modelValue"])]),_:1}),o(c,{label:"\u83DC\u5355\u56FE\u6807"},{default:t(()=>[o(v,{modelValue:e.copyNode.icon,"onUpdate:modelValue":a[3]||(a[3]=l=>e.copyNode.icon=l)},null,8,["modelValue"])]),_:1}),o(c,null,{default:t(()=>[o(y,{type:"primary",onClick:e.handleSubmit,loading:e.editLoading},{default:t(()=>[m(z(e.pageStatus.isCreate?"\u63D0\u4EA4\u6570\u636E":"\u66F4\u65B0\u6570\u636E"),1)]),_:1},8,["onClick","loading"]),o(y,{onClick:e.handleResetForm},{default:t(()=>[ae]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})):(V(),R(b,{key:1,type:"error","show-icon":""},{default:t(()=>[ne]),_:1}))]))]),_:1})])]),_:1})])]),_:1})]),_:1})}const ue=K(J,[["render",le]]);export{ue as default};
