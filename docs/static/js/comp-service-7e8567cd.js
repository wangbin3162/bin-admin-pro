var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,i=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,d=(e,l)=>{for(var a in l||(l={}))n.call(l,a)&&i(e,a,l[a]);if(o)for(var a of o(l))t.call(l,a)&&i(e,a,l[a]);return e},u=(e,o)=>l(e,a(o));import{_ as s}from"./page-wrapper-d233775a.js";import{a7 as r,a8 as m,f as c,n as p,J as h,o as g,A as V,B as v,u as b,w as f,a as R,q as k,g as y,F as C,K as U,c as w,t as x,D as _}from"./vendor-fe3131ae.js";import"./index-e9e85ee6.js";import{_ as D,u as E}from"./index-5542bbfe.js";import"./chunk-brace-7f859248.js";import"./chunk-bin-ui-next-169a0b5b.js";const L={name:"styles-editor",props:{modelValue:{type:String,default:""},showAction:{type:Boolean,default:!0},height:{type:String,default:"100px"}},emits:["update:modelValue","change"],setup(e,{emit:l}){const a=c(""),o=c("25%");function n(){l("update:modelValue",a.value),l("change",a.value)}function t(){a.value="width: 25%;",n()}return p((()=>e.modelValue),(l=>{""!==l?(!function(){const l=e.modelValue;l.includes("width: 25%;")?o.value="25%":l.includes("width: 50%;")?o.value="50%":l.includes("width: 75%;")?o.value="75%":l.includes("width: 100%;")?o.value="100%":o.value=""}(),a.value=l):t()}),{immediate:!0}),p((()=>o.value),(e=>{a.value=`width: ${e};`,n()})),{width:o,styleValue:a,emitValue:n,resetStyle:t}}};r("data-v-5d5152a2");const $={class:"styles-editor-wrap"},q={flex:"main:justify"},M={class:"editor-box"},F={key:0,class:"action-box"},N={class:"mb-5",flex:"main:justify cross:center"},z=v("div",null,"样式显示",-1),S=v("div",{class:"mb-5"},[v("div",null,"宽度设置")],-1),P={class:"mb-5",flex:"cross:center"},j=k("1"),B=k("2"),O=k("3"),I=k("4"),A=v("span",{class:"ml-5"},"/ 4",-1);m(),L.render=function(e,l,a,o,n,t){const i=h("b-ace-editor"),d=h("b-icon"),u=h("b-tooltip"),s=h("b-space"),r=h("b-radio"),m=h("b-radio-group");return g(),V("div",$,[v("div",q,[v("div",M,[b(i,{modelValue:o.styleValue,"onUpdate:modelValue":l[0]||(l[0]=e=>o.styleValue=e),lang:"stylus",height:a.height,"font-size":14,onBlur:o.emitValue},null,8,["modelValue","height","onBlur"])]),a.showAction?(g(),V("div",F,[v("div",N,[z,b(s,null,{default:f((()=>[b(u,{content:"输入样式表，默认控件宽度皆为25%"},{default:f((()=>[b(d,{name:"question-circle",size:18})])),_:1}),b(u,{content:"重置样式"},{default:f((()=>[b(d,{name:"sync",size:18,type:"button",onClick:o.resetStyle},null,8,["onClick"])])),_:1})])),_:1})]),S,v("div",P,[b(m,{modelValue:o.width,"onUpdate:modelValue":l[1]||(l[1]=e=>o.width=e),type:"button",size:"mini"},{default:f((()=>[b(r,{label:"25%"},{default:f((()=>[j])),_:1}),b(r,{label:"50%"},{default:f((()=>[B])),_:1}),b(r,{label:"75%"},{default:f((()=>[O])),_:1}),b(r,{label:"100%"},{default:f((()=>[I])),_:1})])),_:1},8,["modelValue"]),A])])):R("",!0)])])},L.__scopeId="data-v-5d5152a2";const T=["blur","change"],J=["string","number"],G={length:"$length",email:"$email",phone:"$phone",idCode:"$idCode",unifiedCode:"$unifiedCode",orgInstCode:"$orgInstCode",regNo:"$regNo"},H={regexp:"$regexp",conditionRequired:"$conditionRequired",conditionNotRequired:"$conditionNotRequired",conditionNotBe:"$conditionNotBe",notSame:"$notSame",timeBound:"$timeBound"},K=d(d({required:"$required"},G),H),W={$required:"必填项",$length:"长度参数",$email:"邮箱参数",$phone:"手机号码",$regexp:"正则匹配",$idCode:"身份证",$unifiedCode:"统一社会信用代码",$orgInstCode:"组织机构代码",$regNo:"工商注册号",$conditionRequired:"条件必填",$conditionNotRequired:"条件必不填",$conditionNotBe:"条件不为某值",$notSame:"值不能相同",$timeBound:"日期区间"};const Y={name:"async-validator",components:{DragHandle:D},props:{modelValue:{type:String,default:""},dataLength:Number,originalRules:{type:String},showLog:Boolean},emits:["update:modelValue","change"],setup(e,{emit:l}){const a=c(!1),o=c([]),{listRef:n}=E(o,m),t=y((()=>!!i(K.required))),i=e=>o.value.find((l=>l.name===e));function s(l){if(l===K.required&&t.value)return;const a=e=>({name:e,type:J[0],trigger:T[0]});switch(l){case K.required:o.value.unshift(u(d({},a(l)),{message:"必填项"}));break;case K.length:o.value.push(u(d({},a(l)),{min:1,max:e.dataLength||1/0,message:"长度必须在指定的范围内"}));break;case K.email:o.value.push(u(d({},a(l)),{message:"邮箱格式不正确"}));break;case K.phone:o.value.push(u(d({},a(l)),{message:"手机号格式不正确"}));break;case K.idCode:o.value.push(u(d({},a(l)),{preField:"",message:"身份证格式不正确",ignoreCase:!0}));break;case K.unifiedCode:o.value.push(u(d({},a(l)),{preField:"",message:"统一社会信用代码格式不正确",ignoreCase:!0}));break;case K.orgInstCode:o.value.push(u(d({},a(l)),{preField:"",message:"组织机构代码格式不正确",ignoreCase:!0}));break;case K.regNo:o.value.push(u(d({},a(l)),{preField:"",message:"工商注册号格式不正确",ignoreCase:!0}));break;case K.regexp:o.value.push(u(d({},a(l)),{regexp:"",message:"正则表达式不匹配"}));break;case K.conditionRequired:o.value.push(u(d({},a(l)),{preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下必填"}));break;case K.conditionNotRequired:o.value.push(u(d({},a(l)),{preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下不可填写"}));break;case K.conditionNotBe:o.value.push(u(d({},a(l)),{preField:"",preFieldValue:"",notValue:"",message:"当前字段在前置字段条件达成下不能为某值"}));break;case K.notSame:o.value.push(u(d({},a(l)),{preField:"",message:"不能和前置字段值相同"}));break;case K.timeBound:o.value.push(u(d({},a(l)),{time:"$now",compareMode:"gt",message:"日期不符合区间设置"}))}m()}function r(){o.value=[],a.value=!1,m()}function m(){const e=o.value.length?JSON.stringify(o.value):"";l("update:modelValue",e),l("change",e)}return p((()=>e.modelValue),(e=>{if(""!==e)try{o.value=JSON.parse(e),a.value=t.value}catch(l){console.warn("async-validator: model-value is not a right json，rules is reset"),r()}else r()}),{immediate:!0}),{rulesRef:n,SIMPLE_RULE:G,MULTIPLE_RULE:H,RULE:K,RULE_NAME_MAP:W,TRIGGER:T,TYPE:J,hasRequiredRule:t,isRequired:a,checkRules:o,rulesClass:function(e){return e===K.required?"is-required":H[e.slice(1)]?"is-multiple":"is-normal"},requiredChange:function(e){e?s(K.required):(o.value=o.value.filter((e=>e.name!==K.required)),m())},setRules:s,removeRules:function(e){o.value.splice(e,1),m()},hasSameRule:function(e){return!H[e]&&!!i(e)},emitValue:m,allowDrop:function(e){e.preventDefault()},onDrop:function(e,l){o.value[l].hasOwnProperty("preField")&&(o.value[l].preField=e.dataTransfer.getData("index")),o.value[l].hasOwnProperty("time")&&(o.value[l].time=e.dataTransfer.getData("index")),m(),e.preventDefault()},reload:function(){e.originalRules&&(l("update:modelValue",e.originalRules),l("change",e.originalRules))},refreshRules:r}}};r("data-v-135d0b0e");const Q={class:"validator-wrap"},X={class:"mb-10",style:{padding:"0 4px"}},Z={style:{width:"100%","line-height":"32px"},flex:"main:justify"},ee=k(" 必填项 "),le={style:{cursor:"pointer",color:"#13c2c2"}},ae=k(" 静态规则 "),oe={style:{cursor:"pointer",color:"#52c41a"}},ne=k(" 动态规则 "),te=v("i",{class:"b-iconfont b-icon-reload"},null,-1),ie=v("i",{class:"b-iconfont b-icon-mr"},null,-1),de={class:"check-rules-wrap",ref:"rulesRef"},ue={class:"rules-params"},se={class:"title-box",title:"触发条件"},re=v("span",{title:"输入框为失焦事件，其余控件为改变事件"},"触发条件",-1),me={class:"title-box",title:"取值类型"},ce=v("span",{title:"非数字类型选择字符"},"取值类型",-1),pe={class:"rules-cfg"},he={key:0,class:"title-box is-message",title:"正则规则"},ge=v("span",null,"正则规则",-1),Ve={class:"title-box",title:"最小值"},ve=v("span",{style:{width:"60px"}},"最小值",-1),be={class:"title-box",title:"最大值"},fe=v("span",{style:{width:"60px"}},"最大值",-1),Re=["onDrop"],ke=v("span",null,"前置字段",-1),ye=k(" 忽略大小写 "),Ce=["onDrop"],Ue=v("span",null,"前置字段",-1),we={class:"title-box",title:"前置字段值"},xe=v("span",null,"前置字段值",-1),_e=["onDrop"],De=v("span",null,"前置字段",-1),Ee={class:"title-box",title:"前置字段值"},Le=v("span",null,"前置字段值",-1),$e={class:"title-box",title:"不是某值"},qe=v("span",null,"不是某值",-1),Me=["onDrop"],Fe=v("span",null,"前置字段",-1),Ne={class:"title-box",title:"比较模式"},ze=v("span",null,"比较模式",-1),Se=["onDrop"],Pe=v("span",{title:"比较值(yyyy-MM-dd)，可以是字段名，也可以填写$now取得当前时间"},"比较取值",-1),je={class:"rules-message"},Be={class:"title-box is-message",title:"错误提示"},Oe=v("span",null,"错误提示",-1),Ie={class:"delete"},Ae={key:0};m(),Y.render=function(e,l,a,o,n,t){const i=h("b-checkbox"),d=h("b-divider"),u=h("b-icon"),s=h("b-dropdown-item"),r=h("b-dropdown-menu"),m=h("b-dropdown"),c=h("b-button"),p=h("b-tooltip"),y=h("b-option"),D=h("b-select"),E=h("b-space"),L=h("b-input"),$=h("b-input-number"),q=h("drag-handle"),M=h("b-ace-editor");return g(),V("div",Q,[v("div",X,[v("div",Z,[v("div",null,[b(i,{modelValue:o.isRequired,"onUpdate:modelValue":l[0]||(l[0]=e=>o.isRequired=e),onChange:o.requiredChange,style:{"margin-right":"0"}},{default:f((()=>[ee])),_:1},8,["modelValue","onChange"]),b(d,{type:"vertical"}),b(m,{onCommand:o.setRules},{dropdown:f((()=>[b(r,null,{default:f((()=>[(g(!0),V(C,null,U(o.SIMPLE_RULE,((e,l)=>(g(),w(s,{key:l,name:e,disabled:o.hasSameRule(e)},{default:f((()=>[k(x(o.RULE_NAME_MAP[e]),1)])),_:2},1032,["name","disabled"])))),128))])),_:1})])),default:f((()=>[v("span",le,[ae,b(u,{name:"down"})])])),_:1},8,["onCommand"]),b(d,{type:"vertical"}),b(m,{onCommand:o.setRules},{dropdown:f((()=>[b(r,null,{default:f((()=>[(g(!0),V(C,null,U(o.MULTIPLE_RULE,((e,l)=>(g(),w(s,{key:l,name:e},{default:f((()=>[k(x(o.RULE_NAME_MAP[e]),1)])),_:2},1032,["name"])))),128))])),_:1})])),default:f((()=>[v("span",oe,[ne,b(u,{name:"down"})])])),_:1},8,["onCommand"])]),v("div",null,[b(p,{content:"初始化校验"},{default:f((()=>[b(c,{background:"",size:"mini",onClick:o.refreshRules},{default:f((()=>[te])),_:1},8,["onClick"])])),_:1}),a.originalRules?(g(),w(p,{key:0,content:"恢复修改前校验"},{default:f((()=>[b(c,{background:"",size:"mini",onClick:o.reload},{default:f((()=>[ie])),_:1},8,["onClick"])])),_:1})):R("",!0)])])]),v("ul",de,[(g(!0),V(C,null,U(o.checkRules,((e,n)=>(g(),V("li",{key:n,class:"rules-list-item"},[v("div",ue,[b(E,null,{default:f((()=>[v("div",{class:_(["role-name",o.rulesClass(e.name)])},x(o.RULE_NAME_MAP[e.name]),3),v("div",se,[re,b(D,{modelValue:o.checkRules[n].trigger,"onUpdate:modelValue":e=>o.checkRules[n].trigger=e,size:"small","append-to-body":"",onChange:o.emitValue},{default:f((()=>[b(y,{label:"失焦",value:"blur"}),b(y,{label:"改变",value:"change"})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),v("div",me,[ce,b(D,{modelValue:o.checkRules[n].type,"onUpdate:modelValue":e=>o.checkRules[n].type=e,size:"small","append-to-body":"",onChange:o.emitValue},{default:f((()=>[b(y,{label:"字符",value:"string"}),b(y,{label:"数字",value:"number"})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])])),_:2},1024)]),v("div",pe,[e.name===o.RULE.regexp?(g(),V("div",he,[ge,b(L,{modelValue:o.checkRules[n].regexp,"onUpdate:modelValue":e=>o.checkRules[n].regexp=e,modelModifiers:{trim:!0},size:"small",placeholder:"需输入字符格式",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])):R("",!0),b(E,null,{default:f((()=>[e.name===o.RULE.length?(g(),V(C,{key:0},[v("div",Ve,[ve,b($,{modelValue:o.checkRules[n].min,"onUpdate:modelValue":e=>o.checkRules[n].min=e,min:1,max:a.dataLength,precision:0,size:"small",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])]),v("div",be,[fe,b($,{modelValue:o.checkRules[n].max,"onUpdate:modelValue":e=>o.checkRules[n].max=e,min:1,max:a.dataLength,precision:0,size:"small",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])])],64)):R("",!0),[o.RULE.idCode,o.RULE.unifiedCode,o.RULE.orgInstCode,o.RULE.regNo].includes(e.name)?(g(),V(C,{key:1},[v("div",{class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[1]||(l[1]=e=>o.allowDrop(e))},[ke,b(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Re),b(i,{modelValue:o.checkRules[n].ignoreCase,"onUpdate:modelValue":e=>o.checkRules[n].ignoreCase=e,onChange:o.emitValue},{default:f((()=>[ye])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])],64)):R("",!0),e.name===o.RULE.conditionRequired||e.name===o.RULE.conditionNotRequired?(g(),V(C,{key:2},[v("div",{class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[2]||(l[2]=e=>o.allowDrop(e))},[Ue,b(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Ce),v("div",we,[xe,b(L,{modelValue:o.checkRules[n].preFieldValue,"onUpdate:modelValue":e=>o.checkRules[n].preFieldValue=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):R("",!0),e.name===o.RULE.conditionNotBe?(g(),V(C,{key:3},[v("div",{class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[3]||(l[3]=e=>o.allowDrop(e))},[De,b(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,_e),v("div",Ee,[Le,b(L,{modelValue:o.checkRules[n].preFieldValue,"onUpdate:modelValue":e=>o.checkRules[n].preFieldValue=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])]),v("div",$e,[qe,b(L,{modelValue:o.checkRules[n].notValue,"onUpdate:modelValue":e=>o.checkRules[n].notValue=e,modelModifiers:{trim:!0},size:"small",placeholder:"不是某值",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):R("",!0),e.name===o.RULE.notSame?(g(),V("div",{key:4,class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[4]||(l[4]=e=>o.allowDrop(e))},[Fe,b(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Me)):R("",!0),e.name===o.RULE.timeBound?(g(),V(C,{key:5},[v("div",Ne,[ze,b(D,{modelValue:o.checkRules[n].compareMode,"onUpdate:modelValue":e=>o.checkRules[n].compareMode=e,"append-to-body":"",size:"small",onChange:o.emitValue},{default:f((()=>[b(y,{value:"gt",label:">"}),b(y,{value:"ge",label:"≥"}),b(y,{value:"lt",label:"<"}),b(y,{value:"le",label:"≤"})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),v("div",{class:"title-box",onDrop:e=>o.onDrop(e,n),onDragover:l[5]||(l[5]=e=>o.allowDrop(e))},[Pe,b(L,{modelValue:o.checkRules[n].time,"onUpdate:modelValue":e=>o.checkRules[n].time=e,modelModifiers:{trim:!0},size:"small",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Se)],64)):R("",!0)])),_:2},1024)]),v("div",je,[v("div",Be,[Oe,b(L,{modelValue:o.checkRules[n].message,"onUpdate:modelValue":e=>o.checkRules[n].message=e,modelModifiers:{trim:!0},size:"small",placeholder:"错误提示",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),b(q,{icon:"drag-drop-line"}),v("div",Ie,[b(u,{title:"移除",color:"#f5222d",name:"minus-circle",size:"20",type:"button",onClick:e=>o.removeRules(n)},null,8,["onClick"])])])))),128))],512),a.showLog?(g(),V("div",Ae,[b(M,{"model-value":JSON.stringify(o.checkRules,null,2),readonly:""},null,8,["model-value"])])):R("",!0)])},Y.__scopeId="data-v-135d0b0e";const Te={name:"CompService",components:{AsyncValidator:Y,StylesEditor:L,PageWrapper:s}},Je={class:"p10",style:{"min-height":"200px"}};Te.render=function(e,l,a,o,n,t){const i=h("async-validator"),d=h("b-collapse-wrap"),u=h("b-col"),s=h("styles-editor"),r=h("b-row"),m=h("page-wrapper");return g(),w(m,{desc:"业务相关的独立组件，包含通用校验配置，字段样式配置等，可参考进行扩展或实现新的业务组件。"},{default:f((()=>[b(r,{gutter:16},{default:f((()=>[b(u,{span:"12"},{default:f((()=>[b(d,{title:"表单校验",shadow:"none"},{default:f((()=>[v("div",Je,[b(i)])])),_:1})])),_:1}),b(u,{span:"12"},{default:f((()=>[b(d,{title:"字段样式配置",shadow:"none"},{default:f((()=>[b(s)])),_:1})])),_:1})])),_:1})])),_:1})};export{Te as default};
