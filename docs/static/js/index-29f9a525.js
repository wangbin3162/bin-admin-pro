import{i as E,t as K}from"./index-7532bb53.js";import{f as y,x as T,a4 as H,g as N,n as I,J as w,L as j,o as v,A as b,B as i,t as z,c as O,a as p,r as S,u as h,w as f,F as P,d as R,D as L,E as q,a8 as U,a9 as W,q as C}from"./vendor-10026a69.js";function J(t,s={},a,n="text"){const o=y(null),l=y([]),_=y(""),c=y(!1),u=y(!1),d=async()=>{if(!!t){try{r(!0);const e=await t(s);E(e)==="object"?l.value=[e]:l.value=e,a&&a.emit("init-success")}catch(e){K("useTree/getTreeData",e)}r(!1)}},k=async(e=[],m=[])=>{await d(),await T(),o.value.setSelected(e),o.value.setExpand(m)},g=async(e=[])=>{await d(),await T(),o.value&&o.value.setChecked(e)};function r(e){c.value=e}return{treeRef:o,query:_,loading:c,treeData:l,hasChecked:u,getFlatState:()=>o.value.getFlatState(),getTreeData:d,reloadTree:k,reloadTreeWithCheck:g,handleFilter:e=>{o.value&&o.value.filter(e)},filterNode:(e,m)=>e?m[n].indexOf(e)!==-1:!0,handleSelect:(e,m,A)=>{a&&a.emit("select-change",m,A)},handleChecked:(e,m,A)=>{u.value=e.length>0,a&&a.emit("check-change",e,m,A)}}}const G={name:"BaseTree",props:{width:{type:String,default:"320px"},minHeight:{type:String,default:"300px"},maxHeight:{type:String,default:"700px"},treeTitle:{type:String},filterPosition:{type:String,default:"top"},lock:Boolean,fetch:{type:[Function,Array]},params:{type:Object},render:Function,showCheckbox:{type:Boolean},checkStrictly:{type:Boolean},showFilter:{type:Boolean},titleKey:{type:String,default:"text"},defaultExpand:{type:Boolean},expandKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]}},emits:["select-change","check-change","command","init-success"],setup(t,s){const a=y(null),n=N(()=>t.showFilter&&t.filterPosition==="top"),o=N(()=>t.showFilter&&t.filterPosition==="inner"),{treeRef:l,loading:_,query:c,treeData:u,getTreeData:d,reloadTree:k,reloadTreeWithCheck:g,handleSelect:r,handleChecked:F,handleFilter:B,filterNode:D}=J(t.fetch,t.params,s,t.titleKey);function V(e){switch(e){case"expandAll":l.value&&l.value.expandAll();break;case"collapseAll":l.value&&l.value.collapseAll();break;case"checkAll":l.value&&l.value.checkAll();break;case"uncheckAll":l.value&&l.value.uncheckAll();break}s.emit("command",e)}function x(){l.value&&l.value.setExpand(t.expandKeys),l.value&&l.value.setSelected(t.selectedKeys)}return I(()=>t.fetch,async e=>{if(E(e)==="array")return u.value=e,e.length>0&&(await T(),x()),!0;await d(),x()},{immediate:!0}),{treeEl:a,showTopSearch:n,showInnerSearch:o,treeRef:l,query:c,loading:_,treeData:u,getTreeData:d,reloadTree:k,reloadTreeWithCheck:g,handleSelect:r,handleChecked:F,handleAction:V,handleFilter:B,filterNode:D}}},M=t=>(U("data-v-73013618"),t=t(),W(),t),Q={class:"base-tree-header"},X={class:"base-title"},Y={class:"base-ctrl"},Z={class:"search"},$={class:"ctrl"},ee=M(()=>i("i",{class:"b-iconfont b-icon-ellipsis"},null,-1)),te=C("\u5C55\u5F00\u5168\u90E8"),ae=C("\u6536\u8D77\u5168\u90E8"),ne=C("\u9009\u62E9\u5168\u90E8"),le=C("\u53D6\u6D88\u5168\u9009"),oe={key:0,class:"tree-inner"},se={key:1,class:"inner-search"},ce={class:"mr-5"},de={key:0,class:"tree-bottom"};function re(t,s,a,n,o,l){const _=w("b-input"),c=w("b-dropdown-item"),u=w("b-dropdown-menu"),d=w("b-dropdown"),k=w("b-tree"),g=j("loading");return v(),b("div",{class:"base-tree",style:q({width:a.width}),ref:"treeEl"},[i("div",Q,[i("span",X,z(a.treeTitle),1),i("div",Y,[i("div",Z,[n.showTopSearch?(v(),O(_,{key:0,size:"small",search:"",modelValue:n.query,"onUpdate:modelValue":s[0]||(s[0]=r=>n.query=r),placeholder:"\u641C\u7D22",onSearch:n.handleFilter},null,8,["modelValue","onSearch"])):p("",!0),S(t.$slots,"default",{},void 0,!0)]),i("div",$,[h(d,{"append-to-body":"",placement:"bottom-start",onCommand:n.handleAction},{dropdown:f(()=>[h(u,null,{default:f(()=>[h(c,{name:"expandAll"},{default:f(()=>[te]),_:1}),h(c,{name:"collapseAll"},{default:f(()=>[ae]),_:1}),a.showCheckbox?(v(),b(P,{key:0},[h(c,{name:"checkAll",divided:""},{default:f(()=>[ne]),_:1}),h(c,{name:"uncheckAll"},{default:f(()=>[le]),_:1})],64)):p("",!0),S(t.$slots,"ctrl",{},void 0,!0)]),_:3})]),default:f(()=>[ee]),_:3},8,["onCommand"])])])]),R(i("div",{class:L(["tree-wrap",{"has-bottom":t.$slots.bottom}]),style:q({minHeight:a.minHeight,maxHeight:a.maxHeight})},[t.$slots.inner?(v(),b("div",oe,[S(t.$slots,"inner",{},void 0,!0)])):p("",!0),n.showInnerSearch?(v(),b("div",se,[h(_,{size:"small",search:"",modelValue:n.query,"onUpdate:modelValue":s[1]||(s[1]=r=>n.query=r),placeholder:"\u641C\u7D22",onSearch:n.handleFilter},null,8,["modelValue","onSearch"])])):p("",!0),i("div",ce,[h(k,{data:n.treeData,"title-key":a.titleKey,"show-checkbox":a.showCheckbox,"filter-node-method":n.filterNode,render:a.render,"lock-select":a.lock,"default-expand":a.defaultExpand,ref:"treeRef",onSelectChange:n.handleSelect,onCheckChange:n.handleChecked},null,8,["data","title-key","show-checkbox","filter-node-method","render","lock-select","default-expand","onSelectChange","onCheckChange"])])],6),[[g,n.loading]]),t.$slots.bottom?(v(),b("div",de,[S(t.$slots,"bottom",{},void 0,!0)])):p("",!0)],4)}var ue=H(G,[["render",re],["__scopeId","data-v-73013618"]]);export{ue as B,J as u};
