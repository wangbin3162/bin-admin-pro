import{r as b,o as v,j as N,w as e,Q as l,K as t,L as m,f as i,b as p,T,g as I,v as J,a as X,t as Y,i as Z}from"./vendor-BdSUmcRD.js";import{s as ee,i as te}from"./index-t4HwjMnm.js";import{u as ae}from"./useForm-MCNDF1vY.js";import{n as oe}from"./chunk-bin-ui-design-XqwoFEXm.js";import"./chunk-brace-DkiLfVT0.js";import"./chunk-mockjs-B6s4ORgB.js";function le(){return ee({url:"/menu/tree",method:"get"})}const ne={flex:"main:justify cross:center",style:{"font-weight":"normal"}},re={class:"top"},se=p("span",{class:"ml-5"},"编辑菜单",-1),ue={style:{position:"relative","min-height":"100px",overflow:"hidden"}},de={style:{position:"absolute",width:"100%"}},ie={key:0,class:"pt-8"},he=Object.assign({name:"SysMenu"},{__name:"menu",setup(ce){const h=b(null),r=b(null),o=b({}),y=b({}),{formRef:B,editStatus:F,pageStatus:_,editLoading:g,openCreate:R,openEdit:D,backNormal:k,submitForm:K,resetForm:U}=ae();function j(n,a){n.selected?(r.value=n,y.value=a,q()):P()}function E(n){if(n==="root"&&C(),n==="child"){C();const a=r.value;o.value.parentPath=a.path,o.value.parentName=a.title}}function w(n="edit"){if(n==="edit"){const a=y.value,u=r.value,d=a[u.nodeKey].parent,f=d||d===0?a[d].node:{};o.value=u?{...te(u),parentPath:d===0?"":f.path,parentName:f.title}:{};return}o.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function P(){r.value=null,y.value=null,o.value={},k()}function C(){w("create"),R()}function q(){w("edit"),D()}function L(){K(()=>{g.value=!0;const n=_.value;setTimeout(()=>{oe.success(`${n.isCreate?"新增":"修改"}成功！`),k();const a=r.value?[r.value.nodeKey]:[];h.value&&h.value.reloadTree(a),g.value=!1},1e3)})}function M(){w(F.value),U()}const O={path:[{required:!0,message:"菜单路径必填",trigger:"blur"}],title:[{required:!0,message:"菜单名称必填",trigger:"blur"}]};return(n,a)=>{const u=l("b-dropdown-item"),d=l("base-tree"),f=l("iconfont"),S=l("b-alert"),V=l("b-input"),c=l("b-form-item"),Q=l("b-icon-select"),x=l("b-button"),W=l("b-form"),$=l("b-col"),z=l("b-row"),A=l("b-card"),G=l("b-layout"),H=l("page-wrapper");return v(),N(H,null,{default:e(()=>[t(G,{"has-sider":"",collapsedWidth:24},{sider:e(()=>[t(d,{ref_key:"treeRef",ref:h,"tree-title":"菜单列表","show-filter":"","title-key":"title",fetch:m(le),onSelectChange:j,onCommand:E},{ctrl:e(()=>[t(u,{name:"root",divided:""},{default:e(()=>[i("增加根节点")]),_:1}),t(u,{name:"child",disabled:!r.value},{default:e(()=>[i("增加子节点")]),_:1},8,["disabled"])]),_:1},8,["fetch"])]),default:e(()=>[t(A,{bordered:!1,class:"card-panel",shadow:"never"},{header:e(()=>[p("div",ne,[p("div",re,[t(f,{icon:"menu",color:"primary",bg:"",round:""}),se])])]),default:e(()=>[p("div",ue,[t(T,{name:"fade-in"},{default:e(()=>[p("div",de,[I(t(S,null,{default:e(()=>[i("点选左侧部门，进行编辑操作")]),_:1},512),[[J,m(_).isNormal]])])]),_:1}),t(T,{name:"fade-transverse"},{default:e(()=>[m(_).isNormal?Z("",!0):(v(),X("div",ie,[o.value.path!=="root"?(v(),N(z,{key:0},{default:e(()=>[t($,{span:"14"},{default:e(()=>[t(W,{ref_key:"formRef",ref:B,model:o.value,rules:O,"label-width":"100px","label-suffix":":"},{default:e(()=>[t(c,{label:"父级菜单"},{default:e(()=>[t(V,{modelValue:o.value.parentName,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value.parentName=s),disabled:""},null,8,["modelValue"])]),_:1}),t(c,{label:"菜单名称",prop:"title"},{default:e(()=>[t(V,{modelValue:o.value.title,"onUpdate:modelValue":a[1]||(a[1]=s=>o.value.title=s),placeholder:"输入菜单名称",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"菜单路径",prop:"path"},{default:e(()=>[t(V,{modelValue:o.value.path,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value.path=s),placeholder:"输入菜单路径",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"菜单图标"},{default:e(()=>[t(Q,{modelValue:o.value.icon,"onUpdate:modelValue":a[3]||(a[3]=s=>o.value.icon=s)},null,8,["modelValue"])]),_:1}),t(c,null,{default:e(()=>[t(x,{type:"primary",onClick:L,loading:m(g)},{default:e(()=>[i(Y(m(_).isCreate?"提交数据":"更新数据"),1)]),_:1},8,["loading"]),t(x,{onClick:M},{default:e(()=>[i("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})):(v(),N(S,{key:1,type:"error","show-icon":""},{default:e(()=>[i("系统菜单根节点不可编辑")]),_:1}))]))]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{he as default};
