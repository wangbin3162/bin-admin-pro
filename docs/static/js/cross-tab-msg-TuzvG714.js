import{ab as m}from"./vendor-B29aizbt.js";import{i as r,r as v}from"./index-dssKf-7O.js";class _{constructor(e,a="indexDB"){this.store=m.createInstance({name:e,driver:a!=="indexDB"?m.LOCALSTORAGE:m.INDEXEDDB})}async getStorage(e){if(!e){console.warn("storeKey or key is null!");return}return await this.store.getItem(e)}async setStorage(e,a){if(!e){console.warn("storeKey or key is null!");return}return await this.store.setItem(e,r(a)),await this.getStorage(e)}}const T={id:"0001",name:"工资填报",isPublish:"1",reportCount:1,records:1,jsonData:{info:{name:"工资填报"},sheets:[{name:"Sheet1",index:0,config:{columnlen:{1:100,2:100,3:109,4:94,5:98},customWidth:{1:1,2:1,3:1,4:1,5:1},rowlen:{0:45,1:45},customHeight:{0:1,1:1},borderInfo:[{rangeType:"cell",value:{row_index:0,col_index:0,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:1,l:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:2,r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:3,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:4,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:5,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:0,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:1,l:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:2,r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:3,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:4,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:5,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}}],merge:{"0_4":{r:0,c:4,rs:1,cs:2},"1_4":{r:1,c:4,rs:1,cs:2},"0_1":{r:0,c:1,rs:1,cs:2},"1_1":{r:1,c:1,rs:1,cs:2}}},celldata:[{r:0,c:0,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"宋体",ht:0,vt:0,tb:1,v:"姓名",qp:1,m:"姓名"}},{r:0,c:1,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:0,c:1,rs:1,cs:2}}},{r:0,c:2,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:0,c:1}}},{r:0,c:3,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"宋体",ht:0,vt:0,tb:1,v:"年龄",qp:1,m:"年龄"}},{r:0,c:4,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:0,c:4,rs:1,cs:2}}},{r:0,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:0,c:4}}},{r:1,c:0,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"宋体",ht:0,vt:0,tb:1,v:"工资",qp:1,m:"工资"}},{r:1,c:1,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:1,c:1,rs:1,cs:2}}},{r:1,c:2,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:1,c:1}}},{r:1,c:3,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"宋体",ht:0,vt:0,tb:1,v:"性别",qp:1,m:"性别"}},{r:1,c:4,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:1,c:4,rs:1,cs:2}}},{r:1,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1,mc:{r:1,c:4}}},{r:2,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"宋体",ht:0,vt:0,tb:1}}]}]},mapping:[{cellIndex:{row:0,column:1},cellRange:{row:[0,0],column:[1,2]},cellPosition:{start:"B1",end:"C1"},fieldName:"name",fieldTitle:"姓名",dataType:"string",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:0,column:4},cellRange:{row:[0,0],column:[4,5]},cellPosition:{start:"E1",end:"F1"},fieldName:"age",fieldTitle:"年龄",dataType:"number",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:1,column:1},cellRange:{row:[1,1],column:[1,2]},cellPosition:{start:"B2",end:"C2"},fieldName:"gongzi",fieldTitle:"工资",dataType:"number",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:1,column:4},cellRange:{row:[1,1],column:[4,5]},cellPosition:{start:"E2",end:"F2"},fieldName:"sex",fieldTitle:"性别",dataType:"string",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}]},L={id:"0002",name:"级联模板",jsonData:{info:{appversion:"",company:"",createdTime:"",creator:"",lastmodifiedby:"",modifiedTime:"",name:"新模板"},sheets:[{name:"Sheet1",config:{borderInfo:[{rangeType:"cell",value:{row_index:0,col_index:0,l:{color:"#000",style:1},r:{color:"#000",style:1},t:{color:"#000",style:1},b:{color:"#000",style:1}}},{rangeType:"range",borderType:"border-all",style:"1",color:"#000",range:[{row:[0,0],column:[1,1]}]},{rangeType:"range",borderType:"border-all",style:"1",color:"#000",range:[{row:[1,1],column:[0,1]}]},{rangeType:"cell",value:{row_index:1,col_index:0,l:{color:"#000",style:1},r:{color:"#000",style:"1"},t:{color:"#000",style:1},b:{color:"#000",style:"1"}}}],columnlen:{1:136,3:156},customWidth:{1:1,3:1},merge:{},rowlen:{},customHeight:{},rowhidden:{}},index:"1",status:1,order:"0",zoomRatio:1,showGridLines:"1",defaultColWidth:72,defaultRowHeight:20,celldata:[{r:0,c:0,v:{m:"单位类型",v:"单位类型",bg:"#cfe2f3",fs:10,fc:"#000000",ff:"微软雅黑",ht:1,vt:1,tb:1,ct:{fa:"General",t:"g"}}},{r:0,c:1,v:{ct:{fa:"General",t:"g"},v:"",m:""}},{r:1,c:0,v:{m:"单位类别",v:"单位类别",bg:"#cfe2f3",fs:10,fc:"#000000",ff:"微软雅黑",ht:1,vt:1,tb:1,ct:{fa:"General",t:"g"}}},{r:3,c:3,v:{ct:{fa:"General",t:"g"}}}],dataVerification:{"0_1":{type:"dropdown",type2:!1,value1:"党政机关/事业单位,教育机构,医院,文化体育场",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""}}}]},mapping:[{cellIndex:{row:0,column:1},cellRange:{row:[0,0],column:[1,1]},cellPosition:{start:"B1",end:"B1"},fieldName:"type",fieldTitle:"单位类型",dataType:"select",events:{enable:!0,augments:["LuckySheet","cellValue","mapping"],funcBody:`/**
 * 示例三：根据当前单元格变更做级联更新，更新 B2 单元格的数据验证为下拉
 * 当前单元格为 党政机关/事业单位,教育机构,医院,文化体育场
 * 更新映射后 为一下对应选项
 * API: setDataVerification(optionItem, [setting])
 */
const optionsMap = {
  '党政机关/事业单位':'独立办公,集中办公',
  '教育机构':'高等学校,中小学校',
  '医院':'三级,二级以下',
  '文化体育场':'/'
}

const { newValue }  = cellValue
const keyValue = optionsMap[newValue.v]

console.log(keyValue)

const baseOptionItem = {
  checked: false,
  hintShow: false,
  hintText: '',
  prohibitInput: false,
  remote: false,
  type: 'dropdown',
  type2: false,
  value1: '',
  value2: '',
}

LuckySheet.setDataVerification(
  {
    ...baseOptionItem,
    value1: keyValue,
  },
  {
    range: { row: [1, 1], column: [1, 1] }
  }
)
LuckySheet.setCellValue(1, 1, '')
`}},{cellIndex:{row:1,column:1},cellRange:{row:[1,1],column:[1,1]},cellPosition:{start:"B2",end:"B2"},fieldName:"type2",fieldTitle:"单位类别",dataType:"select",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}],isPublish:"0",reportCount:0,records:0},I={id:"0003",name:"级联模式数据源示例",jsonData:{info:{appversion:"",company:"",createdTime:"",creator:"",lastmodifiedby:"",modifiedTime:"",name:"级联模式数据源示例"},sheets:[{name:"Sheet1",index:0,status:1,jfgird_select_save:[],luckysheet_select_save:[{left:271,width:73,top:540,height:19,left_move:271,width_move:73,top_move:540,height_move:19,row:[27,27],column:[3,3],row_focus:27,column_focus:3}],config:{columnlen:{1:122},customWidth:{1:1}},ch_width:4609,rh_height:1760,luckysheet_selection_range:[],zoomRatio:1,images:{},scrollLeft:0,scrollTop:0,dataVerification:{"0_1":{type:"dropdown",type2:!1,value1:"党政机关/事业单位,教育机构,医院,文化体育场",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""}},celldata:[{r:0,c:0,v:{ct:{fa:"General",t:"g"},v:"单位类型",m:"单位类型"}},{r:0,c:1,v:{ct:{fa:"General",t:"g"},m:"党政机关/事业单位",v:"党政机关/事业单位"}},{r:1,c:0,v:{m:"单位类别",ct:{fa:"General",t:"g"},v:"单位类别"}},{r:1,c:1,v:{ct:{fa:"General",t:"g"},m:"",v:""}}],load:"1"}]},mapping:[{cellIndex:{row:0,column:1},cellRange:{row:[0,0],column:[1,1]},cellPosition:{start:"B1",end:"B1"},fieldName:"type",fieldTitle:"单位类型",dataType:"select",datasource:{type:"normal",dependOn:"",normal:"党政机关/事业单位,教育机构,医院,文化体育场",cascade:"",fx:""},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:1,column:1},cellRange:{row:[1,1],column:[1,1]},cellPosition:{start:"B2",end:"B2"},fieldName:"type2",fieldTitle:"单位类别",dataType:"select",datasource:{type:"cascade",dependOn:"B1",normal:"",cascade:`{
  "党政机关/事业单位": "独立办公,集中办公",
  "教育机构": "高等学校,中小学校",
  "医院": "三级,二级以下",
  "文化体育场": "/"
}`,fx:""},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}],isPublish:"0",reportCount:0,records:0},G={id:"0004",name:"函数模式数据源",jsonData:{info:{appversion:"",company:"",createdTime:"",creator:"",lastmodifiedby:"",modifiedTime:"",name:"函数模式数据源"},sheets:[{name:"Sheet1",index:0,status:1,jfgird_select_save:[],luckysheet_select_save:[{row:[0,0],column:[0,0],row_focus:0,column_focus:0,left:0,width:129,top:0,height:19,left_move:0,width_move:129,top_move:0,height_move:19}],config:{columnlen:{0:129,3:135,4:141},customWidth:{0:1,3:1,4:1},merge:{},rowlen:{}},ch_width:4746,rh_height:1760,luckysheet_selection_range:[],zoomRatio:1,images:{},scrollLeft:0,scrollTop:0,dataVerification:{"10_3":{type:"dropdown",type2:!1,value1:"党政机关/事业单位,教育机构,医院,文化体育场",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},"10_4":{type:"dropdown",type2:!1,value1:"高等学校,中小学校",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""}},calcChain:[],filter_select:null,filter:null,luckysheet_conditionformat_save:[],hyperlink:{},celldata:[{r:0,c:0,v:{v:"党政机关/事业单位",ct:{fa:"General",t:"g"},m:"党政机关/事业单位"}},{r:0,c:1,v:{m:"集中办公",ct:{fa:"General",t:"g"},v:"集中办公"}},{r:1,c:0,v:{v:"党政机关/事业单位",ct:{fa:"General",t:"g"},m:"党政机关/事业单位"}},{r:1,c:1,v:{m:"独立办公",ct:{fa:"General",t:"g"},v:"独立办公"}},{r:2,c:0,v:{m:"教育机构",ct:{fa:"General",t:"g"},v:"教育机构"}},{r:2,c:1,v:{m:"高等学校",ct:{fa:"General",t:"g"},v:"高等学校"}},{r:3,c:0,v:{m:"教育机构",ct:{fa:"General",t:"g"},v:"教育机构"}},{r:3,c:1,v:{m:"中小学校",ct:{fa:"General",t:"g"},v:"中小学校"}},{r:4,c:0,v:{v:"医院",ct:{fa:"General",t:"g"},m:"医院"}},{r:4,c:1,v:{m:"三级",ct:{fa:"General",t:"g"},v:"三级"}},{r:5,c:0,v:{m:"医院",ct:{fa:"General",t:"g"},v:"医院"}},{r:5,c:1,v:{m:"二级以下",ct:{fa:"General",t:"g"},v:"二级以下"}},{r:6,c:0,v:{v:"文化体育场",ct:{fa:"General",t:"g"},m:"文化体育场"}},{r:6,c:1,v:{m:"/",ct:{fa:"General",t:"g"},v:"/"}},{r:9,c:3,v:{m:"单位类型",ct:{fa:"General",t:"g"},v:"单位类型"}},{r:9,c:4,v:{m:"单位类别",ct:{fa:"General",t:"g"},v:"单位类别"}},{r:10,c:3,v:{ct:{fa:"General",t:"g"},v:"教育机构",m:"教育机构"}},{r:10,c:4,v:{ct:{fa:"General",t:"g"},m:"中小学校",v:"中小学校"}},{r:11,c:0,v:{v:"党政机关/事业单位",ct:{fa:"General",t:"g"},m:"党政机关/事业单位"}},{r:12,c:0,v:{m:"教育机构",ct:{fa:"General",t:"g"},v:"教育机构"}},{r:13,c:0,v:{m:"医院",ct:{fa:"General",t:"g"},v:"医院"}},{r:14,c:0,v:{v:"文化体育场",ct:{fa:"General",t:"g"},m:"文化体育场"}}],load:"1"}]},mapping:[{cellIndex:{row:10,column:3},cellRange:{row:[10,10],column:[3,3]},cellPosition:{start:"D11",end:"D11"},fieldName:"type",fieldTitle:"单位类型",dataType:"select",datasource:{type:"fx",dependOn:"",normal:"",cascade:"",fx:"MATCH(D11,A12:A15,0)"},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:10,column:4},cellRange:{row:[10,10],column:[4,4]},cellPosition:{start:"E11",end:"E11"},fieldName:"type2",fieldTitle:"单位类别",dataType:"select",datasource:{type:"fx",dependOn:"",normal:"",cascade:"",fx:"MATCH(D11,A12:A15,0),COUNTIF(A1:A7,B1:B7)"},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}],records:0,reportCount:0,isPublish:"0"},S=[T,L,I,G],u=new _("__EXCEL_DATASOURCE__"),h="__excel_data__",C={excelList:r(S),dataList:[{id:"8452b2e4f3124589b13e14a658099f9a",tempId:"0001",tempName:"工资填报",data:{name:"李雷",age:26,gongzi:234523,sex:"男"}}]};async function o(t=h){const e=await u.getStorage(t);return e||await u.setStorage(t,C)}async function i(t,e=h){return await u.setStorage(e,t)}async function E(t){const{excelList:e}=await o();return new Promise(a=>{const{page:l,size:n,name:c,isPublish:d}=t,f=e.filter(s=>s.name.includes(c)&&(s.isPublish===d||d==="")),y=[];let w=Math.ceil(f.length/n);for(let s=0;s<w;s++){let g=s*n,x=g+n,b=f.slice(g,x);y.push(b)}setTimeout(()=>{a({rows:y[l-1],total:f.length})},200)})}async function V(t){const e=await o();return new Promise(a=>{const l=r(t);l.id=v(),l.isPublish="0",l.reportCount=0,l.records=0,e.excelList.unshift(l),i(e),setTimeout(()=>{a(l.id)},200)})}async function P(t){const e=await o();return new Promise(a=>{const l=e.excelList.findIndex(n=>n.id===t.id);l>-1&&e.excelList.splice(l,1,t),i(e),setTimeout(()=>{a(!0)},200)})}async function R(t){const e=await o();return new Promise(a=>{const l=e.excelList.findIndex(n=>n.id===t);l>-1&&e.excelList.splice(l,1),i(e),setTimeout(()=>{a(!0)},200)})}async function A(t){const e=await B(t);return e.isPublish="1",P(e)}async function B(t){const e=await o();return new Promise(a=>{const l=e.excelList.findIndex(n=>n.id===t);setTimeout(()=>{const n=l>-1?r(e.excelList[l]):null;a(n)},200)})}async function N(t){const e=await o();return e.dataList||(e.dataList=[]),new Promise(a=>{const l=r(t);l.id=v(),e.dataList.unshift(l);const n=e.excelList.findIndex(c=>c.id===l.tempId);if(n>-1){const c=e.dataList.filter(d=>d.tempId===l.tempId).length;e.excelList[n].reportCount=e.excelList[n].records=c,console.log(e)}i(e),setTimeout(()=>{a(l.id)},200)})}async function O(t){const{dataList:e}=await o();return new Promise(a=>{const{tempId:l}=t,n=e.filter(c=>c.tempId===l);setTimeout(()=>{a({rows:n,total:n.length})},200)})}async function j(t){const e=await o();return new Promise(a=>{const l=e.dataList.findIndex(n=>n.id===t);l>-1&&e.dataList.splice(l,1),i(e),setTimeout(()=>{a(!0)},200)})}async function M(t){const e=await o();return new Promise(a=>{const l=e.dataList.findIndex(n=>n.id===t);setTimeout(()=>{const n=l>-1?r(e.dataList[l]):null;a(n)},200)})}async function F(t){const e=await o();return new Promise(a=>{const l=e.dataList.findIndex(n=>n.id===t.id);l>-1&&e.dataList.splice(l,1,t),i(e),setTimeout(()=>{a(!0)},200)})}const p=new BroadcastChannel("ExcelChannel");function z(t,e){p.postMessage({type:t,content:e})}function H(t){const e=a=>t&&t(a.data);return p.addEventListener("message",e),()=>p.removeEventListener("message",e)}export{V as a,N as b,F as c,M as d,E as e,O as f,B as g,R as h,H as l,P as m,A as p,j as r,z as s};
