import{r as b,o as x,j as S,w as t,K as l,L as f,f as m,b as s,i as R,g as P,v as Q,T as X,a as Y,t as Z,R as a}from"./vendor-COsJffew.js";import{g as ee}from"./mock.api-B0TQ_Vwh.js";import{d as te}from"./index-DlSIhdb0.js";import{n as le}from"./chunk-bin-ui-design-55yTQV6H.js";import{u as oe}from"./useForm-Uovr2fiU.js";import"./chunk-brace-DF1jSkZr.js";import"./avatar04-C-sfeKu8.js";const ae={flex:"main:justify cross:center",style:{"font-weight":"normal"}},ne={class:"top"},re={class:"right"},se={style:{position:"relative","min-height":"100px",overflow:"hidden"}},de={style:{position:"absolute",width:"100%"}},ue={key:0,class:"pt-8"},ge=Object.assign({name:"SysDepart"},{__name:"depart",setup(ie){const g=b(null),d=b(null),o=b({}),y=b({}),{formRef:T,editStatus:B,pageStatus:c,editLoading:V,openCreate:D,openEdit:F,backNormal:N,submitForm:U,resetForm:K}=oe();function j(n,e){n.selected?(d.value=n,y.value=e,I()):E()}function k(n){if(n==="root"&&h(),n==="child"){h();const e=d.value;o.value.parentId=e.id,o.value.parentName=e.text}}function C(n="edit"){if(n==="edit"){const e=y.value,u=d.value,i=e[u.nodeKey].parent,_=i||i===0?e[i].node:{};o.value=u?{...te(u),parentId:i===0?"":_.id,parentName:_.text}:{};return}o.value={text:"",deptCode:"",status:"1",desc:"",parentId:"",parentName:void 0}}function E(){d.value=null,y.value=null,o.value={},N()}function h(){C("create"),D()}function I(){C("edit"),F()}function q(){U(()=>{V.value=!0;const n=c.value;setTimeout(()=>{le.success(`${n.isCreate?"新增":"修改"}成功！`),N();const e=d.value?[d.value.nodeKey]:[];g.value&&g.value.reloadTree(e),V.value=!1},1e3)})}function z(){C(B.value),K()}const L={text:[{required:!0,message:"部门名称必填",trigger:"blur"}],deptCode:[{required:!0,message:"部门编码必填",trigger:"blur"}]};return(n,e)=>{const u=a("b-dropdown-item"),i=a("base-tree"),_=a("iconfont"),w=a("b-button"),$=a("b-alert"),v=a("b-input"),p=a("b-form-item"),O=a("b-switch"),W=a("b-form"),A=a("b-col"),G=a("b-row"),H=a("b-card"),J=a("b-layout"),M=a("page-wrapper");return x(),S(M,null,{default:t(()=>[l(J,{"has-sider":"",collapsedWidth:24},{sider:t(()=>[l(i,{ref_key:"treeRef",ref:g,"tree-title":"部门列表","show-filter":"",fetch:f(ee),onSelectChange:j,onCommand:k},{ctrl:t(()=>[l(u,{name:"root",divided:""},{default:t(()=>e[6]||(e[6]=[m("增加根节点")])),_:1}),l(u,{name:"child",disabled:!d.value},{default:t(()=>e[7]||(e[7]=[m("增加子节点")])),_:1},8,["disabled"])]),_:1},8,["fetch"])]),default:t(()=>[s("div",null,[l(H,{bordered:!1,class:"card-panel",shadow:"never"},{header:t(()=>[s("div",ae,[s("div",ne,[l(_,{icon:"apartment",color:"primary",bg:"",round:""}),e[8]||(e[8]=s("span",{class:"ml-5"},"编辑部门",-1))]),s("div",re,[d.value?(x(),S(w,{key:0,type:"text",size:"small",onClick:e[0]||(e[0]=r=>k("child"))},{default:t(()=>e[9]||(e[9]=[m(" 新增子部门 ")])),_:1})):R("",!0)])])]),default:t(()=>[s("div",se,[s("div",de,[P(l($,null,{default:t(()=>e[10]||(e[10]=[m("点选左侧部门，进行编辑操作")])),_:1},512),[[Q,f(c).isNormal]])]),l(X,{name:"fade-transverse"},{default:t(()=>[f(c).isNormal?R("",!0):(x(),Y("div",ue,[l(G,null,{default:t(()=>[l(A,{span:"14"},{default:t(()=>[l(W,{ref_key:"formRef",ref:T,model:o.value,rules:L,"label-width":"100px","label-suffix":":"},{default:t(()=>[l(p,{label:"父级组织"},{default:t(()=>[l(v,{modelValue:o.value.parentName,"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.parentName=r),disabled:""},null,8,["modelValue"])]),_:1}),l(p,{label:"部门名称",prop:"text"},{default:t(()=>[l(v,{modelValue:o.value.text,"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.text=r),placeholder:"输入部门名称",clearable:""},null,8,["modelValue"])]),_:1}),l(p,{label:"部门编码",prop:"deptCode"},{default:t(()=>[l(v,{modelValue:o.value.deptCode,"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.deptCode=r),placeholder:"输入部门编码",clearable:""},null,8,["modelValue"])]),_:1}),l(p,{label:"部门状态"},{default:t(()=>[l(O,{size:"large",modelValue:o.value.status,"onUpdate:modelValue":e[4]||(e[4]=r=>o.value.status=r),"true-value":"1","false-value":"0"},{open:t(()=>e[11]||(e[11]=[s("span",null,"启用",-1)])),close:t(()=>e[12]||(e[12]=[s("span",null,"禁用",-1)])),_:1},8,["modelValue"])]),_:1}),l(p,{label:"部门描述"},{default:t(()=>[l(v,{modelValue:o.value.desc,"onUpdate:modelValue":e[5]||(e[5]=r=>o.value.desc=r),type:"textarea",placeholder:"输入部门描述"},null,8,["modelValue"])]),_:1}),l(p,null,{default:t(()=>[l(w,{type:"primary",onClick:q,loading:f(V)},{default:t(()=>[m(Z(f(c).isCreate?"提交数据":"更新数据"),1)]),_:1},8,["loading"]),l(w,{onClick:z},{default:t(()=>e[13]||(e[13]=[m("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]))]),_:1})])]),_:1})])]),_:1})]),_:1})}}});export{ge as default};
