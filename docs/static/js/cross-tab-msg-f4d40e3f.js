import{a9 as m}from"./vendor-a6c5ad11.js";import{i as r,o as v}from"./index-fda68aa4.js";class b{constructor(e,a="indexDB"){this.store=m.createInstance({name:e,driver:a!=="indexDB"?m.LOCALSTORAGE:m.INDEXEDDB})}async getStorage(e){if(!e){console.warn("storeKey or key is null!");return}return await this.store.getItem(e)}async setStorage(e,a){if(!e){console.warn("storeKey or key is null!");return}return await this.store.setItem(e,r(a)),await this.getStorage(e)}}const T={id:"0001",name:"\u5DE5\u8D44\u586B\u62A5",isPublish:"1",reportCount:1,records:1,jsonData:{info:{name:"\u5DE5\u8D44\u586B\u62A5"},sheets:[{name:"Sheet1",index:0,config:{columnlen:{1:100,2:100,3:109,4:94,5:98},customWidth:{1:1,2:1,3:1,4:1,5:1},rowlen:{0:45,1:45},customHeight:{0:1,1:1},borderInfo:[{rangeType:"cell",value:{row_index:0,col_index:0,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:1,l:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:2,r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:3,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:4,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:5,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:0,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:1,l:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:2,r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:3,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:4,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:5,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}}],merge:{"0_4":{r:0,c:4,rs:1,cs:2},"1_4":{r:1,c:4,rs:1,cs:2},"0_1":{r:0,c:1,rs:1,cs:2},"1_1":{r:1,c:1,rs:1,cs:2}}},celldata:[{r:0,c:0,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u59D3\u540D",qp:1,m:"\u59D3\u540D"}},{r:0,c:1,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:1,rs:1,cs:2}}},{r:0,c:2,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:1}}},{r:0,c:3,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u5E74\u9F84",qp:1,m:"\u5E74\u9F84"}},{r:0,c:4,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:4,rs:1,cs:2}}},{r:0,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:4}}},{r:1,c:0,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u5DE5\u8D44",qp:1,m:"\u5DE5\u8D44"}},{r:1,c:1,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:1,rs:1,cs:2}}},{r:1,c:2,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:1}}},{r:1,c:3,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u6027\u522B",qp:1,m:"\u6027\u522B"}},{r:1,c:4,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:4,rs:1,cs:2}}},{r:1,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:4}}},{r:2,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1}}]}]},mapping:[{cellIndex:{row:0,column:1},cellRange:{row:[0,0],column:[1,2]},cellPosition:{start:"B1",end:"C1"},fieldName:"name",fieldTitle:"\u59D3\u540D",dataType:"string",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:0,column:4},cellRange:{row:[0,0],column:[4,5]},cellPosition:{start:"E1",end:"F1"},fieldName:"age",fieldTitle:"\u5E74\u9F84",dataType:"number",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:1,column:1},cellRange:{row:[1,1],column:[1,2]},cellPosition:{start:"B2",end:"C2"},fieldName:"gongzi",fieldTitle:"\u5DE5\u8D44",dataType:"number",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:1,column:4},cellRange:{row:[1,1],column:[4,5]},cellPosition:{start:"E2",end:"F2"},fieldName:"sex",fieldTitle:"\u6027\u522B",dataType:"string",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}]},L={id:"0002",name:"\u7EA7\u8054\u6A21\u677F",jsonData:{info:{appversion:"",company:"",createdTime:"",creator:"",lastmodifiedby:"",modifiedTime:"",name:"\u65B0\u6A21\u677F"},sheets:[{name:"Sheet1",config:{borderInfo:[{rangeType:"cell",value:{row_index:0,col_index:0,l:{color:"#000",style:1},r:{color:"#000",style:1},t:{color:"#000",style:1},b:{color:"#000",style:1}}},{rangeType:"range",borderType:"border-all",style:"1",color:"#000",range:[{row:[0,0],column:[1,1]}]},{rangeType:"range",borderType:"border-all",style:"1",color:"#000",range:[{row:[1,1],column:[0,1]}]},{rangeType:"cell",value:{row_index:1,col_index:0,l:{color:"#000",style:1},r:{color:"#000",style:"1"},t:{color:"#000",style:1},b:{color:"#000",style:"1"}}}],columnlen:{1:136,3:156},customWidth:{1:1,3:1},merge:{},rowlen:{},customHeight:{},rowhidden:{}},index:"1",status:1,order:"0",zoomRatio:1,showGridLines:"1",defaultColWidth:72,defaultRowHeight:20,celldata:[{r:0,c:0,v:{m:"\u5355\u4F4D\u7C7B\u578B",v:"\u5355\u4F4D\u7C7B\u578B",bg:"#cfe2f3",fs:10,fc:"#000000",ff:"\u5FAE\u8F6F\u96C5\u9ED1",ht:1,vt:1,tb:1,ct:{fa:"General",t:"g"}}},{r:0,c:1,v:{ct:{fa:"General",t:"g"},v:"",m:""}},{r:1,c:0,v:{m:"\u5355\u4F4D\u7C7B\u522B",v:"\u5355\u4F4D\u7C7B\u522B",bg:"#cfe2f3",fs:10,fc:"#000000",ff:"\u5FAE\u8F6F\u96C5\u9ED1",ht:1,vt:1,tb:1,ct:{fa:"General",t:"g"}}},{r:3,c:3,v:{ct:{fa:"General",t:"g"}}}],dataVerification:{"0_1":{type:"dropdown",type2:!1,value1:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D,\u6559\u80B2\u673A\u6784,\u533B\u9662,\u6587\u5316\u4F53\u80B2\u573A",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""}}}]},mapping:[{cellIndex:{row:0,column:1},cellRange:{row:[0,0],column:[1,1]},cellPosition:{start:"B1",end:"B1"},fieldName:"type",fieldTitle:"\u5355\u4F4D\u7C7B\u578B",dataType:"select",events:{enable:!0,augments:["LuckySheet","cellValue","mapping"],funcBody:`/**
 * \u793A\u4F8B\u4E09\uFF1A\u6839\u636E\u5F53\u524D\u5355\u5143\u683C\u53D8\u66F4\u505A\u7EA7\u8054\u66F4\u65B0\uFF0C\u66F4\u65B0 B2 \u5355\u5143\u683C\u7684\u6570\u636E\u9A8C\u8BC1\u4E3A\u4E0B\u62C9
 * \u5F53\u524D\u5355\u5143\u683C\u4E3A \u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D,\u6559\u80B2\u673A\u6784,\u533B\u9662,\u6587\u5316\u4F53\u80B2\u573A
 * \u66F4\u65B0\u6620\u5C04\u540E \u4E3A\u4E00\u4E0B\u5BF9\u5E94\u9009\u9879
 * API: setDataVerification(optionItem, [setting])
 */
const optionsMap = {
  '\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D':'\u72EC\u7ACB\u529E\u516C,\u96C6\u4E2D\u529E\u516C',
  '\u6559\u80B2\u673A\u6784':'\u9AD8\u7B49\u5B66\u6821,\u4E2D\u5C0F\u5B66\u6821',
  '\u533B\u9662':'\u4E09\u7EA7,\u4E8C\u7EA7\u4EE5\u4E0B',
  '\u6587\u5316\u4F53\u80B2\u573A':'/'
}

const { newValue }  = cellValue
const keyValue = optionsMap[newValue.v]

console.log(keyValue)

const baseOptionItem = {
  checked: false,
  hintShow: false,
  hintText: '',
  prohibitInput: false,
  remote: false,
  type: 'dropdown',
  type2: false,
  value1: '',
  value2: '',
}

LuckySheet.setDataVerification(
  {
    ...baseOptionItem,
    value1: keyValue,
  },
  {
    range: { row: [1, 1], column: [1, 1] }
  }
)
LuckySheet.setCellValue(1, 1, '')
`}},{cellIndex:{row:1,column:1},cellRange:{row:[1,1],column:[1,1]},cellPosition:{start:"B2",end:"B2"},fieldName:"type2",fieldTitle:"\u5355\u4F4D\u7C7B\u522B",dataType:"select",events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}],isPublish:"0",reportCount:0,records:0},I={id:"0003",name:"\u7EA7\u8054\u6A21\u5F0F\u6570\u636E\u6E90\u793A\u4F8B",jsonData:{info:{appversion:"",company:"",createdTime:"",creator:"",lastmodifiedby:"",modifiedTime:"",name:"\u7EA7\u8054\u6A21\u5F0F\u6570\u636E\u6E90\u793A\u4F8B"},sheets:[{name:"Sheet1",index:0,status:1,jfgird_select_save:[],luckysheet_select_save:[{left:271,width:73,top:540,height:19,left_move:271,width_move:73,top_move:540,height_move:19,row:[27,27],column:[3,3],row_focus:27,column_focus:3}],config:{columnlen:{1:122},customWidth:{1:1}},ch_width:4609,rh_height:1760,luckysheet_selection_range:[],zoomRatio:1,images:{},scrollLeft:0,scrollTop:0,dataVerification:{"0_1":{type:"dropdown",type2:!1,value1:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D,\u6559\u80B2\u673A\u6784,\u533B\u9662,\u6587\u5316\u4F53\u80B2\u573A",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""}},celldata:[{r:0,c:0,v:{ct:{fa:"General",t:"g"},v:"\u5355\u4F4D\u7C7B\u578B",m:"\u5355\u4F4D\u7C7B\u578B"}},{r:0,c:1,v:{ct:{fa:"General",t:"g"},m:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D",v:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D"}},{r:1,c:0,v:{m:"\u5355\u4F4D\u7C7B\u522B",ct:{fa:"General",t:"g"},v:"\u5355\u4F4D\u7C7B\u522B"}},{r:1,c:1,v:{ct:{fa:"General",t:"g"},m:"",v:""}}],load:"1"}]},mapping:[{cellIndex:{row:0,column:1},cellRange:{row:[0,0],column:[1,1]},cellPosition:{start:"B1",end:"B1"},fieldName:"type",fieldTitle:"\u5355\u4F4D\u7C7B\u578B",dataType:"select",datasource:{type:"normal",dependOn:"",normal:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D,\u6559\u80B2\u673A\u6784,\u533B\u9662,\u6587\u5316\u4F53\u80B2\u573A",cascade:"",fx:""},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:1,column:1},cellRange:{row:[1,1],column:[1,1]},cellPosition:{start:"B2",end:"B2"},fieldName:"type2",fieldTitle:"\u5355\u4F4D\u7C7B\u522B",dataType:"select",datasource:{type:"cascade",dependOn:"B1",normal:"",cascade:`{
  "\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D": "\u72EC\u7ACB\u529E\u516C,\u96C6\u4E2D\u529E\u516C",
  "\u6559\u80B2\u673A\u6784": "\u9AD8\u7B49\u5B66\u6821,\u4E2D\u5C0F\u5B66\u6821",
  "\u533B\u9662": "\u4E09\u7EA7,\u4E8C\u7EA7\u4EE5\u4E0B",
  "\u6587\u5316\u4F53\u80B2\u573A": "/"
}`,fx:""},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}],isPublish:"0",reportCount:0,records:0},G={id:"0004",name:"\u51FD\u6570\u6A21\u5F0F\u6570\u636E\u6E90",jsonData:{info:{appversion:"",company:"",createdTime:"",creator:"",lastmodifiedby:"",modifiedTime:"",name:"\u51FD\u6570\u6A21\u5F0F\u6570\u636E\u6E90"},sheets:[{name:"Sheet1",index:0,status:1,jfgird_select_save:[],luckysheet_select_save:[{row:[0,0],column:[0,0],row_focus:0,column_focus:0,left:0,width:129,top:0,height:19,left_move:0,width_move:129,top_move:0,height_move:19}],config:{columnlen:{0:129,3:135,4:141},customWidth:{0:1,3:1,4:1},merge:{},rowlen:{}},ch_width:4746,rh_height:1760,luckysheet_selection_range:[],zoomRatio:1,images:{},scrollLeft:0,scrollTop:0,dataVerification:{"10_3":{type:"dropdown",type2:!1,value1:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D,\u6559\u80B2\u673A\u6784,\u533B\u9662,\u6587\u5316\u4F53\u80B2\u573A",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},"10_4":{type:"dropdown",type2:!1,value1:"\u9AD8\u7B49\u5B66\u6821,\u4E2D\u5C0F\u5B66\u6821",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""}},calcChain:[],filter_select:null,filter:null,luckysheet_conditionformat_save:[],hyperlink:{},celldata:[{r:0,c:0,v:{v:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D",ct:{fa:"General",t:"g"},m:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D"}},{r:0,c:1,v:{m:"\u96C6\u4E2D\u529E\u516C",ct:{fa:"General",t:"g"},v:"\u96C6\u4E2D\u529E\u516C"}},{r:1,c:0,v:{v:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D",ct:{fa:"General",t:"g"},m:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D"}},{r:1,c:1,v:{m:"\u72EC\u7ACB\u529E\u516C",ct:{fa:"General",t:"g"},v:"\u72EC\u7ACB\u529E\u516C"}},{r:2,c:0,v:{m:"\u6559\u80B2\u673A\u6784",ct:{fa:"General",t:"g"},v:"\u6559\u80B2\u673A\u6784"}},{r:2,c:1,v:{m:"\u9AD8\u7B49\u5B66\u6821",ct:{fa:"General",t:"g"},v:"\u9AD8\u7B49\u5B66\u6821"}},{r:3,c:0,v:{m:"\u6559\u80B2\u673A\u6784",ct:{fa:"General",t:"g"},v:"\u6559\u80B2\u673A\u6784"}},{r:3,c:1,v:{m:"\u4E2D\u5C0F\u5B66\u6821",ct:{fa:"General",t:"g"},v:"\u4E2D\u5C0F\u5B66\u6821"}},{r:4,c:0,v:{v:"\u533B\u9662",ct:{fa:"General",t:"g"},m:"\u533B\u9662"}},{r:4,c:1,v:{m:"\u4E09\u7EA7",ct:{fa:"General",t:"g"},v:"\u4E09\u7EA7"}},{r:5,c:0,v:{m:"\u533B\u9662",ct:{fa:"General",t:"g"},v:"\u533B\u9662"}},{r:5,c:1,v:{m:"\u4E8C\u7EA7\u4EE5\u4E0B",ct:{fa:"General",t:"g"},v:"\u4E8C\u7EA7\u4EE5\u4E0B"}},{r:6,c:0,v:{v:"\u6587\u5316\u4F53\u80B2\u573A",ct:{fa:"General",t:"g"},m:"\u6587\u5316\u4F53\u80B2\u573A"}},{r:6,c:1,v:{m:"/",ct:{fa:"General",t:"g"},v:"/"}},{r:9,c:3,v:{m:"\u5355\u4F4D\u7C7B\u578B",ct:{fa:"General",t:"g"},v:"\u5355\u4F4D\u7C7B\u578B"}},{r:9,c:4,v:{m:"\u5355\u4F4D\u7C7B\u522B",ct:{fa:"General",t:"g"},v:"\u5355\u4F4D\u7C7B\u522B"}},{r:10,c:3,v:{ct:{fa:"General",t:"g"},v:"\u6559\u80B2\u673A\u6784",m:"\u6559\u80B2\u673A\u6784"}},{r:10,c:4,v:{ct:{fa:"General",t:"g"},m:"\u4E2D\u5C0F\u5B66\u6821",v:"\u4E2D\u5C0F\u5B66\u6821"}},{r:11,c:0,v:{v:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D",ct:{fa:"General",t:"g"},m:"\u515A\u653F\u673A\u5173/\u4E8B\u4E1A\u5355\u4F4D"}},{r:12,c:0,v:{m:"\u6559\u80B2\u673A\u6784",ct:{fa:"General",t:"g"},v:"\u6559\u80B2\u673A\u6784"}},{r:13,c:0,v:{m:"\u533B\u9662",ct:{fa:"General",t:"g"},v:"\u533B\u9662"}},{r:14,c:0,v:{v:"\u6587\u5316\u4F53\u80B2\u573A",ct:{fa:"General",t:"g"},m:"\u6587\u5316\u4F53\u80B2\u573A"}}],load:"1"}]},mapping:[{cellIndex:{row:10,column:3},cellRange:{row:[10,10],column:[3,3]},cellPosition:{start:"D11",end:"D11"},fieldName:"type",fieldTitle:"\u5355\u4F4D\u7C7B\u578B",dataType:"select",datasource:{type:"fx",dependOn:"",normal:"",cascade:"",fx:"MATCH(D11,A12:A15,0)"},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}},{cellIndex:{row:10,column:4},cellRange:{row:[10,10],column:[4,4]},cellPosition:{start:"E11",end:"E11"},fieldName:"type2",fieldTitle:"\u5355\u4F4D\u7C7B\u522B",dataType:"select",datasource:{type:"fx",dependOn:"",normal:"",cascade:"",fx:"MATCH(D11,A12:A15,0),COUNTIF(A1:A7,B1:B7)"},events:{enable:!1,augments:["LuckySheet","cellValue","mapping"],funcBody:""}}],records:0,reportCount:0,isPublish:"0"},S=[T,L,I,G],u=new b("__EXCEL_DATASOURCE__"),h="__excel_data__",C={excelList:r(S),dataList:[{id:"8452b2e4f3124589b13e14a658099f9a",tempId:"0001",tempName:"\u5DE5\u8D44\u586B\u62A5",data:{name:"\u674E\u96F7",age:26,gongzi:234523,sex:"\u7537"}}]};async function o(t=h){const e=await u.getStorage(t);return e||await u.setStorage(t,C)}async function i(t,e=h){return await u.setStorage(e,t)}async function E(t){const{excelList:e}=await o();return new Promise(a=>{const{page:l,size:n,name:c,isPublish:d}=t,f=e.filter(s=>s.name.includes(c)&&(s.isPublish===d||d==="")),y=[];let w=Math.ceil(f.length/n);for(let s=0;s<w;s++){let g=s*n,x=g+n,_=f.slice(g,x);y.push(_)}setTimeout(()=>{a({rows:y[l-1],total:f.length})},200)})}async function V(t){const e=await o();return new Promise(a=>{const l=r(t);l.id=v(),l.isPublish="0",l.reportCount=0,l.records=0,e.excelList.unshift(l),i(e),setTimeout(()=>{a(l.id)},200)})}async function P(t){const e=await o();return new Promise(a=>{const l=e.excelList.findIndex(n=>n.id===t.id);l>-1&&e.excelList.splice(l,1,t),i(e),setTimeout(()=>{a(!0)},200)})}async function R(t){const e=await o();return new Promise(a=>{const l=e.excelList.findIndex(n=>n.id===t);l>-1&&e.excelList.splice(l,1),i(e),setTimeout(()=>{a(!0)},200)})}async function A(t){const e=await B(t);return e.isPublish="1",P(e)}async function B(t){const e=await o();return new Promise(a=>{const l=e.excelList.findIndex(n=>n.id===t);setTimeout(()=>{const n=l>-1?r(e.excelList[l]):null;a(n)},200)})}async function N(t){const e=await o();return e.dataList||(e.dataList=[]),new Promise(a=>{const l=r(t);l.id=v(),e.dataList.unshift(l);const n=e.excelList.findIndex(c=>c.id===l.tempId);if(n>-1){const c=e.dataList.filter(d=>d.tempId===l.tempId).length;e.excelList[n].reportCount=e.excelList[n].records=c,console.log(e)}i(e),setTimeout(()=>{a(l.id)},200)})}async function O(t){const{dataList:e}=await o();return new Promise(a=>{const{tempId:l}=t,n=e.filter(c=>c.tempId===l);setTimeout(()=>{a({rows:n,total:n.length})},200)})}async function j(t){const e=await o();return new Promise(a=>{const l=e.dataList.findIndex(n=>n.id===t);l>-1&&e.dataList.splice(l,1),i(e),setTimeout(()=>{a(!0)},200)})}async function M(t){const e=await o();return new Promise(a=>{const l=e.dataList.findIndex(n=>n.id===t);setTimeout(()=>{const n=l>-1?r(e.dataList[l]):null;a(n)},200)})}async function F(t){const e=await o();return new Promise(a=>{const l=e.dataList.findIndex(n=>n.id===t.id);l>-1&&e.dataList.splice(l,1,t),i(e),setTimeout(()=>{a(!0)},200)})}const p=new BroadcastChannel("ExcelChannel");function z(t,e){p.postMessage({type:t,content:e})}function H(t){const e=a=>t&&t(a.data);return p.addEventListener("message",e),()=>p.removeEventListener("message",e)}export{V as a,N as b,F as c,M as d,E as e,O as f,B as g,R as h,H as l,P as m,A as p,j as r,z as s};
