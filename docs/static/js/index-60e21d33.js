import{s as e,t as a}from"./index-c2ebc9d7.js";import{f as t,x as l,g as n,n as s,J as o,L as r,o as c,A as d,B as i,t as h,c as u,a as p,r as m,u as f,w as y,F as v,d as k,D as g,E as b,a7 as w,a8 as x,q as S}from"./vendor-b1b195f8.js";function C(n,s={},o,r="text"){const c=t(null),d=t([]),i=t(""),h=t(!1),u=t(!1),p=async()=>{if(n){try{m(!0);const a=await n(s);"object"===e(a)?d.value=[a]:d.value=a,o&&o.emit("init-success")}catch(t){a("useTree/getTreeData",t)}m(!1)}};function m(e){h.value=e}return{treeRef:c,query:i,loading:h,treeData:d,hasChecked:u,getFlatState:()=>c.value.getFlatState(),getTreeData:p,reloadTree:async(e=[],a=[])=>{await p(),await l(),c.value.setSelected(e),c.value.setExpand(a)},reloadTreeWithCheck:async(e=[])=>{await p(),await l(),c.value&&c.value.setChecked(e)},handleFilter:e=>{c.value&&c.value.filter(e)},filterNode:(e,a)=>!e||-1!==a[r].indexOf(e),handleSelect:(e,a,t)=>{o&&o.emit("select-change",a,t)},handleChecked:(e,a,t)=>{u.value=e.length>0,o&&o.emit("check-change",e,a,t)}}}const A={name:"BaseTree",props:{width:{type:String,default:"320px"},minHeight:{type:String,default:"300px"},maxHeight:{type:String,default:"700px"},treeTitle:{type:String},filterPosition:{type:String,default:"top"},lock:Boolean,fetch:{type:[Function,Array]},params:{type:Object},render:Function,showCheckbox:{type:Boolean},checkStrictly:{type:Boolean},showFilter:{type:Boolean},titleKey:{type:String,default:"text"},defaultExpand:{type:Boolean},expandKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]}},emits:["select-change","check-change","command","init-success"],setup(a,o){const r=t(null),c=n((()=>a.showFilter&&"top"===a.filterPosition)),d=n((()=>a.showFilter&&"inner"===a.filterPosition)),{treeRef:i,loading:h,query:u,treeData:p,getTreeData:m,reloadTree:f,reloadTreeWithCheck:y,handleSelect:v,handleChecked:k,handleFilter:g,filterNode:b}=C(a.fetch,a.params,o,a.titleKey);function w(){i.value&&i.value.setExpand(a.expandKeys),i.value&&i.value.setSelected(a.selectedKeys)}return s((()=>a.fetch),(async a=>{if("array"===e(a))return p.value=a,a.length>0&&(await l(),w()),!0;await m(),w()}),{immediate:!0}),{treeEl:r,showTopSearch:c,showInnerSearch:d,treeRef:i,query:u,loading:h,treeData:p,getTreeData:m,reloadTree:f,reloadTreeWithCheck:y,handleSelect:v,handleChecked:k,handleAction:function(e){switch(e){case"expandAll":i.value&&i.value.expandAll();break;case"collapseAll":i.value&&i.value.collapseAll();break;case"checkAll":i.value&&i.value.checkAll();break;case"uncheckAll":i.value&&i.value.uncheckAll()}o.emit("command",e)},handleFilter:g,filterNode:b}}},T={class:"base-tree-header"},F={class:"base-title"},D={class:"base-ctrl"},_={class:"search"},q={class:"ctrl"},B=(e=>(w("data-v-73013618"),e=e(),x(),e))((()=>i("i",{class:"b-iconfont b-icon-ellipsis"},null,-1))),E=S("展开全部"),K=S("收起全部"),$=S("选择全部"),H=S("取消全选"),V={key:0,class:"tree-inner"},j={key:1,class:"inner-search"},N={class:"mr-5"},R={key:0,class:"tree-bottom"};A.render=function(e,a,t,l,n,s){const w=o("b-input"),x=o("b-dropdown-item"),S=o("b-dropdown-menu"),C=o("b-dropdown"),A=o("b-tree"),I=r("loading");return c(),d("div",{class:"base-tree",style:b({width:t.width}),ref:"treeEl"},[i("div",T,[i("span",F,h(t.treeTitle),1),i("div",D,[i("div",_,[l.showTopSearch?(c(),u(w,{key:0,size:"small",search:"",modelValue:l.query,"onUpdate:modelValue":a[0]||(a[0]=e=>l.query=e),placeholder:"搜索",onSearch:l.handleFilter},null,8,["modelValue","onSearch"])):p("",!0),m(e.$slots,"default",{},void 0,!0)]),i("div",q,[f(C,{"append-to-body":"",placement:"bottom-start",onCommand:l.handleAction},{dropdown:y((()=>[f(S,null,{default:y((()=>[f(x,{name:"expandAll"},{default:y((()=>[E])),_:1}),f(x,{name:"collapseAll"},{default:y((()=>[K])),_:1}),t.showCheckbox?(c(),d(v,{key:0},[f(x,{name:"checkAll",divided:""},{default:y((()=>[$])),_:1}),f(x,{name:"uncheckAll"},{default:y((()=>[H])),_:1})],64)):p("",!0),m(e.$slots,"ctrl",{},void 0,!0)])),_:3})])),default:y((()=>[B])),_:3},8,["onCommand"])])])]),k(i("div",{class:g(["tree-wrap",{"has-bottom":e.$slots.bottom}]),style:b({minHeight:t.minHeight,maxHeight:t.maxHeight})},[e.$slots.inner?(c(),d("div",V,[m(e.$slots,"inner",{},void 0,!0)])):p("",!0),l.showInnerSearch?(c(),d("div",j,[f(w,{size:"small",search:"",modelValue:l.query,"onUpdate:modelValue":a[1]||(a[1]=e=>l.query=e),placeholder:"搜索",onSearch:l.handleFilter},null,8,["modelValue","onSearch"])])):p("",!0),i("div",N,[f(A,{data:l.treeData,"title-key":t.titleKey,"show-checkbox":t.showCheckbox,"filter-node-method":l.filterNode,render:t.render,"lock-select":t.lock,"default-expand":t.defaultExpand,ref:"treeRef",onSelectChange:l.handleSelect,onCheckChange:l.handleChecked},null,8,["data","title-key","show-checkbox","filter-node-method","render","lock-select","default-expand","onSelectChange","onCheckChange"])])],6),[[I,l.loading]]),e.$slots.bottom?(c(),d("div",R,[m(e.$slots,"bottom",{},void 0,!0)])):p("",!0)],4)},A.__scopeId="data-v-73013618";export{A as _,C as u};
