import{e as b,f as l,g as x,v as S,x as e,c as t,a2 as p,q as m,l as r,t as T,T as B,y as Q,z as X,j as Y,u as Z}from"./vendor-a6c5ad11.js";import{g as ee}from"./depart.api-7307f64f.js";import{m as te}from"./index-92c56bc9.js";import{a as ae}from"./chunk-bin-ui-next-1e71edb3.js";import{u as oe}from"./useForm-7a8f51b8.js";import"./chunk-brace-6f23dcf5.js";import"./chunk-mockjs-c013c588.js";const le={flex:"main:justify cross:center",style:{"font-weight":"normal"}},ne={class:"top"},se=r("span",{class:"ml-5"},"\u7F16\u8F91\u90E8\u95E8",-1),re={class:"right"},de={style:{position:"relative","min-height":"100px",overflow:"hidden"}},ue={style:{position:"absolute",width:"100%"}},ie={key:0,class:"pt-8"},ce=r("span",null,"\u542F\u7528",-1),me=r("span",null,"\u7981\u7528",-1),Ve=Object.assign({name:"SysDepart"},{__name:"depart",setup(pe){const h=b(null),d=b(null),o=b({}),g=b({}),{formRef:D,editStatus:F,pageStatus:_,editLoading:y,openCreate:R,openEdit:U,backNormal:w,submitForm:j,resetForm:q}=oe();function z(n,a){n.selected?(d.value=n,g.value=a,I()):E()}function N(n){if(n==="root"&&k(),n==="child"){k();const a=d.value;o.value.parentId=a.id,o.value.parentName=a.text}}function V(n="edit"){if(n==="edit"){const a=g.value,u=d.value,i=a[u.nodeKey].parent,f=i||i===0?a[i].node:{};o.value=u?{...te(u),parentId:i===0?"":f.id,parentName:f.text}:{};return}o.value={text:"",deptCode:"",status:"1",desc:"",parentId:"",parentName:void 0}}function E(){d.value=null,g.value=null,o.value={},w()}function k(){V("create"),R()}function I(){V("edit"),U()}function K(){j(()=>{y.value=!0;const n=_.value;setTimeout(()=>{ae.success(`${n.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),w();const a=d.value?[d.value.nodeKey]:[];h.value&&h.value.reloadTree(a),y.value=!1},1e3)})}function $(){V(F.value),q()}const L={text:[{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u5FC5\u586B",trigger:"blur"}],deptCode:[{required:!0,message:"\u90E8\u95E8\u7F16\u7801\u5FC5\u586B",trigger:"blur"}]};return(n,a)=>{const u=l("b-dropdown-item"),i=l("base-tree"),f=l("iconfont"),C=l("b-button"),M=l("b-alert"),v=l("b-input"),c=l("b-form-item"),O=l("b-switch"),W=l("b-form"),A=l("b-col"),G=l("b-row"),H=l("b-card"),J=l("b-layout"),P=l("page-wrapper");return x(),S(P,null,{default:e(()=>[t(J,{"has-sider":"",collapsedWidth:24},{sider:e(()=>[t(i,{ref_key:"treeRef",ref:h,"tree-title":"\u90E8\u95E8\u5217\u8868","show-filter":"",fetch:p(ee),onSelectChange:z,onCommand:N},{ctrl:e(()=>[t(u,{name:"root",divided:""},{default:e(()=>[m("\u589E\u52A0\u6839\u8282\u70B9")]),_:1}),t(u,{name:"child",disabled:!d.value},{default:e(()=>[m("\u589E\u52A0\u5B50\u8282\u70B9")]),_:1},8,["disabled"])]),_:1},8,["fetch"])]),default:e(()=>[r("div",null,[t(H,{bordered:!1,class:"card-panel",shadow:"never"},{header:e(()=>[r("div",le,[r("div",ne,[t(f,{icon:"apartment",color:"primary",bg:"",round:""}),se]),r("div",re,[d.value?(x(),S(C,{key:0,type:"text",size:"small",onClick:a[0]||(a[0]=s=>N("child"))},{default:e(()=>[m(" \u65B0\u589E\u5B50\u90E8\u95E8 ")]),_:1})):T("",!0)])])]),default:e(()=>[r("div",de,[t(B,{name:"fade-in"},{default:e(()=>[r("div",ue,[Q(t(M,null,{default:e(()=>[m("\u70B9\u9009\u5DE6\u4FA7\u90E8\u95E8\uFF0C\u8FDB\u884C\u7F16\u8F91\u64CD\u4F5C")]),_:1},512),[[X,p(_).isNormal]])])]),_:1}),t(B,{name:"fade-transverse"},{default:e(()=>[p(_).isNormal?T("",!0):(x(),Y("div",ie,[t(G,null,{default:e(()=>[t(A,{span:"14"},{default:e(()=>[t(W,{ref_key:"formRef",ref:D,model:o.value,rules:L,"label-width":"100px","label-suffix":":"},{default:e(()=>[t(c,{label:"\u7236\u7EA7\u7EC4\u7EC7"},{default:e(()=>[t(v,{modelValue:o.value.parentName,"onUpdate:modelValue":a[1]||(a[1]=s=>o.value.parentName=s),disabled:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u90E8\u95E8\u540D\u79F0",prop:"text"},{default:e(()=>[t(v,{modelValue:o.value.text,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value.text=s),placeholder:"\u8F93\u5165\u90E8\u95E8\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u90E8\u95E8\u7F16\u7801",prop:"deptCode"},{default:e(()=>[t(v,{modelValue:o.value.deptCode,"onUpdate:modelValue":a[3]||(a[3]=s=>o.value.deptCode=s),placeholder:"\u8F93\u5165\u90E8\u95E8\u7F16\u7801",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u90E8\u95E8\u72B6\u6001"},{default:e(()=>[t(O,{size:"large",modelValue:o.value.status,"onUpdate:modelValue":a[4]||(a[4]=s=>o.value.status=s),"true-value":"1","false-value":"0"},{open:e(()=>[ce]),close:e(()=>[me]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"\u90E8\u95E8\u63CF\u8FF0"},{default:e(()=>[t(v,{modelValue:o.value.desc,"onUpdate:modelValue":a[5]||(a[5]=s=>o.value.desc=s),type:"textarea",placeholder:"\u8F93\u5165\u90E8\u95E8\u63CF\u8FF0"},null,8,["modelValue"])]),_:1}),t(c,null,{default:e(()=>[t(C,{type:"primary",onClick:K,loading:p(y)},{default:e(()=>[m(Z(p(_).isCreate?"\u63D0\u4EA4\u6570\u636E":"\u66F4\u65B0\u6570\u636E"),1)]),_:1},8,["loading"]),t(C,{onClick:$},{default:e(()=>[m("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]))]),_:1})])]),_:1})])]),_:1})]),_:1})}}});export{Ve as default};
