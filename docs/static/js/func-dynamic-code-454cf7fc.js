import{P as L}from"./page-wrapper-8ec56d76.js";import{K as q}from"./index-ddd33828.js";import{a5 as K,b as H,I as r,o as b,z as P,A as o,u as t,d as a,t as S,q as s,a as m,f as A,c as R,J as W,F as Q,G as X,a9 as Y,aa as Z}from"./vendor-e04737d2.js";import{T as $}from"./index-43799032.js";import{a as V}from"./chunk-bin-ui-next-cc573c7a.js";import"./index-8ae97dfa.js";import"./chunk-brace-34d79ec3.js";import"./index-5e9d04a1.js";const ee={name:"FuncBodyEditor",props:{augments:{type:Array,default:()=>[]},modelValue:{type:String,default:""},height:{type:String,default:"120"}},emits:["update:modelValue"],setup(u,{emit:l}){const v=H(()=>u.augments.join(" , "));function e(h){l("update:modelValue",h)}function x(){return new Function(...u.augments,u.modelValue)}return{paramsStr:v,changeValue:e,getFunction:x}}},te={class:"func-body-editor"},ne={class:"func func-top"},oe=s(" function( "),le={class:"params"},ae=s(" ) { "),se={class:"func func-bottom"},de=s("}");function ie(u,l,v,e,x,h){const y=r("b-tag"),_=r("b-ace-editor");return b(),P("div",te,[o("div",ne,[t(y,{type:"primary","tag-style":{fontSize:"14px"}},{default:a(()=>[oe,o("span",le,S(e.paramsStr),1),ae]),_:1})]),o("div",null,[t(_,{lang:"javascript",height:v.height,"model-value":v.modelValue,onChange:e.changeValue},null,8,["height","model-value","onChange"])]),o("div",se,[t(y,{type:"primary","tag-style":{fontSize:"14px"}},{default:a(()=>[de]),_:1})])])}var re=K(ee,[["render",ie],["__scopeId","data-v-98d00336"]]);const ce={name:"FuncDynamicCode",components:{TitleBar:$,FuncBodyEditor:re,KeyValueMapping:q,PageWrapper:L},setup(){const u=m([{key:"name",value:"Akko pc75b plus"},{key:"price",value:549},{key:"num",value:2},{key:"discount",value:.98},{key:"breaks",value:30}]),l=m("return `${name} \u5546\u54C1 \uFF0C\u5355\u4EF7${price} \uFF0C\u6570\u91CF${num} \uFF0C\u603B\u4EF7: ${price*num}`;"),v=m(null),e=m(""),x=m(null),h=m([{name:"Akko pc75b plus",price:549,num:2,discount:1,total:null},{name:"Ciy 68 test",price:79,num:4,discount:1,total:null},{name:"Ganss HS87T",price:398,num:2,discount:.95,total:null},{name:"\u8FBE\u5C14\u4F18A84",price:629,num:2,discount:.9,total:null},{name:"FL cmk87",price:629,num:6,discount:.95,total:null},{name:"\u603B\u8BA1",price:0,num:0,discount:0,total:null}]),y=m(`const { price, num, discount } = goods;
 return price * num * discount;`),_=m(null),f=m(`{
  "name": "\u5F20\u4E09",
  "phone": "",
  "age": 17,
  "address": "\u6C5F\u82CF\u7701\u5F90\u5DDE\u5E02\u4E91\u9F99\u533A"
}`),k=m(["phone","age"]),g=m(""),B=m(!1),D=m(`const validatPhone = phone.length > 0;
const validatAge = age > 18 && age < 35;
if(validatPhone && validatAge){
  return {
    result: true,
    message: '\u6821\u9A8C\u901A\u8FC7'
  };
} else {
  let message = '';
  if(!validatPhone) message += '[\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A]';
  if(!validatAge) message += '[\u5E74\u9F84\u5FC5\u987B\u572818~35\u5C81\u4E4B\u95F4]';
  return{
    result: false,
    message
  };
}`),F=m({});function E(d,i){d.dataTransfer.setData("fieldName",i)}function T(d){const i=d.dataTransfer.getData("fieldName");u.value.findIndex(p=>p.key===i)===-1&&u.value.push({key:i,value:""}),console.log(i)}function N(d){d.preventDefault()}function O(){try{const d=v.value.getFunction(),i=u.value.map(c=>c.key!=="name"?Number(c.value):c.value);console.log(i),console.log(d);const p=d(...i);console.log(p),V.success("\u51FD\u6570\u6267\u884C\u6210\u529F\uFF01"),e.value=p}catch{e.value="",V.error("\u51FD\u6570\u6267\u884C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u51FD\u6570\u4F53\u548C\u5165\u53C2\u662F\u5426\u4E66\u5199\u6B63\u786E\uFF01")}}function j({row:d,column:i,rowIndex:p,columnIndex:c}){if(p===h.value.length-1&&c===0)return[1,4];if(p===h.value.length-1&&c>0&&c<4)return[0,0]}function M(){try{const d=x.value.getFunction(),i=h.value;let p=0;for(let c=0;c<i.length-1;c++){const w=+d(i[c]).toFixed(2);p+=w,i[c].total=w}i[i.length-1].total=p,V.success("\u8BA1\u7B97\u6210\u529F\uFF01")}catch{V.error("\u51FD\u6570\u6267\u884C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u51FD\u6570\u4F53\u548C\u5165\u53C2\u662F\u5426\u4E66\u5199\u6B63\u786E\uFF01")}}function n(){B.value=!0,g.value=""}function z(){const d=k.value;d.indexOf(g.value)===-1&&d.push(g.value),U()}function U(){B.value=!1,g.value=""}function I(d){k.value.splice(k.value.indexOf(d),1)}function G(){try{const d=_.value.getFunction(),i=[],p=k.value;for(let w=0;w<p.length;w++){const J=JSON.parse(f.value)[p[w]];i.push(J)}const c=d(...i);F.value={type:c.result?"success":"error",message:c.message},V(F.value)}catch{e.value="",V.error("\u51FD\u6570\u6267\u884C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u51FD\u6570\u4F53\u548C\u5165\u53C2\u662F\u5426\u4E66\u5199\u6B63\u786E\uFF01")}}return{fieldsEditRef:v,goodsEditRef:x,fieldsMapping:u,fieldsFuncBody:l,fieldsTitle:e,dragField:E,dropField:T,allowDrop:N,runTest1:O,runTest2:M,columns:[{title:"\u5546\u54C1\u540D\u79F0",key:"name"},{title:"\u5546\u54C1\u5355\u4EF7",key:"price"},{title:"\u5546\u54C1\u6570\u91CF",key:"num"},{title:"\u6298\u6263",key:"discount"},{title:"\u5408\u8BA1",key:"total"}],goodsData:h,goodsFuncBody:y,handleSpan:j,formObjStr:f,formParams:k,formAdded:B,formField:g,formFuncBody:D,formEditRef:_,formResult:F,addOne:n,blurAdd:z,blurCancel:U,handleCloseTag:I,runTest3:G}}},C=u=>(Y("data-v-dd467cc4"),u=u(),Z(),u),ue=C(()=>o("div",null,"\u52A8\u6001\u7F16\u5199\u6267\u884C\u51FD\u6570\u4F53\uFF0C\u6267\u884C\u83B7\u53D6\u8FD4\u56DE\u6570\u636E\u3002",-1)),me={flex:""},pe={class:"p10",style:{width:"40%"}},_e=s(" \u52A8\u6001\u6307\u5B9A\u5B57\u6BB5\u540D\u79F0 "),fe=C(()=>o("p",null,"\u9009\u62E9\u5B57\u6BB5\u62D6\u5165\u914D\u7F6E\u533A\u57DF",-1)),ge=C(()=>o("p",null,"\u586B\u5199\u914D\u7F6E\uFF0C\u53F3\u4FA7\u4F1A\u81EA\u52A8\u62FC\u63A5\u51FD\u6570\u53C2\u6570\u3002",-1)),ye=s(" \u5B57\u6BB5\u5019\u9009 "),ve=s("name"),he=s("price"),be=s("num"),ke=s("discount"),Fe=s("breaks"),xe={key:0,class:"tip"},we=s("\u6267\u884C\u8BA1\u7B97"),Ve=s(" \u6267\u884C\u8BA1\u7B97\u6210\u529F "),Ce={class:"p10",style:{width:"60%"}},Be=s(" \u8BA1\u7B97\u51FD\u6570 "),De=C(()=>o("p",null,"\u51FD\u6570\u4F53\u5165\u53C2\u6839\u636E\u914D\u7F6E\u4F20\u5165\uFF0C\u5185\u90E8\u53EF\u76F4\u63A5\u4F7F\u7528\uFF0C\u8F93\u5165\u81EA\u5B9A\u4E49\u8BA1\u7B97\u51FD\u6570\u5E76\u8FD4\u56DE\u5373\u53EF\u3002",-1)),Se=C(()=>o("p",null,"\u51FD\u6570\u4F53\u5185\u4EE3\u7801\u9075\u5FAAjs\u7F16\u5199\u89C4\u8303\uFF0C\u5185\u6709\u4EE3\u7801\u63D0\u793A\uFF0C\u5982\u4EE3\u7801\u7F16\u5199\u9519\u8BEF\u5219\u6267\u884C\u8BA1\u7B97\u65F6\u4F1A\u62A5\u9519\u3002",-1)),Te=C(()=>o("div",{class:"example"},[s(" \u793A\u4F8B\u4EE3\u7801\uFF1A "),o("p",null,"\u62FC\u63A5\u5B57\u7B26\u4E32\uFF1A"),o("p",{style:{"padding-left":"8px"}},"return `${name} \u5546\u54C1 \uFF0C\u5355\u4EF7${price} \uFF0C\u6570\u91CF${num} \uFF0C\u603B\u4EF7: ${price*num}`;"),o("p",null,"\u8FD4\u56DE\u5E03\u5C14\u503C\uFF1A"),o("p",{style:{"padding-left":"8px"}},"return (price * num) * discount >= 200"),o("p",null,"\u590D\u6742\u8BA1\u7B97\u903B\u8F91\uFF1A"),o("p",{style:{"padding-left":"8px"}},"// \u5982\u679C\u6709\u6298\u6263\u5219\u8BA1\u7B97\u6298\u6263\u540E\u603B\u4EF7"),o("p",{style:{"padding-left":"8px"}},"const total = discount? price * num * discount : price * num;"),o("p",{style:{"padding-left":"8px"}},"// \u5224\u65AD\u662F\u5426\u7B26\u5408\u6EE1\u51CF\u653F\u7B56\uFF0C\u5982\u6EE1200-30"),o("p",{style:{"padding-left":"8px"}},"const totalPrice = total >= 200&&breaks ? total - breaks : total;"),o("p",{style:{"padding-left":"8px"}},"// \u8F93\u51FA\u6700\u7EC8\u7ED3\u679C"),o("p",{style:{"padding-left":"8px"}},"return `\u60A8\u8D2D\u4E70\u4E86${name}\uFF0C\u5355\u4EF7${price}\uFF0C\u6570\u91CF${num}\uFF0C\u6700\u7EC8\u4EF7\u683C: ${totalPrice}`")],-1)),Ae={flex:""},Re={class:"p10",style:{width:"70%"}},Pe={class:"p10",style:{width:"30%"}},Ee=s(" tip: \u8FD9\u91CC\u91C7\u7528\u5BF9\u8C61\u4F20\u5165\u7684\u65B9\u5F0F\u8FDB\u884C\u4F20\u53C2 "),Ne=s("\u6267\u884C\u8BA1\u7B97"),Oe={flex:""},je={class:"p10",style:{width:"30%"}},Me={class:"p10",style:{width:"30%"}},ze=s("\u65B0\u589E\u6821\u9A8C\u5B57\u6BB5"),Ue=s("\u6267\u884C\u6821\u9A8C"),Ke={key:0,class:"p10",style:{width:"30%"}};function Ie(u,l,v,e,x,h){const y=r("b-alert"),_=r("b-tag"),f=r("b-divider"),k=r("key-value-mapping"),g=r("b-button"),B=r("b-icon"),D=r("func-body-editor"),F=r("b-collapse-wrap"),E=r("b-table"),T=r("title-bar"),N=r("b-ace-editor"),O=r("b-input"),j=r("b-space"),M=r("page-wrapper");return b(),A(M,null,{desc:a(()=>[ue]),default:a(()=>[t(F,{title:"\u57FA\u7840\u52A8\u6001\u7F16\u7801",shadow:"none",class:"mb-16"},{default:a(()=>[o("div",me,[o("div",pe,[t(y,{"show-icon":""},{desc:a(()=>[fe,ge]),default:a(()=>[_e]),_:1}),o("div",null,[ye,t(_,{type:"primary",draggable:"true",onDragstart:l[0]||(l[0]=n=>e.dragField(n,"name"))},{default:a(()=>[ve]),_:1}),t(_,{type:"info",draggable:"true",onDragstart:l[1]||(l[1]=n=>e.dragField(n,"price"))},{default:a(()=>[he]),_:1}),t(_,{type:"success",draggable:"true",onDragstart:l[2]||(l[2]=n=>e.dragField(n,"num"))},{default:a(()=>[be]),_:1}),t(_,{type:"warning",draggable:"true",onDragstart:l[3]||(l[3]=n=>e.dragField(n,"discount"))},{default:a(()=>[ke]),_:1}),t(_,{type:"danger",draggable:"true",onDragstart:l[4]||(l[4]=n=>e.dragField(n,"breaks"))},{default:a(()=>[Fe]),_:1})]),t(f,{style:{margin:"10px 0"}}),o("div",{class:"drop-wrapper",onDrop:l[6]||(l[6]=n=>e.dropField(n)),onDragover:l[7]||(l[7]=n=>e.allowDrop(n))},[e.fieldsMapping.length===0?(b(),P("p",xe,"\u62D6\u52A8\u5B57\u6BB5\u5230\u6B64\u5904\u8FDB\u884C\u914D\u7F6E")):R("",!0),t(k,{modelValue:e.fieldsMapping,"onUpdate:modelValue":l[5]||(l[5]=n=>e.fieldsMapping=n),"show-add":!1},null,8,["modelValue"])],32),t(f,{style:{margin:"10px 0"}}),t(g,{type:"primary",onClick:e.runTest1},{default:a(()=>[we]),_:1},8,["onClick"]),t(f,{style:{margin:"10px 0"}}),e.fieldsTitle?(b(),A(y,{key:0,type:"success","show-icon":""},{desc:a(()=>[s(S(e.fieldsTitle),1)]),default:a(()=>[Ve]),_:1})):R("",!0)]),o("div",Ce,[t(y,{"show-icon":""},{icon:a(()=>[t(B,{name:"codelibrary"})]),desc:a(()=>[De,Se]),default:a(()=>[Be]),_:1}),t(D,{ref:"fieldsEditRef",modelValue:e.fieldsFuncBody,"onUpdate:modelValue":l[8]||(l[8]=n=>e.fieldsFuncBody=n),augments:e.fieldsMapping.map(n=>n.key)},null,8,["modelValue","augments"]),t(f,{style:{margin:"10px 0"}}),Te])])]),_:1}),t(F,{title:"\u8868\u683C\u7C7B\u65B9\u5F0F\u8C03\u7528",shadow:"none",class:"mb-16"},{default:a(()=>[o("div",Ae,[o("div",Re,[t(E,{columns:e.columns,data:e.goodsData,border:"","merge-method":e.handleSpan,size:"small"},null,8,["columns","data","merge-method"])]),o("div",Pe,[t(T,{title:"\u5546\u54C1\u8BA1\u7B97\u51FD\u6570","tip-pos":"left"}),Ee,t(D,{ref:"goodsEditRef",modelValue:e.goodsFuncBody,"onUpdate:modelValue":l[9]||(l[9]=n=>e.goodsFuncBody=n),augments:["goods"]},null,8,["modelValue"]),t(f,{style:{margin:"10px 0"}}),t(g,{type:"primary",onClick:e.runTest2},{default:a(()=>[Ne]),_:1},8,["onClick"])])])]),_:1}),t(F,{title:"\u7528\u4E8E\u6821\u9A8C\u51FD\u6570",shadow:"none",class:"mb-16"},{default:a(()=>[o("div",Oe,[o("div",je,[t(N,{modelValue:e.formObjStr,"onUpdate:modelValue":l[10]||(l[10]=n=>e.formObjStr=n)},null,8,["modelValue"])]),o("div",Me,[t(T,{title:"\u6821\u9A8C\u51FD\u6570","tip-pos":"left",class:"mb-10"}),t(j,null,{default:a(()=>[t(g,{size:"mini",onClick:e.addOne},{default:a(()=>[ze]),_:1},8,["onClick"]),(b(!0),P(Q,null,W(e.formParams,n=>(b(),A(_,{key:n,type:"primary",closable:"",onClose:z=>e.handleCloseTag(n)},{default:a(()=>[s(S(n),1)]),_:2},1032,["onClose"]))),128)),e.formAdded?(b(),A(O,{key:0,style:{width:"100px"},size:"mini",modelValue:e.formField,"onUpdate:modelValue":l[11]||(l[11]=n=>e.formField=n),onKeydown:X(e.blurAdd,["enter"]),onBlur:e.blurCancel},null,8,["modelValue","onKeydown","onBlur"])):R("",!0)]),_:1}),t(f,{style:{margin:"10px 0"}}),t(D,{ref:"formEditRef",modelValue:e.formFuncBody,"onUpdate:modelValue":l[12]||(l[12]=n=>e.formFuncBody=n),augments:e.formParams,height:"240"},null,8,["modelValue","augments"]),t(f,{style:{margin:"10px 0"}}),t(g,{type:"primary",onClick:e.runTest3},{default:a(()=>[Ue]),_:1},8,["onClick"])]),e.formResult.type?(b(),P("div",Ke,[t(y,{type:e.formResult.type,"show-icon":""},{desc:a(()=>[s(S(e.formResult.message),1)]),default:a(()=>[s(S(e.formResult.type==="success"?"\u9A8C\u8BC1\u6210\u529F":"\u9A8C\u8BC1\u5931\u8D25")+" ",1)]),_:1},8,["type"])])):R("",!0)])]),_:1})]),_:1})}var Ze=K(ce,[["render",Ie],["__scopeId","data-v-dd467cc4"]]);export{Ze as default};
