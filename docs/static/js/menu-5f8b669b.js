import{e as b,f as l,g as v,v as N,x as e,c as t,a2 as m,q as i,l as p,T,y as J,z as Q,j as X,u as Y,t as Z}from"./vendor-a6c5ad11.js";import{p as ee,i as te}from"./index-fda68aa4.js";import{u as ae}from"./useForm-7a8f51b8.js";import{a as oe}from"./chunk-bin-ui-next-1e71edb3.js";import"./chunk-brace-6f23dcf5.js";import"./chunk-mockjs-c013c588.js";function le(){return ee({url:"/menu/tree",method:"get"})}const ne={flex:"main:justify cross:center",style:{"font-weight":"normal"}},re={class:"top"},se=p("span",{class:"ml-5"},"\u7F16\u8F91\u83DC\u5355",-1),ue={style:{position:"relative","min-height":"100px",overflow:"hidden"}},de={style:{position:"absolute",width:"100%"}},ie={key:0,class:"pt-8"},he=Object.assign({name:"SysMenu"},{__name:"menu",setup(ce){const h=b(null),r=b(null),o=b({}),y=b({}),{formRef:B,editStatus:F,pageStatus:_,editLoading:g,openCreate:R,openEdit:D,backNormal:k,submitForm:U,resetForm:j}=ae();function q(n,a){n.selected?(r.value=n,y.value=a,M()):K()}function E(n){if(n==="root"&&C(),n==="child"){C();const a=r.value;o.value.parentPath=a.path,o.value.parentName=a.title}}function V(n="edit"){if(n==="edit"){const a=y.value,u=r.value,d=a[u.nodeKey].parent,f=d||d===0?a[d].node:{};o.value=u?{...te(u),parentPath:d===0?"":f.path,parentName:f.title}:{};return}o.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function K(){r.value=null,y.value=null,o.value={},k()}function C(){V("create"),R()}function M(){V("edit"),D()}function P(){U(()=>{g.value=!0;const n=_.value;setTimeout(()=>{oe.success(`${n.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),k();const a=r.value?[r.value.nodeKey]:[];h.value&&h.value.reloadTree(a),g.value=!1},1e3)})}function z(){V(F.value),j()}const L={path:[{required:!0,message:"\u83DC\u5355\u8DEF\u5F84\u5FC5\u586B",trigger:"blur"}],title:[{required:!0,message:"\u83DC\u5355\u540D\u79F0\u5FC5\u586B",trigger:"blur"}]};return(n,a)=>{const u=l("b-dropdown-item"),d=l("base-tree"),f=l("iconfont"),S=l("b-alert"),w=l("b-input"),c=l("b-form-item"),O=l("b-icon-select"),x=l("b-button"),W=l("b-form"),$=l("b-col"),A=l("b-row"),G=l("b-card"),H=l("b-layout"),I=l("page-wrapper");return v(),N(I,null,{default:e(()=>[t(H,{"has-sider":"",collapsedWidth:24},{sider:e(()=>[t(d,{ref_key:"treeRef",ref:h,"tree-title":"\u83DC\u5355\u5217\u8868","show-filter":"","title-key":"title",fetch:m(le),onSelectChange:q,onCommand:E},{ctrl:e(()=>[t(u,{name:"root",divided:""},{default:e(()=>[i("\u589E\u52A0\u6839\u8282\u70B9")]),_:1}),t(u,{name:"child",disabled:!r.value},{default:e(()=>[i("\u589E\u52A0\u5B50\u8282\u70B9")]),_:1},8,["disabled"])]),_:1},8,["fetch"])]),default:e(()=>[t(G,{bordered:!1,class:"card-panel",shadow:"never"},{header:e(()=>[p("div",ne,[p("div",re,[t(f,{icon:"menu",color:"primary",bg:"",round:""}),se])])]),default:e(()=>[p("div",ue,[t(T,{name:"fade-in"},{default:e(()=>[p("div",de,[J(t(S,null,{default:e(()=>[i("\u70B9\u9009\u5DE6\u4FA7\u90E8\u95E8\uFF0C\u8FDB\u884C\u7F16\u8F91\u64CD\u4F5C")]),_:1},512),[[Q,m(_).isNormal]])])]),_:1}),t(T,{name:"fade-transverse"},{default:e(()=>[m(_).isNormal?Z("",!0):(v(),X("div",ie,[o.value.path!=="root"?(v(),N(A,{key:0},{default:e(()=>[t($,{span:"14"},{default:e(()=>[t(W,{ref_key:"formRef",ref:B,model:o.value,rules:L,"label-width":"100px","label-suffix":":"},{default:e(()=>[t(c,{label:"\u7236\u7EA7\u83DC\u5355"},{default:e(()=>[t(w,{modelValue:o.value.parentName,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value.parentName=s),disabled:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u83DC\u5355\u540D\u79F0",prop:"title"},{default:e(()=>[t(w,{modelValue:o.value.title,"onUpdate:modelValue":a[1]||(a[1]=s=>o.value.title=s),placeholder:"\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u83DC\u5355\u8DEF\u5F84",prop:"path"},{default:e(()=>[t(w,{modelValue:o.value.path,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value.path=s),placeholder:"\u8F93\u5165\u83DC\u5355\u8DEF\u5F84",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u83DC\u5355\u56FE\u6807"},{default:e(()=>[t(O,{modelValue:o.value.icon,"onUpdate:modelValue":a[3]||(a[3]=s=>o.value.icon=s)},null,8,["modelValue"])]),_:1}),t(c,null,{default:e(()=>[t(x,{type:"primary",onClick:P,loading:m(g)},{default:e(()=>[i(Y(m(_).isCreate?"\u63D0\u4EA4\u6570\u636E":"\u66F4\u65B0\u6570\u636E"),1)]),_:1},8,["loading"]),t(x,{onClick:z},{default:e(()=>[i("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})):(v(),N(S,{key:1,type:"error","show-icon":""},{default:e(()=>[i("\u7CFB\u7EDF\u83DC\u5355\u6839\u8282\u70B9\u4E0D\u53EF\u7F16\u8F91")]),_:1}))]))]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{he as default};
