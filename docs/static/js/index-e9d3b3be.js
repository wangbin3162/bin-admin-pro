import{a8 as be,r as Jt,l as Kt,o as wt,a as At,b as Et,H as me,F as ie,i as se,t as oe,g as Gt,v as Ut,I as Me,O as Te,a9 as Ae,aa as ke,Q as Ot,R as ye,j as he,m as Be,K as bt,w as xt,f as Nt,T as Ye,n as Ue,p as Xe,G as we,P as We}from"./vendor-5c4b4c96.js";import{i as ce,n as je,o as ze}from"./index-0c470c36.js";import{n as Oe,c as qe}from"./chunk-bin-ui-design-2f3ecd04.js";import"./chunk-brace-6f23dcf5.js";import"./chunk-mockjs-c013c588.js";const Le="/bin-admin-pro/static/svg/node-bea77eab.svg",Fe="/bin-admin-pro/static/svg/switch-89450647.svg";const $e=X=>(Ae("data-v-a5f8614c"),X=X(),ke(),X),Je=$e(()=>Et("div",{class:"ef-node-left"},null,-1)),Ke={key:0,src:Le,class:"node-ico"},Ze={key:1,src:Fe,class:"switch-ico"},Qe=["title"],tn={key:0,class:"ef-node-right-ico"},en={class:"b-iconfont b-icon-check-circle"},nn={class:"b-iconfont b-icon-error"},sn={class:"b-iconfont b-icon-warning-circle"},on={class:"b-iconfont b-icon-loading"},ln={__name:"flow-node",props:{node:{type:Object,default:()=>({})},showState:{type:Boolean,default:!0},activeElement:Object},emits:["clickNode","changeNodeSite","nodeRightMenu"],setup(X,{emit:c}){const H=c,Q=X,J=Jt(null),W=Kt(()=>({top:Q.node.top,left:Q.node.left})),r=Kt(()=>Q.activeElement.type==="node"&&Q.activeElement.nodeId===Q.node.id),E=Kt(()=>["ef-node-container",`el-node-${Q.node.type}`,{"ef-node-active":r.value},{"view-only":Q.node.viewOnly}]),a=Kt(()=>{const j={};return j[`b-iconfont b-icon-${Q.node.ico}`]=!0,j});function t(){H("clickNode",Q.node.id)}function p(){const{left:j,top:D}=Q.node,I=J.value.style;if(j===I.left&&D===I.top)return;const s={nodeId:Q.node.id,left:I.left,top:I.top};H("changeNodeSite",s)}function x(j){H("nodeRightMenu",Q.node.id,j)}return(j,D)=>(wt(),At("div",{ref_key:"nodeRef",ref:J,style:Me(W.value),class:me(E.value),onClick:t,onMouseup:p,onContextmenu:D[0]||(D[0]=Te(I=>x(I),["stop","prevent"]))},[Je,Et("div",{class:me(["ef-node-left-ico",{" flow-node-drag":!X.node.viewOnly}])},[X.node.ico?(wt(),At("i",{key:0,class:me(a.value)},null,2)):(wt(),At(ie,{key:1},[X.node.type==="common"?(wt(),At("img",Ke)):se("",!0),X.node.type==="switch"?(wt(),At("img",Ze)):se("",!0)],64))],2),Et("div",{class:"ef-node-text",title:X.node.name},oe(X.node.name),9,Qe),X.showState?(wt(),At("div",tn,[Gt(Et("i",en,null,512),[[Ut,X.node.state==="success"]]),Gt(Et("i",nn,null,512),[[Ut,X.node.state==="error"]]),Gt(Et("i",sn,null,512),[[Ut,X.node.state==="warning"]]),Gt(Et("i",on,null,512),[[Ut,X.node.state==="running"]])])):se("",!0)],38))}},rn=be(ln,[["__scopeId","data-v-a5f8614c"]]);const He=X=>(Ae("data-v-51893b01"),X=X(),ke(),X),an={class:"flow-menu",ref:"tool"},un={class:"type-box"},cn=He(()=>Et("img",{src:Le,alt:"node",style:{width:"24px",height:"24px"}},null,-1)),hn=[cn],dn=He(()=>Et("img",{src:Fe,alt:"switch",style:{width:"20px",height:"20px"}},null,-1)),fn=[dn],pn={class:"ef-node-menu-ul"},gn=["type","draggable","onDragstart"],mn={class:"ef-node-left-ico"},yn={key:0,src:Le,alt:"node",style:{width:"24px",height:"24px"}},bn={key:1,src:Fe,alt:"switch",style:{width:"20px",height:"20px"}},_n={class:"ef-node-text"},Ie="common",Ge="switch",vn={__name:"flow-menu",props:{repeat:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},menuList:{type:Object,default:()=>({common:[{id:"11",type:"common",name:"\u6570\u636E\u63A5\u5165",ico:"index",style:{}},{id:"12",type:"common",name:"\u63A5\u53E3\u8C03\u7528",style:{}}],switch:[{id:"13",type:"switch",name:"\u6D41\u7A0B\u7ED3\u675F",style:{}},{id:"14",type:"switch",name:"\u6570\u636E\u6E05\u7406",ico:"clear",style:{}}]})}},setup(X){const c=X,H=Jt(Ie),Q=Kt(()=>c.menuList[H.value]);function J(r){return c.data.nodeList.findIndex(E=>E.id===r)>-1}function W(r,E){r.dataTransfer.setData("node",JSON.stringify(E))}return(r,E)=>{const a=Ot("b-icon");return wt(),At("div",an,[Et("div",un,[Et("div",{class:me(["type-item",{active:H.value===Ie}]),title:"\u901A\u7528\u8282\u70B9",onClick:E[0]||(E[0]=t=>H.value=Ie)},hn,2),Et("div",{class:me(["type-item",{active:H.value===Ge}]),title:"\u6761\u4EF6\u8282\u70B9",onClick:E[1]||(E[1]=t=>H.value=Ge)},fn,2)]),Et("ul",pn,[(wt(!0),At(ie,null,ye(Q.value,t=>(wt(),At("li",{class:me(["ef-node-menu-li",[t.type,{disabled:J(t.id)}]]),key:t.id,type:t.type,draggable:!J(t.id),onDragstart:p=>W(p,t)},[Et("div",mn,[t.ico?(wt(),he(a,{key:0,name:t.ico},null,8,["name"])):(wt(),At(ie,{key:1},[t.type==="common"?(wt(),At("img",yn)):se("",!0),t.type==="switch"?(wt(),At("img",bn)):se("",!0)],64))]),Et("span",_n,oe(t.name),1)],42,gn))),128))])],512)}}},Pn=be(vn,[["__scopeId","data-v-51893b01"]]);const Cn=X=>(Ae("data-v-9adb8357"),X=X(),ke(),X),xn={class:"ef-node-form"},En=Cn(()=>Et("div",{class:"ef-node-form-header"},"\u7F16\u8F91",-1)),Sn={class:"ef-node-form-body"},Dn={class:"empty"},wn={class:"mr-8"},jn={class:"b-iconfont b-icon-check-circle"},An={class:"b-iconfont b-icon-error"},kn={class:"b-iconfont b-icon-warning-circle"},On={class:"b-iconfont b-icon-loading"},In={__name:"flow-form",props:{showIco:{type:Boolean,default:!0},showState:{type:Boolean,default:!0}},emits:["setLineLabel","saveNode","cancelSelect"],setup(X,{expose:c,emit:H}){const Q=H,J=[{state:"success",label:"\u6210\u529F"},{state:"warning",label:"\u8B66\u544A"},{state:"error",label:"\u9519\u8BEF"},{state:"running",label:"\u8FD0\u884C\u4E2D"}],W=Be({type:"node",node:{},line:{},data:{}}),r=Kt(()=>Object.keys(W.node).length===0&&Object.keys(W.line).length===0);function E(j,D){W.type="node",W.data=j,j.nodeList.forEach(I=>{I.id===D&&(W.node=ce(I))})}function a(j,D){W.type="line",W.data=j,W.line=D}function t(){Q("setLineLabel",W.line)}function p(){W.data.nodeList.forEach(j=>{j.id===W.node.id&&(j.name=W.node.name,j.left=W.node.left,j.top=W.node.top,j.ico=W.node.ico,j.state=W.node.state,Q("saveNode",j))})}function x(){W.type="node",W.node={},W.line={},W.data={},Q("cancelSelect")}return c({nodeInit:E,lineInit:a}),(j,D)=>{const I=Ot("b-input"),s=Ot("b-form-item"),l=Ot("b-icon-select"),N=Ot("b-option"),R=Ot("b-select"),U=Ot("b-button"),O=Ot("b-form"),b=Ot("b-ace-editor");return wt(),At("div",xn,[En,Et("div",Sn,[Gt(Et("div",Dn,"\u6682\u672A\u9009\u62E9\u5143\u7D20",512),[[Ut,r.value]]),Gt(bt(O,{model:W.node,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(s,{label:"\u7C7B\u578B"},{default:xt(()=>[bt(I,{modelValue:W.node.type,"onUpdate:modelValue":D[0]||(D[0]=n=>W.node.type=n),disabled:!0},null,8,["modelValue"])]),_:1}),bt(s,{label:"\u540D\u79F0"},{default:xt(()=>[bt(I,{modelValue:W.node.name,"onUpdate:modelValue":D[1]||(D[1]=n=>W.node.name=n),clearable:""},null,8,["modelValue"])]),_:1}),bt(s,{label:"left\u5750\u6807"},{default:xt(()=>[bt(I,{modelValue:W.node.left,"onUpdate:modelValue":D[2]||(D[2]=n=>W.node.left=n),disabled:""},null,8,["modelValue"])]),_:1}),bt(s,{label:"top\u5750\u6807"},{default:xt(()=>[bt(I,{modelValue:W.node.top,"onUpdate:modelValue":D[3]||(D[3]=n=>W.node.top=n),disabled:""},null,8,["modelValue"])]),_:1}),X.showIco?(wt(),he(s,{key:0,label:"ico\u56FE\u6807"},{default:xt(()=>[bt(l,{modelValue:W.node.ico,"onUpdate:modelValue":D[4]||(D[4]=n=>W.node.ico=n)},null,8,["modelValue"])]),_:1})):se("",!0),X.showState?(wt(),he(s,{key:1,label:"\u72B6\u6001"},{default:xt(()=>[bt(R,{modelValue:W.node.state,"onUpdate:modelValue":D[5]||(D[5]=n=>W.node.state=n),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:xt(()=>[(wt(),At(ie,null,ye(J,n=>bt(N,{key:n.state,label:n.label,value:n.state},{default:xt(()=>[Et("span",wn,[Gt(Et("i",jn,null,512),[[Ut,n.state==="success"]]),Gt(Et("i",An,null,512),[[Ut,n.state==="error"]]),Gt(Et("i",kn,null,512),[[Ut,n.state==="warning"]]),Gt(Et("i",On,null,512),[[Ut,n.state==="running"]])]),Et("span",null,oe(n.label),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})):se("",!0),bt(s,null,{default:xt(()=>[bt(U,{icon:"close",onClick:x},{default:xt(()=>[Nt("\u53D6\u6D88")]),_:1}),bt(U,{type:"primary",icon:"check",onClick:p},{default:xt(()=>[Nt("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,W.type==="node"&&W.node.type]]),Gt(bt(O,{model:W.line,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(s,{label:"\u7C7B\u578B"},{default:xt(()=>[bt(I,{modelValue:W.type,"onUpdate:modelValue":D[6]||(D[6]=n=>W.type=n),disabled:!0},null,8,["modelValue"])]),_:1}),bt(s,{label:"\u6761\u4EF6"},{default:xt(()=>[bt(I,{modelValue:W.line.label,"onUpdate:modelValue":D[7]||(D[7]=n=>W.line.label=n),clearable:""},null,8,["modelValue"])]),_:1}),bt(s,null,{default:xt(()=>[bt(U,{icon:"close",onClick:x},{default:xt(()=>[Nt("\u53D6\u6D88")]),_:1}),bt(U,{type:"primary",icon:"check",onClick:t},{default:xt(()=>[Nt("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,W.type==="line"]]),bt(b,{"model-value":JSON.stringify(W,null,2),height:"200px"},null,8,["model-value"])])])}}},Tn=be(In,[["__scopeId","data-v-9adb8357"]]);const Mn={__name:"context-menu",props:{data:{type:Object,default:()=>({})}},emits:["delete"],setup(X,{emit:c}){const H=c,Q=X,J=Kt(()=>Q.data.show),W=Kt(()=>({left:Q.data.left,top:Q.data.top}));function r(){H("delete")}return(E,a)=>{const t=Ot("b-icon");return wt(),he(Ye,{name:"zoom-in-top"},{default:xt(()=>[Gt(Et("ul",{class:"contextmenu",style:Me(W.value)},[Et("li",{onClick:r},[bt(t,{name:"delete"}),Nt(" \u5220\u9664"+oe(X.data.type==="line"?"\u7EBF":"\u8282\u70B9"),1)])],4),[[Ut,J.value]])]),_:1})}}},Ln=be(Mn,[["__scopeId","data-v-0d15390a"]]),Fn={__name:"flow-info",props:{data:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(X,{emit:c}){const H=c,Q=X,J=Kt({get:()=>Q.modelValue,set:W=>H("update:modelValue",W)});return(W,r)=>{const E=Ot("b-ace-editor"),a=Ot("b-modal");return wt(),he(a,{modelValue:J.value,"onUpdate:modelValue":r[0]||(r[0]=t=>J.value=t),title:"\u6D41\u7A0B\u6570\u636E\u4FE1\u606F",width:"680px","destroy-on-close":""},{default:xt(()=>[bt(E,{"model-value":JSON.stringify(X.data,null,2),height:"500px"},null,8,["model-value"])]),_:1},8,["modelValue"])}}};const Nn={style:{overflow:"hidden"},flex:""},Rn={style:{width:"30%","border-right":"1px solid #f0f0f0"}},Gn={class:"scroll-box"},Bn=["id"],Un={class:"title"},Hn={__name:"helper",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(X,{emit:c}){const H=c,Q=X,J=Jt("add"),W=[{id:"add",icon:"plus-circle",title:"\u5982\u4F55\u65B0\u589E",message:["\u6309\u4F4F\u9F20\u6807\u62D6\u62FD\u5DE6\u4FA7\u7EC4\u4EF6\u5230\u4E2D\u95F4\u753B\u5E03\u4E2D\u677E\u5F00\u9F20\u6807\u5373\u53EF"]},{id:"delete",icon:"delete",title:"\u5982\u4F55\u5220\u9664",message:["1\u3001\u9F20\u6807\u70B9\u4E2D\u9700\u8981\u5220\u9664\u7684\u8282\u70B9\u6216\u8FDE\u7EBF\uFF0C\u70B9\u51FB\u5DE6\u4E0A\u89D2\u7684\u5220\u9664\u56FE\u6807","2\u3001\u9F20\u6807\u53F3\u952E\u9700\u8981\u5220\u9664\u7684\u8282\u70B9\u6216\u8FDE\u7EBF\uFF0C\u9009\u62E9\u5220\u9664\u8282\u70B9\u6216\u5220\u9664\u7EBF"]},{id:"move",icon:"drag",title:"\u5982\u4F55\u79FB\u52A8",message:["\u9F20\u6807\u79FB\u52A8\u5230\u8282\u70B9\u4E2D\uFF0C\u5F53\u9F20\u6807\u53D8\u4E3A\u53EF\u62D6\u62FD\u7684\u56FE\u6807\u65F6\u6309\u4E0B\u9F20\u6807\u79FB\u52A8\u5230\u65B0\u7684\u4F4D\u7F6E\u677E\u5F00\u9F20\u6807"]},{id:"line",icon:"index",title:"\u5982\u4F55\u8FDE\u7EBF",message:["\u9F20\u6807\u79FB\u52A8\u5230\u8282\u70B9\u4E2D\u5DE6\u4FA7\u7684\u56FE\u6807\u4E0A\uFF0C\u5F53\u9F20\u6807\u53D8\u4E3A + \u65F6\u6309\u4E0B\u9F20\u6807\u79FB\u52A8\u5230\u53E6\u4E00\u4E2A\u8282\u70B9\u4E2D\u677E\u5F00\u9F20\u6807"]},{id:"condition",icon:"sisternode",title:"\u5982\u4F55\u6DFB\u52A0\u6761\u4EF6",message:["\u70B9\u51FB\u753B\u5E03\u4E2D\u7684\u8FDE\u7EBF\uFF0C\u5728\u9875\u9762\u53F3\u4FA7\u4F1A\u51FA\u73B0\u4E00\u4E2A\u8868\u5355\uFF0C\u8F93\u5165\u65B0\u7684\u6761\u4EF6\uFF0C\u70B9\u51FB\u3010\u4FDD\u5B58\u3011"]}],r=Kt({get:()=>Q.modelValue,set:E=>H("update:modelValue",E)});return Ue(()=>r.value,E=>{E&&(J.value="add")}),(E,a)=>{const t=Ot("b-icon"),p=Ot("b-menu-item"),x=Ot("b-menu"),j=Ot("b-divider"),D=Ot("b-modal");return wt(),he(D,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=I=>r.value=I),title:"\u5E2E\u52A9",width:"680px","body-styles":{padding:0}},{default:xt(()=>[Et("div",Nn,[Et("div",Rn,[bt(x,{"default-active":J.value,onSelect:a[0]||(a[0]=I=>J.value=I)},{default:xt(()=>[(wt(),At(ie,null,ye(W,I=>bt(p,{key:I.id,index:I.id},{title:xt(()=>[Nt(oe(I.title),1)]),default:xt(()=>[bt(t,{name:I.icon},null,8,["name"])]),_:2},1032,["index"])),64))]),_:1},8,["default-active"])]),Et("div",Gn,[(wt(),At(ie,null,ye(W,I=>Gt(Et("div",{key:I.id,class:"scroll-page",id:I.id},[Et("div",Un,[bt(j,{align:"left",style:{margin:"0"}},{default:xt(()=>[Nt(oe(I.title),1)]),_:2},1024)]),(wt(!0),At(ie,null,ye(I.message,(s,l)=>(wt(),At("p",{key:l},oe(s),1))),128))],8,Bn),[[Ut,I.id===J.value]])),64))])])]),_:1},8,["modelValue"])}}},Vn=be(Hn,[["__scopeId","data-v-01b8b5ef"]]);(function(){typeof Math.sgn>"u"&&(Math.sgn=function(g){return g==0?0:g>0?1:-1});let X={subtract:function(g,u){return{x:g.x-u.x,y:g.y-u.y}},dotProduct:function(g,u){return g.x*u.x+g.y*u.y},square:function(g){return Math.sqrt(g.x*g.x+g.y*g.y)},scale:function(g,u){return{x:g.x*u,y:g.y*u}}},c=64,H=Math.pow(2,-c-1),Q=function(g,u){let m=[],A=W(g,u),F=u.length-1,i=2*F-1,e=r(A,i,m,0),d=X.subtract(g,u[0]),C=X.square(d),w=0;for(let z=0;z<e;z++){d=X.subtract(g,p(u,F,m[z],null,null));var B=X.square(d);B<C&&(C=B,w=m[z])}return d=X.subtract(g,u[F]),B=X.square(d),B<C&&(C=B,w=1),{location:w,distance:C}},J=function(g,u){let m=Q(g,u);return{point:p(u,u.length-1,m.location,null,null),location:m.location}};var W=function(g,u){let m=u.length-1,A=2*m-1,F=[],i=[],e=[],d=[],C=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];for(var w=0;w<=m;w++)F[w]=X.subtract(u[w],g);for(var w=0;w<=m-1;w++)i[w]=X.subtract(u[w+1],u[w]),i[w]=X.scale(i[w],3);for(let Y=0;Y<=m-1;Y++)for(let V=0;V<=m;V++)e[Y]||(e[Y]=[]),e[Y][V]=X.dotProduct(i[Y],F[V]);for(w=0;w<=A;w++)d[w]||(d[w]=[]),d[w].y=0,d[w].x=parseFloat(w)/A;let B=m,z=m-1;for(let Y=0;Y<=B+z;Y++){let V=Math.max(0,Y-z),ot=Math.min(Y,B);for(w=V;w<=ot;w++){let ct=Y-w;d[w+ct].y+=e[ct][w]*C[ct][w]}}return d},r=function(g,u,m,A){let F=[],i=[],e,d,C=[],w=[];switch(E(g,u)){case 0:return 0;case 1:{if(A>=c)return m[0]=(g[0].x+g[u].x)/2,1;if(a(g,u))return m[0]=t(g,u),1;break}}p(g,u,.5,F,i),e=r(F,u,C,A+1),d=r(i,u,w,A+1);for(var B=0;B<e;B++)m[B]=C[B];for(var B=0;B<d;B++)m[B+e]=w[B];return e+d},E=function(g,u){let m=0,A,F;A=F=Math.sgn(g[0].y);for(let i=1;i<=u;i++)A=Math.sgn(g[i].y),A!=F&&m++,F=A;return m},a=function(g,u){let m,A,F,i,e,d,C,w,B,z,Y,V,ot,ct,pt,$;d=g[0].y-g[u].y,C=g[u].x-g[0].x,w=g[0].x*g[u].y-g[u].x*g[0].y;let rt,ft;rt=ft=0;for(let ut=1;ut<u;ut++){let ht=d*g[ut].x+C*g[ut].y+w;ht>rt?rt=ht:ht<ft&&(ft=ht)}return Y=0,V=1,ot=0,ct=d,pt=C,$=w-rt,B=Y*pt-ct*V,z=1/B,A=(V*$-pt*ot)*z,ct=d,pt=C,$=w-ft,B=Y*pt-ct*V,z=1/B,F=(V*$-pt*ot)*z,i=Math.min(A,F),e=Math.max(A,F),m=e-i,m<H?1:0},t=function(g,u){let m=1,A=0,F=g[u].x-g[0].x,i=g[u].y-g[0].y,e=g[0].x-0,d=g[0].y-0,C=F*A-i*m,w=1/C,B=(F*d-i*e)*w;return 0+m*B},p=function(g,u,m,A,F){let i=[[]];for(var e=0;e<=u;e++)i[0][e]=g[e];for(let d=1;d<=u;d++)for(var e=0;e<=u-d;e++)i[d]||(i[d]=[]),i[d][e]||(i[d][e]={}),i[d][e].x=(1-m)*i[d-1][e].x+m*i[d-1][e+1].x,i[d][e].y=(1-m)*i[d-1][e].y+m*i[d-1][e+1].y;if(A!=null)for(e=0;e<=u;e++)A[e]=i[e][0];if(F!=null)for(e=0;e<=u;e++)F[e]=i[u-e][e];return i[u][0]};let x={},j=function(g){let u=x[g];if(!u){u=[];let A=function(){return function(w){return Math.pow(w,g)}},F=function(){return function(w){return Math.pow(1-w,g)}},i=function(w){return function(B){return w}},e=function(){return function(w){return w}},d=function(){return function(w){return 1-w}},C=function(w){return function(B){let z=1;for(let Y=0;Y<w.length;Y++)z=z*w[Y](B);return z}};u.push(new A);for(let w=1;w<g;w++){let B=[new i(g)];for(var m=0;m<g-w;m++)B.push(new e);for(var m=0;m<w;m++)B.push(new d);u.push(new C(B))}u.push(new F),x[g]=u}return u},D=function(g,u){let m=j(g.length-1),A=0,F=0;for(let i=0;i<g.length;i++)A=A+g[i].x*m[i](u),F=F+g[i].y*m[i](u);return{x:A,y:F}},I=function(g,u){return Math.sqrt(Math.pow(g.x-u.x,2)+Math.pow(g.y-u.y,2))},s=function(g){return g[0].x===g[1].x&&g[0].y===g[1].y},l=function(g,u,m){if(s(g))return{point:g[0],location:u};let A=D(g,u),F=0,i=u,e=m>0?1:-1,d=null;for(;F<Math.abs(m);)i+=.005*e,d=D(g,i),F+=I(d,A),A=d;return{point:d,location:i}},N=function(g){if(s(g))return 0;let u=D(g,0),m=0,A=0,F=1,i=null;for(;A<1;)A+=.005*F,i=D(g,A),m+=I(i,u),u=i;return m},R=function(g,u,m){return l(g,u,m).point},U=function(g,u,m){return l(g,u,m).location},O=function(g,u){let m=D(g,u),A=D(g.slice(0,g.length-1),u),F=A.y-m.y,i=A.x-m.x;return F===0?1/0:Math.atan(F/i)},b=function(g,u,m){let A=l(g,u,m);return A.location>1&&(A.location=1),A.location<0&&(A.location=0),O(g,A.location)},n=function(g,u,m,A){A=A==null?0:A;let F=l(g,u,A),i=O(g,F.location),e=Math.atan(-1/i),d=m/2*Math.sin(e),C=m/2*Math.cos(e);return[{x:F.point.x+C,y:F.point.y+d},{x:F.point.x-C,y:F.point.y-d}]},y=function(g,u,m,A,F){let i=A-u,e=g-m,d=g*(u-A)+u*(m-g),C=f(F),w=[i*C[0][0]+e*C[1][0],i*C[0][1]+e*C[1][1],i*C[0][2]+e*C[1][2],i*C[0][3]+e*C[1][3]+d],B=v.apply(null,w),z=[];if(B!=null)for(let V=0;V<3;V++){let ot=B[V],ct=Math.pow(ot,2),pt=Math.pow(ot,3),$=[C[0][0]*pt+C[0][1]*ct+C[0][2]*ot+C[0][3],C[1][0]*pt+C[1][1]*ct+C[1][2]*ot+C[1][3]];var Y;m-g!==0?Y=($[0]-g)/(m-g):Y=($[1]-u)/(A-u),ot>=0&&ot<=1&&Y>=0&&Y<=1&&z.push($)}return z},h=function(g,u,m,A,F){let i=[];return i.push.apply(i,y(g,u,g+m,u,F)),i.push.apply(i,y(g+m,u,g+m,u+A,F)),i.push.apply(i,y(g+m,u+A,g,u+A,F)),i.push.apply(i,y(g,u+A,g,u,F)),i},S=function(g,u){let m=[];return m.push.apply(m,y(g.x,g.y,g.x+g.w,g.y,u)),m.push.apply(m,y(g.x+g.w,g.y,g.x+g.w,g.y+g.h,u)),m.push.apply(m,y(g.x+g.w,g.y+g.h,g.x,g.y+g.h,u)),m.push.apply(m,y(g.x,g.y+g.h,g.x,g.y,u)),m};function T(g,u){return[-g[0][u]+3*g[1][u]+-3*g[2][u]+g[3][u],3*g[0][u]-6*g[1][u]+3*g[2][u],-3*g[0][u]+3*g[1][u],g[0][u]]}function f(g){return[T(g,"x"),T(g,"y")]}function _(g){return g<0?-1:g>0?1:0}function v(g,u,m,A){let F=u/g,i=m/g,e=A/g,d=(3*i-Math.pow(F,2))/9,C=(9*F*i-27*e-2*Math.pow(F,3))/54,w=Math.pow(d,3)+Math.pow(C,2),B,z,Y=[];if(w>=0)B=_(C+Math.sqrt(w))*Math.pow(Math.abs(C+Math.sqrt(w)),1/3),z=_(C-Math.sqrt(w))*Math.pow(Math.abs(C-Math.sqrt(w)),1/3),Y[0]=-F/3+(B+z),Y[1]=-F/3-(B+z)/2,Y[2]=-F/3-(B+z)/2,Math.abs(Math.sqrt(3)*(B-z)/2)!==0&&(Y[1]=-1,Y[2]=-1);else{let V=Math.acos(C/Math.sqrt(-Math.pow(d,3)));Y[0]=2*Math.sqrt(-d)*Math.cos(V/3)-F/3,Y[1]=2*Math.sqrt(-d)*Math.cos((V+2*Math.PI)/3)-F/3,Y[2]=2*Math.sqrt(-d)*Math.cos((V+4*Math.PI)/3)-F/3}for(let V=0;V<3;V++)(Y[V]<0||Y[V]>1)&&(Y[V]=-1);return Y}let M=this.jsBezier={distanceFromCurve:Q,gradientAtPoint:O,gradientAtPointAlongCurveFrom:b,nearestPointOnCurve:J,pointOnCurve:D,pointAlongCurveFrom:R,perpendicularToCurveAt:n,locationAlongCurveFrom:U,getLength:N,lineIntersection:y,boxIntersection:h,boundingBoxIntersection:S,version:"0.9.0"};typeof exports<"u"&&(exports.jsBezier=M)}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.Biltong={version:"0.4.0"};typeof exports<"u"&&(exports.Biltong=c);let H=function(a){return Object.prototype.toString.call(a)==="[object Array]"},Q=function(a,t,p){return a=H(a)?a:[a.x,a.y],t=H(t)?t:[t.x,t.y],p(a,t)},J=c.gradient=function(a,t){return Q(a,t,function(p,x){return x[0]==p[0]?x[1]>p[1]?1/0:-1/0:x[1]==p[1]?x[0]>p[0]?0:-0:(x[1]-p[1])/(x[0]-p[0])})};c.normal=function(a,t){return-1/J(a,t)},c.lineLength=function(a,t){return Q(a,t,function(p,x){return Math.sqrt(Math.pow(x[1]-p[1],2)+Math.pow(x[0]-p[0],2))})};let W=c.quadrant=function(a,t){return Q(a,t,function(p,x){return x[0]>p[0]||x[0]==p[0]?x[1]>p[1]?2:1:x[1]>p[1]?3:4})};c.theta=function(a,t){return Q(a,t,function(p,x){let j=J(p,x),D=Math.atan(j),I=W(p,x);return(I==4||I==3)&&(D+=Math.PI),D<0&&(D+=2*Math.PI),D})},c.intersects=function(a,t){let p=a.x,x=a.x+a.w,j=a.y,D=a.y+a.h,I=t.x,s=t.x+t.w,l=t.y,N=t.y+t.h;return p<=I&&I<=x&&j<=l&&l<=D||p<=s&&s<=x&&j<=l&&l<=D||p<=I&&I<=x&&j<=N&&N<=D||p<=s&&I<=x&&j<=N&&N<=D||I<=p&&p<=s&&l<=j&&j<=N||I<=x&&x<=s&&l<=j&&j<=N||I<=p&&p<=s&&l<=D&&D<=N||I<=x&&p<=s&&l<=D&&D<=N},c.encloses=function(a,t,p){let x=a.x,j=a.x+a.w,D=a.y,I=a.y+a.h,s=t.x,l=t.x+t.w,N=t.y,R=t.y+t.h,U=function(O,b,n,y){return p?O<=b&&n>=y:O<b&&n>y};return U(x,s,j,l)&&U(D,N,I,R)};let r=[null,[1,-1],[1,1],[-1,1],[-1,-1]],E=[null,[-1,-1],[-1,1],[1,1],[1,-1]];c.pointOnLine=function(a,t,p){let x=J(a,t),j=W(a,t),D=p>0?r[j]:E[j],I=Math.atan(x),s=Math.abs(p*Math.sin(I))*D[1],l=Math.abs(p*Math.cos(I))*D[0];return{x:a.x+l,y:a.y+s}},c.perpendicularLineTo=function(a,t,p){let x=J(a,t),j=Math.atan(-1/x),D=p/2*Math.sin(j),I=p/2*Math.cos(j);return[{x:t.x+I,y:t.y+D},{x:t.x-I,y:t.y-D}]}}).call(typeof window<"u"?window:globalThis);(function(){function X(i,e,d,C,w,B,z,Y){return new Touch({target:e,identifier:F(),pageX:d,pageY:C,screenX:w,screenY:B,clientX:z||w,clientY:Y||B})}function c(){let i=[];return Array.prototype.push.apply(i,arguments),i.item=function(e){return this[e]},i}function H(i,e,d,C,w,B,z,Y){return c(X.apply(null,arguments))}var Q=this,J=function(i,e,d){d=d||i.parentNode;let C=d.querySelectorAll(e);for(let w=0;w<C.length;w++)if(C[w]===i)return!0;return!1},W=function(i){return typeof i=="string"||i.constructor===String?document.getElementById(i):i},r=function(i){return i.srcElement||i.target},E=function(i,e,d,C){if(C){if(typeof i.path<"u"&&i.path.indexOf)return{path:i.path,end:i.path.indexOf(d)};{let w={path:[],end:-1},B=function(z){w.path.push(z),z===d?w.end=w.path.length-1:z.parentNode!=null&&B(z.parentNode)};return B(e),w}}else return{path:[e],end:1}},a=function(i,e){for(var d=0,C=i.length;d<C&&i[d]!=e;d++);d<i.length&&i.splice(d,1)},t=1,p=function(i,e,d){let C=t++;return i.__ta=i.__ta||{},i.__ta[e]=i.__ta[e]||{},i.__ta[e][C]=d,d.__tauid=C,C},x=function(i,e,d){if(i.__ta&&i.__ta[e]&&delete i.__ta[e][d.__tauid],d.__taExtra){for(let C=0;C<d.__taExtra.length;C++)m(i,d.__taExtra[C][0],d.__taExtra[C][1]);d.__taExtra.length=0}d.__taUnstore&&d.__taUnstore()},j=function(i,e,d,C){if(i==null)return d;{let w=i.split(","),B=function(z){B.__tauid=d.__tauid;let Y=r(z),V=Y,ot=E(z,Y,e,i!=null);if(ot.end!=-1)for(let ct=0;ct<ot.end;ct++){V=ot.path[ct];for(let pt=0;pt<w.length;pt++)J(V,w[pt],e)&&d.apply(V,arguments)}};return D(d,C,B),B}},D=function(i,e,d){i.__taExtra=i.__taExtra||[],i.__taExtra.push([e,d])},I=function(i,e,d,C){if(O&&n[e]){let w=j(C,i,d,n[e]);u(i,n[e],w,d)}e==="focus"&&i.getAttribute("tabindex")==null&&i.setAttribute("tabindex","1"),u(i,e,j(C,i,d,e),d)},s=function(i,e,d,C){if(i.__taSmartClicks==null){let w=function(Y){i.__tad=T(Y)},B=function(Y){i.__tau=T(Y)},z=function(Y){if(i.__tad&&i.__tau&&i.__tad[0]===i.__tau[0]&&i.__tad[1]===i.__tau[1])for(let V=0;V<i.__taSmartClicks.length;V++)i.__taSmartClicks[V].apply(r(Y),[Y])};I(i,"mousedown",w,C),I(i,"mouseup",B,C),I(i,"click",z,C),i.__taSmartClicks=[]}i.__taSmartClicks.push(d),d.__taUnstore=function(){a(i.__taSmartClicks,d)}},l={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},N=function(i,e){return function(d,C,w,B){if(C=="contextmenu"&&b)I(d,C,w,B);else{if(d.__taTapHandler==null){let ct=d.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]};var z=function(pt){let $=r(pt),rt=E(pt,$,d,B!=null),ft=!1;for(let ut=0;ut<rt.end;ut++){if(ft)return;$=rt.path[ut];for(let ht=0;ht<ct.downSelectors.length;ht++)if(ct.downSelectors[ht]==null||J($,ct.downSelectors[ht],d)){ct.down=!0,setTimeout(V,i),setTimeout(ot,e),ft=!0;break}}},Y=function(pt){if(ct.down){let $=r(pt),rt,ft;ct.taps++;let ut=g(pt);for(let ht in l)if(l.hasOwnProperty(ht)){let Ct=l[ht];if(Ct.touches===ut&&(Ct.taps===1||Ct.taps===ct.taps))for(let mt=0;mt<ct[ht].length;mt++){ft=E(pt,$,d,ct[ht][mt][1]!=null);for(let Z=0;Z<ft.end;Z++)if(rt=ft.path[Z],ct[ht][mt][1]==null||J(rt,ct[ht][mt][1],d)){ct[ht][mt][0].apply(rt,[pt]);break}}}}},V=function(){ct.down=!1},ot=function(){ct.taps=0};I(d,"mousedown",z),I(d,"mouseup",Y)}d.__taTapHandler.downSelectors.push(B),d.__taTapHandler[C].push([w,B]),w.__taUnstore=function(){a(d.__taTapHandler[C],w)}}}},R=function(i,e,d,C){for(let w in d.__tamee[i])d.__tamee[i].hasOwnProperty(w)&&d.__tamee[i][w].apply(C,[e])},U=function(){let i=[];return function(e,d,C,w){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};let B=function(Y){let V=r(Y);(w==null&&V==e&&!e.__tamee.over||J(V,w,e)&&(V.__tamee==null||!V.__tamee.over))&&(R("mouseenter",Y,e,V),V.__tamee=V.__tamee||{},V.__tamee.over=!0,i.push(V))},z=function(Y){let V=r(Y);for(let ot=0;ot<i.length;ot++)V==i[ot]&&!J(Y.relatedTarget||Y.toElement,"*",V)&&(V.__tamee.over=!1,i.splice(ot,1),R("mouseexit",Y,e,V))};u(e,"mouseover",j(w,e,B,"mouseover"),B),u(e,"mouseout",j(w,e,z,"mouseout"),z)}C.__taUnstore=function(){delete e.__tamee[d][C.__tauid]},p(e,d,C),e.__tamee[d][C.__tauid]=C}},O="ontouchstart"in document.documentElement,b="onmousedown"in document.documentElement,n={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},y=function(){let i=-1;if(navigator.appName=="Microsoft Internet Explorer"){let e=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),h=y>-1&&y<9,S=function(i,e){if(i==null)return[0,0];let d=M(i),C=v(d,0);return[C[e+"X"],C[e+"Y"]]},T=function(i){return i==null?[0,0]:h?[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop]:S(i,"page")},f=function(i){return S(i,"screen")},_=function(i){return S(i,"client")},v=function(i,e){return i.item?i.item(e):i[e]},M=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},g=function(i){return M(i).length},u=function(i,e,d,C){if(p(i,e,d),C.__tauid=d.__tauid,i.addEventListener)i.addEventListener(e,d,!1);else if(i.attachEvent){let w=e+d.__tauid;i["e"+w]=d,i[w]=function(){i["e"+w]&&i["e"+w](window.event)},i.attachEvent("on"+e,i[w])}},m=function(i,e,d){d!=null&&A(i,function(){let C=W(this);if(x(C,e,d),d.__tauid!=null){if(C.removeEventListener)C.removeEventListener(e,d,!1),O&&n[e]&&C.removeEventListener(n[e],d,!1);else if(this.detachEvent){let w=e+d.__tauid;C[w]&&C.detachEvent("on"+e,C[w]),C[w]=null,C["e"+w]=null}}d.__taTouchProxy&&m(i,d.__taTouchProxy[1],d.__taTouchProxy[0])})},A=function(i,e){if(i!=null){i=typeof Window<"u"&&typeof i.top!="unknown"&&i==i.top?[i]:typeof i!="string"&&i.tagName==null&&i.length!=null?i:typeof i=="string"?document.querySelectorAll(i):[i];for(let d=0;d<i.length;d++)e.apply(i[d])}},F=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})};Q.Mottle=function(i){i=i||{};let e=i.clickThreshold||250,d=i.dblClickThreshold||450,C=new U,w=new N(e,d),B=i.smartClicks,z=function(Y,V,ot,ct){ot!=null&&A(Y,function(){let pt=W(this);B&&V==="click"?s(pt,V,ot,ct):V==="tap"||V==="dbltap"||V==="contextmenu"?w(pt,V,ot,ct):V==="mouseenter"||V=="mouseexit"?C(pt,V,ot,ct):I(pt,V,ot,ct)})};this.remove=function(Y){return A(Y,function(){let V=W(this);if(V.__ta){for(let ot in V.__ta)if(V.__ta.hasOwnProperty(ot))for(let ct in V.__ta[ot])V.__ta[ot].hasOwnProperty(ct)&&m(V,ot,V.__ta[ot][ct])}V.parentNode&&V.parentNode.removeChild(V)}),this},this.on=function(Y,V,ot,ct){let pt=arguments[0],$=arguments.length==4?arguments[2]:null,rt=arguments[1],ft=arguments[arguments.length-1];return z(pt,rt,ft,$),this},this.off=function(Y,V,ot){return m(Y,V,ot),this},this.trigger=function(Y,V,ot,ct){let pt=b&&(typeof MouseEvent>"u"||ot==null||ot.constructor===MouseEvent),$=O&&!b&&n[V]?n[V]:V,rt=!(O&&!b&&n[V]),ft=T(ot),ut=f(ot),ht=_(ot);return A(Y,function(){let Ct=W(this),mt;ot=ot||{screenX:ut[0],screenY:ut[1],clientX:ht[0],clientY:ht[1]};let Z=function(et){ct&&(et.payload=ct)},tt={TouchEvent:function(et){let lt=H(window,Ct,0,ft[0],ft[1],ut[0],ut[1],ht[0],ht[1]);(et.initTouchEvent||et.initEvent)($,!0,!0,window,null,ut[0],ut[1],ht[0],ht[1],!1,!1,!1,!1,lt,lt,lt,1,0)},MouseEvents:function(et){et.initMouseEvent($,!0,!0,window,0,ut[0],ut[1],ht[0],ht[1],!1,!1,!1,!1,1,Ct)}};if(document.createEvent){let et=!rt&&!pt&&O&&n[V],lt=et?"TouchEvent":"MouseEvents";mt=document.createEvent(lt),tt[lt](mt),Z(mt),Ct.dispatchEvent(mt)}else document.createEventObject&&(mt=document.createEventObject(),mt.eventType=mt.eventName=$,mt.screenX=ut[0],mt.screenY=ut[1],mt.clientX=ht[0],mt.clientY=ht[1],Z(mt),Ct.fireEvent("on"+$,mt))}),this}},Q.Mottle.consume=function(i,e){i.stopPropagation?i.stopPropagation():i.returnValue=!1,!e&&i.preventDefault&&i.preventDefault()},Q.Mottle.pageLocation=T,Q.Mottle.setForceTouchEvents=function(i){O=i},Q.Mottle.setForceMouseEvents=function(i){b=i},Q.Mottle.version="0.8.0",typeof exports<"u"&&(exports.Mottle=Q.Mottle)}).call(typeof window>"u"?globalThis:window);(function(){let X=this,c=function(i,e,d){return i.indexOf(e)===-1?(d?i.unshift(e):i.push(e),!0):!1},H=function(i,e){let d=i.indexOf(e);d!==-1&&i.splice(d,1)},Q=function(i,e){let d=[];for(let C=0;C<i.length;C++)e.indexOf(i[C])===-1&&d.push(i[C]);return d},J=function(i){return i==null?!1:typeof i=="string"||i.constructor===String},W=function(i){let e=i.getBoundingClientRect(),d=document.body,C=document.documentElement,w=window.pageYOffset||C.scrollTop||d.scrollTop,B=window.pageXOffset||C.scrollLeft||d.scrollLeft,z=C.clientTop||d.clientTop||0,Y=C.clientLeft||d.clientLeft||0,V=e.top+w-z,ot=e.left+B-Y;return{top:Math.round(V),left:Math.round(ot)}},r=function(i,e,d){d=d||i.parentNode;let C=d.querySelectorAll(e);for(let w=0;w<C.length;w++)if(C[w]===i)return!0;return!1},E=function(i,e,d){if(r(e,d,i))return e;{let C=e.parentNode;for(;C!=null&&C!==i;){if(r(C,d,i))return C;C=C.parentNode}}},a=function(i,e,d){let C=null,w=e.getAttribute("katavorio-draggable"),B=w!=null?"[katavorio-draggable='"+w+"'] ":"";for(let z=0;z<i.length;z++)if(C=E(e,d,B+i[z].selector),C!=null){if(i[z].filter){let Y=r(d,i[z].filter,C);if(i[z].filterExclude===!0&&!Y||Y)return null}return[i[z],C]}return null};var t=function(){let i=-1;if(navigator.appName==="Microsoft Internet Explorer"){let e=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),p=10,x=10,j=t>-1&&t<9,D=t===9,I=function(i){if(j)return[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop];{let e=l(i),d=s(e,0);return D?[d.pageX||d.clientX,d.pageY||d.clientY]:[d.pageX,d.pageY]}},s=function(i,e){return i.item?i.item(e):i[e]},l=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},N={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},R="katavorio-drag-scope",U=["stop","start","drag","drop","over","out","beforeStart"],O=function(){},b=function(){return!0},n=function(i,e,d){for(let C=0;C<i.length;C++)i[C]!=d&&e(i[C])},y=function(i,e,d,C){n(i,function(w){w.setActive(e),e&&w.updatePosition(),d&&w.setHover(C,e)})},h=function(i,e){if(i!=null){i=!J(i)&&i.tagName==null&&i.length!=null?i:[i];for(let d=0;d<i.length;d++)e.apply(i[d],[i[d]])}},S=function(i){i.stopPropagation?(i.stopPropagation(),i.preventDefault()):i.returnValue=!1},T="input,textarea,select,button,option",f=function(i,e,d){let C=i.srcElement||i.target;return!r(C,d.getInputFilterSelector(),e)};let _=function(i,e,d,C){this.params=e||{},this.el=i,this.params.addClass(this.el,this._class),this.uuid=m();let w=!0;return this.setEnabled=function(B){w=B},this.isEnabled=function(){return w},this.toggleEnabled=function(){w=!w},this.setScope=function(B){this.scopes=B?B.split(/\s+/):[C]},this.addScope=function(B){let z={};h(this.scopes,function(Y){z[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){z[Y]=!0}),this.scopes=[];for(let Y in z)this.scopes.push(Y)},this.removeScope=function(B){let z={};h(this.scopes,function(Y){z[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){delete z[Y]}),this.scopes=[];for(let Y in z)this.scopes.push(Y)},this.toggleScope=function(B){let z={};h(this.scopes,function(Y){z[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){z[Y]?delete z[Y]:z[Y]=!0}),this.scopes=[];for(let Y in z)this.scopes.push(Y)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},v=function(){return!0},M=function(){return!1},g=function(i,e,d,C){this._class=d.draggable;let w=_.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;let B=[0,0],z=null,Y=null,V=[0,0],ot=!1,ct=[0,0],pt=this.params.consumeStartEvent!==!1,$=this.el,rt=this.params.clone;this.params.scroll;let ft=e.multipleDrop!==!1,ut=!1,ht=e.ghostProxy===!0?v:e.ghostProxy&&typeof e.ghostProxy=="function"?e.ghostProxy:M,Ct=function(it){return it.cloneNode(!0)},mt=null,Z=[],tt=null,et=e.ghostProxyParent,lt,yt,Dt,Tt;if(e.selector){let it=i.getAttribute("katavorio-draggable");it==null&&(it=""+new Date().getTime(),i.setAttribute("katavorio-draggable",it)),Z.push(e)}let Bt=e.snapThreshold,le=function(it,_t,Pt,gt,St){let kt=Math.floor(it[0]/_t),Xt=_t*kt,$t=Xt+_t,o=Math.abs(it[0]-Xt)<=gt?Xt:Math.abs($t-it[0])<=gt?$t:it[0],k=Math.floor(it[1]/Pt),P=Pt*k,L=P+Pt,G=Math.abs(it[1]-P)<=St?P:Math.abs(L-it[1])<=St?L:it[1];return[o,G]};this.posses=[],this.posseRoles={},this.toGrid=function(it){if(this.params.grid==null)return it;{let _t=this.params.grid?this.params.grid[0]/2:Bt||p/2,Pt=this.params.grid?this.params.grid[1]/2:Bt||x/2;return le(it,this.params.grid[0],this.params.grid[1],_t,Pt)}},this.snap=function(it,_t){if($==null)return;it=it||(this.params.grid?this.params.grid[0]:p),_t=_t||(this.params.grid?this.params.grid[1]:x);let Pt=this.params.getPosition($),gt=this.params.grid?this.params.grid[0]/2:Bt,St=this.params.grid?this.params.grid[1]/2:Bt,kt=le(Pt,it,_t,gt,St);return this.params.setPosition($,kt),kt},this.setUseGhostProxy=function(it){ht=it?v:M};let zt,qt=function(it){return e.allowNegative===!1?[Math.max(0,it[0]),Math.max(0,it[1])]:it},Pe=function(it){zt=typeof it=="function"?it:it?function(_t,Pt,gt,St){return qt([Math.max(0,Math.min(gt.w-St[0],_t[0])),Math.max(0,Math.min(gt.h-St[1],_t[1]))])}.bind(this):function(_t){return qt(_t)}}.bind(this);Pe(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(it){Pe(it)};let de;this.setRevert=function(it){de=it},this.params.revert&&(de=this.params.revert);let Ce=function(it){return typeof it=="function"?(it._katavorioId=m(),it._katavorioId):it},Ht={},fe=function(it){for(let _t in Ht){let Pt=Ht[_t],gt=Pt[0](it);if(Pt[1]&&(gt=!gt),!gt)return!1}return!0},re=this.setFilter=function(it,_t){if(it){let Pt=Ce(it);Ht[Pt]=[function(gt){let St=gt.srcElement||gt.target,kt;return J(it)?kt=r(St,it,i):typeof it=="function"&&(kt=it(gt,i)),kt},_t!==!1]}};this.addFilter=re,this.removeFilter=function(it){let _t=typeof it=="function"?it._katavorioId:it;delete Ht[_t]},this.clearAllFilters=function(){Ht={}},this.canDrag=this.params.canDrag||b;let ae,Mt=[],Yt=[];this.addSelector=function(it){it.selector&&Z.push(it)},this.downListener=function(it){if(it.defaultPrevented)return;if((this.rightButtonCanDrag||it.which!==3&&it.button!==2)&&this.isEnabled()&&this.canDrag())if(fe(it)&&f(it,this.el,this.k)){if(tt=null,mt=null,Z.length>0){let gt=a(Z,this.el,it.target||it.srcElement);if(gt!=null&&(tt=gt[0],mt=gt[1]),mt==null)return}else mt=this.el;if(rt)if($=mt.cloneNode(!0),this.params.addClass($,N.clonedDrag),$.setAttribute("id",null),$.style.position="absolute",this.params.parent!=null){let gt=this.params.getPosition(this.el);$.style.left=gt[0]+"px",$.style.top=gt[1]+"px",this.params.parent.appendChild($)}else{let gt=W(mt);$.style.left=gt.left+"px",$.style.top=gt.top+"px",document.body.appendChild($)}else $=mt;pt&&S(it),B=I(it),$&&$.parentNode&&(ct=[$.parentNode.scrollLeft,$.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),w.markSelection(this),w.markPosses(this),this.params.addClass(document.body,d.noSelect),te("beforeStart",{el:this.el,pos:z,e:it,drag:this})}else this.params.consumeFilteredEvents&&S(it)}.bind(this),this.moveListener=function(it){if(B){if(!ot)if(te("start",{el:this.el,pos:z,e:it,drag:this})!==!1){if(!B)return;this.mark(!0),ot=!0}else this.abort();if(B){Yt.length=0;let _t=I(it),Pt=_t[0]-B[0],gt=_t[1]-B[1],St=this.params.ignoreZoom?1:w.getZoom();$&&$.parentNode&&(Pt+=$.parentNode.scrollLeft-ct[0],gt+=$.parentNode.scrollTop-ct[1]),Pt/=St,gt/=St,this.moveBy(Pt,gt,it),w.updateSelection(Pt,gt,this),w.updatePosses(Pt,gt,this)}}}.bind(this),this.upListener=function(it){B&&(B=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,d.noSelect),this.unmark(it),w.unmarkSelection(this,it),w.unmarkPosses(this,it),this.stop(it),w.notifyPosseDragStop(this,it),ot=!1,Yt.length=0,rt?($&&$.parentNode&&$.parentNode.removeChild($),$=null):de&&de($,this.params.getPosition($))===!0&&(this.params.setPosition($,z),te("revert",$)))}.bind(this),this.getFilters=function(){return Ht},this.abort=function(){B!=null&&this.upListener()},this.getDragElement=function(it){return it?mt||this.el:$||this.el};let It={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};e.events.start&&It.start.push(e.events.start),e.events.beforeStart&&It.beforeStart.push(e.events.beforeStart),e.events.stop&&It.stop.push(e.events.stop),e.events.drag&&It.drag.push(e.events.drag),e.events.revert&&It.revert.push(e.events.revert),this.on=function(it,_t){It[it]&&It[it].push(_t)},this.off=function(it,_t){if(It[it]){let Pt=[];for(let gt=0;gt<It[it].length;gt++)It[it][gt]!==_t&&Pt.push(It[it][gt]);It[it]=Pt}};var te=function(it,_t){let Pt=null;if(tt&&tt[it])Pt=tt[it](_t);else if(It[it])for(let gt=0;gt<It[it].length;gt++)try{let St=It[it][gt](_t);St!=null&&(Pt=St)}catch{}return Pt};this.notifyStart=function(it){te("start",{el:this.el,pos:this.params.getPosition($),e:it,drag:this})},this.stop=function(it,_t){if(_t||ot){let Pt=[],gt=w.getSelection(),St=this.params.getPosition($);if(gt.length>0)for(let kt=0;kt<gt.length;kt++){let Xt=this.params.getPosition(gt[kt].el);Pt.push([gt[kt].el,{left:Xt[0],top:Xt[1]},gt[kt]])}else Pt.push([$,{left:St[0],top:St[1]},this]);te("stop",{el:$,pos:ee||St,finalPos:St,e:it,drag:this,selection:Pt})}},this.mark=function(it){z=this.params.getPosition($),Y=this.params.getPosition($,!0),V=[Y[0]-z[0],Y[1]-z[1]],this.size=this.params.getSize($),Mt=w.getMatchingDroppables(this),y(Mt,!0,!1,this),this.params.addClass($,this.params.dragClass||d.drag);let _t;this.params.getConstrainingRectangle?_t=this.params.getConstrainingRectangle($):_t=this.params.getSize($.parentNode),ae={w:_t[0],h:_t[1]},Dt=0,Tt=0,it&&w.notifySelectionDragStart(this)};let ee;this.unmark=function(it,_t){if(y(Mt,!1,!0,this),ut&&ht(mt,$)?(ee=[$.offsetLeft-Dt,$.offsetTop-Tt],$.parentNode.removeChild($),$=mt):ee=null,this.params.removeClass($,this.params.dragClass||d.drag),Mt.length=0,ut=!1,!_t){Yt.length>0&&ee&&e.setPosition(mt,ee),Yt.sort(A);for(let Pt=0;Pt<Yt.length&&Yt[Pt].drop(this,it)!==!0;Pt++);}},this.moveBy=function(it,_t,Pt){Yt.length=0;let gt=this.toGrid([z[0]+it,z[1]+_t]),St=zt(gt,$,ae,this.size);if(ht(this.el,$))if(gt[0]!==St[0]||gt[1]!==St[1]){if(!ut){let o=Ct(mt);e.addClass(o,N.ghostProxy),et?(et.appendChild(o),lt=e.getPosition(mt.parentNode,!0),yt=e.getPosition(e.ghostProxyParent,!0),Dt=lt[0]-yt[0],Tt=lt[1]-yt[1]):mt.parentNode.appendChild(o),$=o,ut=!0}St=gt}else ut&&($.parentNode.removeChild($),$=mt,ut=!1,lt=null,yt=null,Dt=0,Tt=0);let kt={x:St[0],y:St[1],w:this.size[0],h:this.size[1]},Xt={x:kt.x+V[0],y:kt.y+V[1],w:kt.w,h:kt.h},$t=null;this.params.setPosition($,[St[0]+Dt,St[1]+Tt]);for(let o=0;o<Mt.length;o++){let k={x:Mt[o].pagePosition[0],y:Mt[o].pagePosition[1],w:Mt[o].size[0],h:Mt[o].size[1]};this.params.intersects(Xt,k)&&(ft||$t==null||$t===Mt[o].el)&&Mt[o].canDrop(this)?($t||($t=Mt[o].el),Yt.push(Mt[o]),Mt[o].setHover(this,!0,Pt)):Mt[o].isHover()&&Mt[o].setHover(this,!1,Pt)}te("drag",{el:this.el,pos:St,e:Pt,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?re(this.params.handle,!1):re(this.params.filter,this.params.filterExclude)},u=function(i,e,d,C){this._class=d.droppable,this.params=e||{},this.rank=e.rank||0,this._activeClass=this.params.activeClass||d.active,this._hoverClass=this.params.hoverClass||d.hover,_.apply(this,arguments);let w=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(B){this.params[B?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(B){return!0},this.isHover=function(){return w},this.setHover=function(B,z,Y){(z||this.el._katavorioDragHover==null||this.el._katavorioDragHover===B.el._katavorio)&&(this.params[z?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=z?B.el._katavorio:null,w!==z&&this.params.events[z?"over":"out"]({el:this.el,e:Y,drag:B,drop:this}),w=z)},this.drop=function(B,z){return this.params.events.drop({drag:B,e:z,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,w=null}};var m=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i==="x"?e:e&3|8).toString(16)})},A=function(i,e){return i.rank<e.rank?1:i.rank>e.rank?-1:0};let F=function(i){return i==null||(i=typeof i=="string"||i.constructor===String?document.getElementById(i):i,i==null)?null:(i._katavorio=i._katavorio||m(),i)};X.Katavorio=function(i){let e=[],d={};this._dragsByScope={},this._dropsByScope={};let C=1,w=function(Z,tt){h(Z,function(et){for(let lt=0;lt<et.scopes.length;lt++)tt[et.scopes[lt]]=tt[et.scopes[lt]]||[],tt[et.scopes[lt]].push(et)})},B=function(Z,tt){let et=0;return h(Z,function(lt){for(let yt=0;yt<lt.scopes.length;yt++)if(tt[lt.scopes[yt]]){let Dt=i.indexOf(tt[lt.scopes[yt]],lt);Dt!==-1&&(tt[lt.scopes[yt]].splice(Dt,1),et++)}}),et>0};this.getMatchingDroppables=function(Z){let tt=[],et={};for(let lt=0;lt<Z.scopes.length;lt++){let yt=this._dropsByScope[Z.scopes[lt]];if(yt)for(let Dt=0;Dt<yt.length;Dt++)yt[Dt].canDrop(Z)&&!et[yt[Dt].uuid]&&(yt[Dt].allowLoopback||yt[Dt].el!==Z.el)&&(et[yt[Dt].uuid]=!0,tt.push(yt[Dt]))}return tt.sort(A),tt};let z=function(Z){Z=Z||{};let tt={events:{}},et;for(et in i)tt[et]=i[et];for(et in Z)tt[et]=Z[et];for(et=0;et<U.length;et++)tt.events[U[et]]=Z[U[et]]||O;return tt.katavorio=this,tt}.bind(this),Y=function(Z,tt){for(let et=0;et<U.length;et++)tt[U[et]]&&Z.on(U[et],tt[U[et]])}.bind(this),V={},ot=i.css||{},ct=i.scope||R;for(var pt in N)V[pt]=N[pt];for(var pt in ot)V[pt]=ot[pt];let $=i.inputFilterSelector||T;this.getInputFilterSelector=function(){return $},this.setInputFilterSelector=function(Z){return $=Z,this},this.draggable=function(Z,tt){let et=[];return h(Z,function(lt){if(lt=F(lt),lt!=null)if(lt._katavorioDrag==null){let yt=z(tt);lt._katavorioDrag=new g(lt,yt,V,ct),w(lt._katavorioDrag,this._dragsByScope),et.push(lt._katavorioDrag),i.addClass(lt,yt.selector?V.delegatedDraggable:V.draggable)}else Y(lt._katavorioDrag,tt)}.bind(this)),et},this.droppable=function(Z,tt){let et=[];return h(Z,function(lt){if(lt=F(lt),lt!=null){let yt=new u(lt,z(tt),V,ct);lt._katavorioDrop=lt._katavorioDrop||[],lt._katavorioDrop.push(yt),w(yt,this._dropsByScope),et.push(yt),i.addClass(lt,V.droppable)}}.bind(this)),et},this.select=function(Z){return h(Z,function(){let tt=F(this);tt&&tt._katavorioDrag&&(d[tt._katavorio]||(e.push(tt._katavorioDrag),d[tt._katavorio]=[tt,e.length-1],i.addClass(tt,V.selected)))}),this},this.deselect=function(Z){return h(Z,function(){let tt=F(this);if(tt&&tt._katavorio&&d[tt._katavorio]){let lt=[];for(let yt=0;yt<e.length;yt++)e[yt].el!==tt&&lt.push(e[yt]);e=lt,delete d[tt._katavorio],i.removeClass(tt,V.selected)}}),this},this.deselectAll=function(){for(let Z in d){let tt=d[Z];i.removeClass(tt[0],V.selected)}e.length=0,d={}},this.markSelection=function(Z){n(e,function(tt){tt.mark()},Z)},this.markPosses=function(Z){Z.posses&&h(Z.posses,function(tt){Z.posseRoles[tt]&&Ct[tt]&&n(Ct[tt].members,function(et){et.mark()},Z)})},this.unmarkSelection=function(Z,tt){n(e,function(et){et.unmark(tt)},Z)},this.unmarkPosses=function(Z,tt){Z.posses&&h(Z.posses,function(et){Z.posseRoles[et]&&Ct[et]&&n(Ct[et].members,function(lt){lt.unmark(tt,!0)},Z)})},this.getSelection=function(){return e.slice(0)},this.updateSelection=function(Z,tt,et){n(e,function(lt){lt.moveBy(Z,tt)},et)};let rt=function(Z,tt){tt.posses&&h(tt.posses,function(et){tt.posseRoles[et]&&Ct[et]&&n(Ct[et].members,function(lt){Z(lt)},tt)})};this.updatePosses=function(Z,tt,et){rt(function(lt){lt.moveBy(Z,tt)},et)},this.notifyPosseDragStop=function(Z,tt){rt(function(et){et.stop(tt,!0)},Z)},this.notifySelectionDragStop=function(Z,tt){n(e,function(et){et.stop(tt,!0)},Z)},this.notifySelectionDragStart=function(Z,tt){n(e,function(et){et.notifyStart(tt)},Z)},this.setZoom=function(Z){C=Z},this.getZoom=function(){return C};let ft=function(Z,tt,et,lt){h(Z,function(yt){B(yt,et),yt[lt](tt),w(yt,et)})};h(["set","add","remove","toggle"],function(Z){this[Z+"Scope"]=function(tt,et){ft(tt._katavorioDrag,et,this._dragsByScope,Z+"Scope"),ft(tt._katavorioDrop,et,this._dropsByScope,Z+"Scope")}.bind(this),this[Z+"DragScope"]=function(tt,et){ft(tt.constructor===g?tt:tt._katavorioDrag,et,this._dragsByScope,Z+"Scope")}.bind(this),this[Z+"DropScope"]=function(tt,et){ft(tt.constructor===u?tt:tt._katavorioDrop,et,this._dropsByScope,Z+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(Z,tt){for(let et in this._dragsByScope)n(this._dragsByScope[et],function(lt){lt.snap(Z,tt)})},this.getDragsForScope=function(Z){return this._dragsByScope[Z]},this.getDropsForScope=function(Z){return this._dropsByScope[Z]};let ut=function(Z,tt,et){if(Z=F(Z),Z[tt]){let lt=e.indexOf(Z[tt]);lt>=0&&e.splice(lt,1),B(Z[tt],et)&&h(Z[tt],function(yt){yt.destroy()}),delete Z[tt]}},ht=function(Z,tt,et,lt){Z=F(Z),Z[tt]&&Z[tt].off(et,lt)};this.elementRemoved=function(Z){this.destroyDraggable(Z),this.destroyDroppable(Z)},this.destroyDraggable=function(Z,tt,et){arguments.length===1?ut(Z,"_katavorioDrag",this._dragsByScope):ht(Z,"_katavorioDrag",tt,et)},this.destroyDroppable=function(Z,tt,et){arguments.length===1?ut(Z,"_katavorioDrop",this._dropsByScope):ht(Z,"_katavorioDrop",tt,et)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},e=[],d={},Ct={}};var Ct={};let mt=function(Z,tt,et){let lt=J(tt)?tt:tt.id,yt=J(tt)?!0:tt.active!==!1,Dt=Ct[lt]||function(){let Tt={name:lt,members:[]};return Ct[lt]=Tt,Tt}();return h(Z,function(Tt){if(Tt._katavorioDrag){if(et&&Tt._katavorioDrag.posseRoles[Dt.name]!=null)return;c(Dt.members,Tt._katavorioDrag),c(Tt._katavorioDrag.posses,Dt.name),Tt._katavorioDrag.posseRoles[Dt.name]=yt}}),Dt};this.addToPosse=function(Z,tt){let et=[];for(let lt=1;lt<arguments.length;lt++)et.push(mt(Z,arguments[lt]));return et.length===1?et[0]:et},this.setPosse=function(Z,tt){let et=[];for(let lt=1;lt<arguments.length;lt++)et.push(mt(Z,arguments[lt],!0).name);return h(Z,function(lt){if(lt._katavorioDrag){let yt=Q(lt._katavorioDrag.posses,et),Dt=[];Array.prototype.push.apply(Dt,lt._katavorioDrag.posses);for(let Tt=0;Tt<yt.length;Tt++)this.removeFromPosse(lt,yt[Tt])}}.bind(this)),et.length===1?et[0]:et},this.removeFromPosse=function(Z,tt){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(let et=1;et<arguments.length;et++)tt=arguments[et],h(Z,function(lt){if(lt._katavorioDrag&&lt._katavorioDrag.posses){let yt=lt._katavorioDrag;h(tt,function(Dt){H(Ct[Dt].members,yt),H(yt.posses,Dt),delete yt.posseRoles[Dt]})}})},this.removeFromAllPosses=function(Z){h(Z,function(tt){if(tt._katavorioDrag&&tt._katavorioDrag.posses){let et=tt._katavorioDrag;h(et.posses,function(lt){H(Ct[lt].members,et)}),et.posses.length=0,et.posseRoles={}}})},this.setPosseState=function(Z,tt,et){let lt=Ct[tt];lt&&h(Z,function(yt){yt._katavorioDrag&&yt._katavorioDrag.posses&&(yt._katavorioDrag.posseRoles[lt.name]=et)})}},X.Katavorio.version="1.0.0",typeof exports<"u"&&(exports.Katavorio=X.Katavorio)}).call(typeof window<"u"?window:globalThis);(function(){let X=this;X.jsPlumbUtil=X.jsPlumbUtil||{};let c=X.jsPlumbUtil;typeof exports<"u"&&(exports.jsPlumbUtil=c);function H(u){return Object.prototype.toString.call(u)==="[object Array]"}c.isArray=H;function Q(u){return Object.prototype.toString.call(u)==="[object Number]"}c.isNumber=Q;function J(u){return typeof u=="string"}c.isString=J;function W(u){return typeof u=="boolean"}c.isBoolean=W;function r(u){return u==null}c.isNull=r;function E(u){return u==null?!1:Object.prototype.toString.call(u)==="[object Object]"}c.isObject=E;function a(u){return Object.prototype.toString.call(u)==="[object Date]"}c.isDate=a;function t(u){return Object.prototype.toString.call(u)==="[object Function]"}c.isFunction=t;function p(u){return t(u)&&u.name!=null&&u.name.length>0}c.isNamedFunction=p;function x(u){for(let m in u)if(u.hasOwnProperty(m))return!1;return!0}c.isEmpty=x;function j(u){if(J(u))return""+u;if(W(u))return!!u;if(a(u))return new Date(u.getTime());if(t(u))return u;if(H(u)){let m=[];for(let A=0;A<u.length;A++)m.push(j(u[A]));return m}else if(E(u)){let m={};for(let A in u)m[A]=j(u[A]);return m}else return u}c.clone=j;function D(u,m,A,F){let i={},e,d,C={};for(A=A||[],F=F||[],d=0;d<A.length;d++)i[A[d]]=!0;for(d=0;d<F.length;d++)C[F[d]]=!0;let w=j(u);for(d in m)if(w[d]==null||C[d])w[d]=m[d];else if(J(m[d])||W(m[d]))i[d]?(e=[],e.push.apply(e,H(w[d])?w[d]:[w[d]]),e.push.apply(e,W(m[d])?m[d]:[m[d]]),w[d]=e):w[d]=m[d];else if(H(m[d]))e=[],H(w[d])&&e.push.apply(e,w[d]),e.push.apply(e,m[d]),w[d]=e;else if(E(m[d])){E(w[d])||(w[d]={});for(let B in m[d])w[d][B]=m[d][B]}return w}c.merge=D;function I(u,m,A){if(u==null)return;let F=u,i=F;return m.replace(/([^\.])+/g,function(e,d,C,w){let B=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),z=C+e.length>=w.length,Y=function(){return i[B[1]]||function(){return i[B[1]]=[],i[B[1]]}()};if(z)B?Y()[B[3]]=A:i[e]=A;else if(B){let V=Y();i=V[B[3]]||function(){return V[B[3]]={},V[B[3]]}()}else i=i[e]||function(){return i[e]={},i[e]}();return""}),u}c.replace=I;function s(u,m,A){for(let F=0;F<A.length;F++){let i=A[F][0][A[F][1]].apply(A[F][0],A[F][2]);if(i===m)return i}return u}c.functionChain=s;function l(u,m,A,F){let i=function(d){let C=d.match(/(\${.*?})/g);if(C!=null)for(let w=0;w<C.length;w++){let B=m[C[w].substring(2,C[w].length-1)]||"";B!=null&&(d=d.replace(C[w],B))}return d},e=function(d){if(d!=null){if(J(d))return i(d);if(t(d)&&!F&&(A==null||(d.name||"").indexOf(A)===0))return d(m);if(H(d)){let C=[];for(let w=0;w<d.length;w++)C.push(e(d[w]));return C}else if(E(d)){let C={};for(let w in d)C[w]=e(d[w]);return C}else return d}};return e(u)}c.populate=l;function N(u,m){if(u){for(let A=0;A<u.length;A++)if(m(u[A]))return A}return-1}c.findWithFunction=N;function R(u,m){let A=N(u,m);return A>-1&&u.splice(A,1),A!==-1}c.removeWithFunction=R;function U(u,m){let A=u.indexOf(m);return A>-1&&u.splice(A,1),A!==-1}c.remove=U;function O(u,m,A){N(u,A)===-1&&u.push(m)}c.addWithFunction=O;function b(u,m,A,F){let i=u[m];return i==null&&(i=[],u[m]=i),i[F?"unshift":"push"](A),i}c.addToList=b;function n(u,m,A){return u.indexOf(m)===-1?(A?u.unshift(m):u.push(m),!0):!1}c.suggest=n;function y(u,m,A){let F;m=H(m)?m:[m];let i=function(C){let w=C.__proto__;for(;w!=null;)if(w.prototype!=null){for(let B in w.prototype)w.prototype.hasOwnProperty(B)&&!u.prototype.hasOwnProperty(B)&&(u.prototype[B]=w.prototype[B]);w=w.prototype.__proto__}else w=null};for(F=0;F<m.length;F++){for(let C in m[F].prototype)m[F].prototype.hasOwnProperty(C)&&!u.prototype.hasOwnProperty(C)&&(u.prototype[C]=m[F].prototype[C]);i(m[F])}let e=function(C,w){return function(){for(F=0;F<m.length;F++)m[F].prototype[C]&&m[F].prototype[C].apply(this,arguments);return w.apply(this,arguments)}},d=function(C){for(let w in C)u.prototype[w]=e(w,C[w])};if(arguments.length>2)for(F=2;F<arguments.length;F++)d(arguments[F]);return u}c.extend=y;function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){let m=Math.random()*16|0;return(u==="x"?m:m&3|8).toString(16)})}c.uuid=h;function S(u){if(u==null)return null;let m=u.replace(/^\s\s*/,""),A=/\s/,F=m.length;for(;A.test(m.charAt(--F)););return m.slice(0,F+1)}c.fastTrim=S;function T(u,m){u=u.length==null||typeof u=="string"?[u]:u;for(let A=0;A<u.length;A++)m(u[A])}c.each=T;function f(u,m){let A=[];for(let F=0;F<u.length;F++)A.push(m(u[F]));return A}c.map=f;function _(u,m,A){A=A||"parent";let F=function(w){return w?m[w]:null},i=function(w){return w?F(w[A]):null},e=function(w,B){if(w==null)return B;{let z=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];B.mergeStrategy==="override"&&Array.prototype.push.apply(z,["events","overlays"]);let Y=D(w,B,[],z);return e(i(w),Y)}},d=function(w){if(w==null)return{};if(typeof w=="string")return F(w);if(w.length){let B=!1,z=0,Y;for(;!B&&z<w.length;)Y=d(w[z]),Y?B=!0:z++;return Y}},C=d(u);return C?e(i(C),C):{}}c.mergeWithParents=_,c.logEnabled=!0;function v(){if(c.logEnabled&&typeof console<"u")try{let u=arguments[arguments.length-1];console.log(u)}catch{}}c.log=v;function M(u,m,A){return function(){let F=null;try{m!=null&&(F=m.apply(this,arguments))}catch(i){v("jsPlumb function failed : "+i)}if(u!=null&&(A==null||F!==A))try{F=u.apply(this,arguments)}catch(i){v("wrapped function failed : "+i)}return F}}c.wrap=M;let g=function(){function u(){let m=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(A,F,i){let e=function(d){b(m._listeners,d,F,i),F.__jsPlumb=F.__jsPlumb||{},F.__jsPlumb[h()]=d};if(typeof A=="string")e(A);else if(A.length!=null)for(let d=0;d<A.length;d++)e(A[d]);return m},this.fire=function(A,F,i){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[A]){let e=this._listeners[A].length,d=0,C=!1,w=null;if(!this.shouldFireEvent||this.shouldFireEvent(A,F,i))for(;!C&&d<e&&w!==!1;){if(this.eventsToDieOn[A])this._listeners[A][d].apply(this,[F,i]);else try{w=this._listeners[A][d].apply(this,[F,i])}catch(B){v("jsPlumb: fire failed for event "+A+" : "+B)}d++,(this._listeners==null||this._listeners[A]==null)&&(C=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){let A=m.queue.pop();A&&m.fire.apply(m,A)},this.unbind=function(A,F){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof A=="string")delete this._listeners[A];else if(A.__jsPlumb){let i;for(let e in A.__jsPlumb)i=A.__jsPlumb[e],U(this._listeners[i]||[],A)}}else arguments.length===2&&U(this._listeners[A]||[],F);return this},this.getListener=function(A){return m._listeners[A]},this.setSuspendEvents=function(A){m.eventsSuspended=A},this.isSuspendEvents=function(){return m.eventsSuspended},this.silently=function(A){m.setSuspendEvents(!0);try{A()}catch(F){v("Cannot execute silent function "+F)}m.setSuspendEvents(!1)},this.cleanupListeners=function(){for(let A in m._listeners)m._listeners[A]=null}}return u}();c.EventGenerator=g}).call(typeof window<"u"?window:globalThis);(function(){let X=this;X.jsPlumbUtil.matchesSelector=function(c,H,Q){Q=Q||c.parentNode;let J=Q.querySelectorAll(H);for(let W=0;W<J.length;W++)if(J[W]===c)return!0;return!1},X.jsPlumbUtil.consume=function(c,H){c.stopPropagation?c.stopPropagation():c.returnValue=!1,!H&&c.preventDefault&&c.preventDefault()},X.jsPlumbUtil.sizeElement=function(c,H,Q,J,W){c&&(c.style.height=W+"px",c.height=W,c.style.width=J+"px",c.width=J,c.style.left=H+"px",c.style.top=Q+"px")}}).call(typeof window<"u"?window:globalThis);(function(){let X={deriveAnchor:function(J,W,r,E){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[J][W]}},c=this,H=function(J){this.count=0,this.instance=J,this.lists={},this.instance.addList=function(W,r){return this.listManager.addList(W,r)},this.instance.removeList=function(W){this.listManager.removeList(W)},this.instance.bind("manageElement",function(W){let r=this.instance.getSelector(W.el,"[jtk-scrollable-list]");for(let E=0;E<r.length;E++)this.addList(r[E])}.bind(this)),this.instance.bind("unmanageElement",function(W){this.removeList(W.el)}),this.instance.bind("connection",function(W,r){r==null&&(this._maybeUpdateParentList(W.source),this._maybeUpdateParentList(W.target))}.bind(this))};c.jsPlumbListManager=H,H.prototype={addList:function(J,W){let r=this.instance.extend({},X);W=this.instance.extend(r,W||{});let E=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[E]=new Q(this.instance,J,W,E)},removeList:function(J){let W=this.lists[J._jsPlumbList];W&&(W.destroy(),delete this.lists[J._jsPlumbList])},_maybeUpdateParentList:function(J){let W=J.parentNode,r=this.instance.getContainer();for(;W!=null&&W!==r;){if(W._jsPlumbList!=null&&this.lists[W._jsPlumbList]!=null){W._jsPlumbScrollHandler();return}W=W.parentNode}}};var Q=function(J,W,r,E){W._jsPlumbList=E;function a(j,D,I,s){return r.anchor?r.anchor:r.deriveAnchor(j,D,I,s)}function t(j,D,I,s){return r.deriveEndpoint?r.deriveEndpoint(j,D,I,s):r.endpoint?r.endpoint:I.type}function p(j){let D=j.parentNode,I=J.getContainer();for(;D!=null&&D!==I;){if(J.hasClass(D,"jtk-managed")){J.recalculateOffsets(D);return}D=D.parentNode}}let x=function(j){let D=J.getSelector(W,".jtk-managed"),I=J.getId(W);for(var s=0;s<D.length;s++){if(D[s].offsetTop<W.scrollTop)D[s]._jsPlumbProxies||(D[s]._jsPlumbProxies=D[s]._jsPlumbProxies||[],J.select({source:D[s]}).each(function(l){J.proxyConnection(l,0,W,I,function(){return t("top",0,l.endpoints[0],l)},function(){return a("top",0,l.endpoints[0],l)}),D[s]._jsPlumbProxies.push([l,0])}),J.select({target:D[s]}).each(function(l){J.proxyConnection(l,1,W,I,function(){return t("top",1,l.endpoints[1],l)},function(){return a("top",1,l.endpoints[1],l)}),D[s]._jsPlumbProxies.push([l,1])}));else if(D[s].offsetTop>W.scrollTop+W.offsetHeight)D[s]._jsPlumbProxies||(D[s]._jsPlumbProxies=D[s]._jsPlumbProxies||[],J.select({source:D[s]}).each(function(l){J.proxyConnection(l,0,W,I,function(){return t("bottom",0,l.endpoints[0],l)},function(){return a("bottom",0,l.endpoints[0],l)}),D[s]._jsPlumbProxies.push([l,0])}),J.select({target:D[s]}).each(function(l){J.proxyConnection(l,1,W,I,function(){return t("bottom",1,l.endpoints[1],l)},function(){return a("bottom",1,l.endpoints[1],l)}),D[s]._jsPlumbProxies.push([l,1])}));else if(D[s]._jsPlumbProxies){for(let l=0;l<D[s]._jsPlumbProxies.length;l++)J.unproxyConnection(D[s]._jsPlumbProxies[l][0],D[s]._jsPlumbProxies[l][1],I);delete D[s]._jsPlumbProxies}J.revalidate(D[s])}p(W)};J.setAttribute(W,"jtk-scrollable-list","true"),W._jsPlumbScrollHandler=x,J.on(W,"scroll",x),x(),this.destroy=function(){J.off(W,"scroll",x),delete W._jsPlumbScrollHandler;let j=J.getSelector(W,".jtk-managed"),D=J.getId(W);for(let I=0;I<j.length;I++)if(j[I]._jsPlumbProxies){for(let s=0;s<j[I]._jsPlumbProxies.length;s++)J.unproxyConnection(j[I]._jsPlumbProxies[s][0],j[I]._jsPlumbProxies[s][1],D);delete j[I]._jsPlumbProxies}}}}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumbUtil,H=function(){return""+new Date().getTime()},Q=function(s){if(s._jsPlumb.paintStyle&&s._jsPlumb.hoverPaintStyle){let l={};I.extend(l,s._jsPlumb.paintStyle),I.extend(l,s._jsPlumb.hoverPaintStyle),delete s._jsPlumb.hoverPaintStyle,l.gradient&&s._jsPlumb.paintStyle.fill&&delete l.gradient,s._jsPlumb.hoverPaintStyle=l}},J=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],W=function(s,l,N,R){let U=s.getAttachedElements();if(U)for(let O=0,b=U.length;O<b;O++)(!R||R!==U[O])&&U[O].setHover(l,!0,N)},r=function(s){return s==null?null:s.split(" ")},E=function(s,l,N){for(let R in l)s[R]=N},a=function(s,l,N){if(s.getDefaultType){let R=s.getTypeDescriptor(),U={},O=s.getDefaultType(),b=c.merge({},O);E(U,O,"__default");for(let n=0,y=s._jsPlumb.types.length;n<y;n++){let h=s._jsPlumb.types[n];if(h!=="__default"){let S=s._jsPlumb.instance.getType(h,R);if(S!=null){let T=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],f=[];S.mergeStrategy==="override"?Array.prototype.push.apply(T,["events","overlays","cssClass"]):f.push("cssClass"),b=c.merge(b,S,f,T),E(U,S,h)}}}l&&(b=c.populate(b,l,"_")),s.applyType(b,N,U),N||s.repaint()}},t=X.jsPlumbUIComponent=function(s){c.EventGenerator.apply(this,arguments);let l=this,N=arguments,R=l.idPrefix,U=R+new Date().getTime();this._jsPlumb={instance:s._jsPlumb,parameters:s.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:s.beforeDetach,beforeDrop:s.beforeDrop,overlayPlacements:[],hoverClass:s.hoverClass||s._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(S,T,f){this._jsPlumb.typeCache[f]=this._jsPlumb.typeCache[f]||{},this._jsPlumb.typeCache[f][S]=T},this.getCachedTypeItem=function(S,T){return this._jsPlumb.typeCache[T]?this._jsPlumb.typeCache[T][S]:null},this.getId=function(){return U};let O=s.overlays||[],b={};if(this.defaultOverlayKeys){for(var n=0;n<this.defaultOverlayKeys.length;n++)Array.prototype.push.apply(O,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[n]]||[]);for(n=0;n<O.length;n++){let S=I.convertToFullOverlaySpec(O[n]);b[S[1].id]=S}}let y={overlays:b,parameters:s.parameters||{},scope:s.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return y},this.appendToDefaultType=function(S){for(let T in S)y[T]=S[T]},s.events)for(let S in s.events)l.bind(S,s.events[S]);this.clone=function(){let S=Object.create(this.constructor.prototype);return this.constructor.apply(S,N),S}.bind(this),this.isDetachAllowed=function(S){let T=!0;if(this._jsPlumb.beforeDetach)try{T=this._jsPlumb.beforeDetach(S)}catch(f){c.log("jsPlumb: beforeDetach callback failed",f)}return T},this.isDropAllowed=function(S,T,f,_,v,M,g){let u=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:S,targetId:T,scope:f,connection:_,dropEndpoint:v,source:M,target:g});if(this._jsPlumb.beforeDrop)try{u=this._jsPlumb.beforeDrop({sourceId:S,targetId:T,scope:f,connection:_,dropEndpoint:v,source:M,target:g})}catch(m){c.log("jsPlumb: beforeDrop callback failed",m)}return u};let h=[];this.setListenerComponent=function(S){for(let T=0;T<h.length;T++)h[T][3]=S}},p=function(s,l){let N=s._jsPlumb.types[l],R=s._jsPlumb.instance.getType(N,s.getTypeDescriptor());R!=null&&R.cssClass&&s.canvas&&s._jsPlumb.instance.removeClass(s.canvas,R.cssClass)};c.extend(X.jsPlumbUIComponent,c.EventGenerator,{getParameter:function(s){return this._jsPlumb.parameters[s]},setParameter:function(s,l){this._jsPlumb.parameters[s]=l},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(s){this._jsPlumb.parameters=s},getClass:function(){return I.getClass(this.canvas)},hasClass:function(s){return I.hasClass(this.canvas,s)},addClass:function(s){I.addClass(this.canvas,s)},removeClass:function(s){I.removeClass(this.canvas,s)},updateClasses:function(s,l){I.updateClasses(this.canvas,s,l)},setType:function(s,l,N){this.clearTypes(),this._jsPlumb.types=r(s)||[],a(this,l,N)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(s,l){a(this,s,l)},hasType:function(s){return this._jsPlumb.types.indexOf(s)!==-1},addType:function(s,l,N){let R=r(s),U=!1;if(R!=null){for(let O=0,b=R.length;O<b;O++)this.hasType(R[O])||(this._jsPlumb.types.push(R[O]),U=!0);U&&a(this,l,N)}},removeType:function(s,l,N){let R=r(s),U=!1,O=function(b){let n=this._jsPlumb.types.indexOf(b);return n!==-1?(p(this,n),this._jsPlumb.types.splice(n,1),!0):!1}.bind(this);if(R!=null){for(let b=0,n=R.length;b<n;b++)U=O(R[b])||U;U&&a(this,l,N)}},clearTypes:function(s,l){let N=this._jsPlumb.types.length;for(let R=0;R<N;R++)p(this,0),this._jsPlumb.types.splice(0,1);a(this,s,l)},toggleType:function(s,l,N){let R=r(s);if(R!=null){for(let U=0,O=R.length;U<O;U++){let b=this._jsPlumb.types.indexOf(R[U]);b!==-1?(p(this,b),this._jsPlumb.types.splice(b,1)):this._jsPlumb.types.push(R[U])}a(this,l,N)}},applyType:function(s,l){if(this.setPaintStyle(s.paintStyle,l),this.setHoverPaintStyle(s.hoverPaintStyle,l),s.parameters)for(let N in s.parameters)this.setParameter(N,s.parameters[N]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(s,l){this._jsPlumb.paintStyle=s,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,Q(this),l||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(s,l){this._jsPlumb.hoverPaintStyle=s,Q(this),l||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(s){(s||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(s,l,N){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=s;let R=s?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[R](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[R](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=s?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(N=N||H(),this.repaint({timestamp:N,recalc:!1}))),this.getAttachedElements&&!l&&W(this,s,H(),this)}}});let x=0,j=function(){let s=x+1;return x++,s},D=X.jsPlumbInstance=function(s){this.version="2.12.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},s&&I.extend(this.Defaults,s),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},c.EventGenerator.apply(this);let l=this,N=j(),R=l.bind,U={},O=1,b=function(o){if(o==null)return null;if(o.nodeType===3||o.nodeType===8)return{el:o,text:!0};{let k=l.getElement(o);return{el:k,id:c.isString(o)&&k==null?o:ht(k)}}};this.getInstanceIndex=function(){return N},this.setZoom=function(o,k){return O=o,l.fire("zoom",O),k&&l.repaintEverything(),!0},this.getZoom=function(){return O};for(let o in this.Defaults)U[o]=this.Defaults[o];let n,y=[];this.unbindContainer=function(){if(n!=null&&y.length>0)for(let o=0;o<y.length;o++)l.off(n,y[o][0],y[o][1])},this.setContainer=function(o){this.unbindContainer(),o=this.getElement(o),this.select().each(function(K){K.moveParent(o)}),this.selectEndpoints().each(function(K){K.moveParent(o)});let k=n;n=o,y.length=0;let P={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},L=function(K,st,nt){let dt=st.srcElement||st.target,at=(dt&&dt.parentNode?dt.parentNode._jsPlumb:null)||(dt?dt._jsPlumb:null)||(dt&&dt.parentNode&&dt.parentNode.parentNode?dt.parentNode.parentNode._jsPlumb:null);if(at){at.fire(K,at,st);let vt=nt&&P[nt+K]||K;l.fire(vt,at.component||at,st)}},G=function(K,st,nt){y.push([K,nt]),l.on(n,K,st,nt)},q=function(K){G(K,".jtk-connector",function(st){L(K,st)}),G(K,".jtk-endpoint",function(st){L(K,st,"endpoint")}),G(K,".jtk-overlay",function(st){L(K,st)})};for(let K=0;K<J.length;K++)q(J[K]);for(let K in v){let st=v[K].el;st.parentNode===k&&(k.removeChild(st),n.appendChild(st))}},this.getContainer=function(){return n},this.bind=function(o,k){o==="ready"&&S?k():R.apply(l,[o,k])},l.importDefaults=function(o){for(let k in o)l.Defaults[k]=o[k];return o.Container&&l.setContainer(o.Container),l},l.restoreDefaults=function(){return l.Defaults=I.extend({},U),l};var h=null,S=!1,T=[],f={},_={},v={},M={},g={},u=!1,m=[],A=!1,F=null,i=this.Defaults.Scope,e=1,d=function(){return""+e++},C=function(o,k){n?n.appendChild(o):k?this.getElement(k).appendChild(o):this.appendToRoot(o)}.bind(this),w=function(o,k,P,L){if(!A){let G=ht(o),q,K=l.getDragManager();K&&(q=K.getElementsForDraggable(G)),P==null&&(P=H());let st=It({elId:G,offset:k,recalc:!1,timestamp:P});if(q&&st&&st.o)for(let nt in q)It({elId:q[nt].id,offset:{left:st.o.left+q[nt].offset.left,top:st.o.top+q[nt].offset.top},recalc:!1,timestamp:P});if(l.anchorManager.redraw(G,k,P,null,L),q)for(let nt in q)l.anchorManager.redraw(q[nt].id,k,P,q[nt].offset,L,!0)}},B=function(o){return _[o]},z=function(o,k){let P=o.scope.split(/\s/),L=k.scope.split(/\s/);for(let G=0;G<P.length;G++)for(let q=0;q<L.length;q++)if(L[q]===P[G])return!0;return!1},Y=function(o,k){let P=I.extend({},o);for(let L in k)k[L]&&(P[L]=k[L]);return P},V=function(o,k){let P=I.extend({},o);if(k&&I.extend(P,k),P.source&&(P.source.endpoint?P.sourceEndpoint=P.source:P.source=l.getElement(P.source)),P.target&&(P.target.endpoint?P.targetEndpoint=P.target:P.target=l.getElement(P.target)),o.uuids&&(P.sourceEndpoint=B(o.uuids[0]),P.targetEndpoint=B(o.uuids[1])),P.sourceEndpoint&&P.sourceEndpoint.isFull()){c.log(l,"could not add connection; source endpoint is full");return}if(P.targetEndpoint&&P.targetEndpoint.isFull()){c.log(l,"could not add connection; target endpoint is full");return}if(!P.type&&P.sourceEndpoint&&(P.type=P.sourceEndpoint.connectionType),P.sourceEndpoint&&P.sourceEndpoint.connectorOverlays){P.overlays=P.overlays||[];for(let q=0,K=P.sourceEndpoint.connectorOverlays.length;q<K;q++)P.overlays.push(P.sourceEndpoint.connectorOverlays[q])}P.sourceEndpoint&&P.sourceEndpoint.scope&&(P.scope=P.sourceEndpoint.scope),!P["pointer-events"]&&P.sourceEndpoint&&P.sourceEndpoint.connectorPointerEvents&&(P["pointer-events"]=P.sourceEndpoint.connectorPointerEvents);let L=function(q,K,st){let nt=Y(K,{anchor:P.anchors?P.anchors[st]:P.anchor,endpoint:P.endpoints?P.endpoints[st]:P.endpoint,paintStyle:P.endpointStyles?P.endpointStyles[st]:P.endpointStyle,hoverPaintStyle:P.endpointHoverStyles?P.endpointHoverStyles[st]:P.endpointHoverStyle});return l.addEndpoint(q,nt)},G=function(q,K,st,nt){if(P[q]&&!P[q].endpoint&&!P[q+"Endpoint"]&&!P.newConnection){let dt=ht(P[q]),at=st[dt];if(at=at?at[nt]:null,at){if(!at.enabled)return!1;let vt=I.extend({},at.def);delete vt.label;let jt=at.endpoint!=null&&at.endpoint._jsPlumb?at.endpoint:L(P[q],vt,K);if(jt.isFull())return!1;P[q+"Endpoint"]=jt,!P.scope&&vt.scope&&(P.scope=vt.scope),at.uniqueEndpoint?at.endpoint?jt.finalEndpoint=at.endpoint:(at.endpoint=jt,jt.setDeleteOnEmpty(!1)):jt.setDeleteOnEmpty(!0),K===0&&at.def.connectorOverlays&&(P.overlays=P.overlays||[],Array.prototype.push.apply(P.overlays,at.def.connectorOverlays))}}};if(G("source",0,this.sourceEndpointDefinitions,P.type||"default")!==!1&&G("target",1,this.targetEndpointDefinitions,P.type||"default")!==!1)return P.sourceEndpoint&&P.targetEndpoint&&(z(P.sourceEndpoint,P.targetEndpoint)||(P=null)),P}.bind(l),ot=function(o){let k=l.Defaults.ConnectionType||l.getDefaultConnectionType();o._jsPlumb=l,o.newConnection=ot,o.newEndpoint=pt,o.endpointsByUUID=_,o.endpointsByElement=f,o.finaliseConnection=ct,o.id="con_"+d();let P=new k(o);return P.isDetachable()&&(P.endpoints[0].initDraggable("_jsPlumbSource"),P.endpoints[1].initDraggable("_jsPlumbTarget")),P},ct=l.finaliseConnection=function(o,k,P,L){if(k=k||{},o.suspendedEndpoint||T.push(o),o.pending=null,o.endpoints[0].isTemporarySource=!1,L!==!1&&l.anchorManager.newConnection(o),w(o.source),!k.doNotFireConnectionEvent&&k.fireEvent!==!1){let G={connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]};l.fire("connection",G,P)}},pt=function(o,k){let P=l.Defaults.EndpointType||I.Endpoint,L=I.extend({},o);L._jsPlumb=l,L.newConnection=ot,L.newEndpoint=pt,L.endpointsByUUID=_,L.endpointsByElement=f,L.fireDetachEvent=Z,L.elementId=k||ht(L.source);let G=new P(L);return G.id="ep_"+d(),Yt(L.elementId,L.source),I.headless||l.getDragManager().endpointAdded(L.source,k),G},$=function(o,k,P){let L=f[o];if(L&&L.length)for(let G=0,q=L.length;G<q;G++){for(let K=0,st=L[G].connections.length;K<st;K++)if(k(L[G].connections[K]))return;P&&P(L[G])}},rt=function(o,k,P){k=k==="block";let L=null;P&&(L=function(q){q.setVisible(k,!0,!0)});let G=b(o);$(G.id,function(q){if(k&&P){let K=q.sourceId===G.id?1:0;q.endpoints[K].isVisible()&&q.setVisible(!0)}else q.setVisible(k)},L)},ft=function(o,k){let P=null;k&&(P=function(L){let G=L.isVisible();L.setVisible(!G)}),$(o,function(L){let G=L.isVisible();L.setVisible(!G)},P)},ut=function(o){let k=M[o];return k?{o:k,s:m[o]}:It({elId:o})},ht=function(o,k,P){if(c.isString(o))return o;if(o==null)return null;let L=l.getAttribute(o,"id");return(!L||L==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?L=k:(arguments.length===1||arguments.length===3&&!arguments[2])&&(L="jsPlumb_"+N+"_"+d()),P||l.setAttribute(o,"id",L)),L};this.setConnectionBeingDragged=function(o){u=o},this.isConnectionBeingDragged=function(){return u},this.getManagedElements=function(){return v},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(o,k,P){P=P||{};let L=I.extend({},P);I.extend(L,k),L.endpoint=L.endpoint||l.Defaults.Endpoint,L.paintStyle=L.paintStyle||l.Defaults.EndpointStyle;let G=[],q=c.isArray(o)||o.length!=null&&!c.isString(o)?o:[o];for(let K=0,st=q.length;K<st;K++){L.source=l.getElement(q[K]),ae(L.source);let nt=ht(L.source),dt=pt(L,nt),at=Yt(nt,L.source).info.o;c.addToList(f,nt,dt),A||dt.paint({anchorLoc:dt.anchor.compute({xy:[at.left,at.top],wh:m[nt],element:dt,timestamp:F}),timestamp:F}),G.push(dt)}return G.length===1?G[0]:G},this.addEndpoints=function(o,k,P){let L=[];for(let G=0,q=k.length;G<q;G++){let K=l.addEndpoint(o,k[G],P);c.isArray(K)?Array.prototype.push.apply(L,K):L.push(K)}return L},this.animate=function(o,k,P){if(!this.animationSupported)return!1;P=P||{};let L=l.getElement(o),G=ht(L),q=I.animEvents.step,K=I.animEvents.complete;P[q]=c.wrap(P[q],function(){l.revalidate(G)}),P[K]=c.wrap(P[K],function(){l.revalidate(G)}),l.doAnimate(L,k,P)},this.checkCondition=function(o,k){let P=l.getListener(o),L=!0;if(P&&P.length>0){let G=Array.prototype.slice.call(arguments,1);try{for(let q=0,K=P.length;q<K;q++)L=L&&P[q].apply(P[q],G)}catch(q){c.log(l,"cannot check condition ["+o+"]"+q)}}return L},this.connect=function(o,k){let P=V(o,k),L;if(P){if(P.source==null&&P.sourceEndpoint==null){c.log("Cannot establish connection - source does not exist");return}if(P.target==null&&P.targetEndpoint==null){c.log("Cannot establish connection - target does not exist");return}ae(P.source),L=ot(P),ct(L,P)}return L};let Ct=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],mt=function(o,k,P,L){let G,q=Ct[P],K=o[q.elId];o[q.el];let st,nt,dt=o.endpoints[P],at={index:P,originalSourceId:P===0?K:o.sourceId,newSourceId:o.sourceId,originalTargetId:P===1?K:o.targetId,newTargetId:o.targetId,connection:o};if(k.constructor===I.Endpoint)G=k,G.addConnection(o),k=G.element;else if(st=ht(k),nt=this[q.epDefs][st],st===o[q.elId])G=null;else if(nt)for(let vt in nt){if(!nt[vt].enabled)return;G=nt[vt].endpoint!=null&&nt[vt].endpoint._jsPlumb?nt[vt].endpoint:this.addEndpoint(k,nt[vt].def),nt[vt].uniqueEndpoint&&(nt[vt].endpoint=G),G.addConnection(o)}else G=o.makeEndpoint(P===0,k,st);return G!=null&&(dt.detachFromConnection(o),o.endpoints[P]=G,o[q.el]=G.element,o[q.elId]=G.elementId,at[P===0?"newSourceId":"newTargetId"]=G.elementId,tt(at),L||o.repaint()),at.element=k,at}.bind(this);this.setSource=function(o,k,P){let L=mt(o,k,0,P);this.anchorManager.sourceChanged(L.originalSourceId,L.newSourceId,o,L.el)},this.setTarget=function(o,k,P){let L=mt(o,k,1,P);this.anchorManager.updateOtherEndpoint(L.originalSourceId,L.originalTargetId,L.newTargetId,o)},this.deleteEndpoint=function(o,k,P){let L=typeof o=="string"?_[o]:o;return L&&l.deleteObject({endpoint:L,dontUpdateHover:k,deleteAttachedObjects:P}),l},this.deleteEveryEndpoint=function(){let o=l.setSuspendDrawing(!0);for(let P in f){let L=f[P];if(L&&L.length)for(let G=0,q=L.length;G<q;G++)l.deleteEndpoint(L[G],!0)}f={},v={},_={},M={},g={},l.anchorManager.reset();let k=l.getDragManager();return k&&k.reset(),o||l.setSuspendDrawing(!1),l};var Z=function(o,k,P){let L=l.Defaults.ConnectionType||l.getDefaultConnectionType(),G=o.constructor===L,q=G?{connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]}:o;k&&l.fire("connectionDetached",q,P),l.fire("internal.connectionDetached",q,P),l.anchorManager.connectionDetached(q)},tt=l.fireMoveEvent=function(o,k){l.fire("connectionMoved",o,k)};this.unregisterEndpoint=function(o){o._jsPlumb.uuid&&(_[o._jsPlumb.uuid]=null),l.anchorManager.deleteEndpoint(o);for(let k in f){let P=f[k];if(P){let L=[];for(let G=0,q=P.length;G<q;G++)P[G]!==o&&L.push(P[G]);f[k]=L}f[k].length<1&&delete f[k]}};let et="isDetachAllowed",lt="beforeDetach",yt="checkCondition";this.deleteConnection=function(o,k){return o!=null&&(k=k||{},k.force||c.functionChain(!0,!1,[[o.endpoints[0],et,[o]],[o.endpoints[1],et,[o]],[o,et,[o]],[l,yt,[lt,o]]]))?(o.setHover(!1),Z(o,!o.pending&&k.fireEvent!==!1,k.originalEvent),o.endpoints[0].detachFromConnection(o),o.endpoints[1].detachFromConnection(o),c.removeWithFunction(T,function(P){return o.id===P.id}),o.cleanup(),o.destroy(),!0):!1},this.deleteEveryConnection=function(o){o=o||{};let k=T.length,P=0;return l.batch(function(){for(let L=0;L<k;L++)P+=l.deleteConnection(T[0],o)?1:0}),P},this.deleteConnectionsForElement=function(o,k){k=k||{},o=l.getElement(o);let P=ht(o),L=f[P];if(L&&L.length)for(let G=0,q=L.length;G<q;G++)L[G].deleteEveryConnection(k);return l},this.deleteObject=function(o){let k={endpoints:{},connections:{},endpointCount:0,connectionCount:0},P=o.deleteAttachedObjects!==!1,L=function(K){K!=null&&k.connections[K.id]==null&&(!o.dontUpdateHover&&K._jsPlumb!=null&&K.setHover(!1),k.connections[K.id]=K,k.connectionCount++)},G=function(K){if(K!=null&&k.endpoints[K.id]==null&&(!o.dontUpdateHover&&K._jsPlumb!=null&&K.setHover(!1),k.endpoints[K.id]=K,k.endpointCount++,P))for(let st=0;st<K.connections.length;st++){let nt=K.connections[st];L(nt)}};o.connection?L(o.connection):G(o.endpoint);for(let K in k.connections){var q=k.connections[K];if(q._jsPlumb){c.removeWithFunction(T,function(nt){return q.id===nt.id}),Z(q,o.fireEvent===!1?!1:!q.pending,o.originalEvent);let st=o.deleteAttachedObjects==null?null:!o.deleteAttachedObjects;q.endpoints[0].detachFromConnection(q,null,st),q.endpoints[1].detachFromConnection(q,null,st),q.cleanup(!0),q.destroy(!0)}}for(let K in k.endpoints){let st=k.endpoints[K];st._jsPlumb&&(l.unregisterEndpoint(st),st.cleanup(!0),st.destroy(!0))}return k};let Dt=function(o,k,P,L){for(let G=0,q=o.length;G<q;G++)o[G][k].apply(o[G],P);return L(o)},Tt=function(o,k,P){let L=[];for(let G=0,q=o.length;G<q;G++)L.push([o[G][k].apply(o[G],P),o[G]]);return L},Bt=function(o,k,P){return function(){return Dt(o,k,arguments,P)}},le=function(o,k){return function(){return Tt(o,k,arguments)}},zt=function(o,k){let P=[];if(o)if(typeof o=="string"){if(o==="*")return o;P.push(o)}else if(k)P=o;else if(o.length)for(let L=0,G=o.length;L<G;L++)P.push(b(o[L]).id);else P.push(b(o).id);return P},qt=function(o,k,P){return o==="*"?!0:o.length>0?o.indexOf(k)!==-1:!P};this.getConnections=function(o,k){o?o.constructor===String&&(o={scope:o}):o={};let P=o.scope||l.getDefaultScope(),L=zt(P,!0),G=zt(o.source),q=zt(o.target),K=!k&&L.length>1?{}:[],st=function(nt,dt){if(!k&&L.length>1){let at=K[nt];at==null&&(at=K[nt]=[]),at.push(dt)}else K.push(dt)};for(let nt=0,dt=T.length;nt<dt;nt++){let at=T[nt],vt=at.proxies&&at.proxies[0]?at.proxies[0].originalEp.elementId:at.sourceId,jt=at.proxies&&at.proxies[1]?at.proxies[1].originalEp.elementId:at.targetId;qt(L,at.scope)&&qt(G,vt)&&qt(q,jt)&&st(at.scope,at)}return K};let Pe=function(o,k){return function(P){for(let L=0,G=o.length;L<G;L++)P(o[L]);return k(o)}},de=function(o){return function(k){return o[k]}},Ce=function(o,k){let P={length:o.length,each:Pe(o,k),get:de(o)},L=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],G=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],q,K;for(q=0,K=L.length;q<K;q++)P[L[q]]=Bt(o,L[q],k);for(q=0,K=G.length;q<K;q++)P[G[q]]=le(o,G[q]);return P},Ht=function(o){let k=Ce(o,Ht);return I.extend(k,{setDetachable:Bt(o,"setDetachable",Ht),setReattach:Bt(o,"setReattach",Ht),setConnector:Bt(o,"setConnector",Ht),delete:function(){for(let P=0,L=o.length;P<L;P++)l.deleteConnection(o[P])},isDetachable:le(o,"isDetachable"),isReattach:le(o,"isReattach")})},fe=function(o){let k=Ce(o,fe);return I.extend(k,{setEnabled:Bt(o,"setEnabled",fe),setAnchor:Bt(o,"setAnchor",fe),isEnabled:le(o,"isEnabled"),deleteEveryConnection:function(){for(let P=0,L=o.length;P<L;P++)o[P].deleteEveryConnection()},delete:function(){for(let P=0,L=o.length;P<L;P++)l.deleteEndpoint(o[P])}})};this.select=function(o){return o=o||{},o.scope=o.scope||"*",Ht(o.connections||l.getConnections(o,!0))},this.selectEndpoints=function(o){o=o||{},o.scope=o.scope||"*";let k=!o.element&&!o.source&&!o.target,P=k?"*":zt(o.element),L=k?"*":zt(o.source),G=k?"*":zt(o.target),q=zt(o.scope,!0),K=[];for(let st in f){let nt=qt(P,st,!0),dt=qt(L,st,!0),at=L!=="*",vt=qt(G,st,!0),jt=G!=="*";if(nt||dt||vt){t:for(let Rt=0,xe=f[st].length;Rt<xe;Rt++){let ue=f[st][Rt];if(qt(q,ue.scope,!0)){let Wt=at&&L.length>0&&!ue.isSource,Ee=jt&&G.length>0&&!ue.isTarget;if(Wt||Ee)continue t;K.push(ue)}}}}return fe(K)},this.getAllConnections=function(){return T},this.getDefaultScope=function(){return i},this.getEndpoint=B,this.getEndpoints=function(o){return f[b(o).id]||[]},this.getDefaultEndpointType=function(){return I.Endpoint},this.getDefaultConnectionType=function(){return I.Connection},this.getId=ht,this.draw=w,this.info=b,this.appendElement=C;let re=!1;this.isHoverSuspended=function(){return re},this.setHoverSuspended=function(o){re=o},this.hide=function(o,k){return rt(o,"none",k),l},this.idstamp=d;var ae=function(o){if(!n&&o){let k=l.getElement(o);k.offsetParent&&l.setContainer(k.offsetParent)}};let Mt=function(){l.Defaults.Container&&l.setContainer(l.Defaults.Container)};var Yt=l.manage=function(o,k,P){return v[o]||(v[o]={el:k,endpoints:[],connections:[]},v[o].info=It({elId:o,timestamp:F}),l.addClass(k,"jtk-managed"),P||l.fire("manageElement",{id:o,info:v[o].info,el:k})),v[o]};l.unmanage=function(o){if(v[o]){let k=v[o].el;l.removeClass(k,"jtk-managed"),delete v[o],l.fire("unmanageElement",{id:o,el:k})}};var It=function(o){let k=o.timestamp,P=o.recalc,L=o.offset,G=o.elId,q;return A&&!k&&(k=F),!P&&k&&k===g[G]?{o:o.offset||M[G],s:m[G]}:(P||!L&&M[G]==null?(q=v[G]?v[G].el:null,q!=null&&(m[G]=l.getSize(q),M[G]=l.getOffset(q),g[G]=k)):(M[G]=L||M[G],m[G]==null&&(q=v[G].el,q!=null&&(m[G]=l.getSize(q))),g[G]=k),M[G]&&!M[G].right&&(M[G].right=M[G].left+m[G][0],M[G].bottom=M[G].top+m[G][1],M[G].width=m[G][0],M[G].height=m[G][1],M[G].centerx=M[G].left+M[G].width/2,M[G].centery=M[G].top+M[G].height/2),{o:M[G],s:m[G]})};this.updateOffset=It,this.init=function(){S||(Mt(),l.anchorManager=new X.jsPlumb.AnchorManager({jsPlumbInstance:l}),S=!0,l.fire("ready",l))}.bind(this),this.log=h,this.jsPlumbUIComponent=t,this.makeAnchor=function(){let o,k=function(q,K){if(X.jsPlumb.Anchors[q])return new X.jsPlumb.Anchors[q](K);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+q+"'"}};if(arguments.length===0)return null;let P=arguments[0],L=arguments[1],G=null;if(P.compute&&P.getOrientation)return P;if(typeof P=="string")G=k(arguments[0],{elementId:L,jsPlumbInstance:l});else if(c.isArray(P))if(c.isArray(P[0])||c.isString(P[0]))P.length===2&&c.isObject(P[1])?c.isString(P[0])?(o=X.jsPlumb.extend({elementId:L,jsPlumbInstance:l},P[1]),G=k(P[0],o)):(o=X.jsPlumb.extend({elementId:L,jsPlumbInstance:l,anchors:P[0]},P[1]),G=new X.jsPlumb.DynamicAnchor(o)):G=new I.DynamicAnchor({anchors:P,selector:null,elementId:L,jsPlumbInstance:l});else{let q={x:P[0],y:P[1],orientation:P.length>=4?[P[2],P[3]]:[0,0],offsets:P.length>=6?[P[4],P[5]]:[0,0],elementId:L,jsPlumbInstance:l,cssClass:P.length===7?P[6]:null};G=new X.jsPlumb.Anchor(q),G.clone=function(){return new X.jsPlumb.Anchor(q)}}return G.id||(G.id="anchor_"+d()),G},this.makeAnchors=function(o,k,P){let L=[];for(let G=0,q=o.length;G<q;G++)typeof o[G]=="string"?L.push(X.jsPlumb.Anchors[o[G]]({elementId:k,jsPlumbInstance:P})):c.isArray(o[G])&&L.push(l.makeAnchor(o[G],k,P));return L},this.makeDynamicAnchor=function(o,k){return new X.jsPlumb.DynamicAnchor({anchors:o,selector:k,elementId:null,jsPlumbInstance:l})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};let te=function(o,k,P,L,G){let q=o.target||o.srcElement,K=!1,st=L.getSelector(k,P);for(let nt=0;nt<st.length;nt++)if(st[nt]===q){K=!0;break}return G?!K:K},ee=function(o,k,P,L,G){let q=new t(k),K=k._jsPlumb.EndpointDropHandler({jsPlumb:l,enabled:function(){return o.def.enabled},isFull:function(){let nt=l.select({target:o.id}).length;return o.def.maxConnections>0&&nt>=o.def.maxConnections},element:o.el,elementId:o.id,isSource:L,isTarget:G,addClass:function(nt){l.addClass(o.el,nt)},removeClass:function(nt){l.removeClass(o.el,nt)},onDrop:function(nt){nt.endpoints[0].anchor.unlock()},isDropAllowed:function(){return q.isDropAllowed.apply(q,arguments)},isRedrop:function(nt){return nt.suspendedElement!=null&&nt.suspendedEndpoint!=null&&nt.suspendedEndpoint.element===o.el},getEndpoint:function(nt){let dt=o.def.endpoint;if(dt==null||dt._jsPlumb==null){let at=l.deriveEndpointAndAnchorSpec(nt.getType().join(" "),!0),vt=at.endpoints?X.jsPlumb.extend(k,{endpoint:o.def.def.endpoint||at.endpoints[1]}):k;at.anchors&&(vt=X.jsPlumb.extend(vt,{anchor:o.def.def.anchor||at.anchors[1]})),dt=l.addEndpoint(o.el,vt),dt._mtNew=!0}if(k.uniqueEndpoint&&(o.def.endpoint=dt),dt.setDeleteOnEmpty(!0),nt.isDetachable()&&dt.initDraggable(),dt.anchor.positionFinder!=null){let at=l.getUIPosition(arguments,l.getZoom()),vt=l.getOffset(o.el),jt=l.getSize(o.el),Rt=at==null?[0,0]:dt.anchor.positionFinder(at,vt,jt,dt.anchor.constructorParams);dt.anchor.x=Rt[0],dt.anchor.y=Rt[1]}return dt},maybeCleanup:function(nt){nt._mtNew&&nt.connections.length===0?l.deleteObject({endpoint:nt}):delete nt._mtNew}}),st=X.jsPlumb.dragEvents.drop;return P.scope=P.scope||k.scope||l.Defaults.Scope,P[st]=c.wrap(P[st],K,!0),P.rank=k.rank||0,G&&(P[X.jsPlumb.dragEvents.over]=function(){return!0}),k.allowLoopback===!1&&(P.canDrop=function(nt){return nt.getDragElement()._jsPlumbRelatedElement!==o.el}),l.initDroppable(o.el,P,"internal"),K};this.makeTarget=function(o,k,P){let L=X.jsPlumb.extend({_jsPlumb:this},P);X.jsPlumb.extend(L,k);let G=L.maxConnections||-1,q=function(st){let nt=b(st),dt=nt.id,at=X.jsPlumb.extend({},L.dropOptions||{}),vt=L.connectionType||"default";this.targetEndpointDefinitions[dt]=this.targetEndpointDefinitions[dt]||{},ae(dt),nt.el._isJsPlumbGroup&&at.rank==null&&(at.rank=-1);let jt={def:X.jsPlumb.extend({},L),uniqueEndpoint:L.uniqueEndpoint,maxConnections:G,enabled:!0};L.createEndpoint&&(jt.uniqueEndpoint=!0,jt.endpoint=l.addEndpoint(st,jt.def),jt.endpoint.setDeleteOnEmpty(!1)),nt.def=jt,this.targetEndpointDefinitions[dt][vt]=jt,ee(nt,L,at,L.isSource===!0,!0),nt.el._katavorioDrop[nt.el._katavorioDrop.length-1].targetDef=jt}.bind(this),K=o.length&&o.constructor!==String?o:[o];for(let st=0,nt=K.length;st<nt;st++)q(K[st]);return this},this.unmakeTarget=function(o,k){let P=b(o);return l.destroyDroppable(P.el,"internal"),k||delete this.targetEndpointDefinitions[P.id],this},this.makeSource=function(o,k,P){let L=X.jsPlumb.extend({_jsPlumb:this},P);X.jsPlumb.extend(L,k);let G=L.connectionType||"default",q=l.deriveEndpointAndAnchorSpec(G);L.endpoint=L.endpoint||q.endpoints[0],L.anchor=L.anchor||q.anchors[0];let K=L.maxConnections||-1,st=L.onMaxConnections,nt=function(at){let vt=at.id,jt=this.getElement(at.el);this.sourceEndpointDefinitions[vt]=this.sourceEndpointDefinitions[vt]||{},ae(vt);let Rt={def:X.jsPlumb.extend({},L),uniqueEndpoint:L.uniqueEndpoint,maxConnections:K,enabled:!0};L.createEndpoint&&(Rt.uniqueEndpoint=!0,Rt.endpoint=l.addEndpoint(o,Rt.def),Rt.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[vt][G]=Rt,at.def=Rt;let xe=X.jsPlumb.dragEvents.stop,ue=X.jsPlumb.dragEvents.drag,Wt=X.jsPlumb.extend({},L.dragOptions||{}),Ee=Wt.drag,Ne=Wt.stop,Lt=null,Se=!1;Wt.scope=Wt.scope||L.scope,Wt[ue]=c.wrap(Wt[ue],function(){Ee&&Ee.apply(this,arguments),Se=!1}),Wt[xe]=c.wrap(Wt[xe],function(){if(Ne&&Ne.apply(this,arguments),this.currentlyDragging=!1,Lt._jsPlumb!=null){let Vt=L.anchor||this.Defaults.Anchor,Ft=Lt.anchor,De=Lt.connections[0],Zt=this.makeAnchor(Vt,vt,this),Qt=Lt.element;if(Zt.positionFinder!=null){let ne=l.getOffset(Qt),pe=this.getSize(Qt),_e={left:ne.left+Ft.x*pe[0],top:ne.top+Ft.y*pe[1]},ve=Zt.positionFinder(_e,ne,pe,Zt.constructorParams);Zt.x=ve[0],Zt.y=ve[1]}Lt.setAnchor(Zt,!0),Lt.repaint(),this.repaint(Lt.elementId),De!=null&&this.repaint(De.targetId)}}.bind(this));let Re=function(Vt){if(Vt.which===3||Vt.button===2)return;let Ft=this.sourceEndpointDefinitions[vt][G];if(!Ft.enabled||(vt=this.getId(this.getElement(at.el)),L.filter&&(c.isString(L.filter)?te(Vt,at.el,L.filter,this,L.filterExclude):L.filter(Vt,at.el))===!1))return;let De=this.select({source:vt}).length;if(Ft.maxConnections>=0&&De>=Ft.maxConnections)return st&&st({element:at.el,maxConnections:K},Vt),!1;let Zt=X.jsPlumb.getPositionOnElement(Vt,jt,O),Qt={};X.jsPlumb.extend(Qt,Ft.def),Qt.isTemporarySource=!0,Qt.anchor=[Zt[0],Zt[1],0,0],Qt.dragOptions=Wt,Ft.def.scope&&(Qt.scope=Ft.def.scope),Lt=this.addEndpoint(vt,Qt),Se=!0,Lt.setDeleteOnEmpty(!0),Ft.uniqueEndpoint&&(Ft.endpoint?Lt.finalEndpoint=Ft.endpoint:(Ft.endpoint=Lt,Lt.setDeleteOnEmpty(!1)));let ne=function(){l.off(Lt.canvas,"mouseup",ne),l.off(at.el,"mouseup",ne),Se&&(Se=!1,l.deleteEndpoint(Lt))};l.on(Lt.canvas,"mouseup",ne),l.on(at.el,"mouseup",ne);let pe={};if(Ft.def.extract)for(let _e in Ft.def.extract){let ve=(Vt.srcElement||Vt.target).getAttribute(_e);ve&&(pe[Ft.def.extract[_e]]=ve)}l.trigger(Lt.canvas,"mousedown",Vt,pe),c.consume(Vt)}.bind(this);this.on(at.el,"mousedown",Re),Rt.trigger=Re,L.filter&&(c.isString(L.filter)||c.isFunction(L.filter))&&l.setDragFilter(at.el,L.filter);let Ve=X.jsPlumb.extend({},L.dropOptions||{});ee(at,L,Ve,!0,L.isTarget===!0)}.bind(this),dt=o.length&&o.constructor!==String?o:[o];for(let at=0,vt=dt.length;at<vt;at++)nt(b(dt[at]));return this},this.unmakeSource=function(o,k,P){let L=b(o);l.destroyDroppable(L.el,"internal");let G=this.sourceEndpointDefinitions[L.id];if(G){for(let q in G)if(k==null||k===q){let K=G[q].trigger;K&&l.off(L.el,"mousedown",K),P||delete this.sourceEndpointDefinitions[L.id][q]}}return this},this.unmakeEverySource=function(){for(let o in this.sourceEndpointDefinitions)l.unmakeSource(o,null,!0);return this.sourceEndpointDefinitions={},this};let it=function(o,k,P){k=c.isArray(k)?k:[k];let L=ht(o);P=P||"default";for(let G=0;G<k.length;G++){let q=this[k[G]][L];if(q&&q[P])return q[P].def.scope||this.Defaults.Scope}}.bind(this),_t=function(o,k,P,L){P=c.isArray(P)?P:[P];let G=ht(o);L=L||"default";for(let q=0;q<P.length;q++){let K=this[P[q]][G];K&&K[L]&&(K[L].def.scope=k)}}.bind(this);this.getScope=function(o,k){return it(o,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(o){return it(o,"sourceEndpointDefinitions")},this.getTargetScope=function(o){return it(o,"targetEndpointDefinitions")},this.setScope=function(o,k,P){this.setSourceScope(o,k,P),this.setTargetScope(o,k,P)},this.setSourceScope=function(o,k,P){_t(o,k,"sourceEndpointDefinitions",P),this.setDragScope(o,k)},this.setTargetScope=function(o,k,P){_t(o,k,"targetEndpointDefinitions",P),this.setDropScope(o,k)},this.unmakeEveryTarget=function(){for(let o in this.targetEndpointDefinitions)l.unmakeTarget(o,!0);return this.targetEndpointDefinitions={},this};let Pt=function(o,k,P,L,G){let q=o==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,K,st,nt;if(G=G||"default",k.length&&!c.isString(k)){K=[];for(let dt=0,at=k.length;dt<at;dt++)st=b(k[dt]),q[st.id]&&q[st.id][G]&&(K[dt]=q[st.id][G].enabled,nt=L?!K[dt]:P,q[st.id][G].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}else{st=b(k);let dt=st.id;q[dt]&&q[dt][G]&&(K=q[dt][G].enabled,nt=L?!K:P,q[dt][G].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}return K}.bind(this),gt=function(o,k){if(c.isString(o)||!o.length)return k.apply(this,[o]);if(o.length)return k.apply(this,[o[0]])}.bind(this);this.toggleSourceEnabled=function(o,k){return Pt("source",o,null,!0,k),this.isSourceEnabled(o,k)},this.setSourceEnabled=function(o,k,P){return Pt("source",o,k,null,P)},this.isSource=function(o,k){return k=k||"default",gt(o,function(P){let L=this.sourceEndpointDefinitions[b(P).id];return L!=null&&L[k]!=null}.bind(this))},this.isSourceEnabled=function(o,k){return k=k||"default",gt(o,function(P){let L=this.sourceEndpointDefinitions[b(P).id];return L&&L[k]&&L[k].enabled===!0}.bind(this))},this.toggleTargetEnabled=function(o,k){return Pt("target",o,null,!0,k),this.isTargetEnabled(o,k)},this.isTarget=function(o,k){return k=k||"default",gt(o,function(P){let L=this.targetEndpointDefinitions[b(P).id];return L!=null&&L[k]!=null}.bind(this))},this.isTargetEnabled=function(o,k){return k=k||"default",gt(o,function(P){let L=this.targetEndpointDefinitions[b(P).id];return L&&L[k]&&L[k].enabled===!0}.bind(this))},this.setTargetEnabled=function(o,k,P){return Pt("target",o,k,null,P)},this.ready=function(o){l.bind("ready",o)};let St=function(o,k){if(typeof o=="object"&&o.length)for(let P=0,L=o.length;P<L;P++)k(o[P]);else k(o);return l};this.repaint=function(o,k,P){return St(o,function(L){w(L,k,P)})},this.revalidate=function(o,k,P){return St(o,function(L){let G=P?L:l.getId(L);l.updateOffset({elId:G,recalc:!0,timestamp:k});let q=l.getDragManager();q&&q.updateOffsets(G),l.repaint(L)})},this.repaintEverything=function(){let o=H(),k;for(k in f)l.updateOffset({elId:k,recalc:!0,timestamp:o});for(k in f)w(k,null,o);return this},this.removeAllEndpoints=function(o,k,P){P=P||[];let L=function(G){let q=b(G),K=f[q.id],st,nt;if(K)for(P.push(q),st=0,nt=K.length;st<nt;st++)l.deleteEndpoint(K[st],!1);if(delete f[q.id],k&&q.el&&q.el.nodeType!==3&&q.el.nodeType!==8)for(st=0,nt=q.el.childNodes.length;st<nt;st++)L(q.el.childNodes[st])};return L(o),this};let kt=function(o,k){l.removeAllEndpoints(o.id,!0,k);let P=l.getDragManager(),L=function(G){P&&P.elementRemoved(G.id),l.anchorManager.clearFor(G.id),l.anchorManager.removeFloatingConnection(G.id),l.isSource(G.el)&&l.unmakeSource(G.el),l.isTarget(G.el)&&l.unmakeTarget(G.el),l.destroyDraggable(G.el),l.destroyDroppable(G.el),delete l.floatingConnections[G.id],delete v[G.id],delete M[G.id],G.el&&(l.removeElement(G.el),G.el._jsPlumb=null)};for(let G=1;G<k.length;G++)L(k[G]);L(o)};this.remove=function(o,k){let P=b(o),L=[];return P.text&&P.el.parentNode?P.el.parentNode.removeChild(P.el):P.id&&l.batch(function(){kt(P,L)},k===!0),l},this.empty=function(o,k){let P=[],L=function(G,q){let K=b(G);if(K.text)K.el.parentNode.removeChild(K.el);else if(K.el){for(;K.el.childNodes.length>0;)L(K.el.childNodes[0]);q||kt(K,P)}};return l.batch(function(){L(o,!0)},k===!1),l},this.reset=function(o){l.silently(function(){re=!1,l.removeAllGroups(),l.removeGroupManager(),l.deleteEveryEndpoint(),o||l.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},T.length=0,this.doReset&&this.doReset()}.bind(this))};let Xt=function(o){o.canvas&&o.canvas.parentNode&&o.canvas.parentNode.removeChild(o.canvas),o.cleanup(),o.destroy()};this.clear=function(){l.select().each(Xt),l.selectEndpoints().each(Xt),f={},_={}},this.setDefaultScope=function(o){return i=o,l},this.deriveEndpointAndAnchorSpec=function(o,k){let P=((k?"":"default ")+o).split(/[\s]/),L=null,G=null,q=null,K=null;for(let st=0;st<P.length;st++){let nt=l.getType(P[st],"connection");nt&&(nt.endpoints&&(L=nt.endpoints),nt.endpoint&&(G=nt.endpoint),nt.anchors&&(K=nt.anchors),nt.anchor&&(q=nt.anchor))}return{endpoints:L||[G,G],anchors:K||[q,q]}},this.setId=function(o,k,P){let L;c.isString(o)?L=o:(o=this.getElement(o),L=this.getId(o));let G=this.getConnections({source:L,scope:"*"},!0),q=this.getConnections({target:L,scope:"*"},!0);k=""+k,P?o=this.getElement(k):(o=this.getElement(L),this.setAttribute(o,"id",k)),f[k]=f[L]||[];for(let nt=0,dt=f[k].length;nt<dt;nt++)f[k][nt].setElementId(k),f[k][nt].setReferenceElement(o);delete f[L],this.sourceEndpointDefinitions[k]=this.sourceEndpointDefinitions[L],delete this.sourceEndpointDefinitions[L],this.targetEndpointDefinitions[k]=this.targetEndpointDefinitions[L],delete this.targetEndpointDefinitions[L],this.anchorManager.changeId(L,k);let K=this.getDragManager();K&&K.changeId(L,k),v[k]=v[L],delete v[L];let st=function(nt,dt,at){for(let vt=0,jt=nt.length;vt<jt;vt++)nt[vt].endpoints[dt].setElementId(k),nt[vt].endpoints[dt].setReferenceElement(o),nt[vt][at+"Id"]=k,nt[vt][at]=o};st(G,0,"source"),st(q,1,"target"),this.repaint(k)},this.setDebugLog=function(o){h=o},this.setSuspendDrawing=function(o,k){let P=A;return A=o,o?F=new Date().getTime():F=null,k&&this.repaintEverything(),P},this.isSuspendDrawing=function(){return A},this.getSuspendedAt=function(){return F},this.batch=function(o,k){let P=this.isSuspendDrawing();P||this.setSuspendDrawing(!0);try{o()}catch(L){c.log("Function run while suspended failed",L)}P||this.setSuspendDrawing(!1,!k)},this.doWhileSuspended=this.batch,this.getCachedData=ut,this.timestamp=H,this.show=function(o,k){return rt(o,"block",k),l},this.toggleVisible=ft,this.addListener=this.bind;let $t=[];this.registerFloatingConnection=function(o,k,P){$t[o.id]=k,c.addToList(f,o.id,P)},this.getFloatingConnectionFor=function(o){return $t[o]},this.listManager=new X.jsPlumbListManager(this)};c.extend(X.jsPlumbInstance,c.EventGenerator,{setAttribute:function(s,l,N){this.setAttribute(s,l,N)},getAttribute:function(s,l){return this.getAttribute(X.jsPlumb.getElement(s),l)},convertToFullOverlaySpec:function(s){return c.isString(s)&&(s=[s,{}]),s[1].id=s[1].id||c.uuid(),s},registerConnectionType:function(s,l){if(this._connectionTypes[s]=X.jsPlumb.extend({},l),l.overlays){let N={};for(let R=0;R<l.overlays.length;R++){let U=this.convertToFullOverlaySpec(l.overlays[R]);N[U[1].id]=U}this._connectionTypes[s].overlays=N}},registerConnectionTypes:function(s){for(let l in s)this.registerConnectionType(l,s[l])},registerEndpointType:function(s,l){if(this._endpointTypes[s]=X.jsPlumb.extend({},l),l.overlays){let N={};for(let R=0;R<l.overlays.length;R++){let U=this.convertToFullOverlaySpec(l.overlays[R]);N[U[1].id]=U}this._endpointTypes[s].overlays=N}},registerEndpointTypes:function(s){for(let l in s)this.registerEndpointType(l,s[l])},getType:function(s,l){return l==="connection"?this._connectionTypes[s]:this._endpointTypes[s]},setIdChanged:function(s,l){this.setId(s,l,!0)},setParent:function(s,l){let N=this.getElement(s),R=this.getId(N),U=this.getElement(l),O=this.getId(U),b=this.getDragManager();N.parentNode.removeChild(N),U.appendChild(N),b&&b.setParent(N,R,U,O)},extend:function(s,l,N){let R;if(N)for(R=0;R<N.length;R++)s[N[R]]=l[N[R]];else for(R in l)s[R]=l[R];return s},floatingConnections:{},getFloatingAnchorIndex:function(s){return s.endpoints[0].isFloating()?0:s.endpoints[1].isFloating()?1:-1},proxyConnection:function(s,l,N,R,U,O){let b,n=s.endpoints[l].elementId,y=s.endpoints[l];s.proxies=s.proxies||[],s.proxies[l]?b=s.proxies[l].ep:b=this.addEndpoint(N,{endpoint:U(s,l),anchor:O(s,l),parameters:{isProxyEndpoint:!0}}),b.setDeleteOnEmpty(!0),s.proxies[l]={ep:b,originalEp:y},l===0?this.anchorManager.sourceChanged(n,R,s,N):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,n,R,s),s.target=N,s.targetId=R),y.detachFromConnection(s,null,!0),b.connections=[s],s.endpoints[l]=b,y.setVisible(!1),s.setVisible(!0),this.revalidate(N)},unproxyConnection:function(s,l,N){if(s._jsPlumb==null||s.proxies==null||s.proxies[l]==null)return;let R=s.proxies[l].originalEp.element,U=s.proxies[l].originalEp.elementId;s.endpoints[l]=s.proxies[l].originalEp,l===0?this.anchorManager.sourceChanged(N,U,s,R):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,N,U,s),s.target=R,s.targetId=U),s.proxies[l].ep.detachFromConnection(s,null),s.proxies[l].originalEp.addConnection(s),s.isVisible()&&s.proxies[l].originalEp.setVisible(!0),delete s.proxies[l]}});var I=new D;X.jsPlumb=I,I.getInstance=function(s,l){let N=new D(s);if(l)for(let R in l)N[R]=l[R];return N.init(),N},I.each=function(s,l){if(s!=null)if(typeof s=="string")l(I.getElement(s));else if(s.length!=null)for(let N=0;N<s.length;N++)l(I.getElement(s[N]));else l(s)},typeof exports<"u"&&(exports.jsPlumb=I)}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q="__label",J=function(r,E){let a={cssClass:E.cssClass,labelStyle:r.labelStyle,id:Q,component:r,_jsPlumb:r._jsPlumb.instance},t=c.extend(a,E);return new c.Overlays[r._jsPlumb.instance.getRenderMode()].Label(t)},W=function(r,E){let a=null;if(H.isArray(E)){let t=E[0],p=c.extend({component:r,_jsPlumb:r._jsPlumb.instance},E[1]);E.length===3&&c.extend(p,E[2]),a=new c.Overlays[r._jsPlumb.instance.getRenderMode()][t](p)}else E.constructor===String?a=new c.Overlays[r._jsPlumb.instance.getRenderMode()][E]({component:r,_jsPlumb:r._jsPlumb.instance}):a=E;return a.id=a.id||H.uuid(),r.cacheTypeItem("overlay",a,a.id),r._jsPlumb.overlays[a.id]=a,a};c.OverlayCapableJsPlumbUIComponent=function(r){X.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},r.label?this.getDefaultType().overlays[Q]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:Q}]:r.id&&(this.getDefaultType().overlays[Q]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.emptyLabelStyle||this._jsPlumb.instance.Defaults.emptyLabelStyle,id:Q}]),this.setListenerComponent=function(E){if(this._jsPlumb)for(let a in this._jsPlumb.overlays)this._jsPlumb.overlays[a].setListenerComponent(E)}},c.OverlayCapableJsPlumbUIComponent.applyType=function(r,E){if(E.overlays){let a={},t;for(t in E.overlays){let p=r._jsPlumb.overlays[E.overlays[t][1].id];if(p)p.updateFrom(E.overlays[t][1]),a[E.overlays[t][1].id]=!0;else{let x=r.getCachedTypeItem("overlay",E.overlays[t][1].id);x!=null?(x.reattach(r._jsPlumb.instance,r),x.setVisible(!0),x.updateFrom(E.overlays[t][1]),r._jsPlumb.overlays[x.id]=x):x=r.addOverlay(E.overlays[t],!0),a[x.id]=!0}}for(t in r._jsPlumb.overlays)a[r._jsPlumb.overlays[t].id]==null&&r.removeOverlay(r._jsPlumb.overlays[t].id,!0)}},H.extend(c.OverlayCapableJsPlumbUIComponent,X.jsPlumbUIComponent,{setHover:function(r,E){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(let a in this._jsPlumb.overlays)this._jsPlumb.overlays[a][r?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(r,E){let a=W(this,r);if(this.getData&&a.type==="Label"&&H.isArray(r)){let t=this.getData(),p=r[1];if(t){let x=p.labelLocationAttribute||"labelLocation",j=t?t[x]:null;j&&(a.loc=j)}}return E||this.repaint(),a},getOverlay:function(r){return this._jsPlumb.overlays[r]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(r){let E=this.getOverlay(r);E&&E.hide()},hideOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].hide()},showOverlay:function(r){let E=this.getOverlay(r);E&&E.show()},showOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].show()},removeAllOverlays:function(r){for(let E in this._jsPlumb.overlays)this._jsPlumb.overlays[E].cleanup&&this._jsPlumb.overlays[E].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},r||this.repaint()},removeOverlay:function(r,E){let a=this._jsPlumb.overlays[r];a&&(a.setVisible(!1),!E&&a.cleanup&&a.cleanup(),delete this._jsPlumb.overlays[r],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[r],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[r])},removeOverlays:function(){for(let r=0,E=arguments.length;r<E;r++)this.removeOverlay(arguments[r])},moveParent:function(r){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),r.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),r.appendChild(this.canvas);for(let E in this._jsPlumb.overlays)if(this._jsPlumb.overlays[E].isAppendedAtTopLevel){let a=this._jsPlumb.overlays[E].getElement();a.parentNode.removeChild(a),r.appendChild(a)}}},getLabel:function(){let r=this.getOverlay(Q);return r!=null?r.getLabel():null},getLabelOverlay:function(){return this.getOverlay(Q)},setLabel:function(r){let E=this.getOverlay(Q);if(E)r.constructor===String||r.constructor===Function?E.setLabel(r):(r.label||(r.label=""),E.setLabel(r.label),r.location&&E.setLocation(r.location));else{let a=r.constructor===String||r.constructor===Function?{label:r}:r;E=J(this,a),this._jsPlumb.overlays[Q]=E}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(r){for(let E in this._jsPlumb.overlays)this._jsPlumb.overlays[E].cleanup(r),this._jsPlumb.overlays[E].destroy(r);r&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(r){this[r?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(r,E){this._jsPlumb.overlayPositions[r.id]=E},getAbsoluteOverlayPosition:function(r){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[r.id]:null},_clazzManip:function(r,E,a){if(!a)for(let t in this._jsPlumb.overlays)this._jsPlumb.overlays[t][r+"Class"](E)},addClass:function(r,E){this._clazzManip("add",r,E)},removeClass:function(r,E){this._clazzManip("remove",r,E)}})}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=function(a,t,p){let x=!1;return{drag:function(){if(x)return x=!1,!0;if(t.element){let j=p.getUIPosition(arguments,p.getZoom());j!=null&&p.setPosition(t.element,j),p.repaint(t.element,j),a.paint({anchorPoint:a.anchor.getCurrentLocation({element:a})})}},stopDrag:function(){x=!0}}},J=function(a,t,p,x){let j=t.createElement("div",{position:"absolute"});t.appendElement(j);let D=t.getId(j);t.setPosition(j,p),j.style.width=x[0]+"px",j.style.height=x[1]+"px",t.manage(D,j,!0),a.id=D,a.element=j},W=function(a,t,p,x,j,D,I,s){let l=new c.FloatingAnchor({reference:t,referenceCanvas:x,jsPlumbInstance:D});return I({paintStyle:a,endpoint:p,anchor:l,source:j,scope:s})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],E=function(a,t){let p=0;if(t!=null){for(let x=0;x<a.connections.length;x++)if(a.connections[x].sourceId===t||a.connections[x].targetId===t){p=x;break}}return a.connections[p]};c.Endpoint=function(a){let t=a._jsPlumb,p=a.newConnection,x=a.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:a.connectionType,maxConnections:a.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:a.maxConnections,paintStyle:a.endpointStyle||a.paintStyle||a.style||this._jsPlumb.instance.Defaults.EndpointStyle||c.Defaults.EndpointStyle,hoverPaintStyle:a.endpointHoverStyle||a.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle,connectorStyle:a.connectorStyle,connectorHoverStyle:a.connectorHoverStyle,connectorClass:a.connectorClass,connectorHoverClass:a.connectorHoverClass,connectorOverlays:a.connectorOverlays,connector:a.connector,connectorTooltip:a.connectorTooltip}),this._jsPlumb.enabled=a.enabled!==!1,this._jsPlumb.visible=!0,this.element=c.getElement(a.source),this._jsPlumb.uuid=a.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(a.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=a.elementId,this.dragProxy=a.dragProxy,this._jsPlumb.connectionCost=a.connectionCost,this._jsPlumb.connectionsDirected=a.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};let j=a.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(O){j=O};let D=function(){let O=t.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();let b=t.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(O),this.addClass(b),c.updateClasses(this.element,b,O)}.bind(this);this.prepareAnchor=function(O){let b=this._jsPlumb.instance.makeAnchor(O,this.elementId,t);return b.bind("anchorChanged",function(n){this.fire("anchorChanged",{endpoint:this,anchor:n}),D()}.bind(this)),b},this.setPreparedAnchor=function(O,b){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=O,D(),b||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(O,b){let n=this.prepareAnchor(O);return this.setPreparedAnchor(n,b),this};let I=function(O){if(this.connections.length>0)for(let b=0;b<this.connections.length;b++)this.connections[b].setHover(O,!1);else this.setHover(O)}.bind(this);this.bind("mouseover",function(){I(!0)}),this.bind("mouseout",function(){I(!1)}),a._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(O,b){let n=function(S,T){let f=t.getRenderMode();if(c.Endpoints[f][S])return new c.Endpoints[f][S](T);if(!t.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+S+"'"}},y={_jsPlumb:this._jsPlumb.instance,cssClass:a.cssClass,container:a.container,tooltip:a.tooltip,connectorTooltip:a.connectorTooltip,endpoint:this},h;return H.isString(O)?h=n(O,y):H.isArray(O)?(y=H.merge(O[1],y),h=n(O[0],y)):h=O.clone(),h.clone=function(){if(H.isString(O))return n(O,y);if(H.isArray(O))return y=H.merge(O[1],y),n(O[0],y)}.bind(this),h.typeId=b,h},this.setEndpoint=function(O,b){let n=this.prepareEndpoint(O);this.setPreparedEndpoint(n,!0)},this.setPreparedEndpoint=function(O,b){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=O,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},c.extend(this,a,r),this.isSource=a.isSource||!1,this.isTemporarySource=a.isTemporarySource||!1,this.isTarget=a.isTarget||!1,this.connections=a.connections||[],this.connectorPointerEvents=a["connector-pointer-events"],this.scope=a.scope||t.getDefaultScope(),this.timestamp=null,this.reattachConnections=a.reattach||t.Defaults.ReattachConnections,this.connectionsDetachable=t.Defaults.ConnectionsDetachable,(a.connectionsDetachable===!1||a.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=a.dragAllowedWhenFull!==!1,a.onMaxConnections&&this.bind("maxConnections",a.onMaxConnections),this.addConnection=function(O){this.connections.push(O),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)},this.detachFromConnection=function(O,b,n){b=b==null?this.connections.indexOf(O):b,b>=0&&(this.connections.splice(b,1),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)),!n&&j&&this.connections.length===0&&t.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:n!==!0})},this.deleteEveryConnection=function(O){let b=this.connections.length;for(let n=0;n<b;n++)t.deleteConnection(this.connections[0],O)},this.detachFrom=function(O,b,n){let y=[];for(let h=0;h<this.connections.length;h++)(this.connections[h].endpoints[1]===O||this.connections[h].endpoints[0]===O)&&y.push(this.connections[h]);for(let h=0,S=y.length;h<S;h++)t.deleteConnection(y[0]);return this},this.getElement=function(){return this.element},this.setElement=function(O){let b=this._jsPlumb.instance.getId(O),n=this.elementId;return H.removeWithFunction(a.endpointsByElement[this.elementId],function(y){return y.id===this.id}.bind(this)),this.element=c.getElement(O),this.elementId=t.getId(this.element),t.anchorManager.rehomeEndpoint(this,n,this.element),t.dragManager.endpointAdded(this.element),H.addToList(a.endpointsByElement,b,this),this},this.makeInPlaceCopy=function(){let O=this.anchor.getCurrentLocation({element:this}),b=this.anchor.getOrientation(this),n=this.anchor.getCssClass(),y={bind:function(){},compute:function(){return[O[0],O[1]]},getCurrentLocation:function(){return[O[0],O[1]]},getOrientation:function(){return b},getCssClass:function(){return n}};return x({dropOptions:a.dropOptions,anchor:y,source:this.element,paintStyle:this.getPaintStyle(),endpoint:a.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(O){O=O||{};let b=O.timestamp,n=O.recalc!==!1;if(!b||this.timestamp!==b){let y=t.updateOffset({elId:this.elementId,timestamp:b}),h=O.offset?O.offset.o:y.o;if(h!=null){let S=O.anchorPoint,T=O.connectorPaintStyle;if(S==null){let f=O.dimensions||y.s,_={xy:[h.left,h.top],wh:f,element:this,timestamp:b};if(n&&this.anchor.isDynamic&&this.connections.length>0){let v=E(this,O.elementWithPrecedence),M=v.endpoints[0]===this?1:0,g=M===0?v.sourceId:v.targetId,u=t.getCachedData(g),m=u.o,A=u.s;_.index=M===0?1:0,_.connection=v,_.txy=[m.left,m.top],_.twh=A,_.tElement=v.endpoints[M]}else this.connections.length>0&&(_.connection=this.connections[0]);S=this.anchor.compute(_)}this.endpoint.compute(S,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,T||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=b;for(let f in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(f)){let _=this._jsPlumb.overlays[f];_.isVisible()&&(this._jsPlumb.overlayPlacements[f]=_.draw(this.endpoint,this._jsPlumb.paintStyleInUse),_.paint(this._jsPlumb.overlayPlacements[f]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;let s=!1;this.initDraggable=function(){if(!s&&c.isDragSupported(this.element)){let O={id:null,element:null},b=null,n=!1,y=null,h=Q(this,O,t),S=a.dragOptions||{},T={},f=c.dragEvents.start,_=c.dragEvents.stop,v=c.dragEvents.drag,M=c.dragEvents.beforeStart,g,u=function(F){g=F.e.payload||{}},m=function(F){b=this.connectorSelector();let i=!0;this.isEnabled()||(i=!1),b==null&&!this.isSource&&!this.isTemporarySource&&(i=!1),this.isSource&&this.isFull()&&!(b!=null&&this.dragAllowedWhenFull)&&(i=!1),b!=null&&!b.isDetachable(this)&&(this.isFull()?i=!1:b=null);let e=t.checkCondition(b==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:b});if(e===!1?i=!1:typeof e=="object"?c.extend(e,g||{}):e=g||{},i===!1)return t.stopDrag&&t.stopDrag(this.canvas),h.stopDrag(),!1;for(let V=0;V<this.connections.length;V++)this.connections[V].setHover(!1);this.addClass("endpointDrag"),t.setConnectionBeingDragged(!0),b&&!this.isFull()&&this.isSource&&(b=null),t.updateOffset({elId:this.elementId});let d=this._jsPlumb.instance.getOffset(this.canvas),C=this.canvas,w=this._jsPlumb.instance.getSize(this.canvas);J(O,t,d,w),t.setAttributes(this.canvas,{dragId:O.id,elId:this.elementId});let B=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){let V=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);V.endpoints[1]&&(B=V.endpoints[1])}let z=this._jsPlumb.instance.makeAnchor("Center");z.isFloating=!0,this._jsPlumb.floatingEndpoint=W(this.getPaintStyle(),z,B,this.canvas,O.element,t,x,this.scope);let Y=this._jsPlumb.floatingEndpoint.anchor;if(b==null)this.setHover(!1,!1),b=p({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:O.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:a.connectorStyle,hoverPaintStyle:a.connectorHoverStyle,connector:a.connector,overlays:a.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:a.scope,data:e}),b.pending=!0,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.anchor=Y,t.fire("connectionDrag",b),t.anchorManager.newConnection(b);else{n=!0,b.setHover(!1);let V=b.endpoints[0].id===this.id?0:1;this.detachFromConnection(b,null,!0);let ot=t.getDragScope(C);t.setAttribute(this.canvas,"originalScope",ot),t.fire("connectionDrag",b),V===0?(y=[b.source,b.sourceId,C,ot],t.anchorManager.sourceChanged(b.endpoints[V].elementId,O.id,b,O.element)):(y=[b.target,b.targetId,C,ot],b.target=O.element,b.targetId=O.id,t.anchorManager.updateOtherEndpoint(b.sourceId,b.endpoints[V].elementId,b.targetId,b)),b.suspendedEndpoint=b.endpoints[V],b.suspendedElement=b.endpoints[V].getElement(),b.suspendedElementId=b.endpoints[V].elementId,b.suspendedElementType=V===0?"source":"target",b.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=b.suspendedEndpoint,b.endpoints[V]=this._jsPlumb.floatingEndpoint,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass)}t.registerFloatingConnection(O,b,this._jsPlumb.floatingEndpoint),t.currentlyDragging=!0}.bind(this),A=function(){if(t.setConnectionBeingDragged(!1),b&&b.endpoints!=null){let F=t.getDropEvent(arguments),i=t.getFloatingAnchorIndex(b);if(b.endpoints[i===0?1:0].anchor.unlock(),b.removeClass(t.draggingClass),this._jsPlumb&&(b.deleteConnectionNow||b.endpoints[i]===this._jsPlumb.floatingEndpoint)&&n&&b.suspendedEndpoint){i===0?(b.floatingElement=b.source,b.floatingId=b.sourceId,b.floatingEndpoint=b.endpoints[0],b.floatingIndex=0,b.source=y[0],b.sourceId=y[1]):(b.floatingElement=b.target,b.floatingId=b.targetId,b.floatingEndpoint=b.endpoints[1],b.floatingIndex=1,b.target=y[0],b.targetId=y[1]);let e=this._jsPlumb.floatingEndpoint;t.setDragScope(y[2],y[3]),b.endpoints[i]=b.suspendedEndpoint,b.isReattach()||b._forceReattach||b._forceDetach||!t.deleteConnection(b,{originalEvent:F})?(b.setHover(!1),b._forceDetach=null,b._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(b),b.suspendedEndpoint.addConnection(b),i===1?t.anchorManager.updateOtherEndpoint(b.sourceId,b.floatingId,b.targetId,b):t.anchorManager.sourceChanged(b.floatingId,b.sourceId,b,b.source),t.repaint(y[1])):t.deleteObject({endpoint:e})}this.deleteAfterDragStop?t.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),t.fire("connectionDragStop",b,F),b.pending&&t.fire("connectionAborted",b,F),t.currentlyDragging=!1,b.suspendedElement=null,b.suspendedEndpoint=null,b=null}O&&O.element&&t.remove(O.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.unlock(),this._jsPlumb.floatingEndpoint=null)}.bind(this);S=c.extend(T,S),S.scope=this.scope||S.scope,S[M]=H.wrap(S[M],u,!1),S[f]=H.wrap(S[f],m,!1),S[v]=H.wrap(S[v],h.drag),S[_]=H.wrap(S[_],A),S.multipleDrop=!1,S.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this),t.initDraggable(this.canvas,S,"internal"),this.canvas._jsPlumbRelatedElement=this.element,s=!0}};let l=a.endpoint||this._jsPlumb.instance.Defaults.Endpoint||c.Defaults.Endpoint;this.setEndpoint(l,!0);let N=a.anchor?a.anchor:a.anchors?a.anchors:t.Defaults.Anchor||"Top";this.setAnchor(N,!0);let R=["default",a.type||""].join(" ");this.addType(R,a.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();let U=function(O,b,n,y){if(c.isDropSupported(this.element)){let h=a.dropOptions||t.Defaults.DropOptions||c.Defaults.DropOptions;h=c.extend({},h),h.scope=h.scope||this.scope;let S=c.dragEvents.drop,T=c.dragEvents.over,f=c.dragEvents.out,_=this,v=t.EndpointDropHandler({getEndpoint:function(){return _},jsPlumb:t,enabled:function(){return n!=null?n.isEnabled():!0},isFull:function(){return n.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(M){_.addClass(M)},removeClass:function(M){_.removeClass(M)},isDropAllowed:function(){return _.isDropAllowed.apply(_,arguments)},reference:y,isRedrop:function(M,g){return M.suspendedEndpoint&&g.reference&&M.suspendedEndpoint.id===g.reference.id}});h[S]=H.wrap(h[S],v,!0),h[T]=H.wrap(h[T],function(){let M=c.getDragObject(arguments),g=t.getAttribute(c.getElement(M),"dragId"),u=t.getFloatingConnectionFor(g);if(u!=null){let m=t.getFloatingAnchorIndex(u);if(this.isTarget&&m!==0||u.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===u.suspendedEndpoint.id){let F=t.checkCondition("checkDropAllowed",{sourceEndpoint:u.endpoints[m],targetEndpoint:this,connection:u});this[(F?"add":"remove")+"Class"](t.endpointDropAllowedClass),this[(F?"remove":"add")+"Class"](t.endpointDropForbiddenClass),u.endpoints[m].anchor.over(this.anchor,this)}}}.bind(this)),h[f]=H.wrap(h[f],function(){let M=c.getDragObject(arguments),g=M==null?null:t.getAttribute(c.getElement(M),"dragId"),u=g?t.getFloatingConnectionFor(g):null;if(u!=null){let m=t.getFloatingAnchorIndex(u);(this.isTarget&&m!==0||u.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===u.suspendedEndpoint.id)&&(this.removeClass(t.endpointDropAllowedClass),this.removeClass(t.endpointDropForbiddenClass),u.endpoints[m].anchor.out())}}.bind(this)),t.initDroppable(O,h,"internal",b)}}.bind(this);return this.anchor.isFloating||U(this.canvas,!(a._transient||this.anchor.isFloating),this,a.reference),this},H.extend(c.Endpoint,c.OverlayCapableJsPlumbUIComponent,{setVisible:function(a,t,p){if(this._jsPlumb.visible=a,this.canvas&&(this.canvas.style.display=a?"block":"none"),this[a?"showOverlays":"hideOverlays"](),!t){for(let x=0;x<this.connections.length;x++)if(this.connections[x].setVisible(a),!p){let j=this===this.connections[x].endpoints[0]?1:0;this.connections[x].endpoints[j].connections.length===1&&this.connections[x].endpoints[j].setVisible(a,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(a,t){this.setPaintStyle(a.endpointStyle||a.paintStyle,t),this.setHoverPaintStyle(a.endpointHoverStyle||a.hoverPaintStyle,t),a.maxConnections!=null&&(this._jsPlumb.maxConnections=a.maxConnections),a.scope&&(this.scope=a.scope),c.extend(this,a,r),a.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,a.cssClass),c.OverlayCapableJsPlumbUIComponent.applyType(this,a)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(a){this._jsPlumb.enabled=a},cleanup:function(){let a=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");c.removeClass(this.element,a),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(a){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(a)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(a){let t=!1;if(a){for(let p=0;p<this.connections.length;p++)if(this.connections[p].endpoints[1]===a||this.connections[p].endpoints[0]===a){t=!0;break}}return t},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(a){this._jsPlumb.connectionCost=a},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(a){this._jsPlumb.connectionsDirected=a},setElementId:function(a){this.elementId=a,this.anchor.elementId=a},setReferenceElement:function(a){this.element=c.getElement(a)},setDragAllowedWhenFull:function(a){this.dragAllowedWhenFull=a},equals:function(a){return this.anchor.equals(a.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(a){return this.anchor.compute(a)}}),X.jsPlumbInstance.prototype.EndpointDropHandler=function(a){return function(t){let p=a.jsPlumb;a.removeClass(p.endpointDropAllowedClass),a.removeClass(p.endpointDropForbiddenClass);let x=p.getDropEvent(arguments),j=p.getDragObject(arguments),D=p.getAttribute(j,"dragId");p.getAttribute(j,"elId");let I=p.getAttribute(j,"originalScope"),s=p.getFloatingConnectionFor(D);if(s==null)return;let l=s.suspendedEndpoint!=null;if(l&&s.suspendedEndpoint._jsPlumb==null)return;let N=a.getEndpoint(s);if(N==null)return;if(a.isRedrop(s,a)){s._forceReattach=!0,s.setHover(!1),a.maybeCleanup&&a.maybeCleanup(N);return}let R=p.getFloatingAnchorIndex(s);if(R===0&&!a.isSource||R===1&&!a.isTarget){a.maybeCleanup&&a.maybeCleanup(N);return}a.onDrop&&a.onDrop(s),I&&p.setDragScope(j,I);let U=a.isFull(t);if(U&&N.fire("maxConnections",{endpoint:this,connection:s,maxConnections:N._jsPlumb.maxConnections},x),!U&&a.enabled()){let O=!0;R===0?(s.floatingElement=s.source,s.floatingId=s.sourceId,s.floatingEndpoint=s.endpoints[0],s.floatingIndex=0,s.source=a.element,s.sourceId=a.elementId):(s.floatingElement=s.target,s.floatingId=s.targetId,s.floatingEndpoint=s.endpoints[1],s.floatingIndex=1,s.target=a.element,s.targetId=a.elementId),l&&s.suspendedEndpoint.id!==N.id&&(!s.isDetachAllowed(s)||!s.endpoints[R].isDetachAllowed(s)||!s.suspendedEndpoint.isDetachAllowed(s)||!p.checkCondition("beforeDetach",s))&&(O=!1);let b=function(y){s.endpoints[R].detachFromConnection(s),s.suspendedEndpoint&&s.suspendedEndpoint.detachFromConnection(s),s.endpoints[R]=N,N.addConnection(s);let h=N.getParameters();for(let S in h)s.setParameter(S,h[S]);if(!l)h.draggable&&p.initDraggable(this.element,a.dragOptions,"internal",p);else{let S=s.suspendedEndpoint.elementId;p.fireMoveEvent({index:R,originalSourceId:R===0?S:s.sourceId,newSourceId:R===0?N.elementId:s.sourceId,originalTargetId:R===1?S:s.targetId,newTargetId:R===1?N.elementId:s.targetId,originalSourceEndpoint:R===0?s.suspendedEndpoint:s.endpoints[0],newSourceEndpoint:R===0?N:s.endpoints[0],originalTargetEndpoint:R===1?s.suspendedEndpoint:s.endpoints[1],newTargetEndpoint:R===1?N:s.endpoints[1],connection:s},x)}R===1?p.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):p.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),s.endpoints[0].finalEndpoint&&(s.endpoints[0].detachFromConnection(s),s.endpoints[0]=s.endpoints[0].finalEndpoint,s.endpoints[0].addConnection(s)),H.isObject(y)&&s.mergeData(y),p.finaliseConnection(s,null,x,!1),s.setHover(!1),p.revalidate(s.endpoints[0].element)}.bind(this),n=function(){s.suspendedEndpoint&&(s.endpoints[R]=s.suspendedEndpoint,s.setHover(!1),s._forceDetach=!0,R===0?(s.source=s.suspendedEndpoint.element,s.sourceId=s.suspendedEndpoint.elementId):(s.target=s.suspendedEndpoint.element,s.targetId=s.suspendedEndpoint.elementId),s.suspendedEndpoint.addConnection(s),R===1?p.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):p.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),p.repaint(s.sourceId),s._forceDetach=!1)};if(O=O&&a.isDropAllowed(s.sourceId,s.targetId,s.scope,s,N),O)return b(O),!0;n()}a.maybeCleanup&&a.maybeCleanup(N),p.currentlyDragging=!1}}}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=function(r,E,a,t,p){if(c.Connectors[E]=c.Connectors[E]||{},c.Connectors[E][a]==null){if(c.Connectors[a]==null){if(r.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+a+"'")}c.Connectors[E][a]=function(){c.Connectors[a].apply(this,arguments),c.ConnectorRenderers[E].apply(this,arguments)},H.extend(c.Connectors[E][a],[c.Connectors[a],c.ConnectorRenderers[E]])}return new c.Connectors[E][a](t,p)},J=function(r,E,a){return r?a.makeAnchor(r,E,a):null},W=function(r,E,a,t){E!=null&&(E._jsPlumbConnections=E._jsPlumbConnections||{},t?delete E._jsPlumbConnections[r.id]:E._jsPlumbConnections[r.id]=!0,H.isEmpty(E._jsPlumbConnections)?a.removeClass(E,a.connectedClass):a.addClass(E,a.connectedClass))};c.Connection=function(r){let E=r.newEndpoint;this.id=r.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=r.previousConnection,this.source=c.getElement(r.source),this.target=c.getElement(r.target),c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),r.sourceEndpoint?(this.source=r.sourceEndpoint.getElement(),this.sourceId=r.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),r.targetEndpoint?(this.target=r.targetEndpoint.getElement(),this.targetId=r.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=r.scope,this.endpoints=[],this.endpointStyles=[];let a=this._jsPlumb.instance;a.manage(this.sourceId,this.source),a.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:r.cssClass,container:r.container,"pointer-events":r["pointer-events"],editorParams:r.editorParams,overlays:r.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(N,R,U,O,b){return U=U||this._jsPlumb.instance.getId(R),this.prepareEndpoint(a,E,this,O,N?0:1,r,R,U,b)},r.type&&(r.endpoints=r.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(r.type).endpoints);let t=this.makeEndpoint(!0,this.source,this.sourceId,r.sourceEndpoint),p=this.makeEndpoint(!1,this.target,this.targetId,r.targetEndpoint);t&&H.addToList(r.endpointsByElement,this.sourceId,t),p&&H.addToList(r.endpointsByElement,this.targetId,p),this.scope||(this.scope=this.endpoints[0].scope),r.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(r.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(r.deleteEndpointsOnEmpty));let x=a.Defaults.ConnectionsDetachable;r.detachable===!1&&(x=!1),this.endpoints[0].connectionsDetachable===!1&&(x=!1),this.endpoints[1].connectionsDetachable===!1&&(x=!1);let j=r.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||a.Defaults.ReattachConnections;this.appendToDefaultType({detachable:x,reattach:j,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||r.paintStyle||a.Defaults.PaintStyle||c.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||r.hoverPaintStyle||a.Defaults.HoverPaintStyle||c.Defaults.HoverPaintStyle});let D=a.getSuspendedAt();if(!a.isSuspendDrawing()){let N=a.getCachedData(this.sourceId),R=N.o,U=N.s,O=a.getCachedData(this.targetId),b=O.o,n=O.s,y=D||a.timestamp(),h=this.endpoints[0].anchor.compute({xy:[R.left,R.top],wh:U,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[b.left,b.top],twh:n,tElement:this.endpoints[1],timestamp:y});this.endpoints[0].paint({anchorLoc:h,timestamp:y}),h=this.endpoints[1].anchor.compute({xy:[b.left,b.top],wh:n,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[R.left,R.top],twh:U,tElement:this.endpoints[0],timestamp:y}),this.endpoints[1].paint({anchorLoc:h,timestamp:y})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(N){return this._jsPlumb.detachable===!1?!1:N!=null?N.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(N){this._jsPlumb.detachable=N===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(N){this._jsPlumb.reattach=N===!0},this._jsPlumb.cost=r.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=r.directed,r.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());let I=c.extend({},this.endpoints[1].getParameters());c.extend(I,this.endpoints[0].getParameters()),c.extend(I,this.getParameters()),this.setParameters(I),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||r.connector||a.Defaults.Connector||c.Defaults.Connector,!0);let s=r.data==null||!H.isObject(r.data)?{}:r.data;this.getData=function(){return s},this.setData=function(N){s=N||{}},this.mergeData=function(N){s=c.extend(s,N)};let l=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,r.type].join(" ");/[^\s]/.test(l)&&this.addType(l,r.data,!0),this.updateConnectedClass()},H.extend(c.Connection,c.OverlayCapableJsPlumbUIComponent,{applyType:function(r,E,a){let t=null;r.connector!=null&&(t=this.getCachedTypeItem("connector",a.connector),t==null&&(t=this.prepareConnector(r.connector,a.connector),this.cacheTypeItem("connector",t,a.connector)),this.setPreparedConnector(t)),r.detachable!=null&&this.setDetachable(r.detachable),r.reattach!=null&&this.setReattach(r.reattach),r.scope&&(this.scope=r.scope),r.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,r.cssClass);let p=null;r.anchor?(p=this.getCachedTypeItem("anchors",a.anchor),p==null&&(p=[this._jsPlumb.instance.makeAnchor(r.anchor),this._jsPlumb.instance.makeAnchor(r.anchor)],this.cacheTypeItem("anchors",p,a.anchor))):r.anchors&&(p=this.getCachedTypeItem("anchors",a.anchors),p==null&&(p=[this._jsPlumb.instance.makeAnchor(r.anchors[0]),this._jsPlumb.instance.makeAnchor(r.anchors[1])],this.cacheTypeItem("anchors",p,a.anchors))),p!=null&&(this.endpoints[0].anchor=p[0],this.endpoints[1].anchor=p[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),c.OverlayCapableJsPlumbUIComponent.applyType(this,r)},addClass:function(r,E){E&&(this.endpoints[0].addClass(r),this.endpoints[1].addClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(r)),this.connector&&this.connector.addClass(r)},removeClass:function(r,E){E&&(this.endpoints[0].removeClass(r),this.endpoints[1].removeClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(r)),this.connector&&this.connector.removeClass(r)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(r){this._jsPlumb.visible=r,this.connector&&this.connector.setVisible(r),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(r){this._jsPlumb&&(W(this,this.source,this._jsPlumb.instance,r),W(this,this.target,this._jsPlumb.instance,r))},setHover:function(r){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(r),X.jsPlumb[r?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),X.jsPlumb[r?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(r){this._jsPlumb.cost=r},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(r,E){let a={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},t=this._jsPlumb.instance.getRenderMode(),p;return H.isString(r)?p=Q(this._jsPlumb.instance,t,r,a,this):H.isArray(r)&&(r.length===1?p=Q(this._jsPlumb.instance,t,r[0],a,this):p=Q(this._jsPlumb.instance,t,r[0],H.merge(r[1],a),this)),E!=null&&(p.typeId=E),p},setPreparedConnector:function(r,E,a,t){if(this.connector!==r){let p,x="";if(this.connector!=null&&(p=this.connector,x=p.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=r,t&&this.cacheTypeItem("connector",r,t),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(x),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),p!=null){let j=this.getOverlays();for(let D=0;D<j.length;D++)j[D].transfer&&j[D].transfer(this.connector)}a||this.setListenerComponent(this.connector),E||this.repaint()}},setConnector:function(r,E,a,t){let p=this.prepareConnector(r,t);this.setPreparedConnector(p,E,a,t)},paint:function(r){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){r=r||{};let E=r.timestamp,a=this.targetId,t=this.sourceId,p=1,x=0;if(E==null||E!==this._jsPlumb.lastPaintedAt){let j=this._jsPlumb.instance.updateOffset({elId:t}).o,D=this._jsPlumb.instance.updateOffset({elId:a}).o,I=this.endpoints[x],s=this.endpoints[p],l=I.anchor.getCurrentLocation({xy:[j.left,j.top],wh:[j.width,j.height],element:I,timestamp:E}),N=s.anchor.getCurrentLocation({xy:[D.left,D.top],wh:[D.width,D.height],element:s,timestamp:E});this.connector.resetBounds(),this.connector.compute({sourcePos:l,targetPos:N,sourceOrientation:I.anchor.getOrientation(I),targetOrientation:s.anchor.getOrientation(s),sourceEndpoint:this.endpoints[x],targetEndpoint:this.endpoints[p],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:j,targetInfo:D});let R={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(let n in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(n)){let y=this._jsPlumb.overlays[n];y.isVisible()&&(this._jsPlumb.overlayPlacements[n]=y.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(y)),R.minX=Math.min(R.minX,this._jsPlumb.overlayPlacements[n].minX),R.maxX=Math.max(R.maxX,this._jsPlumb.overlayPlacements[n].maxX),R.minY=Math.min(R.minY,this._jsPlumb.overlayPlacements[n].minY),R.maxY=Math.max(R.maxY,this._jsPlumb.overlayPlacements[n].maxY))}let U=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,O=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),b={xmin:Math.min(this.connector.bounds.minX-(U+O),R.minX),ymin:Math.min(this.connector.bounds.minY-(U+O),R.minY),xmax:Math.max(this.connector.bounds.maxX+(U+O),R.maxX),ymax:Math.max(this.connector.bounds.maxY+(U+O),R.maxY)};this.connector.paintExtents=b,this.connector.paint(this._jsPlumb.paintStyleInUse,null,b);for(let n in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(n)){let y=this._jsPlumb.overlays[n];y.isVisible()&&y.paint(this._jsPlumb.overlayPlacements[n],b)}}this._jsPlumb.lastPaintedAt=E}},repaint:function(r){let E=jsPlumb.extend(r||{},{});E.elId=this.sourceId,this.paint(E)},prepareEndpoint:function(r,E,a,t,p,x,j,D,I){let s;if(t)a.endpoints[p]=t,t.addConnection(a);else{x.endpoints||(x.endpoints=[null,null]);let l=I||x.endpoints[p]||x.endpoint||r.Defaults.Endpoints[p]||c.Defaults.Endpoints[p]||r.Defaults.Endpoint||c.Defaults.Endpoint;x.endpointStyles||(x.endpointStyles=[null,null]),x.endpointHoverStyles||(x.endpointHoverStyles=[null,null]);let N=x.endpointStyles[p]||x.endpointStyle||r.Defaults.EndpointStyles[p]||c.Defaults.EndpointStyles[p]||r.Defaults.EndpointStyle||c.Defaults.EndpointStyle;N.fill==null&&x.paintStyle!=null&&(N.fill=x.paintStyle.stroke),N.outlineStroke==null&&x.paintStyle!=null&&(N.outlineStroke=x.paintStyle.outlineStroke),N.outlineWidth==null&&x.paintStyle!=null&&(N.outlineWidth=x.paintStyle.outlineWidth);let R=x.endpointHoverStyles[p]||x.endpointHoverStyle||r.Defaults.EndpointHoverStyles[p]||c.Defaults.EndpointHoverStyles[p]||r.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle;x.hoverPaintStyle!=null&&(R==null&&(R={}),R.fill==null&&(R.fill=x.hoverPaintStyle.stroke));let U=x.anchors?x.anchors[p]:x.anchor?x.anchor:J(r.Defaults.Anchors[p],D,r)||J(c.Defaults.Anchors[p],D,r)||J(r.Defaults.Anchor,D,r)||J(c.Defaults.Anchor,D,r),O=x.uuids?x.uuids[p]:null;s=E({paintStyle:N,hoverPaintStyle:R,endpoint:l,connections:[a],uuid:O,anchor:U,source:j,scope:x.scope,reattach:x.reattach||r.Defaults.ReattachConnections,detachable:x.detachable||r.Defaults.ConnectionsDetachable}),t==null&&s.setDeleteOnEmpty(!0),a.endpoints[p]=s,x.drawEndpoints===!1&&s.setVisible(!1,!0,!0)}return s},replaceEndpoint:function(r,E){let a=this.endpoints[r],t=a.elementId,p=this._jsPlumb.instance.getEndpoints(t),x=p.indexOf(a),j=this.makeEndpoint(r===0,a.element,t,null,E);this.endpoints[r]=j,p.splice(x,1,j),this._jsPlumb.instance.deleteObject({endpoint:a,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:a,current:j}),this._jsPlumb.instance.anchorManager.updateOtherEndpoint(this.endpoints[0].elementId,this.endpoints[1].elementId,this.endpoints[1].elementId,this)}})}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumbUtil,H=X.jsPlumb;H.AnchorManager=function(r){let E={},a={},t={},p={},x=this,j={},D=r.jsPlumbInstance,I={},s=function(h,S,T,f,_,v,M){let g=[],u=S[_?0:1]/(f.length+1);for(let m=0;m<f.length;m++){let A=(m+1)*u,F=v*S[_?1:0];M&&(A=S[_?0:1]-A);let i=_?A:F,e=T[0]+i,d=i/S[0],C=_?F:A,w=T[1]+C,B=C/S[1];g.push([e,w,d,B,f[m][1],f[m][2]])}return g},l=function(h){return function(S,T){let f=!0;return h?f=S[0][0]<T[0][0]:f=S[0][0]>T[0][0],f===!1?-1:1}},N=function(h,S){let T=h[0][0]<0?-Math.PI-h[0][0]:Math.PI-h[0][0],f=S[0][0]<0?-Math.PI-S[0][0]:Math.PI-S[0][0];return T>f?1:-1},R={top:function(h,S){return h[0]>S[0]?1:-1},right:l(!0),bottom:l(!0),left:N},U=function(h,S){return h.sort(S)},O=function(h,S){let T=D.getCachedData(h),f=T.s,_=T.o,v=function(M,g,u,m,A,F,i){if(m.length>0){let e=U(m,R[M]),d=M==="right"||M==="top",C=s(M,g,u,e,A,F,d),w=function(B,z){a[B.id]=[z[0],z[1],z[2],z[3]],t[B.id]=i};for(let B=0;B<C.length;B++){let z=C[B][4],Y=z.endpoints[0].elementId===h,V=z.endpoints[1].elementId===h;Y&&w(z.endpoints[0],C[B]),V&&w(z.endpoints[1],C[B])}}};v("bottom",f,[_.left,_.top],S.bottom,!0,1,[0,1]),v("top",f,[_.left,_.top],S.top,!0,0,[0,-1]),v("left",f,[_.left,_.top],S.left,!1,0,[-1,0]),v("right",f,[_.left,_.top],S.right,!1,1,[1,0])};this.reset=function(){E={},p={},j={}},this.addFloatingConnection=function(h,S){I[h]=S},this.removeFloatingConnection=function(h){delete I[h]},this.newConnection=function(h){let S=h.sourceId,T=h.targetId,f=h.endpoints,_=!0,v=function(M,g,u,m,A){S===T&&u.isContinuous&&(h._jsPlumb.instance.removeElement(f[1].canvas),_=!1),c.addToList(p,m,[A,g,u.constructor===H.DynamicAnchor])};v(0,f[0],f[0].anchor,T,h),_&&v(1,f[1],f[1].anchor,S,h)};let b=function(h){(function(S,T){if(S){let f=function(_){return _[4]===T};c.removeWithFunction(S.top,f),c.removeWithFunction(S.left,f),c.removeWithFunction(S.bottom,f),c.removeWithFunction(S.right,f)}})(j[h.elementId],h.id)};this.connectionDetached=function(h,S){let T=h.connection||h,f=h.sourceId,_=h.targetId,v=T.endpoints,M=function(g,u,m,A,F){c.removeWithFunction(p[A],function(i){return i[0].id===F.id})};M(1,v[1],v[1].anchor,f,T),M(0,v[0],v[0].anchor,_,T),T.floatingId&&(M(T.floatingIndex,T.floatingEndpoint,T.floatingEndpoint.anchor,T.floatingId,T),b(T.floatingEndpoint)),b(T.endpoints[0]),b(T.endpoints[1]),S||(x.redraw(T.sourceId),T.targetId!==T.sourceId&&x.redraw(T.targetId))},this.add=function(h,S){c.addToList(E,S,h)},this.changeId=function(h,S){p[S]=p[h],E[S]=E[h],delete p[h],delete E[h]},this.getConnectionsFor=function(h){return p[h]||[]},this.getEndpointsFor=function(h){return E[h]||[]},this.deleteEndpoint=function(h){c.removeWithFunction(E[h.elementId],function(S){return S.id===h.id}),b(h)},this.clearFor=function(h){delete E[h],E[h]=[]};let n=function(h,S,T,f,_,v,M,g,u,m,A,F){let i=-1,e=f.endpoints[M],d=e.id,C=[1,0][M],w=[[S,T],f,_,v,d],B=h[u],z=e._continuousAnchorEdge?h[e._continuousAnchorEdge]:null,Y,V;if(z){let ot=c.findWithFunction(z,function(ct){return ct[4]===d});if(ot!==-1)for(z.splice(ot,1),Y=0;Y<z.length;Y++)V=z[Y][1],c.addWithFunction(A,V,function(ct){return ct.id===V.id}),c.addWithFunction(F,z[Y][1].endpoints[M],function(ct){return ct.id===V.endpoints[M].id}),c.addWithFunction(F,z[Y][1].endpoints[C],function(ct){return ct.id===V.endpoints[C].id})}for(Y=0;Y<B.length;Y++)V=B[Y][1],r.idx===1&&B[Y][3]===v&&i===-1&&(i=Y),c.addWithFunction(A,V,function(ot){return ot.id===V.id}),c.addWithFunction(F,B[Y][1].endpoints[M],function(ot){return ot.id===V.endpoints[M].id}),c.addWithFunction(F,B[Y][1].endpoints[C],function(ot){return ot.id===V.endpoints[C].id});{let ot=g?i!==-1?i:0:B.length;B.splice(ot,0,w)}e._continuousAnchorEdge=u};this.updateOtherEndpoint=function(h,S,T,f){let _=c.findWithFunction(p[h],function(M){return M[0].id===f.id}),v=c.findWithFunction(p[S],function(M){return M[0].id===f.id});_!==-1&&(p[h][_][0]=f,p[h][_][1]=f.endpoints[1],p[h][_][2]=f.endpoints[1].anchor.constructor===H.DynamicAnchor),v>-1&&(p[S].splice(v,1),c.addToList(p,T,[f,f.endpoints[0],f.endpoints[0].anchor.constructor===H.DynamicAnchor])),f.updateConnectedClass()},this.sourceChanged=function(h,S,T,f){if(h!==S){T.sourceId=S,T.source=f,c.removeWithFunction(p[h],function(v){return v[0].id===T.id});let _=c.findWithFunction(p[T.targetId],function(v){return v[0].id===T.id});_>-1&&(p[T.targetId][_][0]=T,p[T.targetId][_][1]=T.endpoints[0],p[T.targetId][_][2]=T.endpoints[0].anchor.constructor===H.DynamicAnchor),c.addToList(p,S,[T,T.endpoints[1],T.endpoints[1].anchor.constructor===H.DynamicAnchor]),T.endpoints[1].anchor.isContinuous&&(T.source===T.target?T._jsPlumb.instance.removeElement(T.endpoints[1].canvas):T.endpoints[1].canvas.parentNode==null&&T._jsPlumb.instance.appendElement(T.endpoints[1].canvas)),T.updateConnectedClass()}},this.rehomeEndpoint=function(h,S,T){let f=E[S]||[],_=D.getId(T);if(_!==S){let v=f.indexOf(h);if(v>-1){let M=f.splice(v,1)[0];x.add(M,_)}}for(let v=0;v<h.connections.length;v++)h.connections[v].sourceId===S?x.sourceChanged(S,h.elementId,h.connections[v],h.element):h.connections[v].targetId===S&&(h.connections[v].targetId=h.elementId,h.connections[v].target=h.element,x.updateOtherEndpoint(h.connections[v].sourceId,S,h.elementId,h.connections[v]))},this.redraw=function(h,S,T,f,_,v){if(!D.isSuspendDrawing()){let B=E[h]||[],z=p[h]||[],Y=[],V=[],ot=[];T=T||D.timestamp(),f=f||{left:0,top:0},S&&(S={left:S.left+f.left,top:S.top+f.top});let ct=D.updateOffset({elId:h,offset:S,recalc:!1,timestamp:T}),pt={};for(var M=0;M<z.length;M++){var g=z[M][0],u=g.sourceId,m=g.targetId,A=g.endpoints[0].anchor.isContinuous,F=g.endpoints[1].anchor.isContinuous;if(A||F){var i=u+"_"+m,e=pt[i],d=g.sourceId===h?1:0;A&&!j[u]&&(j[u]={top:[],right:[],bottom:[],left:[]}),F&&!j[m]&&(j[m]={top:[],right:[],bottom:[],left:[]}),h!==m&&D.updateOffset({elId:m,timestamp:T}),h!==u&&D.updateOffset({elId:u,timestamp:T});let rt=D.getCachedData(m),ft=D.getCachedData(u);m===u&&(A||F)?(n(j[u],-Math.PI/2,0,g,!1,m,0,!1,"top",u,Y,V),n(j[m],-Math.PI/2,0,g,!1,u,1,!1,"top",m,Y,V)):(e||(e=this.calculateOrientation(u,m,ft.o,rt.o,g.endpoints[0].anchor,g.endpoints[1].anchor,g),pt[i]=e),A&&n(j[u],e.theta,0,g,!1,m,0,!1,e.a[0],u,Y,V),F&&n(j[m],e.theta2,-1,g,!0,u,1,!0,e.a[1],m,Y,V)),A&&c.addWithFunction(ot,u,function(ut){return ut===u}),F&&c.addWithFunction(ot,m,function(ut){return ut===m}),c.addWithFunction(Y,g,function(ut){return ut.id===g.id}),(A&&d===0||F&&d===1)&&c.addWithFunction(V,g.endpoints[d],function(ut){return ut.id===g.endpoints[d].id})}}for(M=0;M<B.length;M++)B[M].connections.length===0&&B[M].anchor.isContinuous&&(j[h]||(j[h]={top:[],right:[],bottom:[],left:[]}),n(j[h],-Math.PI/2,0,{endpoints:[B[M],B[M]],paint:function(){}},!1,h,0,!1,B[M].anchor.getDefaultFace(),h,Y,V),c.addWithFunction(ot,h,function(rt){return rt===h}));for(M=0;M<ot.length;M++)O(ot[M],j[ot[M]]);for(M=0;M<B.length;M++)B[M].paint({timestamp:T,offset:ct,dimensions:ct.s,recalc:v!==!0});for(M=0;M<V.length;M++){let rt=D.getCachedData(V[M].elementId);V[M].paint({timestamp:null,offset:rt,dimensions:rt.s})}for(M=0;M<z.length;M++){var C=z[M][1];if(C.anchor.constructor===H.DynamicAnchor){C.paint({elementWithPrecedence:h,timestamp:T}),c.addWithFunction(Y,z[M][0],function(rt){return rt.id===z[M][0].id});for(var w=0;w<C.connections.length;w++)C.connections[w]!==z[M][0]&&c.addWithFunction(Y,C.connections[w],function(rt){return rt.id===C.connections[w].id})}else c.addWithFunction(Y,z[M][0],function(rt){return rt.id===z[M][0].id})}let $=I[h];for($&&$.paint({timestamp:T,recalc:!1,elId:h}),M=0;M<Y.length;M++)Y[M].paint({elId:h,timestamp:null,recalc:!1,clearEdits:_})}};let y=function(h){c.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;let S=h.faces||["top","right","bottom","left"],T=h.clockwise!==!1,f={},_={top:"bottom",right:"left",left:"right",bottom:"top"},v={top:"right",right:"bottom",left:"top",bottom:"left"},M={top:"left",right:"top",left:"bottom",bottom:"right"},g=T?v:M,u=T?M:v,m=h.cssClass||"",A=null,F=null,i=["left","right"],e=["top","bottom"],d=null;for(let C=0;C<S.length;C++)f[S[C]]=!0;this.getDefaultFace=function(){return S.length===0?"top":S[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(C){return f[C]?C:f[_[C]]?_[C]:f[g[C]]?g[C]:f[u[C]]?u[C]:C},this.isEdgeSupported=function(C){return d==null?F==null?f[C]===!0:F===C:d.indexOf(C)!==-1},this.setCurrentFace=function(C,w){A=C,w&&F!=null&&(F=A)},this.getCurrentFace=function(){return A},this.getSupportedFaces=function(){let C=[];for(let w in f)f[w]&&C.push(w);return C},this.lock=function(){F=A},this.unlock=function(){F=null},this.isLocked=function(){return F!=null},this.lockCurrentAxis=function(){A!=null&&(d=A==="left"||A==="right"?i:e)},this.unlockCurrentAxis=function(){d=null},this.compute=function(C){return a[C.element.id]||[0,0]},this.getCurrentLocation=function(C){return a[C.element.id]||[0,0]},this.getOrientation=function(C){return t[C.id]||[0,0]},this.getCssClass=function(){return m}};D.continuousAnchorFactory={get:function(h){return new y(h)},clear:function(h){delete a[h]}}},H.AnchorManager.prototype.calculateOrientation=function(r,E,a,t,p,x){let j={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},D=["left","top","right","bottom"];if(r===E)return{orientation:j.IDENTITY,a:["top","top"]};let I=Math.atan2(t.centery-a.centery,t.centerx-a.centerx),s=Math.atan2(a.centery-t.centery,a.centerx-t.centerx),l=[],N={};(function(O,b){for(let n=0;n<O.length;n++)N[O[n]]={left:[b[n].left,b[n].centery],right:[b[n].right,b[n].centery],top:[b[n].centerx,b[n].top],bottom:[b[n].centerx,b[n].bottom]}})(["source","target"],[a,t]);for(let O=0;O<D.length;O++)for(let b=0;b<D.length;b++)l.push({source:D[O],target:D[b],dist:Biltong.lineLength(N.source[D[O]],N.target[D[b]])});l.sort(function(O,b){return O.dist<b.dist?-1:O.dist>b.dist?1:0});let R=l[0].source,U=l[0].target;for(let O=0;O<l.length&&(!p.isContinuous||p.isEdgeSupported(l[O].source)?R=l[O].source:R=null,!x.isContinuous||x.isEdgeSupported(l[O].target)?U=l[O].target:U=null,!(R!=null&&U!=null));O++);return p.isContinuous&&p.setCurrentFace(R),x.isContinuous&&x.setCurrentFace(U),{a:[R,U],theta:I,theta2:s}},H.Anchor=function(r){this.x=r.x||0,this.y=r.y||0,this.elementId=r.elementId,this.cssClass=r.cssClass||"",this.userDefinedLocation=null,this.orientation=r.orientation||[0,0],this.lastReturnValue=null,this.offsets=r.offsets||[0,0],this.timestamp=null;let E=r.relocatable!==!1;this.isRelocatable=function(){return E},this.setRelocatable=function(p){E=p};let a=r.snapOnRelocate!==!1;this.isSnapOnRelocate=function(){return a};let t=!1;this.lock=function(){t=!0},this.unlock=function(){t=!1},this.isLocked=function(){return t},c.EventGenerator.apply(this),this.compute=function(p){let x=p.xy,j=p.wh,D=p.timestamp;return p.clearUserDefinedLocation&&(this.userDefinedLocation=null),D&&D===this.timestamp?this.lastReturnValue:(this.userDefinedLocation!=null?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[x[0]+this.x*j[0]+this.offsets[0],x[1]+this.y*j[1]+this.offsets[1],this.x,this.y],this.timestamp=D,this.lastReturnValue)},this.getCurrentLocation=function(p){return p=p||{},this.lastReturnValue==null||p.timestamp!=null&&this.timestamp!==p.timestamp?this.compute(p):this.lastReturnValue},this.setPosition=function(p,x,j,D,I){(!t||I)&&(this.x=p,this.y=x,this.orientation=[j,D],this.lastReturnValue=null)}},c.extend(H.Anchor,c.EventGenerator,{equals:function(r){if(!r)return!1;let E=r.getOrientation(),a=this.getOrientation();return this.x===r.x&&this.y===r.y&&this.offsets[0]===r.offsets[0]&&this.offsets[1]===r.offsets[1]&&a[0]===E[0]&&a[1]===E[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(r){this.userDefinedLocation=r},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),H.FloatingAnchor=function(r){H.Anchor.apply(this,arguments);let E=r.reference,a=r.referenceCanvas,t=H.getSize(a),p=0,x=0,j=null,D=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(I){let s=I.xy,l=[s[0]+t[0]/2,s[1]+t[1]/2];return D=l,l},this.getOrientation=function(I){if(j)return j;{let s=E.getOrientation(I);return[Math.abs(s[0])*p*-1,Math.abs(s[1])*x*-1]}},this.over=function(I,s){j=I.getOrientation(s)},this.out=function(){j=null},this.getCurrentLocation=function(I){return D==null?this.compute(I):D}},c.extend(H.FloatingAnchor,H.Anchor);let Q=function(r,E,a){return r.constructor===H.Anchor?r:E.makeAnchor(r,a,E)};H.DynamicAnchor=function(r){H.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=r.elementId,this.jsPlumbInstance=r.jsPlumbInstance;for(let j=0;j<r.anchors.length;j++)this.anchors[j]=Q(r.anchors[j],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};let E=this.anchors.length>0?this.anchors[0]:null,a=E,t=this,p=function(j,D,I,s,l){let N=s[0]+j.x*l[0],R=s[1]+j.y*l[1],U=s[0]+l[0]/2,O=s[1]+l[1]/2;return Math.sqrt(Math.pow(D-N,2)+Math.pow(I-R,2))+Math.sqrt(Math.pow(U-N,2)+Math.pow(O-R,2))},x=r.selector||function(j,D,I,s,l){let N=I[0]+s[0]/2,R=I[1]+s[1]/2,U=-1,O=1/0;for(let b=0;b<l.length;b++){let n=p(l[b],N,R,j,D);n<O&&(U=b+0,O=n)}return l[U]};this.compute=function(j){let D=j.xy,I=j.wh,s=j.txy,l=j.twh;this.timestamp=j.timestamp;let N=t.getUserDefinedLocation();return N!=null?N:(this.isLocked()||s==null||l==null||(j.timestamp=null,E=x(D,I,s,l,this.anchors),this.x=E.x,this.y=E.y,E!==a&&this.fire("anchorChanged",E),a=E),E.compute(j))},this.getCurrentLocation=function(j){return this.getUserDefinedLocation()||(E!=null?E.getCurrentLocation(j):null)},this.getOrientation=function(j){return E!=null?E.getOrientation(j):[0,0]},this.over=function(j,D){E!=null&&E.over(j,D)},this.out=function(){E!=null&&E.out()},this.setAnchor=function(j){E=j},this.getCssClass=function(){return E&&E.getCssClass()||""},this.setAnchorCoordinates=function(j){let D=jsPlumbUtil.findWithFunction(this.anchors,function(I){return I.x===j[0]&&I.y===j[1]});return D!==-1?(this.setAnchor(this.anchors[D]),!0):!1}},c.extend(H.DynamicAnchor,H.Anchor);let J=function(r,E,a,t,p,x){H.Anchors[p]=function(j){let D=j.jsPlumbInstance.makeAnchor([r,E,a,t,0,0],j.elementId,j.jsPlumbInstance);return D.type=p,x&&x(D,j),D}};J(.5,0,0,-1,"TopCenter"),J(.5,1,0,1,"BottomCenter"),J(0,.5,-1,0,"LeftMiddle"),J(1,.5,1,0,"RightMiddle"),J(.5,0,0,-1,"Top"),J(.5,1,0,1,"Bottom"),J(0,.5,-1,0,"Left"),J(1,.5,1,0,"Right"),J(.5,.5,0,0,"Center"),J(1,0,0,-1,"TopRight"),J(1,1,0,1,"BottomRight"),J(0,0,0,-1,"TopLeft"),J(0,1,0,1,"BottomLeft"),H.Defaults.DynamicAnchors=function(r){return r.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],r.elementId,r.jsPlumbInstance)},H.Anchors.AutoDefault=function(r){let E=r.jsPlumbInstance.makeDynamicAnchor(H.Defaults.DynamicAnchors(r));return E.type="AutoDefault",E};let W=function(r,E){H.Anchors[r]=function(a){let t=a.jsPlumbInstance.makeAnchor(["Continuous",{faces:E}],a.elementId,a.jsPlumbInstance);return t.type=r,t}};H.Anchors.Continuous=function(r){return r.jsPlumbInstance.continuousAnchorFactory.get(r)},W("ContinuousLeft",["left"]),W("ContinuousTop",["top"]),W("ContinuousBottom",["bottom"]),W("ContinuousRight",["right"]),J(0,0,0,0,"Assign",function(r,E){let a=E.position||"Fixed";r.positionFinder=a.constructor===String?E.jsPlumbInstance.AnchorPositionFinders[a]:a,r.constructorParams=E}),X.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(r,E,a){return[(r.left-E.left)/a[0],(r.top-E.top)/a[1]]},Grid:function(r,E,a,t){let p=r.left-E.left,x=r.top-E.top,j=a[0]/t.grid[0],D=a[1]/t.grid[1],I=Math.floor(p/j),s=Math.floor(x/D);return[(I*j+j/2)/a[0],(s*D+D/2)/a[1]]}},H.Anchors.Perimeter=function(r){r=r||{};let E=r.anchorCount||60,a=r.shape;if(!a)throw new Error("no shape supplied to Perimeter Anchor type");let t=function(){let N=.5,R=Math.PI*2/E,U=0,O=[];for(let b=0;b<E;b++){let n=N+N*Math.sin(U),y=N+N*Math.cos(U);O.push([n,y,0,0]),U+=R}return O},p=function(N){let R=E/N.length,U=[],O=function(b,n,y,h,S,T,f){R=E*S;let _=(y-b)/R,v=(h-n)/R;for(let M=0;M<R;M++)U.push([b+_*M,n+v*M,T==null?0:T,f==null?0:f])};for(let b=0;b<N.length;b++)O.apply(null,N[b]);return U},x=function(N){let R=[];for(let U=0;U<N.length;U++)R.push([N[U][0],N[U][1],N[U][2],N[U][3],1/N.length,N[U][4],N[U][5]]);return p(R)},j=function(){return x([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},D={Circle:t,Ellipse:t,Diamond:function(){return x([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:j,Square:j,Triangle:function(){return x([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(N){let R=N.points,U=[],O=0;for(let b=0;b<R.length-1;b++){let n=Math.sqrt(Math.pow(R[b][2]-R[b][0])+Math.pow(R[b][3]-R[b][1]));O+=n,U.push([R[b][0],R[b][1],R[b+1][0],R[b+1][1],n])}for(let b=0;b<U.length;b++)U[b][4]=U[b][4]/O;return p(U)}},I=function(N,R){let U=[],O=R/180*Math.PI;for(let b=0;b<N.length;b++){let n=N[b][0]-.5,y=N[b][1]-.5;U.push([.5+(n*Math.cos(O)-y*Math.sin(O)),.5+(n*Math.sin(O)+y*Math.cos(O)),N[b][2],N[b][3]])}return U};if(!D[a])throw new Error("Shape ["+a+"] is unknown by Perimeter Anchor type");let s=D[a](r);r.rotation&&(s=I(s,r.rotation));let l=r.jsPlumbInstance.makeDynamicAnchor(s);return l.type="Perimeter",l}}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=X.Biltong;c.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(p,x){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}},this.lineIntersection=function(p,x,j,D){return[]},this.boxIntersection=function(p,x,j,D){let I=[];return I.push.apply(I,this.lineIntersection(p,x,p+j,x)),I.push.apply(I,this.lineIntersection(p+j,x,p+j,x+D)),I.push.apply(I,this.lineIntersection(p+j,x+D,p,x+D)),I.push.apply(I,this.lineIntersection(p,x+D,p,x)),I},this.boundingBoxIntersection=function(p){return this.boxIntersection(p.x,p.y,p.w,p.y)}},Straight:function(t){c.Segments.AbstractSegment.apply(this,arguments);let p,x,j,D,I,s,l,N=function(){p=Math.sqrt(Math.pow(I-D,2)+Math.pow(l-s,2)),x=Q.gradient({x:D,y:s},{x:I,y:l}),j=-1/x};this.type="Straight",this.getLength=function(){return p},this.getGradient=function(){return x},this.getCoordinates=function(){return{x1:D,y1:s,x2:I,y2:l}},this.setCoordinates=function(n){D=n.x1,s=n.y1,I=n.x2,l=n.y2,N()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(D,I),minY:Math.min(s,l),maxX:Math.max(D,I),maxY:Math.max(s,l)}},this.pointOnPath=function(n,y){if(n===0&&!y)return{x:D,y:s};if(n===1&&!y)return{x:I,y:l};{let h=y?n>0?n:p+n:n*p;return Q.pointOnLine({x:D,y:s},{x:I,y:l},h)}},this.gradientAtPoint=function(n){return x},this.pointAlongPathFrom=function(n,y,h){let S=this.pointOnPath(n,h),T=y<=0?{x:D,y:s}:{x:I,y:l};return y<=0&&Math.abs(y)>1&&(y*=-1),Q.pointOnLine(S,T,y)};let R=function(n,y,h){return h>=Math.min(n,y)&&h<=Math.max(n,y)},U=function(n,y,h){return Math.abs(h-n)<Math.abs(h-y)?n:y};this.findClosestPointOnPath=function(n,y){let h={d:1/0,x:null,y:null,l:null,x1:D,x2:I,y1:s,y2:l};if(x===0)h.y=s,h.x=R(D,I,n)?n:U(D,I,n);else if(x===1/0||x===-1/0)h.x=D,h.y=R(s,l,y)?y:U(s,l,y);else{let T=s-x*D,f=y-j*n,_=(f-T)/(x-j),v=x*_+T;h.x=R(D,I,_)?_:U(D,I,_),h.y=R(s,l,v)?v:U(s,l,v)}let S=Q.lineLength([h.x,h.y],[D,s]);return h.d=Q.lineLength([n,y],[h.x,h.y]),h.l=S/p,h};let O=function(n,y,h){return h>y?y<=n&&n<=h:y>=n&&n>=h},b=O;this.lineIntersection=function(n,y,h,S){let T=Math.abs(Q.gradient({x:n,y},{x:h,y:S})),f=Math.abs(x),_=f===1/0?D:s-f*D,v=[],M=T===1/0?n:y-T*n;if(T!==f)if(T===1/0&&f===0)b(n,D,I)&&b(s,y,S)&&(v=[n,s]);else if(T===0&&f===1/0)b(y,s,l)&&b(D,n,h)&&(v=[D,y]);else{let g,u;T===1/0?(g=n,b(g,D,I)&&(u=f*n+_,b(u,y,S)&&(v=[g,u]))):T===0?(u=y,b(u,s,l)&&(g=(y-_)/f,b(g,n,h)&&(v=[g,u]))):(g=(M-_)/(f-T),u=f*g+_,b(g,D,I)&&b(u,s,l)&&(v=[g,u]))}return v},this.boxIntersection=function(n,y,h,S){let T=[];return T.push.apply(T,this.lineIntersection(n,y,n+h,y)),T.push.apply(T,this.lineIntersection(n+h,y,n+h,y+S)),T.push.apply(T,this.lineIntersection(n+h,y+S,n,y+S)),T.push.apply(T,this.lineIntersection(n,y+S,n,y)),T},this.boundingBoxIntersection=function(n){return this.boxIntersection(n.x,n.y,n.w,n.h)}},Arc:function(t){c.Segments.AbstractSegment.apply(this,arguments);var p=function(U,O){return Q.theta([t.cx,t.cy],[U,O])},x=function(U,O){if(U.anticlockwise){let b=U.startAngle<U.endAngle?U.startAngle+j:U.startAngle,n=Math.abs(b-U.endAngle);return b-n*O}else{let b=U.endAngle<U.startAngle?U.endAngle+j:U.endAngle,n=Math.abs(b-U.startAngle);return U.startAngle+n*O}},j=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=p(t.x1,t.y1),this.endAngle=p(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=j),this.startAngle<0&&(this.startAngle+=j);let D=this.endAngle<this.startAngle?this.endAngle+j:this.endAngle;this.sweep=Math.abs(D-this.startAngle),this.anticlockwise&&(this.sweep=j-this.sweep);let I=2*Math.PI*this.radius,s=this.sweep/j,l=I*s;this.getLength=function(){return l},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};let N=1e-10,R=function(U){let O=Math.floor(U),b=Math.ceil(U);return U-O<N?O:b-U<N?b:U};this.pointOnPath=function(U,O){if(U===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(U===1)return{x:this.x2,y:this.y2,theta:this.endAngle};O&&(U=U/l);let b=x(this,U),n=t.cx+t.r*Math.cos(b),y=t.cy+t.r*Math.sin(b);return{x:R(n),y:R(y),theta:b}},this.gradientAtPoint=function(U,O){let b=this.pointOnPath(U,O),n=Q.normal([t.cx,t.cy],[b.x,b.y]);return!this.anticlockwise&&(n===1/0||n===-1/0)&&(n*=-1),n},this.pointAlongPathFrom=function(U,O,b){let n=this.pointOnPath(U,b),y=O/I*2*Math.PI,h=this.anticlockwise?-1:1,S=n.theta+h*y,T=t.cx+this.radius*Math.cos(S),f=t.cy+this.radius*Math.sin(S);return{x:T,y:f}}},Bezier:function(t){this.curve=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}],c.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)},this.type="Bezier";let p=function(x,j,D){return D&&(j=X.jsBezier.locationAlongCurveFrom(x,j>0?0:1,j)),j};this.pointOnPath=function(x,j){return x=p(this.curve,x,j),X.jsBezier.pointOnCurve(this.curve,x)},this.gradientAtPoint=function(x,j){return x=p(this.curve,x,j),X.jsBezier.gradientAtPoint(this.curve,x)},this.pointAlongPathFrom=function(x,j,D){return x=p(this.curve,x,D),X.jsBezier.pointAlongCurveFrom(this.curve,x,j)},this.getLength=function(){return X.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(x,j){let D=X.jsBezier.nearestPointOnCurve({x,y:j},this.curve);return{d:Math.sqrt(Math.pow(D.point.x-x,2)+Math.pow(D.point.y-j,2)),x:D.point.x,y:D.point.y,l:1-D.location,s:this}},this.lineIntersection=function(x,j,D,I){return X.jsBezier.lineIntersection(x,j,D,I,this.curve)}}},c.SegmentRenderer={getPath:function(t,p){return{Straight:function(x){let j=t.getCoordinates();return(x?"M "+j.x1+" "+j.y1+" ":"")+"L "+j.x2+" "+j.y2},Bezier:function(x){let j=t.params;return(x?"M "+j.x2+" "+j.y2+" ":"")+"C "+j.cp2x+" "+j.cp2y+" "+j.cp1x+" "+j.cp1y+" "+j.x1+" "+j.y1},Arc:function(x){let j=t.params,D=t.sweep>Math.PI?1:0,I=t.anticlockwise?0:1;return(x?"M"+t.x1+" "+t.y1+" ":"")+"A "+t.radius+" "+j.r+" 0 "+D+","+I+" "+t.x2+" "+t.y2}}[t.type](p)}};let J=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};c.Connectors.AbstractConnector=function(t){J.apply(this,arguments);let p=[],x=0,j=[],D=[],I=t.stub||0,s=H.isArray(I)?I[0]:I,l=H.isArray(I)?I[1]:I,N=t.gap||0,R=H.isArray(N)?N[0]:N,U=H.isArray(N)?N[1]:N,O=null,b=null;this.getPathData=function(){let f="";for(let _=0;_<p.length;_++)f+=c.SegmentRenderer.getPath(p[_],_===0),f+=" ";return f},this.findSegmentForPoint=function(f,_){let v={d:1/0,s:null,x:null,y:null,l:null};for(let M=0;M<p.length;M++){let g=p[M].findClosestPointOnPath(f,_);g.d<v.d&&(v.d=g.d,v.l=g.l,v.x=g.x,v.y=g.y,v.s=p[M],v.x1=g.x1,v.x2=g.x2,v.y1=g.y1,v.y2=g.y2,v.index=M,v.connectorLocation=j[M][0]+g.l*(j[M][1]-j[M][0]))}return v},this.lineIntersection=function(f,_,v,M){let g=[];for(let u=0;u<p.length;u++)g.push.apply(g,p[u].lineIntersection(f,_,v,M));return g},this.boxIntersection=function(f,_,v,M){let g=[];for(let u=0;u<p.length;u++)g.push.apply(g,p[u].boxIntersection(f,_,v,M));return g},this.boundingBoxIntersection=function(f){let _=[];for(let v=0;v<p.length;v++)_.push.apply(_,p[v].boundingBoxIntersection(f));return _};let n=function(){let f=0;for(let _=0;_<p.length;_++){let v=p[_].getLength();D[_]=v/x,j[_]=[f,f+=v/x]}},y=function(f,_){_&&(f=f>0?f/x:(x+f)/x);let v=j.length-1,M=1;for(let g=0;g<j.length;g++)if(j[g][1]>=f){v=g,M=f===1?1:f===0?0:(f-j[g][0])/D[g];break}return{segment:p[v],proportion:M,index:v}},h=function(f,_,v){if(v.x1===v.x2&&v.y1===v.y2)return;let M=new c.Segments[_](v);p.push(M),x+=M.getLength(),f.updateBounds(M)},S=function(){x=p.length=j.length=D.length=0};this.setSegments=function(f){O=[],x=0;for(let _=0;_<f.length;_++)O.push(f[_]),x+=f[_].getLength()},this.getLength=function(){return x};let T=function(f){this.strokeWidth=f.strokeWidth;let _=Q.quadrant(f.sourcePos,f.targetPos),v=f.targetPos[0]<f.sourcePos[0],M=f.targetPos[1]<f.sourcePos[1],g=f.strokeWidth||1,u=f.sourceEndpoint.anchor.getOrientation(f.sourceEndpoint),m=f.targetEndpoint.anchor.getOrientation(f.targetEndpoint),A=v?f.targetPos[0]:f.sourcePos[0],F=M?f.targetPos[1]:f.sourcePos[1],i=Math.abs(f.targetPos[0]-f.sourcePos[0]),e=Math.abs(f.targetPos[1]-f.sourcePos[1]);if(u[0]===0&&u[1]===0||m[0]===0&&m[1]===0){let V=i>e?0:1,ot=[1,0][V];u=[],m=[],u[V]=f.sourcePos[V]>f.targetPos[V]?-1:1,m[V]=f.sourcePos[V]>f.targetPos[V]?1:-1,u[ot]=0,m[ot]=0}let d=v?i+R*u[0]:R*u[0],C=M?e+R*u[1]:R*u[1],w=v?U*m[0]:i+U*m[0],B=M?U*m[1]:e+U*m[1],z=u[0]*m[0]+u[1]*m[1],Y={sx:d,sy:C,tx:w,ty:B,lw:g,xSpan:Math.abs(w-d),ySpan:Math.abs(B-C),mx:(d+w)/2,my:(C+B)/2,so:u,to:m,x:A,y:F,w:i,h:e,segment:_,startStubX:d+u[0]*s,startStubY:C+u[1]*s,endStubX:w+m[0]*l,endStubY:B+m[1]*l,isXGreaterThanStubTimes2:Math.abs(d-w)>s+l,isYGreaterThanStubTimes2:Math.abs(C-B)>s+l,opposite:z===-1,perpendicular:z===0,orthogonal:z===1,sourceAxis:u[0]===0?"y":"x",points:[A,F,i,e,d,C,w,B],stubs:[s,l]};return Y.anchorOrientation=Y.opposite?"opposite":Y.orthogonal?"orthogonal":"perpendicular",Y};return this.getSegments=function(){return p},this.updateBounds=function(f){let _=f.getBounds();this.bounds.minX=Math.min(this.bounds.minX,_.minX),this.bounds.maxX=Math.max(this.bounds.maxX,_.maxX),this.bounds.minY=Math.min(this.bounds.minY,_.minY),this.bounds.maxY=Math.max(this.bounds.maxY,_.maxY)},this.pointOnPath=function(f,_){let v=y(f,_);return v.segment&&v.segment.pointOnPath(v.proportion,!1)||[0,0]},this.gradientAtPoint=function(f,_){let v=y(f,_);return v.segment&&v.segment.gradientAtPoint(v.proportion,!1)||0},this.pointAlongPathFrom=function(f,_,v){let M=y(f,v);return M.segment&&M.segment.pointAlongPathFrom(M.proportion,_,!1)||[0,0]},this.compute=function(f){b=T.call(this,f),S(),this._compute(b,f),this.x=b.points[0],this.y=b.points[1],this.w=b.points[2],this.h=b.points[3],this.segment=b.segment,n()},{addSegment:h,prepareCompute:T,sourceStub:s,targetStub:l,maxStub:Math.max(s,l),sourceGap:R,targetGap:U,maxGap:Math.max(R,U)}},H.extend(c.Connectors.AbstractConnector,J),c.Endpoints.AbstractEndpoint=function(t){return J.apply(this,arguments),{compute:this.compute=function(x,j,D,I){let s=this._compute.apply(this,arguments);return this.x=s[0],this.y=s[1],this.w=s[2],this.h=s[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,s},cssClass:t.cssClass}},H.extend(c.Endpoints.AbstractEndpoint,J),c.Endpoints.Dot=function(t){this.type="Dot",c.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(p,x,j,D){this.radius=j.radius||this.radius;let I=p[0]-this.radius,s=p[1]-this.radius,l=this.radius*2,N=this.radius*2;if(j.stroke){let R=j.strokeWidth||1;I-=R,s-=R,l+=R*2,N+=R*2}return[I,s,l,N,this.radius]}},H.extend(c.Endpoints.Dot,c.Endpoints.AbstractEndpoint),c.Endpoints.Rectangle=function(t){this.type="Rectangle",c.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(p,x,j,D){let I=j.width||this.width,s=j.height||this.height,l=p[0]-I/2,N=p[1]-s/2;return[l,N,I,s]}},H.extend(c.Endpoints.Rectangle,c.Endpoints.AbstractEndpoint);let W=function(t){c.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};H.extend(W,c.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),c.Endpoints.Image=function(t){this.type="Image",W.apply(this,arguments),c.Endpoints.AbstractEndpoint.apply(this,arguments);let p=t.onload,x=t.src||t.url,j=t.cssClass?" "+t.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=t.width,this._jsPlumb.heightToUse=t.height,this._jsPlumb.endpoint=t.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,p&&p(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(D,I){let s=D.constructor===String?D:D.src;p=I,this._jsPlumb.img.src=s,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(x,p),this._compute=function(D,I,s,l){return this.anchorPoint=D,this._jsPlumb.ready?[D[0]-this._jsPlumb.widthToUse/2,D[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=c.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+j),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(D,I,s){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);let l=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,N=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;H.sizeElement(this.canvas,l,N,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(D,I){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(D,I):X.setTimeout(function(){this.paint(D,I)}.bind(this),200))}},H.extend(c.Endpoints.Image,[W,c.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),c.Endpoints.Blank=function(t){c.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",W.apply(this,arguments),this._compute=function(x,j,D,I){return[x[0],x[1],10,0]};let p=t.cssClass?" "+t.cssClass:"";this.canvas=c.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+p),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(x,j){H.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},H.extend(c.Endpoints.Blank,[c.Endpoints.AbstractEndpoint,W],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),c.Endpoints.Triangle=function(t){this.type="Triangle",c.Endpoints.AbstractEndpoint.apply(this,arguments);let p=this;t=t||{},t.width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(x,j,D,I){let s=D.width||p.width,l=D.height||p.height,N=x[0]-s/2,R=x[1]-l/2;return[N,R,s,l]}};let r=c.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=t.location==null?.5:t.location,this.endpointLoc=t.endpointLocation==null?[.5,.5]:t.endpointLocation,this.visible=t.visible!==!1};r.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t,p){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},c.Overlays.Arrow=function(t){this.type="Arrow",r.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};let p=this;this.length=t.length||20,this.width=t.width||20,this.id=t.id,this.direction=(t.direction||1)<0?-1:1;let x=t.paintStyle||{"stroke-width":1},j=t.foldback||.623;this.computeMaxSize=function(){return p.width*1.5},this.elementCreated=function(D,I){if(this.path=D,t.events)for(let s in t.events)c.on(D,s,t.events[s])},this.draw=function(D,I){let s,l,N,R,U;if(D.pointAlongPathFrom){if(H.isString(this.loc)||this.loc>1||this.loc<0){let h=parseInt(this.loc,10),S=this.loc<0?1:0;s=D.pointAlongPathFrom(S,h,!1),l=D.pointAlongPathFrom(S,h-this.direction*this.length/2,!1),N=Q.pointOnLine(s,l,this.length)}else if(this.loc===1){if(s=D.pointOnPath(this.loc),l=D.pointAlongPathFrom(this.loc,-this.length),N=Q.pointOnLine(s,l,this.length),this.direction===-1){let h=N;N=s,s=h}}else if(this.loc===0){if(N=D.pointOnPath(this.loc),l=D.pointAlongPathFrom(this.loc,this.length),s=Q.pointOnLine(N,l,this.length),this.direction===-1){let h=N;N=s,s=h}}else s=D.pointAlongPathFrom(this.loc,this.direction*this.length/2),l=D.pointOnPath(this.loc),N=Q.pointOnLine(s,l,this.length);R=Q.perpendicularLineTo(s,N,this.width),U=Q.pointOnLine(s,N,j*this.length);let O={hxy:s,tail:R,cxy:U},b=x.stroke||I.stroke,n=x.fill||I.stroke,y=x.strokeWidth||I.strokeWidth;return{component:D,d:O,"stroke-width":y,stroke:b,fill:n,minX:Math.min(s.x,R[0].x,R[1].x),maxX:Math.max(s.x,R[0].x,R[1].x),minY:Math.min(s.y,R[0].y,R[1].y),maxY:Math.max(s.y,R[0].y,R[1].y)}}else return{component:D,minX:0,maxX:0,minY:0,maxY:0}}},H.extend(c.Overlays.Arrow,r,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=t.direction!=null?t.direction:this.direction,this.foldback=t.foldback||this.foldback},cleanup:function(){this.path&&this.canvas&&this.canvas.removeChild(this.path)}}),c.Overlays.PlainArrow=function(t){t=t||{};let p=c.extend(t,{foldback:1});c.Overlays.Arrow.call(this,p),this.type="PlainArrow"},H.extend(c.Overlays.PlainArrow,c.Overlays.Arrow),c.Overlays.Diamond=function(t){t=t||{};let p=t.length||40,x=c.extend(t,{length:p/2,foldback:2});c.Overlays.Arrow.call(this,x),this.type="Diamond"},H.extend(c.Overlays.Diamond,c.Overlays.Arrow);let E=function(t,p){return(t._jsPlumb.cachedDimensions==null||p)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},a=function(t){c.jsPlumbUIComponent.apply(this,arguments),r.apply(this,arguments);let p=this.fire;this.fire=function(){p.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=t.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){let x=this._jsPlumb.div=c.getElement(this._jsPlumb.create(this._jsPlumb.component));x.style.position="absolute",jsPlumb.addClass(x,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"")),this._jsPlumb.instance.appendElement(x),this._jsPlumb.instance.getId(x),this.canvas=x;let j="translate(-50%, -50%)";x.style.webkitTransform=j,x.style.mozTransform=j,x.style.msTransform=j,x.style.oTransform=j,x.style.transform=j,x._jsPlumb=this,t.visible===!1&&(x.style.display="none")}return this._jsPlumb.div},this.draw=function(x,j,D){let I=E(this);if(I!=null&&I.length===2){let s={x:0,y:0};if(D)s={x:D[0],y:D[1]};else if(x.pointOnPath){let R=this.loc,U=!1;(H.isString(this.loc)||this.loc<0||this.loc>1)&&(R=parseInt(this.loc,10),U=!0),s=x.pointOnPath(R,U)}else{let R=this.loc.constructor===Array?this.loc:this.endpointLoc;s={x:R[0]*x.w,y:R[1]*x.h}}let l=s.x-I[0]/2,N=s.y-I[1]/2;return{component:x,d:{minx:l,miny:N,td:I,cxy:s},minX:l,maxX:l+I[0],minY:N,maxY:N+I[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};H.extend(a,[c.jsPlumbUIComponent,r],{getDimensions:function(){return[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(E(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t,p){this._jsPlumb.div!=null&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){let t=E(this);return Math.max(t[0],t[1])},paint:function(t,p){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),c.Overlays.Custom=function(t){this.type="Custom",a.apply(this,arguments)},H.extend(c.Overlays.Custom,a),c.Overlays.GuideLines=function(){let t=this;t.length=50,t.strokeWidth=5,this.type="GuideLines",r.apply(this,arguments),c.jsPlumbUIComponent.apply(this,arguments),this.draw=function(p,x){let j=p.pointAlongPathFrom(t.loc,t.length/2),D=p.pointOnPath(t.loc),I=Q.pointOnLine(j,D,t.length),s=Q.perpendicularLineTo(j,I,40),l=Q.perpendicularLineTo(I,j,20);return{connector:p,head:j,tail:I,headLine:l,tailLine:s,minX:Math.min(j.x,I.x,l[0].x,l[1].x),minY:Math.min(j.y,I.y,l[0].y,l[1].y),maxX:Math.max(j.x,I.x,l[0].x,l[1].x),maxY:Math.max(j.y,I.y,l[0].y,l[1].y)}}},c.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;let p=c.extend({create:function(){return c.createElement("div")}},t);if(c.Overlays.Custom.call(this,p),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){let x=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",x.style.font=this.labelStyle.font,x.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(x.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){let j=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";x.style.border=this.labelStyle.borderWidth+"px solid "+j}this.labelStyle.padding&&(x.style.padding=this.labelStyle.padding)}},H.extend(c.Overlays.Label,c.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),a.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){let t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){t.label!=null&&this.setLabel(t.label)}})}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumbUtil,H=X.jsPlumbInstance,Q="jtk-group-collapsed",J="jtk-group-expanded",W="[jtk-group-content]",r="elementDraggable",E="stop",a="revert",t="_groupManager",p="_jsPlumbGroup",x="_jsPlumbGroupDrag",j="group:addMember",D="group:removeMember",I="group:add",s="group:remove",l="group:expand",N="group:collapse",R="groupDragStop",U="connectionMoved",O="internal.connectionDetached",b="removeAll",n="orphanAll",y="show",h="hide",S=function(f){let _={},v={},M={},g=this;f.bind("connection",function(e){e.source[p]!=null&&e.target[p]!=null&&e.source[p]===e.target[p]?(v[e.connection.id]=e.source[p],M[e.connection.id]=e.source[p]):(e.source[p]!=null&&(c.suggest(e.source[p].connections.source,e.connection),v[e.connection.id]=e.source[p]),e.target[p]!=null&&(c.suggest(e.target[p].connections.target,e.connection),M[e.connection.id]=e.target[p]))});function u(e){delete e.proxies;let d=v[e.id],C;d!=null&&(C=function(w){return w.id===e.id},c.removeWithFunction(d.connections.source,C),c.removeWithFunction(d.connections.target,C),delete v[e.id]),d=M[e.id],d!=null&&(C=function(w){return w.id===e.id},c.removeWithFunction(d.connections.source,C),c.removeWithFunction(d.connections.target,C),delete M[e.id])}f.bind(O,function(e){u(e.connection)}),f.bind(U,function(e){let C=(e.index===0?v:M)[e.connection.id];if(C){let w=C.connections[e.index===0?"source":"target"],B=w.indexOf(e.connection);B!==-1&&w.splice(B,1)}}),this.addGroup=function(e){f.addClass(e.getEl(),J),_[e.id]=e,e.manager=this,i(e),f.fire(I,{group:e})},this.addToGroup=function(e,d,C){if(e=this.getGroup(e),e){let w=e.getEl();if(d._isJsPlumbGroup)return;let B=d._jsPlumbGroup;if(B!==e){let z=f.getOffset(d,!0),Y=e.collapsed?f.getOffset(w,!0):f.getOffset(e.getDragArea(),!0);B!=null&&(B.remove(d,!1,C,!1,e),g.updateConnectionsForGroup(B)),e.add(d,C);let V=function(pt,$){let rt=$===0?1:0;pt.each(function(ft){ft.setVisible(!1),ft.endpoints[rt].element._jsPlumbGroup===e?(ft.endpoints[rt].setVisible(!1),F(ft,rt,e)):(ft.endpoints[$].setVisible(!1),A(ft,$,e))})};e.collapsed&&(V(f.select({source:d}),0),V(f.select({target:d}),1));let ot=f.getId(d);f.dragManager.setParent(d,ot,w,f.getId(w),z);let ct={left:z.left-Y.left,top:z.top-Y.top};if(f.setPosition(d,ct),f.dragManager.revalidateParent(d,ot,z),g.updateConnectionsForGroup(e),f.revalidate(ot),!C){let pt={group:e,el:d,pos:ct};B&&(pt.sourceGroup=B),f.fire(j,pt)}}}},this.removeFromGroup=function(e,d,C){e=this.getGroup(e),e&&e.remove(d,null,C)},this.getGroup=function(e){let d=e;if(c.isString(e)&&(d=_[e],d==null))throw new TypeError("No such group ["+e+"]");return d},this.getGroups=function(){let e=[];for(let d in _)e.push(_[d]);return e},this.removeGroup=function(e,d,C,w){e=this.getGroup(e),this.expandGroup(e,!0);let B=e[d?b:n](C,w);return f.remove(e.getEl()),delete _[e.id],delete f._groups[e.id],f.fire(s,{group:e}),B},this.removeAllGroups=function(e,d,C){for(let w in _)this.removeGroup(_[w],e,d,C)};function m(e,d){let C=e.getMembers();for(let w=0;w<C.length;w++)f[d?y:h](C[w],!0)}var A=function(e,d,C){let w=e.endpoints[d===0?1:0].element;if(w[p]&&!w[p].shouldProxy()&&w[p].collapsed)return;let B=C.getEl(),z=f.getId(B);f.proxyConnection(e,d,B,z,function(Y,V){return C.getEndpoint(Y,V)},function(Y,V){return C.getAnchor(Y,V)})};this.collapseGroup=function(e){if(e=this.getGroup(e),e==null||e.collapsed)return;let d=e.getEl();if(m(e,!1),e.shouldProxy()){let C=function(w,B){for(let z=0;z<w.length;z++){let Y=w[z];A(Y,B,e)}};C(e.connections.source,0),C(e.connections.target,1)}e.collapsed=!0,f.removeClass(d,J),f.addClass(d,Q),f.revalidate(d),f.fire(N,{group:e})};var F=function(e,d,C){f.unproxyConnection(e,d,f.getId(C.getEl()))};this.expandGroup=function(e,d){if(e=this.getGroup(e),e==null||!e.collapsed)return;let C=e.getEl();if(m(e,!0),e.shouldProxy()){let w=function(B,z){for(let Y=0;Y<B.length;Y++){let V=B[Y];F(V,z,e)}};w(e.connections.source,0),w(e.connections.target,1)}e.collapsed=!1,f.addClass(C,J),f.removeClass(C,Q),f.revalidate(C),this.repaintGroup(e),d||f.fire(l,{group:e})},this.repaintGroup=function(e){e=this.getGroup(e);let d=e.getMembers();for(let C=0;C<d.length;C++)f.revalidate(d[C])};function i(e){let d=e.getMembers(),C=f.getConnections({source:d,scope:"*"},!0),w=f.getConnections({target:d,scope:"*"},!0),B={};e.connections.source.length=0,e.connections.target.length=0;let z=function(Y){for(let V=0;V<Y.length;V++)B[Y[V].id]||(B[Y[V].id]=!0,Y[V].source._jsPlumbGroup===e?(Y[V].target._jsPlumbGroup!==e&&e.connections.source.push(Y[V]),v[Y[V].id]=e):Y[V].target._jsPlumbGroup===e&&(e.connections.target.push(Y[V]),M[Y[V].id]=e))};z(C),z(w)}this.updateConnectionsForGroup=i,this.refreshAllGroups=function(){for(let e in _)i(_[e]),f.dragManager.updateOffsets(f.getId(_[e].getEl()))}},T=function(f,_){let v=this,M=_.el;this.getEl=function(){return M},this.id=_.id||c.uuid(),M._isJsPlumbGroup=!0;let g=this.getDragArea=function(){let $=f.getSelector(M,W);return $&&$.length>0?$[0]:M},u=_.ghost===!0,m=u||_.constrain===!0,A=_.revert!==!1,F=_.orphan===!0,i=_.prune===!0,e=_.dropOverride===!0,d=_.proxied!==!1,C=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function($,rt){return _.anchor||"Continuous"},this.getEndpoint=function($,rt){return _.endpoint||["Dot",{radius:10}]},this.collapsed=!1,_.draggable!==!1){let $={stop:function(rt){f.fire(R,jsPlumb.extend(rt,{group:v}))},scope:x};_.dragOptions&&X.jsPlumb.extend($,_.dragOptions),f.draggable(_.el,$)}_.droppable!==!1&&f.droppable(_.el,{drop:function($){let rt=$.drag.el;if(rt._isJsPlumbGroup)return;let ft=rt._jsPlumbGroup;if(ft!==v){if(ft!=null&&ft.overrideDrop(rt,v))return;f.getGroupManager().addToGroup(v,rt,!1)}}});let w=function($,rt){let ft=$.nodeType==null?$:[$];for(let ut=0;ut<ft.length;ut++)rt(ft[ut])};this.overrideDrop=function($,rt){return e&&(A||i||F)},this.add=function($,rt){let ft=g();w($,function(ut){if(ut._jsPlumbGroup!=null){if(ut._jsPlumbGroup===v)return;ut._jsPlumbGroup.remove(ut,!0,rt,!1)}ut._jsPlumbGroup=v,C.push(ut),f.isAlreadyDraggable(ut)&&pt(ut),ut.parentNode!==ft&&ft.appendChild(ut)}),f.getGroupManager().updateConnectionsForGroup(v)},this.remove=function($,rt,ft,ut,ht){w($,function(Ct){if(Ct._jsPlumbGroup===v){if(delete Ct._jsPlumbGroup,c.removeWithFunction(C,function(mt){return mt===Ct}),rt)try{v.getDragArea().removeChild(Ct)}catch(mt){jsPlumbUtil.log("Could not remove element from Group "+mt)}if(ct(Ct),!ft){let mt={group:v,el:Ct};ht&&(mt.targetGroup=ht),f.fire(D,mt)}}}),ut||f.getGroupManager().updateConnectionsForGroup(v)},this.removeAll=function($,rt){for(let ft=0,ut=C.length;ft<ut;ft++){let ht=C[0];v.remove(ht,$,rt,!0),f.remove(ht,!0)}C.length=0,f.getGroupManager().updateConnectionsForGroup(v)},this.orphanAll=function(){let $={};for(let rt=0;rt<C.length;rt++){let ft=Y(C[rt]);$[ft[0]]=ft[1]}return C.length=0,$},this.getMembers=function(){return C},M[p]=this,f.bind(r,function($){$.el._jsPlumbGroup===this&&pt($.el)}.bind(this));function B($){return $.offsetParent}function z($,rt){let ft=B($),ut=f.getSize(ft),ht=f.getSize($),Ct=rt[0],mt=Ct+ht[0],Z=rt[1],tt=Z+ht[1];return mt>0&&Ct<ut[0]&&tt>0&&Z<ut[1]}function Y($){let rt=f.getId($),ft=f.getOffset($);return $.parentNode.removeChild($),f.getContainer().appendChild($),f.setPosition($,ft),ct($),f.dragManager.clearParent($,rt),[rt,ft]}function V($){let rt=[];function ft(ut,ht,Ct){let mt=null;if(!z(ut,[ht,Ct])){let Z=ut._jsPlumbGroup;i?f.remove(ut):mt=Y(ut),Z.remove(ut)}return mt}for(let ut=0;ut<$.selection.length;ut++)rt.push(ft($.selection[ut][0],$.selection[ut][1].left,$.selection[ut][1].top));return rt.length===1?rt[0]:rt}function ot($){let rt=f.getId($);f.revalidate($),f.dragManager.revalidateParent($,rt)}function ct($){!$._katavorioDrag||((i||F)&&$._katavorioDrag.off(E,V),!i&&!F&&A&&($._katavorioDrag.off(a,ot),$._katavorioDrag.setRevert(null)))}function pt($){!$._katavorioDrag||((i||F)&&$._katavorioDrag.on(E,V),m&&$._katavorioDrag.setConstrain(!0),u&&$._katavorioDrag.setUseGhostProxy(!0),!i&&!F&&A&&($._katavorioDrag.on(a,ot),$._katavorioDrag.setRevert(function(rt,ft){return!z(rt,ft)})))}this.shouldProxy=function(){return d},f.getGroupManager().addGroup(this)};H.prototype.addGroup=function(f){let _=this;if(_._groups=_._groups||{},_._groups[f.id]!=null)throw new TypeError("cannot create Group ["+f.id+"]; a Group with that ID exists");if(f.el[p]!=null)throw new TypeError("cannot create Group ["+f.id+"]; the given element is already a Group");let v=new T(_,f);return _._groups[v.id]=v,f.collapsed&&this.collapseGroup(v),v},H.prototype.addToGroup=function(f,_,v){let M=function(g){let u=this.getId(g);this.manage(u,g),this.getGroupManager().addToGroup(f,g,v)}.bind(this);if(Array.isArray(_))for(let g=0;g<_.length;g++)M(_[g]);else M(_)},H.prototype.removeFromGroup=function(f,_,v){this.getGroupManager().removeFromGroup(f,_,v)},H.prototype.removeGroup=function(f,_,v,M){return this.getGroupManager().removeGroup(f,_,v,M)},H.prototype.removeAllGroups=function(f,_,v){this.getGroupManager().removeAllGroups(f,_,v)},H.prototype.getGroup=function(f){return this.getGroupManager().getGroup(f)},H.prototype.getGroups=function(){return this.getGroupManager().getGroups()},H.prototype.expandGroup=function(f){this.getGroupManager().expandGroup(f)},H.prototype.collapseGroup=function(f){this.getGroupManager().collapseGroup(f)},H.prototype.repaintGroup=function(f){this.getGroupManager().repaintGroup(f)},H.prototype.toggleGroup=function(f){f=this.getGroupManager().getGroup(f),f!=null&&this.getGroupManager()[f.collapsed?"expandGroup":"collapseGroup"](f)},H.prototype.getGroupManager=function(){let f=this[t];return f==null&&(f=this[t]=new S(this)),f},H.prototype.removeGroupManager=function(){delete this[t]},H.prototype.getGroupFor=function(f){if(f=this.getElement(f),f)return f[p]}}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q="Straight",J="Arc",W=function(r){this.type="Flowchart",r=r||{},r.stub=r.stub==null?30:r.stub;let E,a=c.Connectors.AbstractConnector.apply(this,arguments),t=r.midpoint==null?.5:r.midpoint,p=r.alwaysRespectStubs===!0,x=null,j=null,D=r.cornerRadius!=null?r.cornerRadius:0;r.loopbackRadius;let I=function(O){return O<0?-1:O===0?0:1},s=function(O){return[I(O[2]-O[0]),I(O[3]-O[1])]},l=function(O,b,n,y){if(x===b&&j===n)return;let h=x==null?y.sx:x,S=j==null?y.sy:j,T=h===b?"v":"h";x=b,j=n,O.push([h,S,b,n,T])},N=function(O){return Math.sqrt(Math.pow(O[0]-O[2],2)+Math.pow(O[1]-O[3],2))},R=function(O){let b=[];return b.push.apply(b,O),b},U=function(O,b,n){let y=null,h,S,T;for(let f=0;f<b.length-1;f++){if(y=y||R(b[f]),h=R(b[f+1]),S=s(y),T=s(h),D>0&&y[4]!==h[4]){let _=Math.min(N(y),N(h)),v=Math.min(D,_/2);y[2]-=S[0]*v,y[3]-=S[1]*v,h[0]+=T[0]*v,h[1]+=T[1]*v;let M=S[1]===T[0]&&T[0]===1||S[1]===T[0]&&T[0]===0&&S[0]!==T[1]||S[1]===T[0]&&T[0]===-1,g=h[1]>y[3]?1:-1,u=h[0]>y[2]?1:-1,m=g===u,A=m&&M||!m&&!M?h[0]:y[2],F=m&&M||!m&&!M?y[3]:h[1];a.addSegment(O,Q,{x1:y[0],y1:y[1],x2:y[2],y2:y[3]}),a.addSegment(O,J,{r:v,x1:y[2],y1:y[3],x2:h[0],y2:h[1],cx:A,cy:F,ac:M})}else{let _=y[2]===y[0]?0:y[2]>y[0]?n.lw/2:-(n.lw/2),v=y[3]===y[1]?0:y[3]>y[1]?n.lw/2:-(n.lw/2);a.addSegment(O,Q,{x1:y[0]-_,y1:y[1]-v,x2:y[2]+_,y2:y[3]+v})}y=h}h!=null&&a.addSegment(O,Q,{x1:h[0],y1:h[1],x2:h[2],y2:h[3]})};this._compute=function(O,b){E=[],x=null,j=null;let n=function(){return[O.startStubX,O.startStubY,O.endStubX,O.endStubY]},h={perpendicular:n,orthogonal:n,opposite:function(i){let e=O,d=i==="x"?0:1;return!p&&{x:function(){return e.so[d]===1&&(e.startStubX>e.endStubX&&e.tx>e.startStubX||e.sx>e.endStubX&&e.tx>e.sx)||e.so[d]===-1&&(e.startStubX<e.endStubX&&e.tx<e.startStubX||e.sx<e.endStubX&&e.tx<e.sx)},y:function(){return e.so[d]===1&&(e.startStubY>e.endStubY&&e.ty>e.startStubY||e.sy>e.endStubY&&e.ty>e.sy)||e.so[d]===-1&&(e.startStubY<e.endStubY&&e.ty<e.startStubY||e.sy<e.endStubY&&e.ty<e.sy)}}[i]()?{x:[(O.sx+O.tx)/2,O.startStubY,(O.sx+O.tx)/2,O.endStubY],y:[O.startStubX,(O.sy+O.ty)/2,O.endStubX,(O.sy+O.ty)/2]}[i]:[O.startStubX,O.startStubY,O.endStubX,O.endStubY]}}[O.anchorOrientation](O.sourceAxis),S=O.sourceAxis==="x"?0:1,T=O.sourceAxis==="x"?1:0,f=h[S],_=h[T],v=h[S+2],M=h[T+2];l(E,h[0],h[1],O);let g=O.startStubX+(O.endStubX-O.startStubX)*t,u=O.startStubY+(O.endStubY-O.startStubY)*t,m={x:[0,1],y:[1,0]},F={perpendicular:function(i){let e=O,d={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},C={x:[[e.startStubX,e.endStubX],null,[e.endStubX,e.startStubX]],y:[[e.startStubY,e.endStubY],null,[e.endStubY,e.startStubY]]},w={x:[[g,e.startStubY],[g,e.endStubY]],y:[[e.startStubX,u],[e.endStubX,u]]},B={x:[[e.endStubX,e.startStubY]],y:[[e.startStubX,e.endStubY]]},z={x:[[e.startStubX,e.endStubY],[e.endStubX,e.endStubY]],y:[[e.endStubX,e.startStubY],[e.endStubX,e.endStubY]]},Y={x:[[e.startStubX,u],[e.endStubX,u],[e.endStubX,e.endStubY]],y:[[g,e.startStubY],[g,e.endStubY],[e.endStubX,e.endStubY]]},V={x:[e.startStubY,e.endStubY],y:[e.startStubX,e.endStubX]},ot=m[i][0],ct=m[i][1],pt=e.so[ot]+1,$=e.to[ct]+1,rt=e.to[ct]===-1&&V[i][1]<V[i][0]||e.to[ct]===1&&V[i][1]>V[i][0],ft=C[i][pt][0],ut=C[i][pt][1],ht=d[i][pt][$];if(e.segment===ht[3]||e.segment===ht[2]&&rt)return w[i];if(e.segment===ht[2]&&ut<ft)return B[i];if(e.segment===ht[2]&&ut>=ft||e.segment===ht[1]&&!rt)return Y[i];if(e.segment===ht[0]||e.segment===ht[1]&&rt)return z[i]},orthogonal:function(i,e,d,C,w){let B=O,z={x:B.so[0]===-1?Math.min(e,C):Math.max(e,C),y:B.so[1]===-1?Math.min(e,C):Math.max(e,C)}[i];return{x:[[z,d],[z,w],[C,w]],y:[[d,z],[w,z],[w,C]]}[i]},opposite:function(i,e,d,C){let w=O,B={x:"y",y:"x"}[i],z={x:"height",y:"width"}[i],Y=w["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(b.sourceEndpoint.elementId===b.targetEndpoint.elementId){let V=d+(1-b.sourceEndpoint.anchor[B])*b.sourceInfo[z]+a.maxStub;return{x:[[e,V],[C,V]],y:[[V,e],[V,C]]}[i]}else{if(!Y||w.so[S]===1&&e>C||w.so[S]===-1&&e<C)return{x:[[e,u],[C,u]],y:[[g,e],[g,C]]}[i];if(w.so[S]===1&&e<C||w.so[S]===-1&&e>C)return{x:[[g,w.sy],[g,w.ty]],y:[[w.sx,u],[w.tx,u]]}[i]}}}[O.anchorOrientation](O.sourceAxis,f,_,v,M);if(F)for(let i=0;i<F.length;i++)l(E,F[i][0],F[i][1],O);l(E,h[2],h[3],O),l(E,O.tx,O.ty,O),U(this,E,O)}};c.Connectors.Flowchart=W,H.extend(c.Connectors.Flowchart,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil;c.Connectors.AbstractBezierConnector=function(J){J=J||{};let W=J.showLoopback!==!1;J.curviness;let r=J.margin||5;J.proximityLimit;let E=J.orientation&&J.orientation==="clockwise",a=J.loopbackRadius||25,t;return this._compute=function(p,x){let j=x.sourcePos,D=x.targetPos,I=Math.abs(j[0]-D[0]),s=Math.abs(j[1]-D[1]);if(!W||x.sourceEndpoint.elementId!==x.targetEndpoint.elementId)this._computeBezier(p,x,j,D,I,s);else{let l=x.sourcePos[0],N=x.sourcePos[1]-r,R=l,U=N-a,O=R-a,b=U-a;I=2*a,s=2*a,p.points[0]=O,p.points[1]=b,p.points[2]=I,p.points[3]=s,t.addSegment(this,"Arc",{loopback:!0,x1:l-O+4,y1:N-b,startAngle:0,endAngle:2*Math.PI,r:a,ac:!E,x2:l-O-4,y2:N-b,cx:R-O,cy:U-b})}},t=c.Connectors.AbstractConnector.apply(this,arguments),t},H.extend(c.Connectors.AbstractBezierConnector,c.Connectors.AbstractConnector);let Q=function(J){J=J||{},this.type="Bezier";let W=c.Connectors.AbstractBezierConnector.apply(this,arguments),r=J.curviness||150,E=10;this.getCurviness=function(){return r},this._findControlPoint=function(a,t,p,x,j,D,I){let s=D[0]!==I[0]||D[1]===I[1],l=[];return s?(I[0]===0?l.push(p[0]<t[0]?a[0]+E:a[0]-E):l.push(a[0]+r*I[0]),I[1]===0?l.push(p[1]<t[1]?a[1]+E:a[1]-E):l.push(a[1]+r*D[1])):(D[0]===0?l.push(t[0]<p[0]?a[0]+E:a[0]-E):l.push(a[0]-r*D[0]),D[1]===0?l.push(t[1]<p[1]?a[1]+E:a[1]-E):l.push(a[1]+r*I[1])),l},this._computeBezier=function(a,t,p,x,j,D){let I,s,l=p[0]<x[0]?j:0,N=p[1]<x[1]?D:0,R=p[0]<x[0]?0:j,U=p[1]<x[1]?0:D;I=this._findControlPoint([l,N],p,x,t.sourceEndpoint,t.targetEndpoint,a.so,a.to),s=this._findControlPoint([R,U],x,p,t.targetEndpoint,t.sourceEndpoint,a.to,a.so),W.addSegment(this,"Bezier",{x1:l,y1:N,x2:R,y2:U,cp1x:I[0],cp1y:I[1],cp2x:s[0],cp2y:s[1]})}};c.Connectors.Bezier=Q,H.extend(Q,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=function(r,E,a,t){return r<=a&&t<=E?1:r<=a&&E<=t?2:a<=r&&t>=E?3:4},J=function(r,E,a,t,p,x,j,D,I){if(D<=I)return[r,E];if(a===1)return t[3]<=0&&p[3]>=1?[r+(t[2]<.5?-1*x:x),E]:t[2]>=1&&p[2]<=0?[r,E+(t[3]<.5?-1*j:j)]:[r+-1*x,E+-1*j];if(a===2)return t[3]>=1&&p[3]<=0?[r+(t[2]<.5?-1*x:x),E]:t[2]>=1&&p[2]<=0?[r,E+(t[3]<.5?-1*j:j)]:[r+x,E+-1*j];if(a===3)return t[3]>=1&&p[3]<=0?[r+(t[2]<.5?-1*x:x),E]:t[2]<=0&&p[2]>=1?[r,E+(t[3]<.5?-1*j:j)]:[r+-1*x,E+-1*j];if(a===4)return t[3]<=0&&p[3]>=1?[r+(t[2]<.5?-1*x:x),E]:t[2]<=0&&p[2]>=1?[r,E+(t[3]<.5?-1*j:j)]:[r+x,E+-1*j]},W=function(r){r=r||{},this.type="StateMachine";let E=c.Connectors.AbstractBezierConnector.apply(this,arguments),a=r.curviness||10,t=r.margin||5,p=r.proximityLimit||80;r.orientation&&r.orientation;let x;this._computeBezier=function(j,D,I,s,l,N){let R=D.sourcePos[0]<D.targetPos[0]?0:l,U=D.sourcePos[1]<D.targetPos[1]?0:N,O=D.sourcePos[0]<D.targetPos[0]?l:0,b=D.sourcePos[1]<D.targetPos[1]?N:0;D.sourcePos[2]===0&&(R-=t),D.sourcePos[2]===1&&(R+=t),D.sourcePos[3]===0&&(U-=t),D.sourcePos[3]===1&&(U+=t),D.targetPos[2]===0&&(O-=t),D.targetPos[2]===1&&(O+=t),D.targetPos[3]===0&&(b-=t),D.targetPos[3]===1&&(b+=t);let n=(R+O)/2,y=(U+b)/2,h=Q(R,U,O,b),S=Math.sqrt(Math.pow(O-R,2)+Math.pow(b-U,2)),T,f,_,v;x=J(n,y,h,D.sourcePos,D.targetPos,a,a,S,p),T=x[0],f=x[0],_=x[1],v=x[1],E.addSegment(this,"Bezier",{x1:O,y1:b,x2:R,y2:U,cp1x:T,cp1y:_,cp2x:f,cp2y:v})}};c.Connectors.StateMachine=W,H.extend(W,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q="Straight",J=function(W){this.type=Q;let r=c.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(E,a){r.addSegment(this,Q,{x1:E.sx,y1:E.sy,x2:E.startStubX,y2:E.startStubY}),r.addSegment(this,Q,{x1:E.startStubX,y1:E.startStubY,x2:E.endStubX,y2:E.endStubY}),r.addSegment(this,Q,{x1:E.endStubX,y1:E.endStubY,x2:E.tx,y2:E.ty})}};c.Connectors.Straight=J,H.extend(J,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},J="stroke-dasharray",W="dashstyle",r="linearGradient",E="radialGradient",a="defs",t="fill",p="stop",x="stroke",j="stroke-width",D="style",I="none",s="jsplumb_gradient_",l="strokeWidth",N={svg:"http://www.w3.org/2000/svg"},R=function(_,v){for(let M in v)_.setAttribute(M,""+v[M])},U=function(_,v){return v=v||{},v.version="1.1",v.xmlns=N.svg,c.createElementNS(N.svg,_,null,null,v)},O=function(_){return"position:absolute;left:"+_[0]+"px;top:"+_[1]+"px"},b=function(_){let v=_.querySelectorAll(" defs,linearGradient,radialGradient");for(let M=0;M<v.length;M++)v[M].parentNode.removeChild(v[M])},n=function(_,v,M,g,u){let m=s+u._jsPlumb.instance.idstamp();b(_);let A;M.gradient.offset?A=U(E,{id:m}):A=U(r,{id:m,gradientUnits:"userSpaceOnUse"});let F=U(a);_.appendChild(F),F.appendChild(A);for(let e=0;e<M.gradient.stops.length;e++){let d=u.segment===1||u.segment===2?e:M.gradient.stops.length-1-e,C=M.gradient.stops[d][1],w=U(p,{offset:Math.floor(M.gradient.stops[e][0]*100)+"%","stop-color":C});A.appendChild(w)}let i=M.stroke?x:t;v.setAttribute(i,"url(#"+m+")")},y=function(_,v,M,g,u){if(v.setAttribute(t,M.fill?M.fill:I),v.setAttribute(x,M.stroke?M.stroke:I),M.gradient?n(_,v,M,g,u):(b(_),v.setAttribute(D,"")),M.strokeWidth&&v.setAttribute(j,M.strokeWidth),M[W]&&M[l]&&!M[J]){let m=M[W].indexOf(",")===-1?" ":",",A=M[W].split(m),F="";A.forEach(function(i){F+=Math.floor(i*M.strokeWidth)+m}),v.setAttribute(J,F)}else M[J]&&v.setAttribute(J,M[J]);for(let m in Q)M[m]&&v.setAttribute(Q[m],M[m])},h=function(_,v,M){_.childNodes.length>M?_.insertBefore(v,_.childNodes[M]):_.appendChild(v)};H.svg={node:U,attr:R,pos:O};let S=function(_){let v=_.pointerEventsSpec||"all",M={};c.jsPlumbUIComponent.apply(this,_.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;let g=_.cssClass+" "+(_.originalArgs[0].cssClass||""),u={style:"",width:0,height:0,"pointer-events":v,position:"absolute"};this.svg=U("svg",u),_.useDivWrapper?(this.canvas=c.createElement("div",{position:"absolute"}),H.sizeElement(this.canvas,0,0,1,1),this.canvas.className=g):(R(this.svg,{class:g}),this.canvas=this.svg),_._jsPlumb.appendElement(this.canvas,_.originalArgs[0].parent),_.useDivWrapper&&this.canvas.appendChild(this.svg);let m=[this.canvas];return this.getDisplayElements=function(){return m},this.appendDisplayElement=function(A){m.push(A)},this.paint=function(A,F,i){if(A!=null){let e=[this.x,this.y],d=[this.w,this.h],C;i!=null&&(i.xmin<0&&(e[0]+=i.xmin),i.ymin<0&&(e[1]+=i.ymin),d[0]=i.xmax+(i.xmin<0?-i.xmin:0),d[1]=i.ymax+(i.ymin<0?-i.ymin:0)),_.useDivWrapper?(H.sizeElement(this.canvas,e[0],e[1],d[0],d[1]),e[0]=0,e[1]=0,C=O([0,0])):C=O([e[0],e[1]]),M.paint.apply(this,arguments),R(this.svg,{style:C,width:d[0]||0,height:d[1]||0})}},{renderer:M}};H.extend(S,c.jsPlumbUIComponent,{cleanup:function(_){_||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(_){let v=_.getContainer();this.canvas&&this.canvas.parentNode==null&&v.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&v.appendChild(this.bgCanvas)},setVisible:function(_){this.canvas&&(this.canvas.style.display=_?"block":"none")}}),c.ConnectorRenderers.svg=function(_){let v=this,M=S.apply(this,[{cssClass:_._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:_._jsPlumb}]);M.renderer.paint=function(g,u,m){let A=v.getSegments(),F="",i=[0,0];if(m.xmin<0&&(i[0]=-m.xmin),m.ymin<0&&(i[1]=-m.ymin),A.length>0){F=v.getPathData();let e={d:F,transform:"translate("+i[0]+","+i[1]+")","pointer-events":_["pointer-events"]||"visibleStroke"},d=null,C=[v.x,v.y,v.w,v.h];if(g.outlineStroke){let w=g.outlineWidth||1,B=g.strokeWidth+2*w;d=c.extend({},g),delete d.gradient,d.stroke=g.outlineStroke,d.strokeWidth=B,v.bgPath==null?(v.bgPath=U("path",e),c.addClass(v.bgPath,c.connectorOutlineClass),h(v.svg,v.bgPath,0)):R(v.bgPath,e),y(v.svg,v.bgPath,d,C,v)}v.path==null?(v.path=U("path",e),h(v.svg,v.path,g.outlineStroke?1:0)):R(v.path,e),y(v.svg,v.path,g,C,v)}}},H.extend(c.ConnectorRenderers.svg,S);let T=c.SvgEndpoint=function(_){let v=S.apply(this,[{cssClass:_._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:_._jsPlumb}]);v.renderer.paint=function(M){let g=c.extend({},M);g.outlineStroke&&(g.stroke=g.outlineStroke),this.node==null?(this.node=this.makeNode(g),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),y(this.svg,this.node,g,[this.x,this.y,this.w,this.h],this),O(this.node,[this.x,this.y])}.bind(this)};H.extend(T,S),c.Endpoints.svg.Dot=function(){c.Endpoints.Dot.apply(this,arguments),T.apply(this,arguments),this.makeNode=function(_){return U("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(_){R(_,{cx:this.w/2,cy:this.h/2,r:this.radius})}},H.extend(c.Endpoints.svg.Dot,[c.Endpoints.Dot,T]),c.Endpoints.svg.Rectangle=function(){c.Endpoints.Rectangle.apply(this,arguments),T.apply(this,arguments),this.makeNode=function(_){return U("rect",{width:this.w,height:this.h})},this.updateNode=function(_){R(_,{width:this.w,height:this.h})}},H.extend(c.Endpoints.svg.Rectangle,[c.Endpoints.Rectangle,T]),c.Endpoints.svg.Image=c.Endpoints.Image,c.Endpoints.svg.Blank=c.Endpoints.Blank,c.Overlays.svg.Label=c.Overlays.Label,c.Overlays.svg.Custom=c.Overlays.Custom;let f=function(_,v){_.apply(this,v),c.jsPlumbUIComponent.apply(this,v),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(g,u){if(g.component.svg&&u){this.path==null&&(this.path=U("path",{"pointer-events":"all"}),g.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,g.component),this.canvas=g.component.svg);let m=v&&v.length===1&&v[0].cssClass||"",A=[0,0];u.xmin<0&&(A[0]=-u.xmin),u.ymin<0&&(A[1]=-u.ymin),R(this.path,{d:M(g.d),class:m,stroke:g.stroke?g.stroke:null,fill:g.fill?g.fill:null,transform:"translate("+A[0]+","+A[1]+")"})}};var M=function(g){return isNaN(g.cxy.x)||isNaN(g.cxy.y)?"":"M"+g.hxy.x+","+g.hxy.y+" L"+g.tail[0].x+","+g.tail[0].y+" L"+g.cxy.x+","+g.cxy.y+" L"+g.tail[1].x+","+g.tail[1].y+" L"+g.hxy.x+","+g.hxy.y};this.transfer=function(g){g.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),g.canvas.appendChild(this.path))}};H.extend(f,[c.jsPlumbUIComponent,c.Overlays.AbstractOverlay],{cleanup:function(_){this.path!=null&&(_?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(_,v){this.path&&v.canvas&&v.canvas.appendChild(this.path)},setVisible:function(_){this.path!=null&&(this.path.style.display=_?"block":"none")}}),c.Overlays.svg.Arrow=function(){f.apply(this,[c.Overlays.Arrow,arguments])},H.extend(c.Overlays.svg.Arrow,[c.Overlays.Arrow,f]),c.Overlays.svg.PlainArrow=function(){f.apply(this,[c.Overlays.PlainArrow,arguments])},H.extend(c.Overlays.svg.PlainArrow,[c.Overlays.PlainArrow,f]),c.Overlays.svg.Diamond=function(){f.apply(this,[c.Overlays.Diamond,arguments])},H.extend(c.Overlays.svg.Diamond,[c.Overlays.Diamond,f]),c.Overlays.svg.GuideLines=function(){let _=null,v=this,M,g;c.Overlays.GuideLines.apply(this,arguments),this.paint=function(m,A){_==null&&(_=U("path"),m.connector.svg.appendChild(_),v.attachListeners(_,m.connector),v.attachListeners(_,v),M=U("path"),m.connector.svg.appendChild(M),v.attachListeners(M,m.connector),v.attachListeners(M,v),g=U("path"),m.connector.svg.appendChild(g),v.attachListeners(g,m.connector),v.attachListeners(g,v));let F=[0,0];A.xmin<0&&(F[0]=-A.xmin),A.ymin<0&&(F[1]=-A.ymin),R(_,{d:u(m.head,m.tail),stroke:"red",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),R(M,{d:u(m.tailLine[0],m.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),R(g,{d:u(m.headLine[0],m.headLine[1]),stroke:"green",fill:null,transform:"translate("+F[0]+","+F[1]+")"})};var u=function(m,A){return"M "+m.x+","+m.y+" L"+A.x+","+A.y}},H.extend(c.Overlays.svg.GuideLines,c.Overlays.GuideLines)}).call(typeof window<"u"?window:globalThis);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=X.Katavorio,J=X.Biltong,W=function(n){let y=n._mottle;return y||(y=n._mottle=new X.Mottle),y},r=function(n,y){y=y||"main";let h="_katavorio_"+y,S=n[h],T=n.getEventManager();return S||(S=new Q({bind:T.on,unbind:T.off,getSize:c.getSize,getConstrainingRectangle:function(f){return[f.parentNode.scrollWidth,f.parentNode.scrollHeight]},getPosition:function(f,_){let v=n.getOffset(f,_,f._katavorioDrag?f.offsetParent:null);return[v.left,v.top]},setPosition:function(f,_){f.style.left=_[0]+"px",f.style.top=_[1]+"px"},addClass:c.addClass,removeClass:c.removeClass,intersects:J.intersects,indexOf:function(f,_){return f.indexOf(_)},scope:n.getDefaultScope(),css:{noSelect:n.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),S.setZoom(n.getZoom()),n[h]=S,n.bind("zoom",S.setZoom)),S},E=function(n){let y=n.el._jsPlumbDragOptions,h=!0;return y.canDrag&&(h=y.canDrag()),h&&(this.setHoverSuspended(!0),this.select({source:n.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:n.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),h},a=function(n){let y=this.getUIPosition(arguments,this.getZoom());if(y!=null){let h=n.el._jsPlumbDragOptions;this.draw(n.el,y,null,!0),h._dragging&&this.addClass(n.el,"jtk-dragged"),h._dragging=!0}},t=function(n){let y=n.selection,h,S=function(T){T[1]!=null&&(h=this.getUIPosition([{el:T[2].el,pos:[T[1].left,T[1].top]}]),this.draw(T[2].el,h)),T[0]._jsPlumbDragOptions!=null&&delete T[0]._jsPlumbDragOptions._dragging,this.removeClass(T[0],"jtk-dragged"),this.select({source:T[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:T[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.getDragManager().dragEnded(T[2].el)}.bind(this);for(let T=0;T<y.length;T++)S(y[T]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},p=function(n,y){let h=function(S){if(y[S]!=null)if(H.isString(y[S])){let T=y[S].match(/-=/)?-1:1,f=y[S].substring(2);return n[S]+T*f}else return y[S];else return n[S]};return[h("left"),h("top")]};var x=function(n,y){if(y==null)return[0,0];let h=l(y),S=s(h,0);return[S[n+"X"],S[n+"Y"]]},j=x.bind(this,"page"),D=x.bind(this,"screen"),I=x.bind(this,"client"),s=function(n,y){return n.item?n.item(y):n[y]},l=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]};let N=function(n){let y={},h=[],S={},T={},f={};this.register=function(_){let v=n.getId(_),M;y[v]||(y[v]=_,h.push(_),S[v]={});let g=function(u){if(u){for(let m=0;m<u.childNodes.length;m++)if(u.childNodes[m].nodeType!==3&&u.childNodes[m].nodeType!==8){let A=jsPlumb.getElement(u.childNodes[m]),F=n.getId(u.childNodes[m],null,!0);if(F&&T[F]&&T[F]>0){M||(M=n.getOffset(_));let i=n.getOffset(A);S[v][F]={id:F,offset:{left:i.left-M.left,top:i.top-M.top}},f[F]=v}g(u.childNodes[m])}}};g(_)},this.updateOffsets=function(_,v){if(_!=null){v=v||{};let M=jsPlumb.getElement(_),g=n.getId(M),u=S[g],m;if(u){for(let A in u)if(u.hasOwnProperty(A)){let F=jsPlumb.getElement(A),i=v[A]||n.getOffset(F);if(F.offsetParent==null&&S[g][A]!=null)continue;m||(m=n.getOffset(M)),S[g][A]={id:A,offset:{left:i.left-m.left,top:i.top-m.top}},f[A]=g}}}},this.endpointAdded=function(_,v){v=v||n.getId(_);let M=document.body,g=_.parentNode;for(T[v]=T[v]?T[v]+1:1;g!=null&&g!==M;){let u=n.getId(g,null,!0);if(u&&y[u]){let m=n.getOffset(g);if(S[u][v]==null){let A=n.getOffset(_);S[u][v]={id:v,offset:{left:A.left-m.left,top:A.top-m.top}},f[v]=u}break}g=g.parentNode}},this.endpointDeleted=function(_){if(T[_.elementId]&&(T[_.elementId]--,T[_.elementId]<=0))for(let v in S)S.hasOwnProperty(v)&&S[v]&&(delete S[v][_.elementId],delete f[_.elementId])},this.changeId=function(_,v){S[v]=S[_],S[_]={},f[v]=f[_],f[_]=null},this.getElementsForDraggable=function(_){return S[_]},this.elementRemoved=function(_){let v=f[_];v&&(delete S[v][_],delete f[_])},this.reset=function(){y={},h=[],S={},T={}},this.dragEnded=function(_){if(_.offsetParent!=null){let v=n.getId(_),M=f[v];M&&this.updateOffsets(M)}},this.setParent=function(_,v,M,g,u){let m=f[v];S[g]||(S[g]={});let A=n.getOffset(M),F=u||n.getOffset(_);m&&S[m]&&delete S[m][v],S[g][v]={id:v,offset:{left:F.left-A.left,top:F.top-A.top}},f[v]=g},this.clearParent=function(_,v){let M=f[v];M&&(delete S[M][v],delete f[v])},this.revalidateParent=function(_,v,M){let g=f[v];if(g){let u={};u[v]=M,this.updateOffsets(g,u),n.revalidate(g)}},this.getDragAncestor=function(_){let v=jsPlumb.getElement(_),M=n.getId(v),g=f[M];return g?jsPlumb.getElement(g):null}},R=function(n,y,h){y=H.fastTrim(y),typeof n.className.baseVal<"u"?n.className.baseVal=y:n.className=y;try{let S=n.classList;if(S!=null){for(;S.length>0;)S.remove(S.item(0));for(let T=0;T<h.length;T++)h[T]&&S.add(h[T])}}catch(S){H.log("JSPLUMB: cannot set class list",S)}},U=function(n){return typeof n.className.baseVal>"u"?n.className:n.className.baseVal},O=function(n,y,h){y=y==null?[]:H.isArray(y)?y:y.split(/\s+/),h=h==null?[]:H.isArray(h)?h:h.split(/\s+/);let S=U(n),T=S.split(/\s+/),f=function(_,v){for(let M=0;M<v.length;M++)if(_)T.indexOf(v[M])===-1&&T.push(v[M]);else{let g=T.indexOf(v[M]);g!==-1&&T.splice(g,1)}};f(!0,y),f(!1,h),R(n,T.join(" "),T)};X.jsPlumb.extend(X.jsPlumbInstance.prototype,{headless:!1,pageLocation:j,screenLocation:D,clientLocation:I,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new N(this)),this.dragManager},recalculateOffsets:function(n){this.getDragManager().updateOffsets(n)},createElement:function(n,y,h,S){return this.createElementNS(null,n,y,h,S)},createElementNS:function(n,y,h,S,T){let f=n==null?document.createElement(y):document.createElementNS(n,y),_;h=h||{};for(_ in h)f.style[_]=h[_];S&&(f.className=S),T=T||{};for(_ in T)f.setAttribute(_,""+T[_]);return f},getAttribute:function(n,y){return n.getAttribute!=null?n.getAttribute(y):null},setAttribute:function(n,y,h){n.setAttribute!=null&&n.setAttribute(y,h)},setAttributes:function(n,y){for(let h in y)y.hasOwnProperty(h)&&n.setAttribute(h,y[h])},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["svg"]},getClass:U,addClass:function(n,y){jsPlumb.each(n,function(h){O(h,y)})},hasClass:function(n,y){return n=jsPlumb.getElement(n),n.classList?n.classList.contains(y):U(n).indexOf(y)!==-1},removeClass:function(n,y){jsPlumb.each(n,function(h){O(h,null,y)})},toggleClass:function(n,y){jsPlumb.hasClass(n,y)?jsPlumb.removeClass(n,y):jsPlumb.addClass(n,y)},updateClasses:function(n,y,h){jsPlumb.each(n,function(S){O(S,y,h)})},setClass:function(n,y){y!=null&&jsPlumb.each(n,function(h){R(h,y,y.split(/\s+/))})},setPosition:function(n,y){n.style.left=y.left+"px",n.style.top=y.top+"px"},getPosition:function(n){let y=function(h){let S=n.style[h];return S?S.substring(0,S.length-2):0};return{left:y("left"),top:y("top")}},getStyle:function(n,y){return typeof window.getComputedStyle<"u"?getComputedStyle(n,null).getPropertyValue(y):n.currentStyle[y]},getSelector:function(n,y){let h=null;return arguments.length===1?h=n.nodeType!=null?n:document.querySelectorAll(n):h=n.querySelectorAll(y),h},getOffset:function(n,y,h){n=jsPlumb.getElement(n),h=h||this.getContainer();let S={left:n.offsetLeft,top:n.offsetTop},T=y||h!=null&&n!==h&&n.offsetParent!==h?n.offsetParent:null,f=function(_){_!=null&&_!==document.body&&(_.scrollTop>0||_.scrollLeft>0)&&(S.left-=_.scrollLeft,S.top-=_.scrollTop)}.bind(this);for(;T!=null;)S.left+=T.offsetLeft,S.top+=T.offsetTop,f(T),T=y?T.offsetParent:T.offsetParent===h?null:T.offsetParent;if(h!=null&&!y&&(h.scrollTop>0||h.scrollLeft>0)){let _=n.offsetParent!=null?this.getStyle(n.offsetParent,"position"):"static",v=this.getStyle(n,"position");v!=="absolute"&&v!=="fixed"&&_!=="absolute"&&_!=="fixed"&&(S.left-=h.scrollLeft,S.top-=h.scrollTop)}return S},getPositionOnElement:function(n,y,h){let S=typeof y.getBoundingClientRect<"u"?y.getBoundingClientRect():{left:0,top:0,width:0,height:0},T=document.body,f=document.documentElement,_=window.pageYOffset||f.scrollTop||T.scrollTop,v=window.pageXOffset||f.scrollLeft||T.scrollLeft,M=f.clientTop||T.clientTop||0,g=f.clientLeft||T.clientLeft||0,u=0,m=0,A=S.top+_-M+u*h,F=S.left+v-g+m*h,i=jsPlumb.pageLocation(n),e=S.width||y.offsetWidth*h,d=S.height||y.offsetHeight*h,C=(i[0]-F)/e,w=(i[1]-A)/d;return[C,w]},getAbsolutePosition:function(n){let y=function(h){let S=n.style[h];if(S)return parseFloat(S.substring(0,S.length-2))};return[y("left"),y("top")]},setAbsolutePosition:function(n,y,h,S){h?this.animate(n,{left:"+="+(y[0]-h[0]),top:"+="+(y[1]-h[1])},S):(n.style.left=y[0]+"px",n.style.top=y[1]+"px")},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(n,y){let h;return n=H.isArray(n)||n.length!=null&&!H.isString(n)?n:[n],Array.prototype.slice.call(n).forEach(function(S){h=this.info(S),h.el&&this._initDraggableIfNecessary(h.el,!0,y,h.id,!0)}.bind(this)),this},snapToGrid:function(n,y,h){let S=[],T=function(f){let _=this.info(f);if(_.el!=null&&_.el._katavorioDrag){let v=_.el._katavorioDrag.snap(y,h);this.revalidate(_.el),S.push([_.el,v])}}.bind(this);if(arguments.length===1||arguments.length===3)T(n,y,h);else{let f=this.getManagedElements();for(let _ in f)T(_,arguments[0],arguments[1])}return S},initDraggable:function(n,y,h){r(this,h).draggable(n,y),n._jsPlumbDragOptions=y},destroyDraggable:function(n,y){r(this,y).destroyDraggable(n),delete n._jsPlumbDragOptions},unbindDraggable:function(n,y,h,S){r(this,S).destroyDraggable(n,y,h)},setDraggable:function(n,y){return jsPlumb.each(n,function(h){this.isDragSupported(h)&&(this._draggableStates[this.getAttribute(h,"id")]=y,this.setElementDraggable(h,y))}.bind(this))},_draggableStates:{},toggleDraggable:function(n){let y;return jsPlumb.each(n,function(h){let S=this.getAttribute(h,"id");return y=this._draggableStates[S]==null?!1:this._draggableStates[S],y=!y,this._draggableStates[S]=y,this.setDraggable(h,y),y}.bind(this)),y},_initDraggableIfNecessary:function(n,y,h,S,T){if(!jsPlumb.headless&&(y==null?!1:y)&&jsPlumb.isDragSupported(n,this)){let _=h||this.Defaults.DragOptions;if(_=jsPlumb.extend({},_),jsPlumb.isAlreadyDraggable(n,this))h.force&&this.initDraggable(n,_);else{let v=jsPlumb.dragEvents.drag,M=jsPlumb.dragEvents.stop,g=jsPlumb.dragEvents.start;this.manage(S,n),_[g]=H.wrap(_[g],E.bind(this)),_[v]=H.wrap(_[v],a.bind(this)),_[M]=H.wrap(_[M],t.bind(this));let u=this.getId(n);this._draggableStates[u]=!0;let m=this._draggableStates[u];_.disabled=m==null?!1:!m,this.initDraggable(n,_),this.getDragManager().register(n),T&&this.fire("elementDraggable",{el:n,options:_})}}},animationSupported:!0,getElement:function(n){return n==null?null:(n=typeof n=="string"?n:n.length!=null&&n.enctype==null?n[0]:n,typeof n=="string"?document.getElementById(n):n)},removeElement:function(n){r(this).elementRemoved(n),this.getEventManager().remove(n)},doAnimate:function(n,y,h){h=h||{};var S=this.getOffset(n),T=p(S,y),f=T[0]-S.left,_=T[1]-S.top,v=h.duration||250,M=15,g=v/M,u=M/v*f,m=M/v*_,A=0,F=setInterval(function(){c.setPosition(n,{left:S.left+u*(A+1),top:S.top+m*(A+1)}),h.step!=null&&h.step(A,Math.ceil(g)),A++,A>=g&&(window.clearInterval(F),h.complete!=null&&h.complete())},M)},destroyDroppable:function(n,y){r(this,y).destroyDroppable(n)},unbindDroppable:function(n,y,h,S){r(this,S).destroyDroppable(n,y,h)},droppable:function(n,y){n=H.isArray(n)||n.length!=null&&!H.isString(n)?n:[n];let h;return y=y||{},y.allowLoopback=!1,Array.prototype.slice.call(n).forEach(function(S){h=this.info(S),h.el&&this.initDroppable(h.el,y)}.bind(this)),this},initDroppable:function(n,y,h){r(this,h).droppable(n,y)},isAlreadyDraggable:function(n){return n._katavorioDrag!=null},isDragSupported:function(n,y){return!0},isDropSupported:function(n,y){return!0},isElementDraggable:function(n){return n=c.getElement(n),n._katavorioDrag&&n._katavorioDrag.isEnabled()},getDragObject:function(n){return n[0].drag.getDragElement()},getDragScope:function(n){return n._katavorioDrag&&n._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(n){return n[0].e},getUIPosition:function(n,y){let h=n[0].el;if(h.offsetParent==null)return null;let S=n[0].finalPos||n[0].pos,T={left:S[0],top:S[1]};if(h._katavorioDrag&&h.offsetParent!==this.getContainer()){let f=this.getOffset(h.offsetParent);T.left+=f.left,T.top+=f.top}return T},setDragFilter:function(n,y,h){n._katavorioDrag&&n._katavorioDrag.setFilter(y,h)},setElementDraggable:function(n,y){n=c.getElement(n),n._katavorioDrag&&n._katavorioDrag.setEnabled(y)},setDragScope:function(n,y){n._katavorioDrag&&n._katavorioDrag.k.setDragScope(n,y)},setDropScope:function(n,y){n._katavorioDrop&&n._katavorioDrop.length>0&&n._katavorioDrop[0].k.setDropScope(n,y)},addToPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),S=r(this);c.each(n,function(T){T=[c.getElement(T)],T.push.apply(T,h),S.addToPosse.apply(S,T)})},setPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),S=r(this);c.each(n,function(T){T=[c.getElement(T)],T.push.apply(T,h),S.setPosse.apply(S,T)})},removeFromPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),S=r(this);c.each(n,function(T){T=[c.getElement(T)],T.push.apply(T,h),S.removeFromPosse.apply(S,T)})},removeFromAllPosses:function(n){let y=r(this);c.each(n,function(h){y.removeFromAllPosses(c.getElement(h))})},setPosseState:function(n,y,h){let S=r(this);c.each(n,function(T){S.setPosseState(c.getElement(T),y,h)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(n){n._katavorioDrag&&n._katavorioDrag.abort()},addToDragSelection:function(n){r(this).select(n)},removeFromDragSelection:function(n){r(this).deselect(n)},clearDragSelection:function(){r(this).deselectAll()},trigger:function(n,y,h,S){this.getEventManager().trigger(n,y,h,S)},doReset:function(){for(let n in this)n.indexOf("_katavorio_")===0&&this[n].reset()},getEventManager:function(){return W(this)},on:function(n,y,h){return this.getEventManager().on.apply(this,arguments),this},off:function(n,y,h){return this.getEventManager().off.apply(this,arguments),this}}),function(n){let y=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?n():setTimeout(y,9)};y()}(c.init)}).call(typeof window<"u"?window:globalThis);const ge={jsplumbSetting:{Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"efContainer",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.1,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},Scope:"jsPlumb_DefaultScope"},jsplumbConnectOptions:{isSource:!0,isTarget:!0,anchor:"Continuous",labelStyle:{cssClass:"flowLabel"},emptyLabelStyle:{cssClass:"emptyFlowLabel"}},jsplumbSourceOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!1,connectorStyle:{stroke:"#b1b1b1",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#999999",strokeWidth:1.5}},jsplumbSourceOptions2:{filter:".flow-node-drag",filterExclude:!1,allowLoopback:!0,connector:["Flowchart",{curviness:50}],connectorStyle:{stroke:"#1089ff",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#0d6ecc",strokeWidth:1.5}},jsplumbTargetOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}}};class Yn{constructor(c){this.loadEasyFlowFinish=!1,this.jsplumb=jsPlumb.getInstance(),this.init(c)}init(c){this.jsplumb.ready(()=>{this.jsplumb.importDefaults(ge.jsplumbSetting),this.jsplumb.setSuspendDrawing(!1,!0),this.loadEasyFlow(c),this.loadEasyFlowFinish=!0,this.jsplumb.setContainer(document.querySelector("#efContainer"))})}loadEasyFlow(c){const{nodeList:H,lineList:Q}=c,J=je(ce(ge.jsplumbSourceOptions),{}),W=je(ce(ge.jsplumbTargetOptions),{});for(let r=0;r<H.length;r++){let E=H[r];this.jsplumb.makeSource(E.id,J),this.jsplumb.makeTarget(E.id,W),E.viewOnly||this.jsplumb.draggable(E.id,{containment:"parent"})}for(let r=0;r<Q.length;r++){let E=Q[r],a={source:E.from,target:E.to,label:E.label?E.label:"",connector:E.connector?E.connector:"",anchors:E.anchors?E.anchors:void 0,paintStyle:E.paintStyle?E.paintStyle:void 0};this.jsplumb.connect(a,ge.jsplumbConnectOptions)}}getConnections(c,H){return this.jsplumb.getConnections({source:c,target:H})[0]}deleteConnection(c,H){const Q=this.getConnections(c,H);this.jsplumb.deleteConnection(Q)}removeAllEndpoints(c){this.jsplumb.removeAllEndpoints(c)}addNode(c){const H=je(ce(ge.jsplumbSourceOptions),{}),Q=je(ce(ge.jsplumbTargetOptions),{});this.jsplumb.makeSource(c,H),this.jsplumb.makeTarget(c,Q),this.jsplumb.draggable(c,{containment:"parent"})}repaint(){this.jsplumb.repaint()}}let Xn={name:"\u6D41\u7A0BA",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BA-\u8282\u70B9A",type:"switch",left:"26px",top:"161px"},{id:"nodeB",name:"\u6D41\u7A0BA-\u8282\u70B9B",type:"common",left:"340px",top:"161px"},{id:"nodeC",name:"\u6D41\u7A0BA-\u8282\u70B9C",type:"common",left:"739px",top:"161px"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},Wn={name:"\u6D41\u7A0BB",nodeList:[{id:"nodeA",name:"\u8282\u70B9A-\u4E0D\u53EF\u62D6\u62FD",type:"common",left:"18px",top:"223px",ico:"user",state:"success",viewOnly:!0},{id:"nodeB",type:"common",name:"\u6D41\u7A0BB-\u8282\u70B9B",left:"351px",top:"96px",ico:"bug",state:"error"},{id:"nodeC",name:"\u6D41\u7A0BB-\u8282\u70B9C",type:"common",left:"354px",top:"351px",ico:"index",state:"warning"},{id:"nodeD",name:"\u6D41\u7A0BB-\u8282\u70B9D",type:"common",left:"723px",top:"215px",ico:"printer",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"\u6761\u4EF6A"},{from:"nodeA",to:"nodeC",label:"\u6761\u4EF6B"},{from:"nodeB",to:"nodeD"},{from:"nodeC",to:"nodeD"}]},zn={name:"\u6D41\u7A0BC",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BC-\u8282\u70B9A",type:"common",left:"400px",top:"15px",ico:"smile"},{id:"nodeB",name:"\u6D41\u7A0BC-\u8282\u70B9B",type:"common",left:"400px",top:"200px",ico:"smile"},{id:"nodeC",name:"\u6D41\u7A0BC-\u8282\u70B9C",type:"common",left:"400px",top:"378px",ico:"smile"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},qn={name:"\u6D41\u7A0BD",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BD-\u8282\u70B9A",type:"common",left:"18px",top:"223px",ico:"smile",state:"success"},{id:"nodeB",type:"common",name:"\u6D41\u7A0BD-\u8282\u70B9B",left:"351px",top:"96px",ico:"smile",state:"error"},{id:"nodeC",name:"\u6D41\u7A0BD-\u8282\u70B9C",type:"common",left:"354px",top:"351px",ico:"smile",state:"warning"},{id:"nodeD",name:"\u6D41\u7A0BD-\u8282\u70B9D",type:"common",left:"723px",top:"215px",ico:"smile",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"\u76F4\u7EBF,\u81EA\u5B9A\u4E49\u7EBF\u6837\u5F0F,\u56FA\u5B9A\u951A\u70B9",connector:"Straight",anchors:["Top","Bottom"],paintStyle:{strokeWidth:2,stroke:"#1879FF"}},{from:"nodeA",to:"nodeC",label:"\u8D1D\u585E\u5C14\u66F2\u7EBF,\u56FA\u5B9A\u951A\u70B9",connector:"Bezier",anchors:["Bottom","Left"]},{from:"nodeB",to:"nodeD",label:"\u6D41\u7A0B\u56FE\u7EBF,\u52A8\u6001\u951A\u70B9",connector:["Flowchart",{curviness:50}]},{from:"nodeC",to:"nodeD",label:"\u72B6\u6001\u673A,\u52A8\u6001\u951A\u70B9",connector:["StateMachine",{margin:8,curviness:10,proximityLimit:80}]},{from:"nodeC",to:"nodeC",label:"\u81EA\u8FDE\u63A5"}]};function $n(X="dataB"){return ce({dataA:Xn,dataB:Wn,dataC:zn,dataD:qn}[X])}const Jn=X=>(Ae("data-v-8c3a720f"),X=X(),ke(),X),Kn={class:"ef-toolbar"},Zn={style:{float:"right","margin-right":"5px"}},Qn={key:0,class:"easy-flow"},ti={class:"left-side"},ei=["onClick"],ni=Jn(()=>Et("div",{class:"move-grid",style:{position:"absolute",top:"2000px",left:"2000px"}},"\xA0",-1)),ii={class:"right-side"},si={name:"EasyFlow"},oi=Object.assign(si,{props:{height:{type:String,default:"100%"},repeat:{type:Boolean,default:!0}},setup(X){const c=X,H=Jt(!1),Q=Jt(null),J=Jt(null),W=Jt(!1),r=Jt(!1),E=Jt({nodeList:[],lineList:[]}),a=Jt({type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}),t=Be({show:!1,type:"",left:0,top:0});let p;Xe(()=>{D("dataA")});function x(u,m){const{lineList:A}=E.value;return A.findIndex(F=>F.from===u&&F.to===m)>-1}function j(u,m){return x(m,u)}async function D(u){const m=$n(u);a.value.type="node",a.value.nodeId="",H.value=!1,E.value={nodeList:[],lineList:[]},await we(),H.value=!0,E.value=ce(m),await we(),I()}function I(){p=new Yn(E.value),p.jsplumb.bind("click",h),p.jsplumb.bind("connection",T),p.jsplumb.bind("connectionDetached",f),p.jsplumb.bind("connectionMoved",_),p.jsplumb.bind("contextmenu",(u,m)=>{m.preventDefault(),n(u,m)}),p.jsplumb.bind("beforeDrop",S),console.log("----------new plumb----------",p)}function s(){}function l(u){a.value.type="node",a.value.nodeId=u,Q.value.nodeInit(E.value,u)}function N(u){const{nodeList:m}=E.value;for(let A=0;A<m.length;A++){let F=m[A];F.id===u.nodeId&&(F.left=u.left,F.top=u.top)}}function R(u){const m=E.value.nodeList.findIndex(A=>A.id===u);E.value.nodeList.splice(m,1),we(()=>{p.removeAllEndpoints(u)})}function U(){const{type:u,nodeId:m,sourceId:A,targetId:F}=a.value;qe.confirm({type:"warning",title:"\u63D0\u793A",message:`\u786E\u5B9A\u5220\u9664\u5F53\u524D\u9009\u4E2D\u7684${u==="node"?"\u8282\u70B9":"\u8FDE\u63A5\u7EBF"}\u5417?`}).then(()=>{u==="node"?R(m):u==="line"&&p.deleteConnection(A,F)}).catch(()=>{})}function O(u){u.preventDefault();let m=u.dataTransfer.getData("node"),A={};try{A=JSON.parse(m)}catch{console.log("drag data is not right json!");return}const F=J.value.getBoundingClientRect(),i=u.clientX,e=u.clientY,d=i-F.x+J.value.scrollLeft-85,C=e-F.y+J.value.scrollTop-16;let w=A.name,B=w,z=A.id;if(c.repeat){let V=1;for(;V<1e4;){let ot=!1;for(let ct=0;ct<E.value.nodeList.length;ct++)E.value.nodeList[ct].name===B&&(B=w+V,ot=!0);if(ot){V++;continue}break}z=ze()}const Y={id:z,name:B,type:A.type,left:d+"px",top:C+"px",ico:A.ico};E.value.nodeList.push(Y),we(()=>p.addNode(z))}function b(u,m){l(u),t.show=!0,t.type="node",t.left=m.clientX+"px",t.top=m.clientY+"px"}function n(u,m){h(u),t.show=!0,t.type="line",t.left=m.clientX+"px",t.top=m.clientY+"px"}function y(){t.show=!1}Ue(()=>t.show,u=>{u?document.body.addEventListener("click",y):document.body.removeEventListener("click",y)});function h(u){a.value.type="line",a.value.sourceId=u.sourceId,a.value.targetId=u.targetId,Q.value.lineInit(E.value,{from:u.sourceId,to:u.targetId,label:u.getLabel()})}function S(u){const{sourceId:m,targetId:A}=u;return m===A?!1:x(m,A)?(Oe.error("\u8BE5\u5173\u7CFB\u5DF2\u5B58\u5728,\u4E0D\u5141\u8BB8\u91CD\u590D\u521B\u5EFA"),!1):j(m,A)?(Oe.error("\u4E0D\u652F\u6301\u4E24\u4E2A\u8282\u70B9\u4E4B\u95F4\u8FDE\u7EBF\u56DE\u73AF"),!1):(Oe.success("\u8FDE\u63A5\u6210\u529F"),!0)}function T(u){const{sourceId:m,targetId:A}=u;p.loadEasyFlowFinish&&E.value.lineList.push({from:m,to:A})}function f(u){const{sourceId:m,targetId:A}=u,F=E.value.lineList.findIndex(i=>i.from===m&&i.to===A);E.value.lineList.splice(F,1)}function _(u){const{originalSourceId:m,originalTargetId:A}=u,F=E.value.lineList.findIndex(i=>i.from===m&&i.to===A);E.value.lineList.splice(F,1)}function v({from:u,to:m,label:A}){let F=p.getConnections(u,m);!A||A===""?(F.removeClass("flowLabel"),F.addClass("emptyFlowLabel")):F.addClass("flowLabel"),F.setLabel({label:A}),E.value.lineList.forEach(i=>{i.from===u&&i.to===m&&(i.label=A)})}function M(){p.repaint()}function g(){a.value={type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}}return(u,m)=>{const A=Ot("b-button"),F=Ot("b-divider"),i=Ot("b-dropdown-item"),e=Ot("b-dropdown-menu"),d=Ot("b-dropdown"),C=We("flow-drag");return wt(),At("div",{class:"easy-flow-container",style:Me({height:X.height})},[Et("div",Kn,[bt(A,{type:"text"},{default:xt(()=>[Nt(oe(E.value.name),1)]),_:1}),bt(F,{type:"vertical"}),bt(A,{type:"text",icon:"delete",onClick:U,disabled:!a.value.type},null,8,["disabled"]),Et("div",Zn,[bt(A,{size:"small",type:"info",plain:"",icon:"filedone",onClick:m[0]||(m[0]=w=>W.value=!0)},{default:xt(()=>[Nt(" \u6D41\u7A0B\u4FE1\u606F ")]),_:1}),bt(d,{trigger:"click",style:{margin:"0 10px"},onCommand:D},{dropdown:xt(()=>[bt(e,null,{default:xt(()=>[bt(i,{name:"dataA"},{default:xt(()=>[Nt("dataA")]),_:1}),bt(i,{name:"dataB"},{default:xt(()=>[Nt("dataB")]),_:1}),bt(i,{name:"dataC"},{default:xt(()=>[Nt("dataC")]),_:1}),bt(i,{name:"dataD"},{default:xt(()=>[Nt("dataD")]),_:1})]),_:1})]),default:xt(()=>[bt(A,{size:"small",type:"info",plain:"",icon:"database"},{default:xt(()=>[Nt("\u6570\u636E\u6E90")]),_:1})]),_:1}),bt(A,{size:"small",type:"info",plain:"",icon:"book",onClick:m[1]||(m[1]=w=>r.value=!0)},{default:xt(()=>[Nt(" \u5E2E\u52A9 ")]),_:1})])]),H.value?(wt(),At("div",Qn,[Et("div",ti,[bt(Pn,{repeat:X.repeat,data:E.value},null,8,["repeat","data"])]),Gt((wt(),At("div",{class:"canvas-side",id:"efContainer",ref_key:"efContainer",ref:J,onClick:Te(s,["self"]),onDragover:m[2]||(m[2]=Te(()=>{},["prevent"])),onDrop:O},[(wt(!0),At(ie,null,ye(E.value.nodeList,w=>(wt(),he(rn,{key:w.id,id:w.id,node:w,activeElement:a.value,onClickNode:l,onChangeNodeSite:N,onNodeRightMenu:b},null,8,["id","node","activeElement"]))),128)),ni],40,ei)),[[C]]),Et("div",ii,[bt(Tn,{ref_key:"nodeFormRef",ref:Q,onSetLineLabel:v,onSaveNode:M,onCancelSelect:g},null,512)]),bt(Fn,{modelValue:W.value,"onUpdate:modelValue":m[3]||(m[3]=w=>W.value=w),data:E.value},null,8,["modelValue","data"]),bt(Ln,{data:t,onDelete:U},null,8,["data"])])):se("",!0),bt(Vn,{modelValue:r.value,"onUpdate:modelValue":m[4]||(m[4]=w=>r.value=w)},null,8,["modelValue"])],4)}}}),li=be(oi,[["__scopeId","data-v-8c3a720f"]]);const ri={class:"p16 wrapper"},fi={__name:"index",setup(X){return(c,H)=>(wt(),At("div",ri,[bt(li)]))}};export{fi as default};
