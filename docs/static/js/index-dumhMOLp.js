import{a8 as be,r as Jt,l as Zt,o as wt,a as At,b as Et,H as me,F as ie,i as se,t as oe,g as Rt,v as Ut,I as Ie,O as Oe,R as Ot,Q as ye,j as he,m as Ge,K as bt,w as xt,f as Nt,T as Ue,n as Re,p as He,G as we,P as Ve}from"./vendor-COsJffew.js";import{d as ce,f as je,k as Ye}from"./index-DlSIhdb0.js";import{n as Ae,c as Xe}from"./chunk-bin-ui-design-55yTQV6H.js";import"./chunk-brace-DF1jSkZr.js";const Me="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20class='icon'%20width='200px'%20height='200.00px'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill='%23333333'%20d='M212.992%20526.336%20212.992%20526.336%20212.992%20526.336%20215.04%20526.336%20212.992%20526.336ZM927.744%20530.432%20567.296%20530.432c-10.24%200-20.48%2010.24-20.48%2020.48l0%20221.184c0%2012.288%2010.24%2020.48%2020.48%2020.48l360.448%200c10.24%200%2020.48-8.192%2020.48-20.48L948.224%20550.912C948.224%20538.624%20937.984%20530.432%20927.744%20530.432zM909.312%20729.088c0%2014.336-10.24%2024.576-24.576%2024.576L610.304%20753.664c-14.336%200-24.576-10.24-24.576-24.576L585.728%20593.92c0-14.336%2010.24-24.576%2024.576-24.576l272.384%200c14.336%200%2024.576%2010.24%2024.576%2024.576L907.264%20729.088zM663.552%20815.104l167.936%200%200%2024.576-167.936%200%200-24.576ZM454.656%20178.176%2096.256%20178.176c-12.288%200-20.48%2010.24-20.48%2020.48l0%20221.184c0%2012.288%208.192%2020.48%2020.48%2020.48l360.448%200c12.288%200%2020.48-8.192%2020.48-20.48L477.184%20198.656C475.136%20186.368%20466.944%20178.176%20454.656%20178.176zM436.224%20376.832c0%2014.336-10.24%2024.576-24.576%2024.576L139.264%20401.408c-14.336%200-24.576-10.24-24.576-24.576l0-135.168c0-14.336%2010.24-24.576%2024.576-24.576l272.384%200c14.336%200%2024.576%2010.24%2024.576%2024.576L436.224%20376.832zM192.512%20462.848l167.936%200%200%2024.576-167.936%200%200-24.576ZM727.04%20313.344l24.576%200%200%20223.232-24.576%200%200-223.232ZM751.616%20198.656c-36.864%200-65.536%2030.72-65.536%2065.536s30.72%2065.536%2065.536%2065.536c36.864%200%2065.536-30.72%2065.536-65.536S788.48%20198.656%20751.616%20198.656zM751.616%20303.104c-20.48%200-38.912-16.384-38.912-38.912s16.384-38.912%2038.912-38.912%2038.912%2016.384%2038.912%2038.912S774.144%20303.104%20751.616%20303.104zM323.584%20684.032l223.232%200%200%2024.576-223.232%200%200-24.576ZM475.136%20253.952l223.232%200%200%2024.576-223.232%200%200-24.576ZM270.336%20487.424l24.576%200%200%20169.984-24.576%200%200-169.984ZM270.336%20638.976c-36.864%200-65.536%2030.72-65.536%2065.536s30.72%2065.536%2065.536%2065.536%2065.536-30.72%2065.536-65.536S307.2%20638.976%20270.336%20638.976zM270.336%20743.424c-20.48%200-38.912-16.384-38.912-38.912s16.384-38.912%2038.912-38.912%2038.912%2016.384%2038.912%2038.912S290.816%20743.424%20270.336%20743.424z'%20/%3e%3c/svg%3e",Le="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20class='icon'%20width='200px'%20height='200.00px'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill='%23333333'%20d='M874.496%20693.4528c-12.288-12.288-33.5872-3.6864-33.5872%2013.9264v59.392H684.032l-40.96-76.1856c16.384-11.0592%2028.2624-24.9856%2032.768-42.1888%201.2288-3.2768%202.048-7.3728%202.048-11.0592v-241.664-1.6384-2.4576c0-23.7568-13.5168-43.008-35.2256-57.344l40.96-76.1856h157.2864v53.6576c0%2017.6128%2021.2992%2026.2144%2033.5872%2013.9264l84.3776-84.3776c7.7824-7.7824%207.7824-20.0704%200-27.8528l-84.3776-84.3776c-12.288-12.288-33.5872-3.6864-33.5872%2013.9264V196.608h-175.3088c-11.4688%200-21.7088%206.144-27.0336%2015.9744L585.728%20310.0672c-22.9376-5.7344-48.7424-8.6016-73.728-8.6016s-50.7904%202.8672-73.728%208.6016L385.4336%20212.1728c-5.3248-9.8304-15.5648-15.9744-27.0336-15.9744H183.0912V142.5408c0-17.6128-21.2992-26.2144-33.5872-13.9264L65.1264%20212.992c-7.7824%207.7824-7.7824%2020.0704%200%2027.8528l84.3776%2084.3776c12.288%2012.288%2033.5872%203.6864%2033.5872-13.9264V257.6384H339.968l40.96%2076.1856c-21.7088%2014.336-35.2256%2033.5872-35.2256%2057.344v245.76c0%203.6864%200.8192%207.3728%202.048%2010.6496%204.5056%2017.2032%2016.384%2031.5392%2033.1776%2042.5984l-40.96%2076.1856H183.0912V712.704c0-17.6128-21.2992-26.2144-33.5872-13.9264l-84.3776%2084.3776c-7.7824%207.7824-7.7824%2020.0704%200%2027.8528l84.3776%2084.3776c12.288%2012.288%2033.5872%203.6864%2033.5872-13.9264v-53.6576h175.3088c11.4688%200%2021.7088-6.144%2027.0336-15.9744l52.8384-97.8944c23.7568%205.7344%2049.152%208.6016%2073.728%208.6016s50.3808-2.8672%2073.728-8.6016l52.8384%2097.8944c5.3248%209.8304%2015.5648%2015.9744%2027.0336%2015.9744h175.3088v47.5136c0%2017.6128%2021.2992%2026.2144%2033.5872%2013.9264l84.3776-84.3776c7.7824-7.7824%207.7824-20.0704%200-27.8528l-84.3776-83.5584z%20m-466.944-61.44V399.7696c0.4096-2.4576%200.4096-5.3248%200-8.192%204.9152-9.0112%2040.5504-29.0816%20104.448-29.0816s99.5328%2020.0704%20104.448%2029.0816c-0.4096%202.8672-0.4096%205.3248%200%207.7824v232.2432c-4.096%208.6016-39.7312%2029.4912-104.448%2029.4912s-100.352-20.48-104.448-29.0816z'%20/%3e%3c/svg%3e",We={key:0,src:Me,class:"node-ico"},ze={key:1,src:Le,class:"switch-ico"},qe=["title"],$e={key:0,class:"ef-node-right-ico"},Je={class:"b-iconfont b-icon-check-circle"},Ze={class:"b-iconfont b-icon-error"},Ke={class:"b-iconfont b-icon-warning-circle"},Qe={class:"b-iconfont b-icon-loading"},tn={__name:"flow-node",props:{node:{type:Object,default:()=>({})},showState:{type:Boolean,default:!0},activeElement:Object},emits:["clickNode","changeNodeSite","nodeRightMenu"],setup(q,{emit:c}){const H=c,Q=q,J=Jt(null),X=Zt(()=>({top:Q.node.top,left:Q.node.left})),r=Zt(()=>Q.activeElement.type==="node"&&Q.activeElement.nodeId===Q.node.id),x=Zt(()=>["ef-node-container",`el-node-${Q.node.type}`,{"ef-node-active":r.value},{"view-only":Q.node.viewOnly}]),u=Zt(()=>{const j={};return j[`b-iconfont b-icon-${Q.node.ico}`]=!0,j});function t(){H("clickNode",Q.node.id)}function g(){const{left:j,top:P}=Q.node,I=J.value.style;if(j===I.left&&P===I.top)return;const s={nodeId:Q.node.id,left:I.left,top:I.top};H("changeNodeSite",s)}function S(j){H("nodeRightMenu",Q.node.id,j)}return(j,P)=>(wt(),At("div",{ref_key:"nodeRef",ref:J,style:Ie(X.value),class:me(x.value),onClick:t,onMouseup:g,onContextmenu:P[0]||(P[0]=Oe(I=>S(I),["stop","prevent"]))},[P[1]||(P[1]=Et("div",{class:"ef-node-left"},null,-1)),Et("div",{class:me(["ef-node-left-ico",{" flow-node-drag":!q.node.viewOnly}])},[q.node.ico?(wt(),At("i",{key:0,class:me(u.value)},null,2)):(wt(),At(ie,{key:1},[q.node.type==="common"?(wt(),At("img",We)):se("",!0),q.node.type==="switch"?(wt(),At("img",ze)):se("",!0)],64))],2),Et("div",{class:"ef-node-text",title:q.node.name},oe(q.node.name),9,qe),q.showState?(wt(),At("div",$e,[Rt(Et("i",Je,null,512),[[Ut,q.node.state==="success"]]),Rt(Et("i",Ze,null,512),[[Ut,q.node.state==="error"]]),Rt(Et("i",Ke,null,512),[[Ut,q.node.state==="warning"]]),Rt(Et("i",Qe,null,512),[[Ut,q.node.state==="running"]])])):se("",!0)],38))}},en=be(tn,[["__scopeId","data-v-ac610543"]]),nn={class:"flow-menu",ref:"tool"},sn={class:"type-box"},on={class:"ef-node-menu-ul"},ln=["type","draggable","onDragstart"],rn={class:"ef-node-left-ico"},un={key:0,src:Me,alt:"node",style:{width:"24px",height:"24px"}},an={key:1,src:Le,alt:"switch",style:{width:"20px",height:"20px"}},cn={class:"ef-node-text"},ke="common",Ne="switch",hn={__name:"flow-menu",props:{repeat:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},menuList:{type:Object,default:()=>({common:[{id:"11",type:"common",name:"数据接入",ico:"index",style:{}},{id:"12",type:"common",name:"接口调用",style:{}}],switch:[{id:"13",type:"switch",name:"流程结束",style:{}},{id:"14",type:"switch",name:"数据清理",ico:"clear",style:{}}]})}},setup(q){const c=q,H=Jt(ke),Q=Zt(()=>c.menuList[H.value]);function J(r){return c.data.nodeList.findIndex(x=>x.id===r)>-1}function X(r,x){r.dataTransfer.setData("node",JSON.stringify(x))}return(r,x)=>{const u=Ot("b-icon");return wt(),At("div",nn,[Et("div",sn,[Et("div",{class:me(["type-item",{active:H.value===ke}]),title:"通用节点",onClick:x[0]||(x[0]=t=>H.value=ke)},x[2]||(x[2]=[Et("img",{src:Me,alt:"node",style:{width:"24px",height:"24px"}},null,-1)]),2),Et("div",{class:me(["type-item",{active:H.value===Ne}]),title:"条件节点",onClick:x[1]||(x[1]=t=>H.value=Ne)},x[3]||(x[3]=[Et("img",{src:Le,alt:"switch",style:{width:"20px",height:"20px"}},null,-1)]),2)]),Et("ul",on,[(wt(!0),At(ie,null,ye(Q.value,t=>(wt(),At("li",{class:me(["ef-node-menu-li",[t.type,{disabled:J(t.id)}]]),key:t.id,type:t.type,draggable:!J(t.id),onDragstart:g=>X(g,t)},[Et("div",rn,[t.ico?(wt(),he(u,{key:0,name:t.ico},null,8,["name"])):(wt(),At(ie,{key:1},[t.type==="common"?(wt(),At("img",un)):se("",!0),t.type==="switch"?(wt(),At("img",an)):se("",!0)],64))]),Et("span",cn,oe(t.name),1)],42,ln))),128))])],512)}}},dn=be(hn,[["__scopeId","data-v-ce640da8"]]),fn={class:"ef-node-form"},pn={class:"ef-node-form-body"},gn={class:"empty"},mn={class:"mr-8"},yn={class:"b-iconfont b-icon-check-circle"},bn={class:"b-iconfont b-icon-error"},vn={class:"b-iconfont b-icon-warning-circle"},_n={class:"b-iconfont b-icon-loading"},Pn={__name:"flow-form",props:{showIco:{type:Boolean,default:!0},showState:{type:Boolean,default:!0}},emits:["setLineLabel","saveNode","cancelSelect"],setup(q,{expose:c,emit:H}){const Q=H,J=[{state:"success",label:"成功"},{state:"warning",label:"警告"},{state:"error",label:"错误"},{state:"running",label:"运行中"}],X=Ge({type:"node",node:{},line:{},data:{}}),r=Zt(()=>Object.keys(X.node).length===0&&Object.keys(X.line).length===0);function x(j,P){X.type="node",X.data=j,j.nodeList.forEach(I=>{I.id===P&&(X.node=ce(I))})}function u(j,P){X.type="line",X.data=j,X.line=P}function t(){Q("setLineLabel",X.line)}function g(){X.data.nodeList.forEach(j=>{j.id===X.node.id&&(j.name=X.node.name,j.left=X.node.left,j.top=X.node.top,j.ico=X.node.ico,j.state=X.node.state,Q("saveNode",j))})}function S(){X.type="node",X.node={},X.line={},X.data={},Q("cancelSelect")}return c({nodeInit:x,lineInit:u}),(j,P)=>{const I=Ot("b-input"),s=Ot("b-form-item"),l=Ot("b-icon-select"),N=Ot("b-option"),G=Ot("b-select"),U=Ot("b-button"),O=Ot("b-form"),b=Ot("b-ace-editor");return wt(),At("div",fn,[P[12]||(P[12]=Et("div",{class:"ef-node-form-header"},"编辑",-1)),Et("div",pn,[Rt(Et("div",gn,"暂未选择元素",512),[[Ut,r.value]]),Rt(bt(O,{model:X.node,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(s,{label:"类型"},{default:xt(()=>[bt(I,{modelValue:X.node.type,"onUpdate:modelValue":P[0]||(P[0]=n=>X.node.type=n),disabled:!0},null,8,["modelValue"])]),_:1}),bt(s,{label:"名称"},{default:xt(()=>[bt(I,{modelValue:X.node.name,"onUpdate:modelValue":P[1]||(P[1]=n=>X.node.name=n),clearable:""},null,8,["modelValue"])]),_:1}),bt(s,{label:"left坐标"},{default:xt(()=>[bt(I,{modelValue:X.node.left,"onUpdate:modelValue":P[2]||(P[2]=n=>X.node.left=n),disabled:""},null,8,["modelValue"])]),_:1}),bt(s,{label:"top坐标"},{default:xt(()=>[bt(I,{modelValue:X.node.top,"onUpdate:modelValue":P[3]||(P[3]=n=>X.node.top=n),disabled:""},null,8,["modelValue"])]),_:1}),q.showIco?(wt(),he(s,{key:0,label:"ico图标"},{default:xt(()=>[bt(l,{modelValue:X.node.ico,"onUpdate:modelValue":P[4]||(P[4]=n=>X.node.ico=n)},null,8,["modelValue"])]),_:1})):se("",!0),q.showState?(wt(),he(s,{key:1,label:"状态"},{default:xt(()=>[bt(G,{modelValue:X.node.state,"onUpdate:modelValue":P[5]||(P[5]=n=>X.node.state=n),placeholder:"请选择",clearable:""},{default:xt(()=>[(wt(),At(ie,null,ye(J,n=>bt(N,{key:n.state,label:n.label,value:n.state},{default:xt(()=>[Et("span",mn,[Rt(Et("i",yn,null,512),[[Ut,n.state==="success"]]),Rt(Et("i",bn,null,512),[[Ut,n.state==="error"]]),Rt(Et("i",vn,null,512),[[Ut,n.state==="warning"]]),Rt(Et("i",_n,null,512),[[Ut,n.state==="running"]])]),Et("span",null,oe(n.label),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})):se("",!0),bt(s,null,{default:xt(()=>[bt(U,{icon:"close",onClick:S},{default:xt(()=>P[8]||(P[8]=[Nt("取消")])),_:1}),bt(U,{type:"primary",icon:"check",onClick:g},{default:xt(()=>P[9]||(P[9]=[Nt("保存")])),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,X.type==="node"&&X.node.type]]),Rt(bt(O,{model:X.line,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(s,{label:"类型"},{default:xt(()=>[bt(I,{modelValue:X.type,"onUpdate:modelValue":P[6]||(P[6]=n=>X.type=n),disabled:!0},null,8,["modelValue"])]),_:1}),bt(s,{label:"条件"},{default:xt(()=>[bt(I,{modelValue:X.line.label,"onUpdate:modelValue":P[7]||(P[7]=n=>X.line.label=n),clearable:""},null,8,["modelValue"])]),_:1}),bt(s,null,{default:xt(()=>[bt(U,{icon:"close",onClick:S},{default:xt(()=>P[10]||(P[10]=[Nt("取消")])),_:1}),bt(U,{type:"primary",icon:"check",onClick:t},{default:xt(()=>P[11]||(P[11]=[Nt("保存")])),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,X.type==="line"]]),bt(b,{"model-value":JSON.stringify(X,null,2),height:"200px"},null,8,["model-value"])])])}}},Cn=be(Pn,[["__scopeId","data-v-a7ee15a9"]]),xn={__name:"context-menu",props:{data:{type:Object,default:()=>({})}},emits:["delete"],setup(q,{emit:c}){const H=c,Q=q,J=Zt(()=>Q.data.show),X=Zt(()=>({left:Q.data.left,top:Q.data.top}));function r(){H("delete")}return(x,u)=>{const t=Ot("b-icon");return wt(),he(Ue,{name:"zoom-in-top"},{default:xt(()=>[Rt(Et("ul",{class:"contextmenu",style:Ie(X.value)},[Et("li",{onClick:r},[bt(t,{name:"delete"}),Nt(" 删除"+oe(q.data.type==="line"?"线":"节点"),1)])],4),[[Ut,J.value]])]),_:1})}}},En=be(xn,[["__scopeId","data-v-9e4baa69"]]),Sn={__name:"flow-info",props:{data:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(q,{emit:c}){const H=c,Q=q,J=Zt({get:()=>Q.modelValue,set:X=>H("update:modelValue",X)});return(X,r)=>{const x=Ot("b-ace-editor"),u=Ot("b-modal");return wt(),he(u,{modelValue:J.value,"onUpdate:modelValue":r[0]||(r[0]=t=>J.value=t),title:"流程数据信息",width:"680px","destroy-on-close":""},{default:xt(()=>[bt(x,{"model-value":JSON.stringify(q.data,null,2),height:"500px"},null,8,["model-value"])]),_:1},8,["modelValue"])}}},Dn={style:{overflow:"hidden"},flex:""},wn={style:{width:"30%","border-right":"1px solid #f0f0f0"}},jn={class:"scroll-box"},An=["id"],kn={class:"title"},On={__name:"helper",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(q,{emit:c}){const H=c,Q=q,J=Jt("add"),X=[{id:"add",icon:"plus-circle",title:"如何新增",message:["按住鼠标拖拽左侧组件到中间画布中松开鼠标即可"]},{id:"delete",icon:"delete",title:"如何删除",message:["1、鼠标点中需要删除的节点或连线，点击左上角的删除图标","2、鼠标右键需要删除的节点或连线，选择删除节点或删除线"]},{id:"move",icon:"drag",title:"如何移动",message:["鼠标移动到节点中，当鼠标变为可拖拽的图标时按下鼠标移动到新的位置松开鼠标"]},{id:"line",icon:"index",title:"如何连线",message:["鼠标移动到节点中左侧的图标上，当鼠标变为 + 时按下鼠标移动到另一个节点中松开鼠标"]},{id:"condition",icon:"sisternode",title:"如何添加条件",message:["点击画布中的连线，在页面右侧会出现一个表单，输入新的条件，点击【保存】"]}],r=Zt({get:()=>Q.modelValue,set:x=>H("update:modelValue",x)});return Re(()=>r.value,x=>{x&&(J.value="add")}),(x,u)=>{const t=Ot("b-icon"),g=Ot("b-menu-item"),S=Ot("b-menu"),j=Ot("b-divider"),P=Ot("b-modal");return wt(),he(P,{modelValue:r.value,"onUpdate:modelValue":u[1]||(u[1]=I=>r.value=I),title:"帮助",width:"680px","body-styles":{padding:0}},{default:xt(()=>[Et("div",Dn,[Et("div",wn,[bt(S,{"default-active":J.value,onSelect:u[0]||(u[0]=I=>J.value=I)},{default:xt(()=>[(wt(),At(ie,null,ye(X,I=>bt(g,{key:I.id,index:I.id},{title:xt(()=>[Nt(oe(I.title),1)]),default:xt(()=>[bt(t,{name:I.icon},null,8,["name"])]),_:2},1032,["index"])),64))]),_:1},8,["default-active"])]),Et("div",jn,[(wt(),At(ie,null,ye(X,I=>Rt(Et("div",{key:I.id,class:"scroll-page",id:I.id},[Et("div",kn,[bt(j,{align:"left",style:{margin:"0"}},{default:xt(()=>[Nt(oe(I.title),1)]),_:2},1024)]),(wt(!0),At(ie,null,ye(I.message,(s,l)=>(wt(),At("p",{key:l},oe(s),1))),128))],8,An),[[Ut,I.id===J.value]])),64))])])]),_:1},8,["modelValue"])}}},In=be(On,[["__scopeId","data-v-2b6f178d"]]);(function(){typeof Math.sgn>"u"&&(Math.sgn=function(m){return m==0?0:m>0?1:-1});let q={subtract:function(m,a){return{x:m.x-a.x,y:m.y-a.y}},dotProduct:function(m,a){return m.x*a.x+m.y*a.y},square:function(m){return Math.sqrt(m.x*m.x+m.y*m.y)},scale:function(m,a){return{x:m.x*a,y:m.y*a}}},c=64,H=Math.pow(2,-c-1),Q=function(m,a){let f=[],A=X(m,a),F=a.length-1,i=2*F-1,e=r(A,i,f,0),d=q.subtract(m,a[0]),E=q.square(d),w=0;for(let W=0;W<e;W++){d=q.subtract(m,g(a,F,f[W],null,null));var B=q.square(d);B<E&&(E=B,w=f[W])}return d=q.subtract(m,a[F]),B=q.square(d),B<E&&(E=B,w=1),{location:w,distance:E}},J=function(m,a){let f=Q(m,a);return{point:g(a,a.length-1,f.location,null,null),location:f.location}};var X=function(m,a){let f=a.length-1,A=2*f-1,F=[],i=[],e=[],d=[],E=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];for(var w=0;w<=f;w++)F[w]=q.subtract(a[w],m);for(var w=0;w<=f-1;w++)i[w]=q.subtract(a[w+1],a[w]),i[w]=q.scale(i[w],3);for(let Y=0;Y<=f-1;Y++)for(let V=0;V<=f;V++)e[Y]||(e[Y]=[]),e[Y][V]=q.dotProduct(i[Y],F[V]);for(w=0;w<=A;w++)d[w]||(d[w]=[]),d[w].y=0,d[w].x=parseFloat(w)/A;let B=f,W=f-1;for(let Y=0;Y<=B+W;Y++){let V=Math.max(0,Y-W),ot=Math.min(Y,B);for(w=V;w<=ot;w++){let ct=Y-w;d[w+ct].y+=e[ct][w]*E[ct][w]}}return d},r=function(m,a,f,A){let F=[],i=[],e,d,E=[],w=[];switch(x(m,a)){case 0:return 0;case 1:{if(A>=c)return f[0]=(m[0].x+m[a].x)/2,1;if(u(m,a))return f[0]=t(m,a),1;break}}g(m,a,.5,F,i),e=r(F,a,E,A+1),d=r(i,a,w,A+1);for(var B=0;B<e;B++)f[B]=E[B];for(var B=0;B<d;B++)f[B+e]=w[B];return e+d},x=function(m,a){let f=0,A,F;A=F=Math.sgn(m[0].y);for(let i=1;i<=a;i++)A=Math.sgn(m[i].y),A!=F&&f++,F=A;return f},u=function(m,a){let f,A,F,i,e,d,E,w,B,W,Y,V,ot,ct,pt,$;d=m[0].y-m[a].y,E=m[a].x-m[0].x,w=m[0].x*m[a].y-m[a].x*m[0].y;let rt,ft;rt=ft=0;for(let at=1;at<a;at++){let ht=d*m[at].x+E*m[at].y+w;ht>rt?rt=ht:ht<ft&&(ft=ht)}return Y=0,V=1,ot=0,ct=d,pt=E,$=w-rt,B=Y*pt-ct*V,W=1/B,A=(V*$-pt*ot)*W,ct=d,pt=E,$=w-ft,B=Y*pt-ct*V,W=1/B,F=(V*$-pt*ot)*W,i=Math.min(A,F),e=Math.max(A,F),f=e-i,f<H?1:0},t=function(m,a){let f=1,A=0,F=m[a].x-m[0].x,i=m[a].y-m[0].y,e=m[0].x-0,d=m[0].y-0,E=F*A-i*f,w=1/E,B=(F*d-i*e)*w;return 0+f*B},g=function(m,a,f,A,F){let i=[[]];for(var e=0;e<=a;e++)i[0][e]=m[e];for(let d=1;d<=a;d++)for(var e=0;e<=a-d;e++)i[d]||(i[d]=[]),i[d][e]||(i[d][e]={}),i[d][e].x=(1-f)*i[d-1][e].x+f*i[d-1][e+1].x,i[d][e].y=(1-f)*i[d-1][e].y+f*i[d-1][e+1].y;if(A!=null)for(e=0;e<=a;e++)A[e]=i[e][0];if(F!=null)for(e=0;e<=a;e++)F[e]=i[a-e][e];return i[a][0]};let S={},j=function(m){let a=S[m];if(!a){a=[];let A=function(){return function(w){return Math.pow(w,m)}},F=function(){return function(w){return Math.pow(1-w,m)}},i=function(w){return function(B){return w}},e=function(){return function(w){return w}},d=function(){return function(w){return 1-w}},E=function(w){return function(B){let W=1;for(let Y=0;Y<w.length;Y++)W=W*w[Y](B);return W}};a.push(new A);for(let w=1;w<m;w++){let B=[new i(m)];for(var f=0;f<m-w;f++)B.push(new e);for(var f=0;f<w;f++)B.push(new d);a.push(new E(B))}a.push(new F),S[m]=a}return a},P=function(m,a){let f=j(m.length-1),A=0,F=0;for(let i=0;i<m.length;i++)A=A+m[i].x*f[i](a),F=F+m[i].y*f[i](a);return{x:A,y:F}},I=function(m,a){return Math.sqrt(Math.pow(m.x-a.x,2)+Math.pow(m.y-a.y,2))},s=function(m){return m[0].x===m[1].x&&m[0].y===m[1].y},l=function(m,a,f){if(s(m))return{point:m[0],location:a};let A=P(m,a),F=0,i=a,e=f>0?1:-1,d=null;for(;F<Math.abs(f);)i+=.005*e,d=P(m,i),F+=I(d,A),A=d;return{point:d,location:i}},N=function(m){if(s(m))return 0;let a=P(m,0),f=0,A=0,F=1,i=null;for(;A<1;)A+=.005*F,i=P(m,A),f+=I(i,a),a=i;return f},G=function(m,a,f){return l(m,a,f).point},U=function(m,a,f){return l(m,a,f).location},O=function(m,a){let f=P(m,a),A=P(m.slice(0,m.length-1),a),F=A.y-f.y,i=A.x-f.x;return F===0?1/0:Math.atan(F/i)},b=function(m,a,f){let A=l(m,a,f);return A.location>1&&(A.location=1),A.location<0&&(A.location=0),O(m,A.location)},n=function(m,a,f,A){A=A??0;let F=l(m,a,A),i=O(m,F.location),e=Math.atan(-1/i),d=f/2*Math.sin(e),E=f/2*Math.cos(e);return[{x:F.point.x+E,y:F.point.y+d},{x:F.point.x-E,y:F.point.y-d}]},y=function(m,a,f,A,F){let i=A-a,e=m-f,d=m*(a-A)+a*(f-m),E=p(F),w=[i*E[0][0]+e*E[1][0],i*E[0][1]+e*E[1][1],i*E[0][2]+e*E[1][2],i*E[0][3]+e*E[1][3]+d],B=_.apply(null,w),W=[];if(B!=null)for(let V=0;V<3;V++){let ot=B[V],ct=Math.pow(ot,2),pt=Math.pow(ot,3),$=[E[0][0]*pt+E[0][1]*ct+E[0][2]*ot+E[0][3],E[1][0]*pt+E[1][1]*ct+E[1][2]*ot+E[1][3]];var Y;f-m!==0?Y=($[0]-m)/(f-m):Y=($[1]-a)/(A-a),ot>=0&&ot<=1&&Y>=0&&Y<=1&&W.push($)}return W},h=function(m,a,f,A,F){let i=[];return i.push.apply(i,y(m,a,m+f,a,F)),i.push.apply(i,y(m+f,a,m+f,a+A,F)),i.push.apply(i,y(m+f,a+A,m,a+A,F)),i.push.apply(i,y(m,a+A,m,a,F)),i},D=function(m,a){let f=[];return f.push.apply(f,y(m.x,m.y,m.x+m.w,m.y,a)),f.push.apply(f,y(m.x+m.w,m.y,m.x+m.w,m.y+m.h,a)),f.push.apply(f,y(m.x+m.w,m.y+m.h,m.x,m.y+m.h,a)),f.push.apply(f,y(m.x,m.y+m.h,m.x,m.y,a)),f};function M(m,a){return[-m[0][a]+3*m[1][a]+-3*m[2][a]+m[3][a],3*m[0][a]-6*m[1][a]+3*m[2][a],-3*m[0][a]+3*m[1][a],m[0][a]]}function p(m){return[M(m,"x"),M(m,"y")]}function v(m){return m<0?-1:m>0?1:0}function _(m,a,f,A){let F=a/m,i=f/m,e=A/m,d=(3*i-Math.pow(F,2))/9,E=(9*F*i-27*e-2*Math.pow(F,3))/54,w=Math.pow(d,3)+Math.pow(E,2),B,W,Y=[];if(w>=0)B=v(E+Math.sqrt(w))*Math.pow(Math.abs(E+Math.sqrt(w)),1/3),W=v(E-Math.sqrt(w))*Math.pow(Math.abs(E-Math.sqrt(w)),1/3),Y[0]=-F/3+(B+W),Y[1]=-F/3-(B+W)/2,Y[2]=-F/3-(B+W)/2,Math.abs(Math.sqrt(3)*(B-W)/2)!==0&&(Y[1]=-1,Y[2]=-1);else{let V=Math.acos(E/Math.sqrt(-Math.pow(d,3)));Y[0]=2*Math.sqrt(-d)*Math.cos(V/3)-F/3,Y[1]=2*Math.sqrt(-d)*Math.cos((V+2*Math.PI)/3)-F/3,Y[2]=2*Math.sqrt(-d)*Math.cos((V+4*Math.PI)/3)-F/3}for(let V=0;V<3;V++)(Y[V]<0||Y[V]>1)&&(Y[V]=-1);return Y}let L=this.jsBezier={distanceFromCurve:Q,gradientAtPoint:O,gradientAtPointAlongCurveFrom:b,nearestPointOnCurve:J,pointOnCurve:P,pointAlongCurveFrom:G,perpendicularToCurveAt:n,locationAlongCurveFrom:U,getLength:N,lineIntersection:y,boxIntersection:h,boundingBoxIntersection:D,version:"0.9.0"};typeof exports<"u"&&(exports.jsBezier=L)}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.Biltong={version:"0.4.0"};typeof exports<"u"&&(exports.Biltong=c);let H=function(u){return Object.prototype.toString.call(u)==="[object Array]"},Q=function(u,t,g){return u=H(u)?u:[u.x,u.y],t=H(t)?t:[t.x,t.y],g(u,t)},J=c.gradient=function(u,t){return Q(u,t,function(g,S){return S[0]==g[0]?S[1]>g[1]?1/0:-1/0:S[1]==g[1]?S[0]>g[0]?0:-0:(S[1]-g[1])/(S[0]-g[0])})};c.normal=function(u,t){return-1/J(u,t)},c.lineLength=function(u,t){return Q(u,t,function(g,S){return Math.sqrt(Math.pow(S[1]-g[1],2)+Math.pow(S[0]-g[0],2))})};let X=c.quadrant=function(u,t){return Q(u,t,function(g,S){return S[0]>g[0]||S[0]==g[0]?S[1]>g[1]?2:1:S[1]>g[1]?3:4})};c.theta=function(u,t){return Q(u,t,function(g,S){let j=J(g,S),P=Math.atan(j),I=X(g,S);return(I==4||I==3)&&(P+=Math.PI),P<0&&(P+=2*Math.PI),P})},c.intersects=function(u,t){let g=u.x,S=u.x+u.w,j=u.y,P=u.y+u.h,I=t.x,s=t.x+t.w,l=t.y,N=t.y+t.h;return g<=I&&I<=S&&j<=l&&l<=P||g<=s&&s<=S&&j<=l&&l<=P||g<=I&&I<=S&&j<=N&&N<=P||g<=s&&I<=S&&j<=N&&N<=P||I<=g&&g<=s&&l<=j&&j<=N||I<=S&&S<=s&&l<=j&&j<=N||I<=g&&g<=s&&l<=P&&P<=N||I<=S&&g<=s&&l<=P&&P<=N},c.encloses=function(u,t,g){let S=u.x,j=u.x+u.w,P=u.y,I=u.y+u.h,s=t.x,l=t.x+t.w,N=t.y,G=t.y+t.h,U=function(O,b,n,y){return g?O<=b&&n>=y:O<b&&n>y};return U(S,s,j,l)&&U(P,N,I,G)};let r=[null,[1,-1],[1,1],[-1,1],[-1,-1]],x=[null,[-1,-1],[-1,1],[1,1],[1,-1]];c.pointOnLine=function(u,t,g){let S=J(u,t),j=X(u,t),P=g>0?r[j]:x[j],I=Math.atan(S),s=Math.abs(g*Math.sin(I))*P[1],l=Math.abs(g*Math.cos(I))*P[0];return{x:u.x+l,y:u.y+s}},c.perpendicularLineTo=function(u,t,g){let S=J(u,t),j=Math.atan(-1/S),P=g/2*Math.sin(j),I=g/2*Math.cos(j);return[{x:t.x+I,y:t.y+P},{x:t.x-I,y:t.y-P}]}}).call(typeof window<"u"?window:void 0);(function(){function q(i,e,d,E,w,B,W,Y){return new Touch({target:e,identifier:F(),pageX:d,pageY:E,screenX:w,screenY:B,clientX:W||w,clientY:Y||B})}function c(){let i=[];return Array.prototype.push.apply(i,arguments),i.item=function(e){return this[e]},i}function H(i,e,d,E,w,B,W,Y){return c(q.apply(null,arguments))}var Q=this,J=function(i,e,d){d=d||i.parentNode;let E=d.querySelectorAll(e);for(let w=0;w<E.length;w++)if(E[w]===i)return!0;return!1},X=function(i){return typeof i=="string"||i.constructor===String?document.getElementById(i):i},r=function(i){return i.srcElement||i.target},x=function(i,e,d,E){if(E){if(typeof i.path<"u"&&i.path.indexOf)return{path:i.path,end:i.path.indexOf(d)};{let w={path:[],end:-1},B=function(W){w.path.push(W),W===d?w.end=w.path.length-1:W.parentNode!=null&&B(W.parentNode)};return B(e),w}}else return{path:[e],end:1}},u=function(i,e){for(var d=0,E=i.length;d<E&&i[d]!=e;d++);d<i.length&&i.splice(d,1)},t=1,g=function(i,e,d){let E=t++;return i.__ta=i.__ta||{},i.__ta[e]=i.__ta[e]||{},i.__ta[e][E]=d,d.__tauid=E,E},S=function(i,e,d){if(i.__ta&&i.__ta[e]&&delete i.__ta[e][d.__tauid],d.__taExtra){for(let E=0;E<d.__taExtra.length;E++)f(i,d.__taExtra[E][0],d.__taExtra[E][1]);d.__taExtra.length=0}d.__taUnstore&&d.__taUnstore()},j=function(i,e,d,E){if(i==null)return d;{let w=i.split(","),B=function(W){B.__tauid=d.__tauid;let Y=r(W),V=Y,ot=x(W,Y,e,i!=null);if(ot.end!=-1)for(let ct=0;ct<ot.end;ct++){V=ot.path[ct];for(let pt=0;pt<w.length;pt++)J(V,w[pt],e)&&d.apply(V,arguments)}};return P(d,E,B),B}},P=function(i,e,d){i.__taExtra=i.__taExtra||[],i.__taExtra.push([e,d])},I=function(i,e,d,E){if(O&&n[e]){let w=j(E,i,d,n[e]);a(i,n[e],w,d)}e==="focus"&&i.getAttribute("tabindex")==null&&i.setAttribute("tabindex","1"),a(i,e,j(E,i,d,e),d)},s=function(i,e,d,E){if(i.__taSmartClicks==null){let w=function(Y){i.__tad=M(Y)},B=function(Y){i.__tau=M(Y)},W=function(Y){if(i.__tad&&i.__tau&&i.__tad[0]===i.__tau[0]&&i.__tad[1]===i.__tau[1])for(let V=0;V<i.__taSmartClicks.length;V++)i.__taSmartClicks[V].apply(r(Y),[Y])};I(i,"mousedown",w,E),I(i,"mouseup",B,E),I(i,"click",W,E),i.__taSmartClicks=[]}i.__taSmartClicks.push(d),d.__taUnstore=function(){u(i.__taSmartClicks,d)}},l={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},N=function(i,e){return function(d,E,w,B){if(E=="contextmenu"&&b)I(d,E,w,B);else{if(d.__taTapHandler==null){let ct=d.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]};var W=function(pt){let $=r(pt),rt=x(pt,$,d,B!=null),ft=!1;for(let at=0;at<rt.end;at++){if(ft)return;$=rt.path[at];for(let ht=0;ht<ct.downSelectors.length;ht++)if(ct.downSelectors[ht]==null||J($,ct.downSelectors[ht],d)){ct.down=!0,setTimeout(V,i),setTimeout(ot,e),ft=!0;break}}},Y=function(pt){if(ct.down){let $=r(pt),rt,ft;ct.taps++;let at=m(pt);for(let ht in l)if(l.hasOwnProperty(ht)){let Ct=l[ht];if(Ct.touches===at&&(Ct.taps===1||Ct.taps===ct.taps))for(let mt=0;mt<ct[ht].length;mt++){ft=x(pt,$,d,ct[ht][mt][1]!=null);for(let K=0;K<ft.end;K++)if(rt=ft.path[K],ct[ht][mt][1]==null||J(rt,ct[ht][mt][1],d)){ct[ht][mt][0].apply(rt,[pt]);break}}}}},V=function(){ct.down=!1},ot=function(){ct.taps=0};I(d,"mousedown",W),I(d,"mouseup",Y)}d.__taTapHandler.downSelectors.push(B),d.__taTapHandler[E].push([w,B]),w.__taUnstore=function(){u(d.__taTapHandler[E],w)}}}},G=function(i,e,d,E){for(let w in d.__tamee[i])d.__tamee[i].hasOwnProperty(w)&&d.__tamee[i][w].apply(E,[e])},U=function(){let i=[];return function(e,d,E,w){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};let B=function(Y){let V=r(Y);(w==null&&V==e&&!e.__tamee.over||J(V,w,e)&&(V.__tamee==null||!V.__tamee.over))&&(G("mouseenter",Y,e,V),V.__tamee=V.__tamee||{},V.__tamee.over=!0,i.push(V))},W=function(Y){let V=r(Y);for(let ot=0;ot<i.length;ot++)V==i[ot]&&!J(Y.relatedTarget||Y.toElement,"*",V)&&(V.__tamee.over=!1,i.splice(ot,1),G("mouseexit",Y,e,V))};a(e,"mouseover",j(w,e,B,"mouseover"),B),a(e,"mouseout",j(w,e,W,"mouseout"),W)}E.__taUnstore=function(){delete e.__tamee[d][E.__tauid]},g(e,d,E),e.__tamee[d][E.__tauid]=E}},O="ontouchstart"in document.documentElement,b="onmousedown"in document.documentElement,n={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},y=function(){let i=-1;if(navigator.appName=="Microsoft Internet Explorer"){let e=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),h=y>-1&&y<9,D=function(i,e){if(i==null)return[0,0];let d=L(i),E=_(d,0);return[E[e+"X"],E[e+"Y"]]},M=function(i){return i==null?[0,0]:h?[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop]:D(i,"page")},p=function(i){return D(i,"screen")},v=function(i){return D(i,"client")},_=function(i,e){return i.item?i.item(e):i[e]},L=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},m=function(i){return L(i).length},a=function(i,e,d,E){if(g(i,e,d),E.__tauid=d.__tauid,i.addEventListener)i.addEventListener(e,d,!1);else if(i.attachEvent){let w=e+d.__tauid;i["e"+w]=d,i[w]=function(){i["e"+w]&&i["e"+w](window.event)},i.attachEvent("on"+e,i[w])}},f=function(i,e,d){d!=null&&A(i,function(){let E=X(this);if(S(E,e,d),d.__tauid!=null){if(E.removeEventListener)E.removeEventListener(e,d,!1),O&&n[e]&&E.removeEventListener(n[e],d,!1);else if(this.detachEvent){let w=e+d.__tauid;E[w]&&E.detachEvent("on"+e,E[w]),E[w]=null,E["e"+w]=null}}d.__taTouchProxy&&f(i,d.__taTouchProxy[1],d.__taTouchProxy[0])})},A=function(i,e){if(i!=null){i=typeof Window<"u"&&typeof i.top!="unknown"&&i==i.top?[i]:typeof i!="string"&&i.tagName==null&&i.length!=null?i:typeof i=="string"?document.querySelectorAll(i):[i];for(let d=0;d<i.length;d++)e.apply(i[d])}},F=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})};Q.Mottle=function(i){i=i||{};let e=i.clickThreshold||250,d=i.dblClickThreshold||450,E=new U,w=new N(e,d),B=i.smartClicks,W=function(Y,V,ot,ct){ot!=null&&A(Y,function(){let pt=X(this);B&&V==="click"?s(pt,V,ot,ct):V==="tap"||V==="dbltap"||V==="contextmenu"?w(pt,V,ot,ct):V==="mouseenter"||V=="mouseexit"?E(pt,V,ot,ct):I(pt,V,ot,ct)})};this.remove=function(Y){return A(Y,function(){let V=X(this);if(V.__ta){for(let ot in V.__ta)if(V.__ta.hasOwnProperty(ot))for(let ct in V.__ta[ot])V.__ta[ot].hasOwnProperty(ct)&&f(V,ot,V.__ta[ot][ct])}V.parentNode&&V.parentNode.removeChild(V)}),this},this.on=function(Y,V,ot,ct){let pt=arguments[0],$=arguments.length==4?arguments[2]:null,rt=arguments[1],ft=arguments[arguments.length-1];return W(pt,rt,ft,$),this},this.off=function(Y,V,ot){return f(Y,V,ot),this},this.trigger=function(Y,V,ot,ct){let pt=b&&(typeof MouseEvent>"u"||ot==null||ot.constructor===MouseEvent),$=O&&!b&&n[V]?n[V]:V,rt=!(O&&!b&&n[V]),ft=M(ot),at=p(ot),ht=v(ot);return A(Y,function(){let Ct=X(this),mt;ot=ot||{screenX:at[0],screenY:at[1],clientX:ht[0],clientY:ht[1]};let K=function(et){ct&&(et.payload=ct)},tt={TouchEvent:function(et){let lt=H(window,Ct,0,ft[0],ft[1],at[0],at[1],ht[0],ht[1]);(et.initTouchEvent||et.initEvent)($,!0,!0,window,null,at[0],at[1],ht[0],ht[1],!1,!1,!1,!1,lt,lt,lt,1,0)},MouseEvents:function(et){et.initMouseEvent($,!0,!0,window,0,at[0],at[1],ht[0],ht[1],!1,!1,!1,!1,1,Ct)}};if(document.createEvent){let et=!rt&&!pt&&O&&n[V],lt=et?"TouchEvent":"MouseEvents";mt=document.createEvent(lt),tt[lt](mt),K(mt),Ct.dispatchEvent(mt)}else document.createEventObject&&(mt=document.createEventObject(),mt.eventType=mt.eventName=$,mt.screenX=at[0],mt.screenY=at[1],mt.clientX=ht[0],mt.clientY=ht[1],K(mt),Ct.fireEvent("on"+$,mt))}),this}},Q.Mottle.consume=function(i,e){i.stopPropagation?i.stopPropagation():i.returnValue=!1,!e&&i.preventDefault&&i.preventDefault()},Q.Mottle.pageLocation=M,Q.Mottle.setForceTouchEvents=function(i){O=i},Q.Mottle.setForceMouseEvents=function(i){b=i},Q.Mottle.version="0.8.0",typeof exports<"u"&&(exports.Mottle=Q.Mottle)}).call(typeof window>"u"?void 0:window);(function(){let q=this,c=function(i,e,d){return i.indexOf(e)===-1?(i.push(e),!0):!1},H=function(i,e){let d=i.indexOf(e);d!==-1&&i.splice(d,1)},Q=function(i,e){let d=[];for(let E=0;E<i.length;E++)e.indexOf(i[E])===-1&&d.push(i[E]);return d},J=function(i){return i==null?!1:typeof i=="string"||i.constructor===String},X=function(i){let e=i.getBoundingClientRect(),d=document.body,E=document.documentElement,w=window.pageYOffset||E.scrollTop||d.scrollTop,B=window.pageXOffset||E.scrollLeft||d.scrollLeft,W=E.clientTop||d.clientTop||0,Y=E.clientLeft||d.clientLeft||0,V=e.top+w-W,ot=e.left+B-Y;return{top:Math.round(V),left:Math.round(ot)}},r=function(i,e,d){d=d||i.parentNode;let E=d.querySelectorAll(e);for(let w=0;w<E.length;w++)if(E[w]===i)return!0;return!1},x=function(i,e,d){if(r(e,d,i))return e;{let E=e.parentNode;for(;E!=null&&E!==i;){if(r(E,d,i))return E;E=E.parentNode}}},u=function(i,e,d){let E=null,w=e.getAttribute("katavorio-draggable"),B=w!=null?"[katavorio-draggable='"+w+"'] ":"";for(let W=0;W<i.length;W++)if(E=x(e,d,B+i[W].selector),E!=null){if(i[W].filter){let Y=r(d,i[W].filter,E);if(i[W].filterExclude===!0&&!Y||Y)return null}return[i[W],E]}return null};var t=function(){let i=-1;if(navigator.appName==="Microsoft Internet Explorer"){let e=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),g=10,S=10,j=t>-1&&t<9,P=t===9,I=function(i){if(j)return[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop];{let e=l(i),d=s(e,0);return P?[d.pageX||d.clientX,d.pageY||d.clientY]:[d.pageX,d.pageY]}},s=function(i,e){return i.item?i.item(e):i[e]},l=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},N={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},G="katavorio-drag-scope",U=["stop","start","drag","drop","over","out","beforeStart"],O=function(){},b=function(){return!0},n=function(i,e,d){for(let E=0;E<i.length;E++)i[E]!=d&&e(i[E])},y=function(i,e,d,E){n(i,function(w){w.setActive(e),e&&w.updatePosition(),d&&w.setHover(E,e)})},h=function(i,e){if(i!=null){i=!J(i)&&i.tagName==null&&i.length!=null?i:[i];for(let d=0;d<i.length;d++)e.apply(i[d],[i[d]])}},D=function(i){i.stopPropagation?(i.stopPropagation(),i.preventDefault()):i.returnValue=!1},M="input,textarea,select,button,option",p=function(i,e,d){let E=i.srcElement||i.target;return!r(E,d.getInputFilterSelector(),e)};let v=function(i,e,d,E){this.params=e||{},this.el=i,this.params.addClass(this.el,this._class),this.uuid=f();let w=!0;return this.setEnabled=function(B){w=B},this.isEnabled=function(){return w},this.toggleEnabled=function(){w=!w},this.setScope=function(B){this.scopes=B?B.split(/\s+/):[E]},this.addScope=function(B){let W={};h(this.scopes,function(Y){W[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){W[Y]=!0}),this.scopes=[];for(let Y in W)this.scopes.push(Y)},this.removeScope=function(B){let W={};h(this.scopes,function(Y){W[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){delete W[Y]}),this.scopes=[];for(let Y in W)this.scopes.push(Y)},this.toggleScope=function(B){let W={};h(this.scopes,function(Y){W[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){W[Y]?delete W[Y]:W[Y]=!0}),this.scopes=[];for(let Y in W)this.scopes.push(Y)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},_=function(){return!0},L=function(){return!1},m=function(i,e,d,E){this._class=d.draggable;let w=v.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;let B=[0,0],W=null,Y=null,V=[0,0],ot=!1,ct=[0,0],pt=this.params.consumeStartEvent!==!1,$=this.el,rt=this.params.clone;this.params.scroll;let ft=e.multipleDrop!==!1,at=!1,ht=e.ghostProxy===!0?_:e.ghostProxy&&typeof e.ghostProxy=="function"?e.ghostProxy:L,Ct=function(it){return it.cloneNode(!0)},mt=null,K=[],tt=null,et=e.ghostProxyParent,lt,yt,Dt,Mt;if(e.selector){let it=i.getAttribute("katavorio-draggable");it==null&&(it=""+new Date().getTime(),i.setAttribute("katavorio-draggable",it)),K.push(e)}let Bt=e.snapThreshold,le=function(it,vt,Pt,gt,St){let kt=Math.floor(it[0]/vt),Xt=vt*kt,$t=Xt+vt,o=Math.abs(it[0]-Xt)<=gt?Xt:Math.abs($t-it[0])<=gt?$t:it[0],k=Math.floor(it[1]/Pt),C=Pt*k,T=C+Pt,R=Math.abs(it[1]-C)<=St?C:Math.abs(T-it[1])<=St?T:it[1];return[o,R]};this.posses=[],this.posseRoles={},this.toGrid=function(it){if(this.params.grid==null)return it;{let vt=this.params.grid?this.params.grid[0]/2:Bt||g/2,Pt=this.params.grid?this.params.grid[1]/2:Bt||S/2;return le(it,this.params.grid[0],this.params.grid[1],vt,Pt)}},this.snap=function(it,vt){if($==null)return;it=it||(this.params.grid?this.params.grid[0]:g),vt=vt||(this.params.grid?this.params.grid[1]:S);let Pt=this.params.getPosition($),gt=this.params.grid?this.params.grid[0]/2:Bt,St=this.params.grid?this.params.grid[1]/2:Bt,kt=le(Pt,it,vt,gt,St);return this.params.setPosition($,kt),kt},this.setUseGhostProxy=function(it){ht=it?_:L};let zt,qt=function(it){return e.allowNegative===!1?[Math.max(0,it[0]),Math.max(0,it[1])]:it},Pe=(function(it){zt=typeof it=="function"?it:it?(function(vt,Pt,gt,St){return qt([Math.max(0,Math.min(gt.w-St[0],vt[0])),Math.max(0,Math.min(gt.h-St[1],vt[1]))])}).bind(this):function(vt){return qt(vt)}}).bind(this);Pe(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(it){Pe(it)};let de;this.setRevert=function(it){de=it},this.params.revert&&(de=this.params.revert);let Ce=function(it){return typeof it=="function"?(it._katavorioId=f(),it._katavorioId):it},Ht={},fe=function(it){for(let vt in Ht){let Pt=Ht[vt],gt=Pt[0](it);if(Pt[1]&&(gt=!gt),!gt)return!1}return!0},re=this.setFilter=function(it,vt){if(it){let Pt=Ce(it);Ht[Pt]=[function(gt){let St=gt.srcElement||gt.target,kt;return J(it)?kt=r(St,it,i):typeof it=="function"&&(kt=it(gt,i)),kt},vt!==!1]}};this.addFilter=re,this.removeFilter=function(it){let vt=typeof it=="function"?it._katavorioId:it;delete Ht[vt]},this.clearAllFilters=function(){Ht={}},this.canDrag=this.params.canDrag||b;let ue,Lt=[],Yt=[];this.addSelector=function(it){it.selector&&K.push(it)},this.downListener=(function(it){if(it.defaultPrevented)return;if((this.rightButtonCanDrag||it.which!==3&&it.button!==2)&&this.isEnabled()&&this.canDrag())if(fe(it)&&p(it,this.el,this.k)){if(tt=null,mt=null,K.length>0){let gt=u(K,this.el,it.target||it.srcElement);if(gt!=null&&(tt=gt[0],mt=gt[1]),mt==null)return}else mt=this.el;if(rt)if($=mt.cloneNode(!0),this.params.addClass($,N.clonedDrag),$.setAttribute("id",null),$.style.position="absolute",this.params.parent!=null){let gt=this.params.getPosition(this.el);$.style.left=gt[0]+"px",$.style.top=gt[1]+"px",this.params.parent.appendChild($)}else{let gt=X(mt);$.style.left=gt.left+"px",$.style.top=gt.top+"px",document.body.appendChild($)}else $=mt;pt&&D(it),B=I(it),$&&$.parentNode&&(ct=[$.parentNode.scrollLeft,$.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),w.markSelection(this),w.markPosses(this),this.params.addClass(document.body,d.noSelect),te("beforeStart",{el:this.el,pos:W,e:it,drag:this})}else this.params.consumeFilteredEvents&&D(it)}).bind(this),this.moveListener=(function(it){if(B){if(!ot)if(te("start",{el:this.el,pos:W,e:it,drag:this})!==!1){if(!B)return;this.mark(!0),ot=!0}else this.abort();if(B){Yt.length=0;let vt=I(it),Pt=vt[0]-B[0],gt=vt[1]-B[1],St=this.params.ignoreZoom?1:w.getZoom();$&&$.parentNode&&(Pt+=$.parentNode.scrollLeft-ct[0],gt+=$.parentNode.scrollTop-ct[1]),Pt/=St,gt/=St,this.moveBy(Pt,gt,it),w.updateSelection(Pt,gt,this),w.updatePosses(Pt,gt,this)}}}).bind(this),this.upListener=(function(it){B&&(B=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,d.noSelect),this.unmark(it),w.unmarkSelection(this,it),w.unmarkPosses(this,it),this.stop(it),w.notifyPosseDragStop(this,it),ot=!1,Yt.length=0,rt?($&&$.parentNode&&$.parentNode.removeChild($),$=null):de&&de($,this.params.getPosition($))===!0&&(this.params.setPosition($,W),te("revert",$)))}).bind(this),this.getFilters=function(){return Ht},this.abort=function(){B!=null&&this.upListener()},this.getDragElement=function(it){return it?mt||this.el:$||this.el};let It={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};e.events.start&&It.start.push(e.events.start),e.events.beforeStart&&It.beforeStart.push(e.events.beforeStart),e.events.stop&&It.stop.push(e.events.stop),e.events.drag&&It.drag.push(e.events.drag),e.events.revert&&It.revert.push(e.events.revert),this.on=function(it,vt){It[it]&&It[it].push(vt)},this.off=function(it,vt){if(It[it]){let Pt=[];for(let gt=0;gt<It[it].length;gt++)It[it][gt]!==vt&&Pt.push(It[it][gt]);It[it]=Pt}};var te=function(it,vt){let Pt=null;if(tt&&tt[it])Pt=tt[it](vt);else if(It[it])for(let gt=0;gt<It[it].length;gt++)try{let St=It[it][gt](vt);St!=null&&(Pt=St)}catch{}return Pt};this.notifyStart=function(it){te("start",{el:this.el,pos:this.params.getPosition($),e:it,drag:this})},this.stop=function(it,vt){if(vt||ot){let Pt=[],gt=w.getSelection(),St=this.params.getPosition($);if(gt.length>0)for(let kt=0;kt<gt.length;kt++){let Xt=this.params.getPosition(gt[kt].el);Pt.push([gt[kt].el,{left:Xt[0],top:Xt[1]},gt[kt]])}else Pt.push([$,{left:St[0],top:St[1]},this]);te("stop",{el:$,pos:ee||St,finalPos:St,e:it,drag:this,selection:Pt})}},this.mark=function(it){W=this.params.getPosition($),Y=this.params.getPosition($,!0),V=[Y[0]-W[0],Y[1]-W[1]],this.size=this.params.getSize($),Lt=w.getMatchingDroppables(this),y(Lt,!0,!1,this),this.params.addClass($,this.params.dragClass||d.drag);let vt;this.params.getConstrainingRectangle?vt=this.params.getConstrainingRectangle($):vt=this.params.getSize($.parentNode),ue={w:vt[0],h:vt[1]},Dt=0,Mt=0,it&&w.notifySelectionDragStart(this)};let ee;this.unmark=function(it,vt){if(y(Lt,!1,!0,this),at&&ht(mt,$)?(ee=[$.offsetLeft-Dt,$.offsetTop-Mt],$.parentNode.removeChild($),$=mt):ee=null,this.params.removeClass($,this.params.dragClass||d.drag),Lt.length=0,at=!1,!vt){Yt.length>0&&ee&&e.setPosition(mt,ee),Yt.sort(A);for(let Pt=0;Pt<Yt.length&&Yt[Pt].drop(this,it)!==!0;Pt++);}},this.moveBy=function(it,vt,Pt){Yt.length=0;let gt=this.toGrid([W[0]+it,W[1]+vt]),St=zt(gt,$,ue,this.size);if(ht(this.el,$))if(gt[0]!==St[0]||gt[1]!==St[1]){if(!at){let o=Ct(mt);e.addClass(o,N.ghostProxy),et?(et.appendChild(o),lt=e.getPosition(mt.parentNode,!0),yt=e.getPosition(e.ghostProxyParent,!0),Dt=lt[0]-yt[0],Mt=lt[1]-yt[1]):mt.parentNode.appendChild(o),$=o,at=!0}St=gt}else at&&($.parentNode.removeChild($),$=mt,at=!1,lt=null,yt=null,Dt=0,Mt=0);let kt={x:St[0],y:St[1],w:this.size[0],h:this.size[1]},Xt={x:kt.x+V[0],y:kt.y+V[1],w:kt.w,h:kt.h},$t=null;this.params.setPosition($,[St[0]+Dt,St[1]+Mt]);for(let o=0;o<Lt.length;o++){let k={x:Lt[o].pagePosition[0],y:Lt[o].pagePosition[1],w:Lt[o].size[0],h:Lt[o].size[1]};this.params.intersects(Xt,k)&&(ft||$t==null||$t===Lt[o].el)&&Lt[o].canDrop(this)?($t||($t=Lt[o].el),Yt.push(Lt[o]),Lt[o].setHover(this,!0,Pt)):Lt[o].isHover()&&Lt[o].setHover(this,!1,Pt)}te("drag",{el:this.el,pos:St,e:Pt,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?re(this.params.handle,!1):re(this.params.filter,this.params.filterExclude)},a=function(i,e,d,E){this._class=d.droppable,this.params=e||{},this.rank=e.rank||0,this._activeClass=this.params.activeClass||d.active,this._hoverClass=this.params.hoverClass||d.hover,v.apply(this,arguments);let w=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(B){this.params[B?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(B){return!0},this.isHover=function(){return w},this.setHover=function(B,W,Y){(W||this.el._katavorioDragHover==null||this.el._katavorioDragHover===B.el._katavorio)&&(this.params[W?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=W?B.el._katavorio:null,w!==W&&this.params.events[W?"over":"out"]({el:this.el,e:Y,drag:B,drop:this}),w=W)},this.drop=function(B,W){return this.params.events.drop({drag:B,e:W,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,w=null}};var f=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i==="x"?e:e&3|8).toString(16)})},A=function(i,e){return i.rank<e.rank?1:i.rank>e.rank?-1:0};let F=function(i){return i==null||(i=typeof i=="string"||i.constructor===String?document.getElementById(i):i,i==null)?null:(i._katavorio=i._katavorio||f(),i)};q.Katavorio=function(i){let e=[],d={};this._dragsByScope={},this._dropsByScope={};let E=1,w=function(K,tt){h(K,function(et){for(let lt=0;lt<et.scopes.length;lt++)tt[et.scopes[lt]]=tt[et.scopes[lt]]||[],tt[et.scopes[lt]].push(et)})},B=function(K,tt){let et=0;return h(K,function(lt){for(let yt=0;yt<lt.scopes.length;yt++)if(tt[lt.scopes[yt]]){let Dt=i.indexOf(tt[lt.scopes[yt]],lt);Dt!==-1&&(tt[lt.scopes[yt]].splice(Dt,1),et++)}}),et>0};this.getMatchingDroppables=function(K){let tt=[],et={};for(let lt=0;lt<K.scopes.length;lt++){let yt=this._dropsByScope[K.scopes[lt]];if(yt)for(let Dt=0;Dt<yt.length;Dt++)yt[Dt].canDrop(K)&&!et[yt[Dt].uuid]&&(yt[Dt].allowLoopback||yt[Dt].el!==K.el)&&(et[yt[Dt].uuid]=!0,tt.push(yt[Dt]))}return tt.sort(A),tt};let W=(function(K){K=K||{};let tt={events:{}},et;for(et in i)tt[et]=i[et];for(et in K)tt[et]=K[et];for(et=0;et<U.length;et++)tt.events[U[et]]=K[U[et]]||O;return tt.katavorio=this,tt}).bind(this),Y=(function(K,tt){for(let et=0;et<U.length;et++)tt[U[et]]&&K.on(U[et],tt[U[et]])}).bind(this),V={},ot=i.css||{},ct=i.scope||G;for(var pt in N)V[pt]=N[pt];for(var pt in ot)V[pt]=ot[pt];let $=i.inputFilterSelector||M;this.getInputFilterSelector=function(){return $},this.setInputFilterSelector=function(K){return $=K,this},this.draggable=function(K,tt){let et=[];return h(K,(function(lt){if(lt=F(lt),lt!=null)if(lt._katavorioDrag==null){let yt=W(tt);lt._katavorioDrag=new m(lt,yt,V,ct),w(lt._katavorioDrag,this._dragsByScope),et.push(lt._katavorioDrag),i.addClass(lt,yt.selector?V.delegatedDraggable:V.draggable)}else Y(lt._katavorioDrag,tt)}).bind(this)),et},this.droppable=function(K,tt){let et=[];return h(K,(function(lt){if(lt=F(lt),lt!=null){let yt=new a(lt,W(tt),V,ct);lt._katavorioDrop=lt._katavorioDrop||[],lt._katavorioDrop.push(yt),w(yt,this._dropsByScope),et.push(yt),i.addClass(lt,V.droppable)}}).bind(this)),et},this.select=function(K){return h(K,function(){let tt=F(this);tt&&tt._katavorioDrag&&(d[tt._katavorio]||(e.push(tt._katavorioDrag),d[tt._katavorio]=[tt,e.length-1],i.addClass(tt,V.selected)))}),this},this.deselect=function(K){return h(K,function(){let tt=F(this);if(tt&&tt._katavorio&&d[tt._katavorio]){let lt=[];for(let yt=0;yt<e.length;yt++)e[yt].el!==tt&&lt.push(e[yt]);e=lt,delete d[tt._katavorio],i.removeClass(tt,V.selected)}}),this},this.deselectAll=function(){for(let K in d){let tt=d[K];i.removeClass(tt[0],V.selected)}e.length=0,d={}},this.markSelection=function(K){n(e,function(tt){tt.mark()},K)},this.markPosses=function(K){K.posses&&h(K.posses,function(tt){K.posseRoles[tt]&&Ct[tt]&&n(Ct[tt].members,function(et){et.mark()},K)})},this.unmarkSelection=function(K,tt){n(e,function(et){et.unmark(tt)},K)},this.unmarkPosses=function(K,tt){K.posses&&h(K.posses,function(et){K.posseRoles[et]&&Ct[et]&&n(Ct[et].members,function(lt){lt.unmark(tt,!0)},K)})},this.getSelection=function(){return e.slice(0)},this.updateSelection=function(K,tt,et){n(e,function(lt){lt.moveBy(K,tt)},et)};let rt=function(K,tt){tt.posses&&h(tt.posses,function(et){tt.posseRoles[et]&&Ct[et]&&n(Ct[et].members,function(lt){K(lt)},tt)})};this.updatePosses=function(K,tt,et){rt(function(lt){lt.moveBy(K,tt)},et)},this.notifyPosseDragStop=function(K,tt){rt(function(et){et.stop(tt,!0)},K)},this.notifySelectionDragStop=function(K,tt){n(e,function(et){et.stop(tt,!0)},K)},this.notifySelectionDragStart=function(K,tt){n(e,function(et){et.notifyStart(tt)},K)},this.setZoom=function(K){E=K},this.getZoom=function(){return E};let ft=function(K,tt,et,lt){h(K,function(yt){B(yt,et),yt[lt](tt),w(yt,et)})};h(["set","add","remove","toggle"],(function(K){this[K+"Scope"]=(function(tt,et){ft(tt._katavorioDrag,et,this._dragsByScope,K+"Scope"),ft(tt._katavorioDrop,et,this._dropsByScope,K+"Scope")}).bind(this),this[K+"DragScope"]=(function(tt,et){ft(tt.constructor===m?tt:tt._katavorioDrag,et,this._dragsByScope,K+"Scope")}).bind(this),this[K+"DropScope"]=(function(tt,et){ft(tt.constructor===a?tt:tt._katavorioDrop,et,this._dropsByScope,K+"Scope")}).bind(this)}).bind(this)),this.snapToGrid=function(K,tt){for(let et in this._dragsByScope)n(this._dragsByScope[et],function(lt){lt.snap(K,tt)})},this.getDragsForScope=function(K){return this._dragsByScope[K]},this.getDropsForScope=function(K){return this._dropsByScope[K]};let at=function(K,tt,et){if(K=F(K),K[tt]){let lt=e.indexOf(K[tt]);lt>=0&&e.splice(lt,1),B(K[tt],et)&&h(K[tt],function(yt){yt.destroy()}),delete K[tt]}},ht=function(K,tt,et,lt){K=F(K),K[tt]&&K[tt].off(et,lt)};this.elementRemoved=function(K){this.destroyDraggable(K),this.destroyDroppable(K)},this.destroyDraggable=function(K,tt,et){arguments.length===1?at(K,"_katavorioDrag",this._dragsByScope):ht(K,"_katavorioDrag",tt,et)},this.destroyDroppable=function(K,tt,et){arguments.length===1?at(K,"_katavorioDrop",this._dropsByScope):ht(K,"_katavorioDrop",tt,et)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},e=[],d={},Ct={}};var Ct={};let mt=function(K,tt,et){let lt=J(tt)?tt:tt.id,yt=J(tt)?!0:tt.active!==!1,Dt=Ct[lt]||function(){let Mt={name:lt,members:[]};return Ct[lt]=Mt,Mt}();return h(K,function(Mt){if(Mt._katavorioDrag){if(et&&Mt._katavorioDrag.posseRoles[Dt.name]!=null)return;c(Dt.members,Mt._katavorioDrag),c(Mt._katavorioDrag.posses,Dt.name),Mt._katavorioDrag.posseRoles[Dt.name]=yt}}),Dt};this.addToPosse=function(K,tt){let et=[];for(let lt=1;lt<arguments.length;lt++)et.push(mt(K,arguments[lt]));return et.length===1?et[0]:et},this.setPosse=function(K,tt){let et=[];for(let lt=1;lt<arguments.length;lt++)et.push(mt(K,arguments[lt],!0).name);return h(K,(function(lt){if(lt._katavorioDrag){let yt=Q(lt._katavorioDrag.posses,et),Dt=[];Array.prototype.push.apply(Dt,lt._katavorioDrag.posses);for(let Mt=0;Mt<yt.length;Mt++)this.removeFromPosse(lt,yt[Mt])}}).bind(this)),et.length===1?et[0]:et},this.removeFromPosse=function(K,tt){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(let et=1;et<arguments.length;et++)tt=arguments[et],h(K,function(lt){if(lt._katavorioDrag&&lt._katavorioDrag.posses){let yt=lt._katavorioDrag;h(tt,function(Dt){H(Ct[Dt].members,yt),H(yt.posses,Dt),delete yt.posseRoles[Dt]})}})},this.removeFromAllPosses=function(K){h(K,function(tt){if(tt._katavorioDrag&&tt._katavorioDrag.posses){let et=tt._katavorioDrag;h(et.posses,function(lt){H(Ct[lt].members,et)}),et.posses.length=0,et.posseRoles={}}})},this.setPosseState=function(K,tt,et){let lt=Ct[tt];lt&&h(K,function(yt){yt._katavorioDrag&&yt._katavorioDrag.posses&&(yt._katavorioDrag.posseRoles[lt.name]=et)})}},q.Katavorio.version="1.0.0",typeof exports<"u"&&(exports.Katavorio=q.Katavorio)}).call(typeof window<"u"?window:void 0);(function(){let q=this;q.jsPlumbUtil=q.jsPlumbUtil||{};let c=q.jsPlumbUtil;typeof exports<"u"&&(exports.jsPlumbUtil=c);function H(a){return Object.prototype.toString.call(a)==="[object Array]"}c.isArray=H;function Q(a){return Object.prototype.toString.call(a)==="[object Number]"}c.isNumber=Q;function J(a){return typeof a=="string"}c.isString=J;function X(a){return typeof a=="boolean"}c.isBoolean=X;function r(a){return a==null}c.isNull=r;function x(a){return a==null?!1:Object.prototype.toString.call(a)==="[object Object]"}c.isObject=x;function u(a){return Object.prototype.toString.call(a)==="[object Date]"}c.isDate=u;function t(a){return Object.prototype.toString.call(a)==="[object Function]"}c.isFunction=t;function g(a){return t(a)&&a.name!=null&&a.name.length>0}c.isNamedFunction=g;function S(a){for(let f in a)if(a.hasOwnProperty(f))return!1;return!0}c.isEmpty=S;function j(a){if(J(a))return""+a;if(X(a))return!!a;if(u(a))return new Date(a.getTime());if(t(a))return a;if(H(a)){let f=[];for(let A=0;A<a.length;A++)f.push(j(a[A]));return f}else if(x(a)){let f={};for(let A in a)f[A]=j(a[A]);return f}else return a}c.clone=j;function P(a,f,A,F){let i={},e,d,E={};for(A=A||[],F=F||[],d=0;d<A.length;d++)i[A[d]]=!0;for(d=0;d<F.length;d++)E[F[d]]=!0;let w=j(a);for(d in f)if(w[d]==null||E[d])w[d]=f[d];else if(J(f[d])||X(f[d]))i[d]?(e=[],e.push.apply(e,H(w[d])?w[d]:[w[d]]),e.push.apply(e,X(f[d])?f[d]:[f[d]]),w[d]=e):w[d]=f[d];else if(H(f[d]))e=[],H(w[d])&&e.push.apply(e,w[d]),e.push.apply(e,f[d]),w[d]=e;else if(x(f[d])){x(w[d])||(w[d]={});for(let B in f[d])w[d][B]=f[d][B]}return w}c.merge=P;function I(a,f,A){if(a==null)return;let F=a,i=F;return f.replace(/([^\.])+/g,function(e,d,E,w){let B=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),W=E+e.length>=w.length,Y=function(){return i[B[1]]||function(){return i[B[1]]=[],i[B[1]]}()};if(W)B?Y()[B[3]]=A:i[e]=A;else if(B){let V=Y();i=V[B[3]]||function(){return V[B[3]]={},V[B[3]]}()}else i=i[e]||function(){return i[e]={},i[e]}();return""}),a}c.replace=I;function s(a,f,A){for(let F=0;F<A.length;F++){let i=A[F][0][A[F][1]].apply(A[F][0],A[F][2]);if(i===f)return i}return a}c.functionChain=s;function l(a,f,A,F){let i=function(d){let E=d.match(/(\${.*?})/g);if(E!=null)for(let w=0;w<E.length;w++){let B=f[E[w].substring(2,E[w].length-1)]||"";B!=null&&(d=d.replace(E[w],B))}return d},e=function(d){if(d!=null){if(J(d))return i(d);if(t(d)&&!F&&(A==null||(d.name||"").indexOf(A)===0))return d(f);if(H(d)){let E=[];for(let w=0;w<d.length;w++)E.push(e(d[w]));return E}else if(x(d)){let E={};for(let w in d)E[w]=e(d[w]);return E}else return d}};return e(a)}c.populate=l;function N(a,f){if(a){for(let A=0;A<a.length;A++)if(f(a[A]))return A}return-1}c.findWithFunction=N;function G(a,f){let A=N(a,f);return A>-1&&a.splice(A,1),A!==-1}c.removeWithFunction=G;function U(a,f){let A=a.indexOf(f);return A>-1&&a.splice(A,1),A!==-1}c.remove=U;function O(a,f,A){N(a,A)===-1&&a.push(f)}c.addWithFunction=O;function b(a,f,A,F){let i=a[f];return i==null&&(i=[],a[f]=i),i[F?"unshift":"push"](A),i}c.addToList=b;function n(a,f,A){return a.indexOf(f)===-1?(A?a.unshift(f):a.push(f),!0):!1}c.suggest=n;function y(a,f,A){let F;f=H(f)?f:[f];let i=function(E){let w=E.__proto__;for(;w!=null;)if(w.prototype!=null){for(let B in w.prototype)w.prototype.hasOwnProperty(B)&&!a.prototype.hasOwnProperty(B)&&(a.prototype[B]=w.prototype[B]);w=w.prototype.__proto__}else w=null};for(F=0;F<f.length;F++){for(let E in f[F].prototype)f[F].prototype.hasOwnProperty(E)&&!a.prototype.hasOwnProperty(E)&&(a.prototype[E]=f[F].prototype[E]);i(f[F])}let e=function(E,w){return function(){for(F=0;F<f.length;F++)f[F].prototype[E]&&f[F].prototype[E].apply(this,arguments);return w.apply(this,arguments)}},d=function(E){for(let w in E)a.prototype[w]=e(w,E[w])};if(arguments.length>2)for(F=2;F<arguments.length;F++)d(arguments[F]);return a}c.extend=y;function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){let f=Math.random()*16|0;return(a==="x"?f:f&3|8).toString(16)})}c.uuid=h;function D(a){if(a==null)return null;let f=a.replace(/^\s\s*/,""),A=/\s/,F=f.length;for(;A.test(f.charAt(--F)););return f.slice(0,F+1)}c.fastTrim=D;function M(a,f){a=a.length==null||typeof a=="string"?[a]:a;for(let A=0;A<a.length;A++)f(a[A])}c.each=M;function p(a,f){let A=[];for(let F=0;F<a.length;F++)A.push(f(a[F]));return A}c.map=p;function v(a,f,A){A=A||"parent";let F=function(w){return w?f[w]:null},i=function(w){return w?F(w[A]):null},e=function(w,B){if(w==null)return B;{let W=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];B.mergeStrategy==="override"&&Array.prototype.push.apply(W,["events","overlays"]);let Y=P(w,B,[],W);return e(i(w),Y)}},d=function(w){if(w==null)return{};if(typeof w=="string")return F(w);if(w.length){let B=!1,W=0,Y;for(;!B&&W<w.length;)Y=d(w[W]),Y?B=!0:W++;return Y}},E=d(a);return E?e(i(E),E):{}}c.mergeWithParents=v,c.logEnabled=!0;function _(){if(c.logEnabled&&typeof console<"u")try{let a=arguments[arguments.length-1];console.log(a)}catch{}}c.log=_;function L(a,f,A){return function(){let F=null;try{f!=null&&(F=f.apply(this,arguments))}catch(i){_("jsPlumb function failed : "+i)}if(a!=null&&(A==null||F!==A))try{F=a.apply(this,arguments)}catch(i){_("wrapped function failed : "+i)}return F}}c.wrap=L;let m=function(){function a(){let f=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(A,F,i){let e=function(d){b(f._listeners,d,F,i),F.__jsPlumb=F.__jsPlumb||{},F.__jsPlumb[h()]=d};if(typeof A=="string")e(A);else if(A.length!=null)for(let d=0;d<A.length;d++)e(A[d]);return f},this.fire=function(A,F,i){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[A]){let e=this._listeners[A].length,d=0,E=!1,w=null;if(!this.shouldFireEvent||this.shouldFireEvent(A,F,i))for(;!E&&d<e&&w!==!1;){if(this.eventsToDieOn[A])this._listeners[A][d].apply(this,[F,i]);else try{w=this._listeners[A][d].apply(this,[F,i])}catch(B){_("jsPlumb: fire failed for event "+A+" : "+B)}d++,(this._listeners==null||this._listeners[A]==null)&&(E=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){let A=f.queue.pop();A&&f.fire.apply(f,A)},this.unbind=function(A,F){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof A=="string")delete this._listeners[A];else if(A.__jsPlumb){let i;for(let e in A.__jsPlumb)i=A.__jsPlumb[e],U(this._listeners[i]||[],A)}}else arguments.length===2&&U(this._listeners[A]||[],F);return this},this.getListener=function(A){return f._listeners[A]},this.setSuspendEvents=function(A){f.eventsSuspended=A},this.isSuspendEvents=function(){return f.eventsSuspended},this.silently=function(A){f.setSuspendEvents(!0);try{A()}catch(F){_("Cannot execute silent function "+F)}f.setSuspendEvents(!1)},this.cleanupListeners=function(){for(let A in f._listeners)f._listeners[A]=null}}return a}();c.EventGenerator=m}).call(typeof window<"u"?window:void 0);(function(){let q=this;q.jsPlumbUtil.matchesSelector=function(c,H,Q){Q=Q||c.parentNode;let J=Q.querySelectorAll(H);for(let X=0;X<J.length;X++)if(J[X]===c)return!0;return!1},q.jsPlumbUtil.consume=function(c,H){c.stopPropagation?c.stopPropagation():c.returnValue=!1,!H&&c.preventDefault&&c.preventDefault()},q.jsPlumbUtil.sizeElement=function(c,H,Q,J,X){c&&(c.style.height=X+"px",c.height=X,c.style.width=J+"px",c.width=J,c.style.left=H+"px",c.style.top=Q+"px")}}).call(typeof window<"u"?window:void 0);(function(){let q={deriveAnchor:function(J,X,r,x){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[J][X]}},c=this,H=function(J){this.count=0,this.instance=J,this.lists={},this.instance.addList=function(X,r){return this.listManager.addList(X,r)},this.instance.removeList=function(X){this.listManager.removeList(X)},this.instance.bind("manageElement",(function(X){let r=this.instance.getSelector(X.el,"[jtk-scrollable-list]");for(let x=0;x<r.length;x++)this.addList(r[x])}).bind(this)),this.instance.bind("unmanageElement",function(X){this.removeList(X.el)}),this.instance.bind("connection",(function(X,r){r==null&&(this._maybeUpdateParentList(X.source),this._maybeUpdateParentList(X.target))}).bind(this))};c.jsPlumbListManager=H,H.prototype={addList:function(J,X){let r=this.instance.extend({},q);X=this.instance.extend(r,X||{});let x=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[x]=new Q(this.instance,J,X,x)},removeList:function(J){let X=this.lists[J._jsPlumbList];X&&(X.destroy(),delete this.lists[J._jsPlumbList])},_maybeUpdateParentList:function(J){let X=J.parentNode,r=this.instance.getContainer();for(;X!=null&&X!==r;){if(X._jsPlumbList!=null&&this.lists[X._jsPlumbList]!=null){X._jsPlumbScrollHandler();return}X=X.parentNode}}};var Q=function(J,X,r,x){X._jsPlumbList=x;function u(j,P,I,s){return r.anchor?r.anchor:r.deriveAnchor(j,P,I,s)}function t(j,P,I,s){return r.deriveEndpoint?r.deriveEndpoint(j,P,I,s):r.endpoint?r.endpoint:I.type}function g(j){let P=j.parentNode,I=J.getContainer();for(;P!=null&&P!==I;){if(J.hasClass(P,"jtk-managed")){J.recalculateOffsets(P);return}P=P.parentNode}}let S=function(j){let P=J.getSelector(X,".jtk-managed"),I=J.getId(X);for(var s=0;s<P.length;s++){if(P[s].offsetTop<X.scrollTop)P[s]._jsPlumbProxies||(P[s]._jsPlumbProxies=P[s]._jsPlumbProxies||[],J.select({source:P[s]}).each(function(l){J.proxyConnection(l,0,X,I,function(){return t("top",0,l.endpoints[0],l)},function(){return u("top",0,l.endpoints[0],l)}),P[s]._jsPlumbProxies.push([l,0])}),J.select({target:P[s]}).each(function(l){J.proxyConnection(l,1,X,I,function(){return t("top",1,l.endpoints[1],l)},function(){return u("top",1,l.endpoints[1],l)}),P[s]._jsPlumbProxies.push([l,1])}));else if(P[s].offsetTop>X.scrollTop+X.offsetHeight)P[s]._jsPlumbProxies||(P[s]._jsPlumbProxies=P[s]._jsPlumbProxies||[],J.select({source:P[s]}).each(function(l){J.proxyConnection(l,0,X,I,function(){return t("bottom",0,l.endpoints[0],l)},function(){return u("bottom",0,l.endpoints[0],l)}),P[s]._jsPlumbProxies.push([l,0])}),J.select({target:P[s]}).each(function(l){J.proxyConnection(l,1,X,I,function(){return t("bottom",1,l.endpoints[1],l)},function(){return u("bottom",1,l.endpoints[1],l)}),P[s]._jsPlumbProxies.push([l,1])}));else if(P[s]._jsPlumbProxies){for(let l=0;l<P[s]._jsPlumbProxies.length;l++)J.unproxyConnection(P[s]._jsPlumbProxies[l][0],P[s]._jsPlumbProxies[l][1],I);delete P[s]._jsPlumbProxies}J.revalidate(P[s])}g(X)};J.setAttribute(X,"jtk-scrollable-list","true"),X._jsPlumbScrollHandler=S,J.on(X,"scroll",S),S(),this.destroy=function(){J.off(X,"scroll",S),delete X._jsPlumbScrollHandler;let j=J.getSelector(X,".jtk-managed"),P=J.getId(X);for(let I=0;I<j.length;I++)if(j[I]._jsPlumbProxies){for(let s=0;s<j[I]._jsPlumbProxies.length;s++)J.unproxyConnection(j[I]._jsPlumbProxies[s][0],j[I]._jsPlumbProxies[s][1],P);delete j[I]._jsPlumbProxies}}}}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumbUtil,H=function(){return""+new Date().getTime()},Q=function(s){if(s._jsPlumb.paintStyle&&s._jsPlumb.hoverPaintStyle){let l={};I.extend(l,s._jsPlumb.paintStyle),I.extend(l,s._jsPlumb.hoverPaintStyle),delete s._jsPlumb.hoverPaintStyle,l.gradient&&s._jsPlumb.paintStyle.fill&&delete l.gradient,s._jsPlumb.hoverPaintStyle=l}},J=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],X=function(s,l,N,G){let U=s.getAttachedElements();if(U)for(let O=0,b=U.length;O<b;O++)(!G||G!==U[O])&&U[O].setHover(l,!0,N)},r=function(s){return s==null?null:s.split(" ")},x=function(s,l,N){for(let G in l)s[G]=N},u=function(s,l,N){if(s.getDefaultType){let G=s.getTypeDescriptor(),U={},O=s.getDefaultType(),b=c.merge({},O);x(U,O,"__default");for(let n=0,y=s._jsPlumb.types.length;n<y;n++){let h=s._jsPlumb.types[n];if(h!=="__default"){let D=s._jsPlumb.instance.getType(h,G);if(D!=null){let M=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],p=[];D.mergeStrategy==="override"?Array.prototype.push.apply(M,["events","overlays","cssClass"]):p.push("cssClass"),b=c.merge(b,D,p,M),x(U,D,h)}}}l&&(b=c.populate(b,l,"_")),s.applyType(b,N,U),N||s.repaint()}},t=q.jsPlumbUIComponent=function(s){c.EventGenerator.apply(this,arguments);let l=this,N=arguments,G=l.idPrefix,U=G+new Date().getTime();this._jsPlumb={instance:s._jsPlumb,parameters:s.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:s.beforeDetach,beforeDrop:s.beforeDrop,overlayPlacements:[],hoverClass:s.hoverClass||s._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(D,M,p){this._jsPlumb.typeCache[p]=this._jsPlumb.typeCache[p]||{},this._jsPlumb.typeCache[p][D]=M},this.getCachedTypeItem=function(D,M){return this._jsPlumb.typeCache[M]?this._jsPlumb.typeCache[M][D]:null},this.getId=function(){return U};let O=s.overlays||[],b={};if(this.defaultOverlayKeys){for(var n=0;n<this.defaultOverlayKeys.length;n++)Array.prototype.push.apply(O,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[n]]||[]);for(n=0;n<O.length;n++){let D=I.convertToFullOverlaySpec(O[n]);b[D[1].id]=D}}let y={overlays:b,parameters:s.parameters||{},scope:s.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return y},this.appendToDefaultType=function(D){for(let M in D)y[M]=D[M]},s.events)for(let D in s.events)l.bind(D,s.events[D]);this.clone=(function(){let D=Object.create(this.constructor.prototype);return this.constructor.apply(D,N),D}).bind(this),this.isDetachAllowed=function(D){let M=!0;if(this._jsPlumb.beforeDetach)try{M=this._jsPlumb.beforeDetach(D)}catch(p){c.log("jsPlumb: beforeDetach callback failed",p)}return M},this.isDropAllowed=function(D,M,p,v,_,L,m){let a=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:D,targetId:M,scope:p,connection:v,dropEndpoint:_,source:L,target:m});if(this._jsPlumb.beforeDrop)try{a=this._jsPlumb.beforeDrop({sourceId:D,targetId:M,scope:p,connection:v,dropEndpoint:_,source:L,target:m})}catch(f){c.log("jsPlumb: beforeDrop callback failed",f)}return a};let h=[];this.setListenerComponent=function(D){for(let M=0;M<h.length;M++)h[M][3]=D}},g=function(s,l){let N=s._jsPlumb.types[l],G=s._jsPlumb.instance.getType(N,s.getTypeDescriptor());G!=null&&G.cssClass&&s.canvas&&s._jsPlumb.instance.removeClass(s.canvas,G.cssClass)};c.extend(q.jsPlumbUIComponent,c.EventGenerator,{getParameter:function(s){return this._jsPlumb.parameters[s]},setParameter:function(s,l){this._jsPlumb.parameters[s]=l},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(s){this._jsPlumb.parameters=s},getClass:function(){return I.getClass(this.canvas)},hasClass:function(s){return I.hasClass(this.canvas,s)},addClass:function(s){I.addClass(this.canvas,s)},removeClass:function(s){I.removeClass(this.canvas,s)},updateClasses:function(s,l){I.updateClasses(this.canvas,s,l)},setType:function(s,l,N){this.clearTypes(),this._jsPlumb.types=r(s)||[],u(this,l,N)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(s,l){u(this,s,l)},hasType:function(s){return this._jsPlumb.types.indexOf(s)!==-1},addType:function(s,l,N){let G=r(s),U=!1;if(G!=null){for(let O=0,b=G.length;O<b;O++)this.hasType(G[O])||(this._jsPlumb.types.push(G[O]),U=!0);U&&u(this,l,N)}},removeType:function(s,l,N){let G=r(s),U=!1,O=(function(b){let n=this._jsPlumb.types.indexOf(b);return n!==-1?(g(this,n),this._jsPlumb.types.splice(n,1),!0):!1}).bind(this);if(G!=null){for(let b=0,n=G.length;b<n;b++)U=O(G[b])||U;U&&u(this,l,N)}},clearTypes:function(s,l){let N=this._jsPlumb.types.length;for(let G=0;G<N;G++)g(this,0),this._jsPlumb.types.splice(0,1);u(this,s,l)},toggleType:function(s,l,N){let G=r(s);if(G!=null){for(let U=0,O=G.length;U<O;U++){let b=this._jsPlumb.types.indexOf(G[U]);b!==-1?(g(this,b),this._jsPlumb.types.splice(b,1)):this._jsPlumb.types.push(G[U])}u(this,l,N)}},applyType:function(s,l){if(this.setPaintStyle(s.paintStyle,l),this.setHoverPaintStyle(s.hoverPaintStyle,l),s.parameters)for(let N in s.parameters)this.setParameter(N,s.parameters[N]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(s,l){this._jsPlumb.paintStyle=s,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,Q(this),l||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(s,l){this._jsPlumb.hoverPaintStyle=s,Q(this),l||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(s){(s||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(s,l,N){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=s;let G=s?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[G](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[G](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=s?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(N=N||H(),this.repaint({timestamp:N,recalc:!1}))),this.getAttachedElements&&!l&&X(this,s,H(),this)}}});let S=0,j=function(){let s=S+1;return S++,s},P=q.jsPlumbInstance=function(s){this.version="2.12.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},s&&I.extend(this.Defaults,s),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},c.EventGenerator.apply(this);let l=this,N=j(),G=l.bind,U={},O=1,b=function(o){if(o==null)return null;if(o.nodeType===3||o.nodeType===8)return{el:o,text:!0};{let k=l.getElement(o);return{el:k,id:c.isString(o)&&k==null?o:ht(k)}}};this.getInstanceIndex=function(){return N},this.setZoom=function(o,k){return O=o,l.fire("zoom",O),k&&l.repaintEverything(),!0},this.getZoom=function(){return O};for(let o in this.Defaults)U[o]=this.Defaults[o];let n,y=[];this.unbindContainer=function(){if(n!=null&&y.length>0)for(let o=0;o<y.length;o++)l.off(n,y[o][0],y[o][1])},this.setContainer=function(o){this.unbindContainer(),o=this.getElement(o),this.select().each(function(Z){Z.moveParent(o)}),this.selectEndpoints().each(function(Z){Z.moveParent(o)});let k=n;n=o,y.length=0;let C={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},T=function(Z,st,nt){let dt=st.srcElement||st.target,ut=(dt&&dt.parentNode?dt.parentNode._jsPlumb:null)||(dt?dt._jsPlumb:null)||(dt&&dt.parentNode&&dt.parentNode.parentNode?dt.parentNode.parentNode._jsPlumb:null);if(ut){ut.fire(Z,ut,st);let _t=nt&&C[nt+Z]||Z;l.fire(_t,ut.component||ut,st)}},R=function(Z,st,nt){y.push([Z,nt]),l.on(n,Z,st,nt)},z=function(Z){R(Z,".jtk-connector",function(st){T(Z,st)}),R(Z,".jtk-endpoint",function(st){T(Z,st,"endpoint")}),R(Z,".jtk-overlay",function(st){T(Z,st)})};for(let Z=0;Z<J.length;Z++)z(J[Z]);for(let Z in _){let st=_[Z].el;st.parentNode===k&&(k.removeChild(st),n.appendChild(st))}},this.getContainer=function(){return n},this.bind=function(o,k){o==="ready"&&D?k():G.apply(l,[o,k])},l.importDefaults=function(o){for(let k in o)l.Defaults[k]=o[k];return o.Container&&l.setContainer(o.Container),l},l.restoreDefaults=function(){return l.Defaults=I.extend({},U),l};var h=null,D=!1,M=[],p={},v={},_={},L={},m={},a=!1,f=[],A=!1,F=null,i=this.Defaults.Scope,e=1,d=function(){return""+e++},E=(function(o,k){n?n.appendChild(o):k?this.getElement(k).appendChild(o):this.appendToRoot(o)}).bind(this),w=function(o,k,C,T){if(!A){let R=ht(o),z,Z=l.getDragManager();Z&&(z=Z.getElementsForDraggable(R)),C==null&&(C=H());let st=It({elId:R,offset:k,recalc:!1,timestamp:C});if(z&&st&&st.o)for(let nt in z)It({elId:z[nt].id,offset:{left:st.o.left+z[nt].offset.left,top:st.o.top+z[nt].offset.top},recalc:!1,timestamp:C});if(l.anchorManager.redraw(R,k,C,null,T),z)for(let nt in z)l.anchorManager.redraw(z[nt].id,k,C,z[nt].offset,T,!0)}},B=function(o){return v[o]},W=function(o,k){let C=o.scope.split(/\s/),T=k.scope.split(/\s/);for(let R=0;R<C.length;R++)for(let z=0;z<T.length;z++)if(T[z]===C[R])return!0;return!1},Y=function(o,k){let C=I.extend({},o);for(let T in k)k[T]&&(C[T]=k[T]);return C},V=(function(o,k){let C=I.extend({},o);if(k&&I.extend(C,k),C.source&&(C.source.endpoint?C.sourceEndpoint=C.source:C.source=l.getElement(C.source)),C.target&&(C.target.endpoint?C.targetEndpoint=C.target:C.target=l.getElement(C.target)),o.uuids&&(C.sourceEndpoint=B(o.uuids[0]),C.targetEndpoint=B(o.uuids[1])),C.sourceEndpoint&&C.sourceEndpoint.isFull()){c.log(l,"could not add connection; source endpoint is full");return}if(C.targetEndpoint&&C.targetEndpoint.isFull()){c.log(l,"could not add connection; target endpoint is full");return}if(!C.type&&C.sourceEndpoint&&(C.type=C.sourceEndpoint.connectionType),C.sourceEndpoint&&C.sourceEndpoint.connectorOverlays){C.overlays=C.overlays||[];for(let z=0,Z=C.sourceEndpoint.connectorOverlays.length;z<Z;z++)C.overlays.push(C.sourceEndpoint.connectorOverlays[z])}C.sourceEndpoint&&C.sourceEndpoint.scope&&(C.scope=C.sourceEndpoint.scope),!C["pointer-events"]&&C.sourceEndpoint&&C.sourceEndpoint.connectorPointerEvents&&(C["pointer-events"]=C.sourceEndpoint.connectorPointerEvents);let T=function(z,Z,st){let nt=Y(Z,{anchor:C.anchors?C.anchors[st]:C.anchor,endpoint:C.endpoints?C.endpoints[st]:C.endpoint,paintStyle:C.endpointStyles?C.endpointStyles[st]:C.endpointStyle,hoverPaintStyle:C.endpointHoverStyles?C.endpointHoverStyles[st]:C.endpointHoverStyle});return l.addEndpoint(z,nt)},R=function(z,Z,st,nt){if(C[z]&&!C[z].endpoint&&!C[z+"Endpoint"]&&!C.newConnection){let dt=ht(C[z]),ut=st[dt];if(ut=ut?ut[nt]:null,ut){if(!ut.enabled)return!1;let _t=I.extend({},ut.def);delete _t.label;let jt=ut.endpoint!=null&&ut.endpoint._jsPlumb?ut.endpoint:T(C[z],_t,Z);if(jt.isFull())return!1;C[z+"Endpoint"]=jt,!C.scope&&_t.scope&&(C.scope=_t.scope),ut.uniqueEndpoint?ut.endpoint?jt.finalEndpoint=ut.endpoint:(ut.endpoint=jt,jt.setDeleteOnEmpty(!1)):jt.setDeleteOnEmpty(!0),Z===0&&ut.def.connectorOverlays&&(C.overlays=C.overlays||[],Array.prototype.push.apply(C.overlays,ut.def.connectorOverlays))}}};if(R("source",0,this.sourceEndpointDefinitions,C.type||"default")!==!1&&R("target",1,this.targetEndpointDefinitions,C.type||"default")!==!1)return C.sourceEndpoint&&C.targetEndpoint&&(W(C.sourceEndpoint,C.targetEndpoint)||(C=null)),C}).bind(l),ot=function(o){let k=l.Defaults.ConnectionType||l.getDefaultConnectionType();o._jsPlumb=l,o.newConnection=ot,o.newEndpoint=pt,o.endpointsByUUID=v,o.endpointsByElement=p,o.finaliseConnection=ct,o.id="con_"+d();let C=new k(o);return C.isDetachable()&&(C.endpoints[0].initDraggable("_jsPlumbSource"),C.endpoints[1].initDraggable("_jsPlumbTarget")),C},ct=l.finaliseConnection=function(o,k,C,T){if(k=k||{},o.suspendedEndpoint||M.push(o),o.pending=null,o.endpoints[0].isTemporarySource=!1,T!==!1&&l.anchorManager.newConnection(o),w(o.source),!k.doNotFireConnectionEvent&&k.fireEvent!==!1){let R={connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]};l.fire("connection",R,C)}},pt=function(o,k){let C=l.Defaults.EndpointType||I.Endpoint,T=I.extend({},o);T._jsPlumb=l,T.newConnection=ot,T.newEndpoint=pt,T.endpointsByUUID=v,T.endpointsByElement=p,T.fireDetachEvent=K,T.elementId=k||ht(T.source);let R=new C(T);return R.id="ep_"+d(),Yt(T.elementId,T.source),I.headless||l.getDragManager().endpointAdded(T.source,k),R},$=function(o,k,C){let T=p[o];if(T&&T.length)for(let R=0,z=T.length;R<z;R++){for(let Z=0,st=T[R].connections.length;Z<st;Z++)if(k(T[R].connections[Z]))return;C&&C(T[R])}},rt=function(o,k,C){k=k==="block";let T=null;C&&(T=function(z){z.setVisible(k,!0,!0)});let R=b(o);$(R.id,function(z){if(k&&C){let Z=z.sourceId===R.id?1:0;z.endpoints[Z].isVisible()&&z.setVisible(!0)}else z.setVisible(k)},T)},ft=function(o,k){let C=null;k&&(C=function(T){let R=T.isVisible();T.setVisible(!R)}),$(o,function(T){let R=T.isVisible();T.setVisible(!R)},C)},at=function(o){let k=L[o];return k?{o:k,s:f[o]}:It({elId:o})},ht=function(o,k,C){if(c.isString(o))return o;if(o==null)return null;let T=l.getAttribute(o,"id");return(!T||T==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?T=k:(arguments.length===1||arguments.length===3&&!arguments[2])&&(T="jsPlumb_"+N+"_"+d()),C||l.setAttribute(o,"id",T)),T};this.setConnectionBeingDragged=function(o){a=o},this.isConnectionBeingDragged=function(){return a},this.getManagedElements=function(){return _},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(o,k,C){C=C||{};let T=I.extend({},C);I.extend(T,k),T.endpoint=T.endpoint||l.Defaults.Endpoint,T.paintStyle=T.paintStyle||l.Defaults.EndpointStyle;let R=[],z=c.isArray(o)||o.length!=null&&!c.isString(o)?o:[o];for(let Z=0,st=z.length;Z<st;Z++){T.source=l.getElement(z[Z]),ue(T.source);let nt=ht(T.source),dt=pt(T,nt),ut=Yt(nt,T.source).info.o;c.addToList(p,nt,dt),A||dt.paint({anchorLoc:dt.anchor.compute({xy:[ut.left,ut.top],wh:f[nt],element:dt,timestamp:F}),timestamp:F}),R.push(dt)}return R.length===1?R[0]:R},this.addEndpoints=function(o,k,C){let T=[];for(let R=0,z=k.length;R<z;R++){let Z=l.addEndpoint(o,k[R],C);c.isArray(Z)?Array.prototype.push.apply(T,Z):T.push(Z)}return T},this.animate=function(o,k,C){if(!this.animationSupported)return!1;C=C||{};let T=l.getElement(o),R=ht(T),z=I.animEvents.step,Z=I.animEvents.complete;C[z]=c.wrap(C[z],function(){l.revalidate(R)}),C[Z]=c.wrap(C[Z],function(){l.revalidate(R)}),l.doAnimate(T,k,C)},this.checkCondition=function(o,k){let C=l.getListener(o),T=!0;if(C&&C.length>0){let R=Array.prototype.slice.call(arguments,1);try{for(let z=0,Z=C.length;z<Z;z++)T=T&&C[z].apply(C[z],R)}catch(z){c.log(l,"cannot check condition ["+o+"]"+z)}}return T},this.connect=function(o,k){let C=V(o,k),T;if(C){if(C.source==null&&C.sourceEndpoint==null){c.log("Cannot establish connection - source does not exist");return}if(C.target==null&&C.targetEndpoint==null){c.log("Cannot establish connection - target does not exist");return}ue(C.source),T=ot(C),ct(T,C)}return T};let Ct=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],mt=(function(o,k,C,T){let R,z=Ct[C],Z=o[z.elId];o[z.el];let st,nt,dt=o.endpoints[C],ut={index:C,originalSourceId:C===0?Z:o.sourceId,newSourceId:o.sourceId,originalTargetId:C===1?Z:o.targetId,newTargetId:o.targetId,connection:o};if(k.constructor===I.Endpoint)R=k,R.addConnection(o),k=R.element;else if(st=ht(k),nt=this[z.epDefs][st],st===o[z.elId])R=null;else if(nt)for(let _t in nt){if(!nt[_t].enabled)return;R=nt[_t].endpoint!=null&&nt[_t].endpoint._jsPlumb?nt[_t].endpoint:this.addEndpoint(k,nt[_t].def),nt[_t].uniqueEndpoint&&(nt[_t].endpoint=R),R.addConnection(o)}else R=o.makeEndpoint(C===0,k,st);return R!=null&&(dt.detachFromConnection(o),o.endpoints[C]=R,o[z.el]=R.element,o[z.elId]=R.elementId,ut[C===0?"newSourceId":"newTargetId"]=R.elementId,tt(ut),T||o.repaint()),ut.element=k,ut}).bind(this);this.setSource=function(o,k,C){let T=mt(o,k,0,C);this.anchorManager.sourceChanged(T.originalSourceId,T.newSourceId,o,T.el)},this.setTarget=function(o,k,C){let T=mt(o,k,1,C);this.anchorManager.updateOtherEndpoint(T.originalSourceId,T.originalTargetId,T.newTargetId,o)},this.deleteEndpoint=function(o,k,C){let T=typeof o=="string"?v[o]:o;return T&&l.deleteObject({endpoint:T,dontUpdateHover:k,deleteAttachedObjects:C}),l},this.deleteEveryEndpoint=function(){let o=l.setSuspendDrawing(!0);for(let C in p){let T=p[C];if(T&&T.length)for(let R=0,z=T.length;R<z;R++)l.deleteEndpoint(T[R],!0)}p={},_={},v={},L={},m={},l.anchorManager.reset();let k=l.getDragManager();return k&&k.reset(),o||l.setSuspendDrawing(!1),l};var K=function(o,k,C){let T=l.Defaults.ConnectionType||l.getDefaultConnectionType(),R=o.constructor===T,z=R?{connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]}:o;k&&l.fire("connectionDetached",z,C),l.fire("internal.connectionDetached",z,C),l.anchorManager.connectionDetached(z)},tt=l.fireMoveEvent=function(o,k){l.fire("connectionMoved",o,k)};this.unregisterEndpoint=function(o){o._jsPlumb.uuid&&(v[o._jsPlumb.uuid]=null),l.anchorManager.deleteEndpoint(o);for(let k in p){let C=p[k];if(C){let T=[];for(let R=0,z=C.length;R<z;R++)C[R]!==o&&T.push(C[R]);p[k]=T}p[k].length<1&&delete p[k]}};let et="isDetachAllowed",lt="beforeDetach",yt="checkCondition";this.deleteConnection=function(o,k){return o!=null&&(k=k||{},k.force||c.functionChain(!0,!1,[[o.endpoints[0],et,[o]],[o.endpoints[1],et,[o]],[o,et,[o]],[l,yt,[lt,o]]]))?(o.setHover(!1),K(o,!o.pending&&k.fireEvent!==!1,k.originalEvent),o.endpoints[0].detachFromConnection(o),o.endpoints[1].detachFromConnection(o),c.removeWithFunction(M,function(C){return o.id===C.id}),o.cleanup(),o.destroy(),!0):!1},this.deleteEveryConnection=function(o){o=o||{};let k=M.length,C=0;return l.batch(function(){for(let T=0;T<k;T++)C+=l.deleteConnection(M[0],o)?1:0}),C},this.deleteConnectionsForElement=function(o,k){k=k||{},o=l.getElement(o);let C=ht(o),T=p[C];if(T&&T.length)for(let R=0,z=T.length;R<z;R++)T[R].deleteEveryConnection(k);return l},this.deleteObject=function(o){let k={endpoints:{},connections:{},endpointCount:0,connectionCount:0},C=o.deleteAttachedObjects!==!1,T=function(Z){Z!=null&&k.connections[Z.id]==null&&(!o.dontUpdateHover&&Z._jsPlumb!=null&&Z.setHover(!1),k.connections[Z.id]=Z,k.connectionCount++)},R=function(Z){if(Z!=null&&k.endpoints[Z.id]==null&&(!o.dontUpdateHover&&Z._jsPlumb!=null&&Z.setHover(!1),k.endpoints[Z.id]=Z,k.endpointCount++,C))for(let st=0;st<Z.connections.length;st++){let nt=Z.connections[st];T(nt)}};o.connection?T(o.connection):R(o.endpoint);for(let Z in k.connections){var z=k.connections[Z];if(z._jsPlumb){c.removeWithFunction(M,function(nt){return z.id===nt.id}),K(z,o.fireEvent===!1?!1:!z.pending,o.originalEvent);let st=o.deleteAttachedObjects==null?null:!o.deleteAttachedObjects;z.endpoints[0].detachFromConnection(z,null,st),z.endpoints[1].detachFromConnection(z,null,st),z.cleanup(!0),z.destroy(!0)}}for(let Z in k.endpoints){let st=k.endpoints[Z];st._jsPlumb&&(l.unregisterEndpoint(st),st.cleanup(!0),st.destroy(!0))}return k};let Dt=function(o,k,C,T){for(let R=0,z=o.length;R<z;R++)o[R][k].apply(o[R],C);return T(o)},Mt=function(o,k,C){let T=[];for(let R=0,z=o.length;R<z;R++)T.push([o[R][k].apply(o[R],C),o[R]]);return T},Bt=function(o,k,C){return function(){return Dt(o,k,arguments,C)}},le=function(o,k){return function(){return Mt(o,k,arguments)}},zt=function(o,k){let C=[];if(o)if(typeof o=="string"){if(o==="*")return o;C.push(o)}else if(k)C=o;else if(o.length)for(let T=0,R=o.length;T<R;T++)C.push(b(o[T]).id);else C.push(b(o).id);return C},qt=function(o,k,C){return o==="*"?!0:o.length>0?o.indexOf(k)!==-1:!C};this.getConnections=function(o,k){o?o.constructor===String&&(o={scope:o}):o={};let C=o.scope||l.getDefaultScope(),T=zt(C,!0),R=zt(o.source),z=zt(o.target),Z=!k&&T.length>1?{}:[],st=function(nt,dt){if(!k&&T.length>1){let ut=Z[nt];ut==null&&(ut=Z[nt]=[]),ut.push(dt)}else Z.push(dt)};for(let nt=0,dt=M.length;nt<dt;nt++){let ut=M[nt],_t=ut.proxies&&ut.proxies[0]?ut.proxies[0].originalEp.elementId:ut.sourceId,jt=ut.proxies&&ut.proxies[1]?ut.proxies[1].originalEp.elementId:ut.targetId;qt(T,ut.scope)&&qt(R,_t)&&qt(z,jt)&&st(ut.scope,ut)}return Z};let Pe=function(o,k){return function(C){for(let T=0,R=o.length;T<R;T++)C(o[T]);return k(o)}},de=function(o){return function(k){return o[k]}},Ce=function(o,k){let C={length:o.length,each:Pe(o,k),get:de(o)},T=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],R=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],z,Z;for(z=0,Z=T.length;z<Z;z++)C[T[z]]=Bt(o,T[z],k);for(z=0,Z=R.length;z<Z;z++)C[R[z]]=le(o,R[z]);return C},Ht=function(o){let k=Ce(o,Ht);return I.extend(k,{setDetachable:Bt(o,"setDetachable",Ht),setReattach:Bt(o,"setReattach",Ht),setConnector:Bt(o,"setConnector",Ht),delete:function(){for(let C=0,T=o.length;C<T;C++)l.deleteConnection(o[C])},isDetachable:le(o,"isDetachable"),isReattach:le(o,"isReattach")})},fe=function(o){let k=Ce(o,fe);return I.extend(k,{setEnabled:Bt(o,"setEnabled",fe),setAnchor:Bt(o,"setAnchor",fe),isEnabled:le(o,"isEnabled"),deleteEveryConnection:function(){for(let C=0,T=o.length;C<T;C++)o[C].deleteEveryConnection()},delete:function(){for(let C=0,T=o.length;C<T;C++)l.deleteEndpoint(o[C])}})};this.select=function(o){return o=o||{},o.scope=o.scope||"*",Ht(o.connections||l.getConnections(o,!0))},this.selectEndpoints=function(o){o=o||{},o.scope=o.scope||"*";let k=!o.element&&!o.source&&!o.target,C=k?"*":zt(o.element),T=k?"*":zt(o.source),R=k?"*":zt(o.target),z=zt(o.scope,!0),Z=[];for(let st in p){let nt=qt(C,st,!0),dt=qt(T,st,!0),ut=T!=="*",_t=qt(R,st,!0),jt=R!=="*";if(nt||dt||_t)t:for(let Gt=0,xe=p[st].length;Gt<xe;Gt++){let ae=p[st][Gt];if(qt(z,ae.scope,!0)){let Wt=ut&&T.length>0&&!ae.isSource,Ee=jt&&R.length>0&&!ae.isTarget;if(Wt||Ee)continue t;Z.push(ae)}}}return fe(Z)},this.getAllConnections=function(){return M},this.getDefaultScope=function(){return i},this.getEndpoint=B,this.getEndpoints=function(o){return p[b(o).id]||[]},this.getDefaultEndpointType=function(){return I.Endpoint},this.getDefaultConnectionType=function(){return I.Connection},this.getId=ht,this.draw=w,this.info=b,this.appendElement=E;let re=!1;this.isHoverSuspended=function(){return re},this.setHoverSuspended=function(o){re=o},this.hide=function(o,k){return rt(o,"none",k),l},this.idstamp=d;var ue=function(o){if(!n&&o){let k=l.getElement(o);k.offsetParent&&l.setContainer(k.offsetParent)}};let Lt=function(){l.Defaults.Container&&l.setContainer(l.Defaults.Container)};var Yt=l.manage=function(o,k,C){return _[o]||(_[o]={el:k,endpoints:[],connections:[]},_[o].info=It({elId:o,timestamp:F}),l.addClass(k,"jtk-managed"),C||l.fire("manageElement",{id:o,info:_[o].info,el:k})),_[o]};l.unmanage=function(o){if(_[o]){let k=_[o].el;l.removeClass(k,"jtk-managed"),delete _[o],l.fire("unmanageElement",{id:o,el:k})}};var It=function(o){let k=o.timestamp,C=o.recalc,T=o.offset,R=o.elId,z;return A&&!k&&(k=F),!C&&k&&k===m[R]?{o:o.offset||L[R],s:f[R]}:(C||!T&&L[R]==null?(z=_[R]?_[R].el:null,z!=null&&(f[R]=l.getSize(z),L[R]=l.getOffset(z),m[R]=k)):(L[R]=T||L[R],f[R]==null&&(z=_[R].el,z!=null&&(f[R]=l.getSize(z))),m[R]=k),L[R]&&!L[R].right&&(L[R].right=L[R].left+f[R][0],L[R].bottom=L[R].top+f[R][1],L[R].width=f[R][0],L[R].height=f[R][1],L[R].centerx=L[R].left+L[R].width/2,L[R].centery=L[R].top+L[R].height/2),{o:L[R],s:f[R]})};this.updateOffset=It,this.init=(function(){D||(Lt(),l.anchorManager=new q.jsPlumb.AnchorManager({jsPlumbInstance:l}),D=!0,l.fire("ready",l))}).bind(this),this.log=h,this.jsPlumbUIComponent=t,this.makeAnchor=function(){let o,k=function(z,Z){if(q.jsPlumb.Anchors[z])return new q.jsPlumb.Anchors[z](Z);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+z+"'"}};if(arguments.length===0)return null;let C=arguments[0],T=arguments[1],R=null;if(C.compute&&C.getOrientation)return C;if(typeof C=="string")R=k(arguments[0],{elementId:T,jsPlumbInstance:l});else if(c.isArray(C))if(c.isArray(C[0])||c.isString(C[0]))C.length===2&&c.isObject(C[1])?c.isString(C[0])?(o=q.jsPlumb.extend({elementId:T,jsPlumbInstance:l},C[1]),R=k(C[0],o)):(o=q.jsPlumb.extend({elementId:T,jsPlumbInstance:l,anchors:C[0]},C[1]),R=new q.jsPlumb.DynamicAnchor(o)):R=new I.DynamicAnchor({anchors:C,selector:null,elementId:T,jsPlumbInstance:l});else{let z={x:C[0],y:C[1],orientation:C.length>=4?[C[2],C[3]]:[0,0],offsets:C.length>=6?[C[4],C[5]]:[0,0],elementId:T,jsPlumbInstance:l,cssClass:C.length===7?C[6]:null};R=new q.jsPlumb.Anchor(z),R.clone=function(){return new q.jsPlumb.Anchor(z)}}return R.id||(R.id="anchor_"+d()),R},this.makeAnchors=function(o,k,C){let T=[];for(let R=0,z=o.length;R<z;R++)typeof o[R]=="string"?T.push(q.jsPlumb.Anchors[o[R]]({elementId:k,jsPlumbInstance:C})):c.isArray(o[R])&&T.push(l.makeAnchor(o[R],k,C));return T},this.makeDynamicAnchor=function(o,k){return new q.jsPlumb.DynamicAnchor({anchors:o,selector:k,elementId:null,jsPlumbInstance:l})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};let te=function(o,k,C,T,R){let z=o.target||o.srcElement,Z=!1,st=T.getSelector(k,C);for(let nt=0;nt<st.length;nt++)if(st[nt]===z){Z=!0;break}return R?!Z:Z},ee=function(o,k,C,T,R){let z=new t(k),Z=k._jsPlumb.EndpointDropHandler({jsPlumb:l,enabled:function(){return o.def.enabled},isFull:function(){let nt=l.select({target:o.id}).length;return o.def.maxConnections>0&&nt>=o.def.maxConnections},element:o.el,elementId:o.id,isSource:T,isTarget:R,addClass:function(nt){l.addClass(o.el,nt)},removeClass:function(nt){l.removeClass(o.el,nt)},onDrop:function(nt){nt.endpoints[0].anchor.unlock()},isDropAllowed:function(){return z.isDropAllowed.apply(z,arguments)},isRedrop:function(nt){return nt.suspendedElement!=null&&nt.suspendedEndpoint!=null&&nt.suspendedEndpoint.element===o.el},getEndpoint:function(nt){let dt=o.def.endpoint;if(dt==null||dt._jsPlumb==null){let ut=l.deriveEndpointAndAnchorSpec(nt.getType().join(" "),!0),_t=ut.endpoints?q.jsPlumb.extend(k,{endpoint:o.def.def.endpoint||ut.endpoints[1]}):k;ut.anchors&&(_t=q.jsPlumb.extend(_t,{anchor:o.def.def.anchor||ut.anchors[1]})),dt=l.addEndpoint(o.el,_t),dt._mtNew=!0}if(k.uniqueEndpoint&&(o.def.endpoint=dt),dt.setDeleteOnEmpty(!0),nt.isDetachable()&&dt.initDraggable(),dt.anchor.positionFinder!=null){let ut=l.getUIPosition(arguments,l.getZoom()),_t=l.getOffset(o.el),jt=l.getSize(o.el),Gt=ut==null?[0,0]:dt.anchor.positionFinder(ut,_t,jt,dt.anchor.constructorParams);dt.anchor.x=Gt[0],dt.anchor.y=Gt[1]}return dt},maybeCleanup:function(nt){nt._mtNew&&nt.connections.length===0?l.deleteObject({endpoint:nt}):delete nt._mtNew}}),st=q.jsPlumb.dragEvents.drop;return C.scope=C.scope||k.scope||l.Defaults.Scope,C[st]=c.wrap(C[st],Z,!0),C.rank=k.rank||0,R&&(C[q.jsPlumb.dragEvents.over]=function(){return!0}),k.allowLoopback===!1&&(C.canDrop=function(nt){return nt.getDragElement()._jsPlumbRelatedElement!==o.el}),l.initDroppable(o.el,C,"internal"),Z};this.makeTarget=function(o,k,C){let T=q.jsPlumb.extend({_jsPlumb:this},C);q.jsPlumb.extend(T,k);let R=T.maxConnections||-1,z=(function(st){let nt=b(st),dt=nt.id,ut=q.jsPlumb.extend({},T.dropOptions||{}),_t=T.connectionType||"default";this.targetEndpointDefinitions[dt]=this.targetEndpointDefinitions[dt]||{},ue(dt),nt.el._isJsPlumbGroup&&ut.rank==null&&(ut.rank=-1);let jt={def:q.jsPlumb.extend({},T),uniqueEndpoint:T.uniqueEndpoint,maxConnections:R,enabled:!0};T.createEndpoint&&(jt.uniqueEndpoint=!0,jt.endpoint=l.addEndpoint(st,jt.def),jt.endpoint.setDeleteOnEmpty(!1)),nt.def=jt,this.targetEndpointDefinitions[dt][_t]=jt,ee(nt,T,ut,T.isSource===!0,!0),nt.el._katavorioDrop[nt.el._katavorioDrop.length-1].targetDef=jt}).bind(this),Z=o.length&&o.constructor!==String?o:[o];for(let st=0,nt=Z.length;st<nt;st++)z(Z[st]);return this},this.unmakeTarget=function(o,k){let C=b(o);return l.destroyDroppable(C.el,"internal"),k||delete this.targetEndpointDefinitions[C.id],this},this.makeSource=function(o,k,C){let T=q.jsPlumb.extend({_jsPlumb:this},C);q.jsPlumb.extend(T,k);let R=T.connectionType||"default",z=l.deriveEndpointAndAnchorSpec(R);T.endpoint=T.endpoint||z.endpoints[0],T.anchor=T.anchor||z.anchors[0];let Z=T.maxConnections||-1,st=T.onMaxConnections,nt=(function(ut){let _t=ut.id,jt=this.getElement(ut.el);this.sourceEndpointDefinitions[_t]=this.sourceEndpointDefinitions[_t]||{},ue(_t);let Gt={def:q.jsPlumb.extend({},T),uniqueEndpoint:T.uniqueEndpoint,maxConnections:Z,enabled:!0};T.createEndpoint&&(Gt.uniqueEndpoint=!0,Gt.endpoint=l.addEndpoint(o,Gt.def),Gt.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[_t][R]=Gt,ut.def=Gt;let xe=q.jsPlumb.dragEvents.stop,ae=q.jsPlumb.dragEvents.drag,Wt=q.jsPlumb.extend({},T.dragOptions||{}),Ee=Wt.drag,Te=Wt.stop,Tt=null,Se=!1;Wt.scope=Wt.scope||T.scope,Wt[ae]=c.wrap(Wt[ae],function(){Ee&&Ee.apply(this,arguments),Se=!1}),Wt[xe]=c.wrap(Wt[xe],(function(){if(Te&&Te.apply(this,arguments),this.currentlyDragging=!1,Tt._jsPlumb!=null){let Vt=T.anchor||this.Defaults.Anchor,Ft=Tt.anchor,De=Tt.connections[0],Kt=this.makeAnchor(Vt,_t,this),Qt=Tt.element;if(Kt.positionFinder!=null){let ne=l.getOffset(Qt),pe=this.getSize(Qt),ve={left:ne.left+Ft.x*pe[0],top:ne.top+Ft.y*pe[1]},_e=Kt.positionFinder(ve,ne,pe,Kt.constructorParams);Kt.x=_e[0],Kt.y=_e[1]}Tt.setAnchor(Kt,!0),Tt.repaint(),this.repaint(Tt.elementId),De!=null&&this.repaint(De.targetId)}}).bind(this));let Fe=(function(Vt){if(Vt.which===3||Vt.button===2)return;let Ft=this.sourceEndpointDefinitions[_t][R];if(!Ft.enabled||(_t=this.getId(this.getElement(ut.el)),T.filter&&(c.isString(T.filter)?te(Vt,ut.el,T.filter,this,T.filterExclude):T.filter(Vt,ut.el))===!1))return;let De=this.select({source:_t}).length;if(Ft.maxConnections>=0&&De>=Ft.maxConnections)return st&&st({element:ut.el,maxConnections:Z},Vt),!1;let Kt=q.jsPlumb.getPositionOnElement(Vt,jt,O),Qt={};q.jsPlumb.extend(Qt,Ft.def),Qt.isTemporarySource=!0,Qt.anchor=[Kt[0],Kt[1],0,0],Qt.dragOptions=Wt,Ft.def.scope&&(Qt.scope=Ft.def.scope),Tt=this.addEndpoint(_t,Qt),Se=!0,Tt.setDeleteOnEmpty(!0),Ft.uniqueEndpoint&&(Ft.endpoint?Tt.finalEndpoint=Ft.endpoint:(Ft.endpoint=Tt,Tt.setDeleteOnEmpty(!1)));let ne=function(){l.off(Tt.canvas,"mouseup",ne),l.off(ut.el,"mouseup",ne),Se&&(Se=!1,l.deleteEndpoint(Tt))};l.on(Tt.canvas,"mouseup",ne),l.on(ut.el,"mouseup",ne);let pe={};if(Ft.def.extract)for(let ve in Ft.def.extract){let _e=(Vt.srcElement||Vt.target).getAttribute(ve);_e&&(pe[Ft.def.extract[ve]]=_e)}l.trigger(Tt.canvas,"mousedown",Vt,pe),c.consume(Vt)}).bind(this);this.on(ut.el,"mousedown",Fe),Gt.trigger=Fe,T.filter&&(c.isString(T.filter)||c.isFunction(T.filter))&&l.setDragFilter(ut.el,T.filter);let Be=q.jsPlumb.extend({},T.dropOptions||{});ee(ut,T,Be,!0,T.isTarget===!0)}).bind(this),dt=o.length&&o.constructor!==String?o:[o];for(let ut=0,_t=dt.length;ut<_t;ut++)nt(b(dt[ut]));return this},this.unmakeSource=function(o,k,C){let T=b(o);l.destroyDroppable(T.el,"internal");let R=this.sourceEndpointDefinitions[T.id];if(R){for(let z in R)if(k==null||k===z){let Z=R[z].trigger;Z&&l.off(T.el,"mousedown",Z),C||delete this.sourceEndpointDefinitions[T.id][z]}}return this},this.unmakeEverySource=function(){for(let o in this.sourceEndpointDefinitions)l.unmakeSource(o,null,!0);return this.sourceEndpointDefinitions={},this};let it=(function(o,k,C){k=c.isArray(k)?k:[k];let T=ht(o);C=C||"default";for(let R=0;R<k.length;R++){let z=this[k[R]][T];if(z&&z[C])return z[C].def.scope||this.Defaults.Scope}}).bind(this),vt=(function(o,k,C,T){C=c.isArray(C)?C:[C];let R=ht(o);T=T||"default";for(let z=0;z<C.length;z++){let Z=this[C[z]][R];Z&&Z[T]&&(Z[T].def.scope=k)}}).bind(this);this.getScope=function(o,k){return it(o,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(o){return it(o,"sourceEndpointDefinitions")},this.getTargetScope=function(o){return it(o,"targetEndpointDefinitions")},this.setScope=function(o,k,C){this.setSourceScope(o,k,C),this.setTargetScope(o,k,C)},this.setSourceScope=function(o,k,C){vt(o,k,"sourceEndpointDefinitions",C),this.setDragScope(o,k)},this.setTargetScope=function(o,k,C){vt(o,k,"targetEndpointDefinitions",C),this.setDropScope(o,k)},this.unmakeEveryTarget=function(){for(let o in this.targetEndpointDefinitions)l.unmakeTarget(o,!0);return this.targetEndpointDefinitions={},this};let Pt=(function(o,k,C,T,R){let z=o==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,Z,st,nt;if(R=R||"default",k.length&&!c.isString(k)){Z=[];for(let dt=0,ut=k.length;dt<ut;dt++)st=b(k[dt]),z[st.id]&&z[st.id][R]&&(Z[dt]=z[st.id][R].enabled,nt=T?!Z[dt]:C,z[st.id][R].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}else{st=b(k);let dt=st.id;z[dt]&&z[dt][R]&&(Z=z[dt][R].enabled,nt=T?!Z:C,z[dt][R].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}return Z}).bind(this),gt=(function(o,k){if(c.isString(o)||!o.length)return k.apply(this,[o]);if(o.length)return k.apply(this,[o[0]])}).bind(this);this.toggleSourceEnabled=function(o,k){return Pt("source",o,null,!0,k),this.isSourceEnabled(o,k)},this.setSourceEnabled=function(o,k,C){return Pt("source",o,k,null,C)},this.isSource=function(o,k){return k=k||"default",gt(o,(function(C){let T=this.sourceEndpointDefinitions[b(C).id];return T!=null&&T[k]!=null}).bind(this))},this.isSourceEnabled=function(o,k){return k=k||"default",gt(o,(function(C){let T=this.sourceEndpointDefinitions[b(C).id];return T&&T[k]&&T[k].enabled===!0}).bind(this))},this.toggleTargetEnabled=function(o,k){return Pt("target",o,null,!0,k),this.isTargetEnabled(o,k)},this.isTarget=function(o,k){return k=k||"default",gt(o,(function(C){let T=this.targetEndpointDefinitions[b(C).id];return T!=null&&T[k]!=null}).bind(this))},this.isTargetEnabled=function(o,k){return k=k||"default",gt(o,(function(C){let T=this.targetEndpointDefinitions[b(C).id];return T&&T[k]&&T[k].enabled===!0}).bind(this))},this.setTargetEnabled=function(o,k,C){return Pt("target",o,k,null,C)},this.ready=function(o){l.bind("ready",o)};let St=function(o,k){if(typeof o=="object"&&o.length)for(let C=0,T=o.length;C<T;C++)k(o[C]);else k(o);return l};this.repaint=function(o,k,C){return St(o,function(T){w(T,k,C)})},this.revalidate=function(o,k,C){return St(o,function(T){let R=C?T:l.getId(T);l.updateOffset({elId:R,recalc:!0,timestamp:k});let z=l.getDragManager();z&&z.updateOffsets(R),l.repaint(T)})},this.repaintEverything=function(){let o=H(),k;for(k in p)l.updateOffset({elId:k,recalc:!0,timestamp:o});for(k in p)w(k,null,o);return this},this.removeAllEndpoints=function(o,k,C){C=C||[];let T=function(R){let z=b(R),Z=p[z.id],st,nt;if(Z)for(C.push(z),st=0,nt=Z.length;st<nt;st++)l.deleteEndpoint(Z[st],!1);if(delete p[z.id],k&&z.el&&z.el.nodeType!==3&&z.el.nodeType!==8)for(st=0,nt=z.el.childNodes.length;st<nt;st++)T(z.el.childNodes[st])};return T(o),this};let kt=function(o,k){l.removeAllEndpoints(o.id,!0,k);let C=l.getDragManager(),T=function(R){C&&C.elementRemoved(R.id),l.anchorManager.clearFor(R.id),l.anchorManager.removeFloatingConnection(R.id),l.isSource(R.el)&&l.unmakeSource(R.el),l.isTarget(R.el)&&l.unmakeTarget(R.el),l.destroyDraggable(R.el),l.destroyDroppable(R.el),delete l.floatingConnections[R.id],delete _[R.id],delete L[R.id],R.el&&(l.removeElement(R.el),R.el._jsPlumb=null)};for(let R=1;R<k.length;R++)T(k[R]);T(o)};this.remove=function(o,k){let C=b(o),T=[];return C.text&&C.el.parentNode?C.el.parentNode.removeChild(C.el):C.id&&l.batch(function(){kt(C,T)},k===!0),l},this.empty=function(o,k){let C=[],T=function(R,z){let Z=b(R);if(Z.text)Z.el.parentNode.removeChild(Z.el);else if(Z.el){for(;Z.el.childNodes.length>0;)T(Z.el.childNodes[0]);z||kt(Z,C)}};return l.batch(function(){T(o,!0)},k===!1),l},this.reset=function(o){l.silently((function(){re=!1,l.removeAllGroups(),l.removeGroupManager(),l.deleteEveryEndpoint(),o||l.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},M.length=0,this.doReset&&this.doReset()}).bind(this))};let Xt=function(o){o.canvas&&o.canvas.parentNode&&o.canvas.parentNode.removeChild(o.canvas),o.cleanup(),o.destroy()};this.clear=function(){l.select().each(Xt),l.selectEndpoints().each(Xt),p={},v={}},this.setDefaultScope=function(o){return i=o,l},this.deriveEndpointAndAnchorSpec=function(o,k){let C=((k?"":"default ")+o).split(/[\s]/),T=null,R=null,z=null,Z=null;for(let st=0;st<C.length;st++){let nt=l.getType(C[st],"connection");nt&&(nt.endpoints&&(T=nt.endpoints),nt.endpoint&&(R=nt.endpoint),nt.anchors&&(Z=nt.anchors),nt.anchor&&(z=nt.anchor))}return{endpoints:T||[R,R],anchors:Z||[z,z]}},this.setId=function(o,k,C){let T;c.isString(o)?T=o:(o=this.getElement(o),T=this.getId(o));let R=this.getConnections({source:T,scope:"*"},!0),z=this.getConnections({target:T,scope:"*"},!0);k=""+k,C?o=this.getElement(k):(o=this.getElement(T),this.setAttribute(o,"id",k)),p[k]=p[T]||[];for(let nt=0,dt=p[k].length;nt<dt;nt++)p[k][nt].setElementId(k),p[k][nt].setReferenceElement(o);delete p[T],this.sourceEndpointDefinitions[k]=this.sourceEndpointDefinitions[T],delete this.sourceEndpointDefinitions[T],this.targetEndpointDefinitions[k]=this.targetEndpointDefinitions[T],delete this.targetEndpointDefinitions[T],this.anchorManager.changeId(T,k);let Z=this.getDragManager();Z&&Z.changeId(T,k),_[k]=_[T],delete _[T];let st=function(nt,dt,ut){for(let _t=0,jt=nt.length;_t<jt;_t++)nt[_t].endpoints[dt].setElementId(k),nt[_t].endpoints[dt].setReferenceElement(o),nt[_t][ut+"Id"]=k,nt[_t][ut]=o};st(R,0,"source"),st(z,1,"target"),this.repaint(k)},this.setDebugLog=function(o){h=o},this.setSuspendDrawing=function(o,k){let C=A;return A=o,o?F=new Date().getTime():F=null,k&&this.repaintEverything(),C},this.isSuspendDrawing=function(){return A},this.getSuspendedAt=function(){return F},this.batch=function(o,k){let C=this.isSuspendDrawing();C||this.setSuspendDrawing(!0);try{o()}catch(T){c.log("Function run while suspended failed",T)}C||this.setSuspendDrawing(!1,!k)},this.doWhileSuspended=this.batch,this.getCachedData=at,this.timestamp=H,this.show=function(o,k){return rt(o,"block",k),l},this.toggleVisible=ft,this.addListener=this.bind;let $t=[];this.registerFloatingConnection=function(o,k,C){$t[o.id]=k,c.addToList(p,o.id,C)},this.getFloatingConnectionFor=function(o){return $t[o]},this.listManager=new q.jsPlumbListManager(this)};c.extend(q.jsPlumbInstance,c.EventGenerator,{setAttribute:function(s,l,N){this.setAttribute(s,l,N)},getAttribute:function(s,l){return this.getAttribute(q.jsPlumb.getElement(s),l)},convertToFullOverlaySpec:function(s){return c.isString(s)&&(s=[s,{}]),s[1].id=s[1].id||c.uuid(),s},registerConnectionType:function(s,l){if(this._connectionTypes[s]=q.jsPlumb.extend({},l),l.overlays){let N={};for(let G=0;G<l.overlays.length;G++){let U=this.convertToFullOverlaySpec(l.overlays[G]);N[U[1].id]=U}this._connectionTypes[s].overlays=N}},registerConnectionTypes:function(s){for(let l in s)this.registerConnectionType(l,s[l])},registerEndpointType:function(s,l){if(this._endpointTypes[s]=q.jsPlumb.extend({},l),l.overlays){let N={};for(let G=0;G<l.overlays.length;G++){let U=this.convertToFullOverlaySpec(l.overlays[G]);N[U[1].id]=U}this._endpointTypes[s].overlays=N}},registerEndpointTypes:function(s){for(let l in s)this.registerEndpointType(l,s[l])},getType:function(s,l){return l==="connection"?this._connectionTypes[s]:this._endpointTypes[s]},setIdChanged:function(s,l){this.setId(s,l,!0)},setParent:function(s,l){let N=this.getElement(s),G=this.getId(N),U=this.getElement(l),O=this.getId(U),b=this.getDragManager();N.parentNode.removeChild(N),U.appendChild(N),b&&b.setParent(N,G,U,O)},extend:function(s,l,N){let G;if(N)for(G=0;G<N.length;G++)s[N[G]]=l[N[G]];else for(G in l)s[G]=l[G];return s},floatingConnections:{},getFloatingAnchorIndex:function(s){return s.endpoints[0].isFloating()?0:s.endpoints[1].isFloating()?1:-1},proxyConnection:function(s,l,N,G,U,O){let b,n=s.endpoints[l].elementId,y=s.endpoints[l];s.proxies=s.proxies||[],s.proxies[l]?b=s.proxies[l].ep:b=this.addEndpoint(N,{endpoint:U(s,l),anchor:O(s,l),parameters:{isProxyEndpoint:!0}}),b.setDeleteOnEmpty(!0),s.proxies[l]={ep:b,originalEp:y},l===0?this.anchorManager.sourceChanged(n,G,s,N):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,n,G,s),s.target=N,s.targetId=G),y.detachFromConnection(s,null,!0),b.connections=[s],s.endpoints[l]=b,y.setVisible(!1),s.setVisible(!0),this.revalidate(N)},unproxyConnection:function(s,l,N){if(s._jsPlumb==null||s.proxies==null||s.proxies[l]==null)return;let G=s.proxies[l].originalEp.element,U=s.proxies[l].originalEp.elementId;s.endpoints[l]=s.proxies[l].originalEp,l===0?this.anchorManager.sourceChanged(N,U,s,G):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,N,U,s),s.target=G,s.targetId=U),s.proxies[l].ep.detachFromConnection(s,null),s.proxies[l].originalEp.addConnection(s),s.isVisible()&&s.proxies[l].originalEp.setVisible(!0),delete s.proxies[l]}});var I=new P;q.jsPlumb=I,I.getInstance=function(s,l){let N=new P(s);if(l)for(let G in l)N[G]=l[G];return N.init(),N},I.each=function(s,l){if(s!=null)if(typeof s=="string")l(I.getElement(s));else if(s.length!=null)for(let N=0;N<s.length;N++)l(I.getElement(s[N]));else l(s)},typeof exports<"u"&&(exports.jsPlumb=I)}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q="__label",J=function(r,x){let u={cssClass:x.cssClass,labelStyle:r.labelStyle,id:Q,component:r,_jsPlumb:r._jsPlumb.instance},t=c.extend(u,x);return new c.Overlays[r._jsPlumb.instance.getRenderMode()].Label(t)},X=function(r,x){let u=null;if(H.isArray(x)){let t=x[0],g=c.extend({component:r,_jsPlumb:r._jsPlumb.instance},x[1]);x.length===3&&c.extend(g,x[2]),u=new c.Overlays[r._jsPlumb.instance.getRenderMode()][t](g)}else x.constructor===String?u=new c.Overlays[r._jsPlumb.instance.getRenderMode()][x]({component:r,_jsPlumb:r._jsPlumb.instance}):u=x;return u.id=u.id||H.uuid(),r.cacheTypeItem("overlay",u,u.id),r._jsPlumb.overlays[u.id]=u,u};c.OverlayCapableJsPlumbUIComponent=function(r){q.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},r.label?this.getDefaultType().overlays[Q]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:Q}]:r.id&&(this.getDefaultType().overlays[Q]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.emptyLabelStyle||this._jsPlumb.instance.Defaults.emptyLabelStyle,id:Q}]),this.setListenerComponent=function(x){if(this._jsPlumb)for(let u in this._jsPlumb.overlays)this._jsPlumb.overlays[u].setListenerComponent(x)}},c.OverlayCapableJsPlumbUIComponent.applyType=function(r,x){if(x.overlays){let u={},t;for(t in x.overlays){let g=r._jsPlumb.overlays[x.overlays[t][1].id];if(g)g.updateFrom(x.overlays[t][1]),u[x.overlays[t][1].id]=!0;else{let S=r.getCachedTypeItem("overlay",x.overlays[t][1].id);S!=null?(S.reattach(r._jsPlumb.instance,r),S.setVisible(!0),S.updateFrom(x.overlays[t][1]),r._jsPlumb.overlays[S.id]=S):S=r.addOverlay(x.overlays[t],!0),u[S.id]=!0}}for(t in r._jsPlumb.overlays)u[r._jsPlumb.overlays[t].id]==null&&r.removeOverlay(r._jsPlumb.overlays[t].id,!0)}},H.extend(c.OverlayCapableJsPlumbUIComponent,q.jsPlumbUIComponent,{setHover:function(r,x){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(let u in this._jsPlumb.overlays)this._jsPlumb.overlays[u][r?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(r,x){let u=X(this,r);if(this.getData&&u.type==="Label"&&H.isArray(r)){let t=this.getData(),g=r[1];if(t){let S=g.labelLocationAttribute||"labelLocation",j=t?t[S]:null;j&&(u.loc=j)}}return x||this.repaint(),u},getOverlay:function(r){return this._jsPlumb.overlays[r]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(r){let x=this.getOverlay(r);x&&x.hide()},hideOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].hide()},showOverlay:function(r){let x=this.getOverlay(r);x&&x.show()},showOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].show()},removeAllOverlays:function(r){for(let x in this._jsPlumb.overlays)this._jsPlumb.overlays[x].cleanup&&this._jsPlumb.overlays[x].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},r||this.repaint()},removeOverlay:function(r,x){let u=this._jsPlumb.overlays[r];u&&(u.setVisible(!1),!x&&u.cleanup&&u.cleanup(),delete this._jsPlumb.overlays[r],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[r],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[r])},removeOverlays:function(){for(let r=0,x=arguments.length;r<x;r++)this.removeOverlay(arguments[r])},moveParent:function(r){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),r.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),r.appendChild(this.canvas);for(let x in this._jsPlumb.overlays)if(this._jsPlumb.overlays[x].isAppendedAtTopLevel){let u=this._jsPlumb.overlays[x].getElement();u.parentNode.removeChild(u),r.appendChild(u)}}},getLabel:function(){let r=this.getOverlay(Q);return r!=null?r.getLabel():null},getLabelOverlay:function(){return this.getOverlay(Q)},setLabel:function(r){let x=this.getOverlay(Q);if(x)r.constructor===String||r.constructor===Function?x.setLabel(r):(r.label||(r.label=""),x.setLabel(r.label),r.location&&x.setLocation(r.location));else{let u=r.constructor===String||r.constructor===Function?{label:r}:r;x=J(this,u),this._jsPlumb.overlays[Q]=x}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(r){for(let x in this._jsPlumb.overlays)this._jsPlumb.overlays[x].cleanup(r),this._jsPlumb.overlays[x].destroy(r);r&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(r){this[r?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(r,x){this._jsPlumb.overlayPositions[r.id]=x},getAbsoluteOverlayPosition:function(r){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[r.id]:null},_clazzManip:function(r,x,u){if(!u)for(let t in this._jsPlumb.overlays)this._jsPlumb.overlays[t][r+"Class"](x)},addClass:function(r,x){this._clazzManip("add",r,x)},removeClass:function(r,x){this._clazzManip("remove",r,x)}})}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q=function(u,t,g){let S=!1;return{drag:function(){if(S)return S=!1,!0;if(t.element){let j=g.getUIPosition(arguments,g.getZoom());j!=null&&g.setPosition(t.element,j),g.repaint(t.element,j),u.paint({anchorPoint:u.anchor.getCurrentLocation({element:u})})}},stopDrag:function(){S=!0}}},J=function(u,t,g,S){let j=t.createElement("div",{position:"absolute"});t.appendElement(j);let P=t.getId(j);t.setPosition(j,g),j.style.width=S[0]+"px",j.style.height=S[1]+"px",t.manage(P,j,!0),u.id=P,u.element=j},X=function(u,t,g,S,j,P,I,s){let l=new c.FloatingAnchor({reference:t,referenceCanvas:S,jsPlumbInstance:P});return I({paintStyle:u,endpoint:g,anchor:l,source:j,scope:s})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],x=function(u,t){let g=0;if(t!=null){for(let S=0;S<u.connections.length;S++)if(u.connections[S].sourceId===t||u.connections[S].targetId===t){g=S;break}}return u.connections[g]};c.Endpoint=function(u){let t=u._jsPlumb,g=u.newConnection,S=u.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:u.connectionType,maxConnections:u.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:u.maxConnections,paintStyle:u.endpointStyle||u.paintStyle||u.style||this._jsPlumb.instance.Defaults.EndpointStyle||c.Defaults.EndpointStyle,hoverPaintStyle:u.endpointHoverStyle||u.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle,connectorStyle:u.connectorStyle,connectorHoverStyle:u.connectorHoverStyle,connectorClass:u.connectorClass,connectorHoverClass:u.connectorHoverClass,connectorOverlays:u.connectorOverlays,connector:u.connector,connectorTooltip:u.connectorTooltip}),this._jsPlumb.enabled=u.enabled!==!1,this._jsPlumb.visible=!0,this.element=c.getElement(u.source),this._jsPlumb.uuid=u.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(u.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=u.elementId,this.dragProxy=u.dragProxy,this._jsPlumb.connectionCost=u.connectionCost,this._jsPlumb.connectionsDirected=u.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};let j=u.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(O){j=O};let P=(function(){let O=t.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();let b=t.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(O),this.addClass(b),c.updateClasses(this.element,b,O)}).bind(this);this.prepareAnchor=function(O){let b=this._jsPlumb.instance.makeAnchor(O,this.elementId,t);return b.bind("anchorChanged",(function(n){this.fire("anchorChanged",{endpoint:this,anchor:n}),P()}).bind(this)),b},this.setPreparedAnchor=function(O,b){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=O,P(),b||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(O,b){let n=this.prepareAnchor(O);return this.setPreparedAnchor(n,b),this};let I=(function(O){if(this.connections.length>0)for(let b=0;b<this.connections.length;b++)this.connections[b].setHover(O,!1);else this.setHover(O)}).bind(this);this.bind("mouseover",function(){I(!0)}),this.bind("mouseout",function(){I(!1)}),u._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(O,b){let n=function(D,M){let p=t.getRenderMode();if(c.Endpoints[p][D])return new c.Endpoints[p][D](M);if(!t.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+D+"'"}},y={_jsPlumb:this._jsPlumb.instance,cssClass:u.cssClass,container:u.container,tooltip:u.tooltip,connectorTooltip:u.connectorTooltip,endpoint:this},h;return H.isString(O)?h=n(O,y):H.isArray(O)?(y=H.merge(O[1],y),h=n(O[0],y)):h=O.clone(),h.clone=(function(){if(H.isString(O))return n(O,y);if(H.isArray(O))return y=H.merge(O[1],y),n(O[0],y)}).bind(this),h.typeId=b,h},this.setEndpoint=function(O,b){let n=this.prepareEndpoint(O);this.setPreparedEndpoint(n,!0)},this.setPreparedEndpoint=function(O,b){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=O,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},c.extend(this,u,r),this.isSource=u.isSource||!1,this.isTemporarySource=u.isTemporarySource||!1,this.isTarget=u.isTarget||!1,this.connections=u.connections||[],this.connectorPointerEvents=u["connector-pointer-events"],this.scope=u.scope||t.getDefaultScope(),this.timestamp=null,this.reattachConnections=u.reattach||t.Defaults.ReattachConnections,this.connectionsDetachable=t.Defaults.ConnectionsDetachable,(u.connectionsDetachable===!1||u.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=u.dragAllowedWhenFull!==!1,u.onMaxConnections&&this.bind("maxConnections",u.onMaxConnections),this.addConnection=function(O){this.connections.push(O),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)},this.detachFromConnection=function(O,b,n){b=b??this.connections.indexOf(O),b>=0&&(this.connections.splice(b,1),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)),!n&&j&&this.connections.length===0&&t.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:n!==!0})},this.deleteEveryConnection=function(O){let b=this.connections.length;for(let n=0;n<b;n++)t.deleteConnection(this.connections[0],O)},this.detachFrom=function(O,b,n){let y=[];for(let h=0;h<this.connections.length;h++)(this.connections[h].endpoints[1]===O||this.connections[h].endpoints[0]===O)&&y.push(this.connections[h]);for(let h=0,D=y.length;h<D;h++)t.deleteConnection(y[0]);return this},this.getElement=function(){return this.element},this.setElement=function(O){let b=this._jsPlumb.instance.getId(O),n=this.elementId;return H.removeWithFunction(u.endpointsByElement[this.elementId],(function(y){return y.id===this.id}).bind(this)),this.element=c.getElement(O),this.elementId=t.getId(this.element),t.anchorManager.rehomeEndpoint(this,n,this.element),t.dragManager.endpointAdded(this.element),H.addToList(u.endpointsByElement,b,this),this},this.makeInPlaceCopy=function(){let O=this.anchor.getCurrentLocation({element:this}),b=this.anchor.getOrientation(this),n=this.anchor.getCssClass(),y={bind:function(){},compute:function(){return[O[0],O[1]]},getCurrentLocation:function(){return[O[0],O[1]]},getOrientation:function(){return b},getCssClass:function(){return n}};return S({dropOptions:u.dropOptions,anchor:y,source:this.element,paintStyle:this.getPaintStyle(),endpoint:u.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(O){O=O||{};let b=O.timestamp,n=O.recalc!==!1;if(!b||this.timestamp!==b){let y=t.updateOffset({elId:this.elementId,timestamp:b}),h=O.offset?O.offset.o:y.o;if(h!=null){let D=O.anchorPoint,M=O.connectorPaintStyle;if(D==null){let p=O.dimensions||y.s,v={xy:[h.left,h.top],wh:p,element:this,timestamp:b};if(n&&this.anchor.isDynamic&&this.connections.length>0){let _=x(this,O.elementWithPrecedence),L=_.endpoints[0]===this?1:0,m=L===0?_.sourceId:_.targetId,a=t.getCachedData(m),f=a.o,A=a.s;v.index=L===0?1:0,v.connection=_,v.txy=[f.left,f.top],v.twh=A,v.tElement=_.endpoints[L]}else this.connections.length>0&&(v.connection=this.connections[0]);D=this.anchor.compute(v)}this.endpoint.compute(D,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,M||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=b;for(let p in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(p)){let v=this._jsPlumb.overlays[p];v.isVisible()&&(this._jsPlumb.overlayPlacements[p]=v.draw(this.endpoint,this._jsPlumb.paintStyleInUse),v.paint(this._jsPlumb.overlayPlacements[p]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;let s=!1;this.initDraggable=function(){if(!s&&c.isDragSupported(this.element)){let O={id:null,element:null},b=null,n=!1,y=null,h=Q(this,O,t),D=u.dragOptions||{},M={},p=c.dragEvents.start,v=c.dragEvents.stop,_=c.dragEvents.drag,L=c.dragEvents.beforeStart,m,a=function(F){m=F.e.payload||{}},f=(function(F){b=this.connectorSelector();let i=!0;this.isEnabled()||(i=!1),b==null&&!this.isSource&&!this.isTemporarySource&&(i=!1),this.isSource&&this.isFull()&&!(b!=null&&this.dragAllowedWhenFull)&&(i=!1),b!=null&&!b.isDetachable(this)&&(this.isFull()?i=!1:b=null);let e=t.checkCondition(b==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:b});if(e===!1?i=!1:typeof e=="object"?c.extend(e,m||{}):e=m||{},i===!1)return t.stopDrag&&t.stopDrag(this.canvas),h.stopDrag(),!1;for(let V=0;V<this.connections.length;V++)this.connections[V].setHover(!1);this.addClass("endpointDrag"),t.setConnectionBeingDragged(!0),b&&!this.isFull()&&this.isSource&&(b=null),t.updateOffset({elId:this.elementId});let d=this._jsPlumb.instance.getOffset(this.canvas),E=this.canvas,w=this._jsPlumb.instance.getSize(this.canvas);J(O,t,d,w),t.setAttributes(this.canvas,{dragId:O.id,elId:this.elementId});let B=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){let V=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);V.endpoints[1]&&(B=V.endpoints[1])}let W=this._jsPlumb.instance.makeAnchor("Center");W.isFloating=!0,this._jsPlumb.floatingEndpoint=X(this.getPaintStyle(),W,B,this.canvas,O.element,t,S,this.scope);let Y=this._jsPlumb.floatingEndpoint.anchor;if(b==null)this.setHover(!1,!1),b=g({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:O.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:u.connectorStyle,hoverPaintStyle:u.connectorHoverStyle,connector:u.connector,overlays:u.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:u.scope,data:e}),b.pending=!0,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.anchor=Y,t.fire("connectionDrag",b),t.anchorManager.newConnection(b);else{n=!0,b.setHover(!1);let V=b.endpoints[0].id===this.id?0:1;this.detachFromConnection(b,null,!0);let ot=t.getDragScope(E);t.setAttribute(this.canvas,"originalScope",ot),t.fire("connectionDrag",b),V===0?(y=[b.source,b.sourceId,E,ot],t.anchorManager.sourceChanged(b.endpoints[V].elementId,O.id,b,O.element)):(y=[b.target,b.targetId,E,ot],b.target=O.element,b.targetId=O.id,t.anchorManager.updateOtherEndpoint(b.sourceId,b.endpoints[V].elementId,b.targetId,b)),b.suspendedEndpoint=b.endpoints[V],b.suspendedElement=b.endpoints[V].getElement(),b.suspendedElementId=b.endpoints[V].elementId,b.suspendedElementType=V===0?"source":"target",b.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=b.suspendedEndpoint,b.endpoints[V]=this._jsPlumb.floatingEndpoint,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass)}t.registerFloatingConnection(O,b,this._jsPlumb.floatingEndpoint),t.currentlyDragging=!0}).bind(this),A=(function(){if(t.setConnectionBeingDragged(!1),b&&b.endpoints!=null){let F=t.getDropEvent(arguments),i=t.getFloatingAnchorIndex(b);if(b.endpoints[i===0?1:0].anchor.unlock(),b.removeClass(t.draggingClass),this._jsPlumb&&(b.deleteConnectionNow||b.endpoints[i]===this._jsPlumb.floatingEndpoint)&&n&&b.suspendedEndpoint){i===0?(b.floatingElement=b.source,b.floatingId=b.sourceId,b.floatingEndpoint=b.endpoints[0],b.floatingIndex=0,b.source=y[0],b.sourceId=y[1]):(b.floatingElement=b.target,b.floatingId=b.targetId,b.floatingEndpoint=b.endpoints[1],b.floatingIndex=1,b.target=y[0],b.targetId=y[1]);let e=this._jsPlumb.floatingEndpoint;t.setDragScope(y[2],y[3]),b.endpoints[i]=b.suspendedEndpoint,b.isReattach()||b._forceReattach||b._forceDetach||!t.deleteConnection(b,{originalEvent:F})?(b.setHover(!1),b._forceDetach=null,b._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(b),b.suspendedEndpoint.addConnection(b),i===1?t.anchorManager.updateOtherEndpoint(b.sourceId,b.floatingId,b.targetId,b):t.anchorManager.sourceChanged(b.floatingId,b.sourceId,b,b.source),t.repaint(y[1])):t.deleteObject({endpoint:e})}this.deleteAfterDragStop?t.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),t.fire("connectionDragStop",b,F),b.pending&&t.fire("connectionAborted",b,F),t.currentlyDragging=!1,b.suspendedElement=null,b.suspendedEndpoint=null,b=null}O&&O.element&&t.remove(O.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.unlock(),this._jsPlumb.floatingEndpoint=null)}).bind(this);D=c.extend(M,D),D.scope=this.scope||D.scope,D[L]=H.wrap(D[L],a,!1),D[p]=H.wrap(D[p],f,!1),D[_]=H.wrap(D[_],h.drag),D[v]=H.wrap(D[v],A),D.multipleDrop=!1,D.canDrag=(function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}).bind(this),t.initDraggable(this.canvas,D,"internal"),this.canvas._jsPlumbRelatedElement=this.element,s=!0}};let l=u.endpoint||this._jsPlumb.instance.Defaults.Endpoint||c.Defaults.Endpoint;this.setEndpoint(l,!0);let N=u.anchor?u.anchor:u.anchors?u.anchors:t.Defaults.Anchor||"Top";this.setAnchor(N,!0);let G=["default",u.type||""].join(" ");this.addType(G,u.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();let U=(function(O,b,n,y){if(c.isDropSupported(this.element)){let h=u.dropOptions||t.Defaults.DropOptions||c.Defaults.DropOptions;h=c.extend({},h),h.scope=h.scope||this.scope;let D=c.dragEvents.drop,M=c.dragEvents.over,p=c.dragEvents.out,v=this,_=t.EndpointDropHandler({getEndpoint:function(){return v},jsPlumb:t,enabled:function(){return n!=null?n.isEnabled():!0},isFull:function(){return n.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(L){v.addClass(L)},removeClass:function(L){v.removeClass(L)},isDropAllowed:function(){return v.isDropAllowed.apply(v,arguments)},reference:y,isRedrop:function(L,m){return L.suspendedEndpoint&&m.reference&&L.suspendedEndpoint.id===m.reference.id}});h[D]=H.wrap(h[D],_,!0),h[M]=H.wrap(h[M],(function(){let L=c.getDragObject(arguments),m=t.getAttribute(c.getElement(L),"dragId"),a=t.getFloatingConnectionFor(m);if(a!=null){let f=t.getFloatingAnchorIndex(a);if(this.isTarget&&f!==0||a.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===a.suspendedEndpoint.id){let F=t.checkCondition("checkDropAllowed",{sourceEndpoint:a.endpoints[f],targetEndpoint:this,connection:a});this[(F?"add":"remove")+"Class"](t.endpointDropAllowedClass),this[(F?"remove":"add")+"Class"](t.endpointDropForbiddenClass),a.endpoints[f].anchor.over(this.anchor,this)}}}).bind(this)),h[p]=H.wrap(h[p],(function(){let L=c.getDragObject(arguments),m=L==null?null:t.getAttribute(c.getElement(L),"dragId"),a=m?t.getFloatingConnectionFor(m):null;if(a!=null){let f=t.getFloatingAnchorIndex(a);(this.isTarget&&f!==0||a.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===a.suspendedEndpoint.id)&&(this.removeClass(t.endpointDropAllowedClass),this.removeClass(t.endpointDropForbiddenClass),a.endpoints[f].anchor.out())}}).bind(this)),t.initDroppable(O,h,"internal",b)}}).bind(this);return this.anchor.isFloating||U(this.canvas,!(u._transient||this.anchor.isFloating),this,u.reference),this},H.extend(c.Endpoint,c.OverlayCapableJsPlumbUIComponent,{setVisible:function(u,t,g){if(this._jsPlumb.visible=u,this.canvas&&(this.canvas.style.display=u?"block":"none"),this[u?"showOverlays":"hideOverlays"](),!t){for(let S=0;S<this.connections.length;S++)if(this.connections[S].setVisible(u),!g){let j=this===this.connections[S].endpoints[0]?1:0;this.connections[S].endpoints[j].connections.length===1&&this.connections[S].endpoints[j].setVisible(u,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(u,t){this.setPaintStyle(u.endpointStyle||u.paintStyle,t),this.setHoverPaintStyle(u.endpointHoverStyle||u.hoverPaintStyle,t),u.maxConnections!=null&&(this._jsPlumb.maxConnections=u.maxConnections),u.scope&&(this.scope=u.scope),c.extend(this,u,r),u.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,u.cssClass),c.OverlayCapableJsPlumbUIComponent.applyType(this,u)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(u){this._jsPlumb.enabled=u},cleanup:function(){let u=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");c.removeClass(this.element,u),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(u){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(u)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(u){let t=!1;if(u){for(let g=0;g<this.connections.length;g++)if(this.connections[g].endpoints[1]===u||this.connections[g].endpoints[0]===u){t=!0;break}}return t},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(u){this._jsPlumb.connectionCost=u},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(u){this._jsPlumb.connectionsDirected=u},setElementId:function(u){this.elementId=u,this.anchor.elementId=u},setReferenceElement:function(u){this.element=c.getElement(u)},setDragAllowedWhenFull:function(u){this.dragAllowedWhenFull=u},equals:function(u){return this.anchor.equals(u.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(u){return this.anchor.compute(u)}}),q.jsPlumbInstance.prototype.EndpointDropHandler=function(u){return function(t){let g=u.jsPlumb;u.removeClass(g.endpointDropAllowedClass),u.removeClass(g.endpointDropForbiddenClass);let S=g.getDropEvent(arguments),j=g.getDragObject(arguments),P=g.getAttribute(j,"dragId");g.getAttribute(j,"elId");let I=g.getAttribute(j,"originalScope"),s=g.getFloatingConnectionFor(P);if(s==null)return;let l=s.suspendedEndpoint!=null;if(l&&s.suspendedEndpoint._jsPlumb==null)return;let N=u.getEndpoint(s);if(N==null)return;if(u.isRedrop(s,u)){s._forceReattach=!0,s.setHover(!1),u.maybeCleanup&&u.maybeCleanup(N);return}let G=g.getFloatingAnchorIndex(s);if(G===0&&!u.isSource||G===1&&!u.isTarget){u.maybeCleanup&&u.maybeCleanup(N);return}u.onDrop&&u.onDrop(s),I&&g.setDragScope(j,I);let U=u.isFull(t);if(U&&N.fire("maxConnections",{endpoint:this,connection:s,maxConnections:N._jsPlumb.maxConnections},S),!U&&u.enabled()){let O=!0;G===0?(s.floatingElement=s.source,s.floatingId=s.sourceId,s.floatingEndpoint=s.endpoints[0],s.floatingIndex=0,s.source=u.element,s.sourceId=u.elementId):(s.floatingElement=s.target,s.floatingId=s.targetId,s.floatingEndpoint=s.endpoints[1],s.floatingIndex=1,s.target=u.element,s.targetId=u.elementId),l&&s.suspendedEndpoint.id!==N.id&&(!s.isDetachAllowed(s)||!s.endpoints[G].isDetachAllowed(s)||!s.suspendedEndpoint.isDetachAllowed(s)||!g.checkCondition("beforeDetach",s))&&(O=!1);let b=(function(y){s.endpoints[G].detachFromConnection(s),s.suspendedEndpoint&&s.suspendedEndpoint.detachFromConnection(s),s.endpoints[G]=N,N.addConnection(s);let h=N.getParameters();for(let D in h)s.setParameter(D,h[D]);if(!l)h.draggable&&g.initDraggable(this.element,u.dragOptions,"internal",g);else{let D=s.suspendedEndpoint.elementId;g.fireMoveEvent({index:G,originalSourceId:G===0?D:s.sourceId,newSourceId:G===0?N.elementId:s.sourceId,originalTargetId:G===1?D:s.targetId,newTargetId:G===1?N.elementId:s.targetId,originalSourceEndpoint:G===0?s.suspendedEndpoint:s.endpoints[0],newSourceEndpoint:G===0?N:s.endpoints[0],originalTargetEndpoint:G===1?s.suspendedEndpoint:s.endpoints[1],newTargetEndpoint:G===1?N:s.endpoints[1],connection:s},S)}G===1?g.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):g.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),s.endpoints[0].finalEndpoint&&(s.endpoints[0].detachFromConnection(s),s.endpoints[0]=s.endpoints[0].finalEndpoint,s.endpoints[0].addConnection(s)),H.isObject(y)&&s.mergeData(y),g.finaliseConnection(s,null,S,!1),s.setHover(!1),g.revalidate(s.endpoints[0].element)}).bind(this),n=function(){s.suspendedEndpoint&&(s.endpoints[G]=s.suspendedEndpoint,s.setHover(!1),s._forceDetach=!0,G===0?(s.source=s.suspendedEndpoint.element,s.sourceId=s.suspendedEndpoint.elementId):(s.target=s.suspendedEndpoint.element,s.targetId=s.suspendedEndpoint.elementId),s.suspendedEndpoint.addConnection(s),G===1?g.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):g.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),g.repaint(s.sourceId),s._forceDetach=!1)};if(O=O&&u.isDropAllowed(s.sourceId,s.targetId,s.scope,s,N),O)return b(O),!0;n()}u.maybeCleanup&&u.maybeCleanup(N),g.currentlyDragging=!1}}}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q=function(r,x,u,t,g){if(c.Connectors[x]=c.Connectors[x]||{},c.Connectors[x][u]==null){if(c.Connectors[u]==null){if(r.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+u+"'")}c.Connectors[x][u]=function(){c.Connectors[u].apply(this,arguments),c.ConnectorRenderers[x].apply(this,arguments)},H.extend(c.Connectors[x][u],[c.Connectors[u],c.ConnectorRenderers[x]])}return new c.Connectors[x][u](t,g)},J=function(r,x,u){return r?u.makeAnchor(r,x,u):null},X=function(r,x,u,t){x!=null&&(x._jsPlumbConnections=x._jsPlumbConnections||{},t?delete x._jsPlumbConnections[r.id]:x._jsPlumbConnections[r.id]=!0,H.isEmpty(x._jsPlumbConnections)?u.removeClass(x,u.connectedClass):u.addClass(x,u.connectedClass))};c.Connection=function(r){let x=r.newEndpoint;this.id=r.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=r.previousConnection,this.source=c.getElement(r.source),this.target=c.getElement(r.target),c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),r.sourceEndpoint?(this.source=r.sourceEndpoint.getElement(),this.sourceId=r.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),r.targetEndpoint?(this.target=r.targetEndpoint.getElement(),this.targetId=r.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=r.scope,this.endpoints=[],this.endpointStyles=[];let u=this._jsPlumb.instance;u.manage(this.sourceId,this.source),u.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:r.cssClass,container:r.container,"pointer-events":r["pointer-events"],editorParams:r.editorParams,overlays:r.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",(function(){this.setHover(!0)}).bind(this)),this.bind("mouseout",(function(){this.setHover(!1)}).bind(this)),this.makeEndpoint=function(N,G,U,O,b){return U=U||this._jsPlumb.instance.getId(G),this.prepareEndpoint(u,x,this,O,N?0:1,r,G,U,b)},r.type&&(r.endpoints=r.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(r.type).endpoints);let t=this.makeEndpoint(!0,this.source,this.sourceId,r.sourceEndpoint),g=this.makeEndpoint(!1,this.target,this.targetId,r.targetEndpoint);t&&H.addToList(r.endpointsByElement,this.sourceId,t),g&&H.addToList(r.endpointsByElement,this.targetId,g),this.scope||(this.scope=this.endpoints[0].scope),r.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(r.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(r.deleteEndpointsOnEmpty));let S=u.Defaults.ConnectionsDetachable;r.detachable===!1&&(S=!1),this.endpoints[0].connectionsDetachable===!1&&(S=!1),this.endpoints[1].connectionsDetachable===!1&&(S=!1);let j=r.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||u.Defaults.ReattachConnections;this.appendToDefaultType({detachable:S,reattach:j,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||r.paintStyle||u.Defaults.PaintStyle||c.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||r.hoverPaintStyle||u.Defaults.HoverPaintStyle||c.Defaults.HoverPaintStyle});let P=u.getSuspendedAt();if(!u.isSuspendDrawing()){let N=u.getCachedData(this.sourceId),G=N.o,U=N.s,O=u.getCachedData(this.targetId),b=O.o,n=O.s,y=P||u.timestamp(),h=this.endpoints[0].anchor.compute({xy:[G.left,G.top],wh:U,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[b.left,b.top],twh:n,tElement:this.endpoints[1],timestamp:y});this.endpoints[0].paint({anchorLoc:h,timestamp:y}),h=this.endpoints[1].anchor.compute({xy:[b.left,b.top],wh:n,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[G.left,G.top],twh:U,tElement:this.endpoints[0],timestamp:y}),this.endpoints[1].paint({anchorLoc:h,timestamp:y})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(N){return this._jsPlumb.detachable===!1?!1:N!=null?N.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(N){this._jsPlumb.detachable=N===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(N){this._jsPlumb.reattach=N===!0},this._jsPlumb.cost=r.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=r.directed,r.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());let I=c.extend({},this.endpoints[1].getParameters());c.extend(I,this.endpoints[0].getParameters()),c.extend(I,this.getParameters()),this.setParameters(I),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||r.connector||u.Defaults.Connector||c.Defaults.Connector,!0);let s=r.data==null||!H.isObject(r.data)?{}:r.data;this.getData=function(){return s},this.setData=function(N){s=N||{}},this.mergeData=function(N){s=c.extend(s,N)};let l=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,r.type].join(" ");/[^\s]/.test(l)&&this.addType(l,r.data,!0),this.updateConnectedClass()},H.extend(c.Connection,c.OverlayCapableJsPlumbUIComponent,{applyType:function(r,x,u){let t=null;r.connector!=null&&(t=this.getCachedTypeItem("connector",u.connector),t==null&&(t=this.prepareConnector(r.connector,u.connector),this.cacheTypeItem("connector",t,u.connector)),this.setPreparedConnector(t)),r.detachable!=null&&this.setDetachable(r.detachable),r.reattach!=null&&this.setReattach(r.reattach),r.scope&&(this.scope=r.scope),r.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,r.cssClass);let g=null;r.anchor?(g=this.getCachedTypeItem("anchors",u.anchor),g==null&&(g=[this._jsPlumb.instance.makeAnchor(r.anchor),this._jsPlumb.instance.makeAnchor(r.anchor)],this.cacheTypeItem("anchors",g,u.anchor))):r.anchors&&(g=this.getCachedTypeItem("anchors",u.anchors),g==null&&(g=[this._jsPlumb.instance.makeAnchor(r.anchors[0]),this._jsPlumb.instance.makeAnchor(r.anchors[1])],this.cacheTypeItem("anchors",g,u.anchors))),g!=null&&(this.endpoints[0].anchor=g[0],this.endpoints[1].anchor=g[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),c.OverlayCapableJsPlumbUIComponent.applyType(this,r)},addClass:function(r,x){x&&(this.endpoints[0].addClass(r),this.endpoints[1].addClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(r)),this.connector&&this.connector.addClass(r)},removeClass:function(r,x){x&&(this.endpoints[0].removeClass(r),this.endpoints[1].removeClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(r)),this.connector&&this.connector.removeClass(r)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(r){this._jsPlumb.visible=r,this.connector&&this.connector.setVisible(r),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(r){this._jsPlumb&&(X(this,this.source,this._jsPlumb.instance,r),X(this,this.target,this._jsPlumb.instance,r))},setHover:function(r){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(r),q.jsPlumb[r?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),q.jsPlumb[r?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(r){this._jsPlumb.cost=r},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(r,x){let u={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},t=this._jsPlumb.instance.getRenderMode(),g;return H.isString(r)?g=Q(this._jsPlumb.instance,t,r,u,this):H.isArray(r)&&(r.length===1?g=Q(this._jsPlumb.instance,t,r[0],u,this):g=Q(this._jsPlumb.instance,t,r[0],H.merge(r[1],u),this)),x!=null&&(g.typeId=x),g},setPreparedConnector:function(r,x,u,t){if(this.connector!==r){let g,S="";if(this.connector!=null&&(g=this.connector,S=g.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=r,t&&this.cacheTypeItem("connector",r,t),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(S),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),g!=null){let j=this.getOverlays();for(let P=0;P<j.length;P++)j[P].transfer&&j[P].transfer(this.connector)}u||this.setListenerComponent(this.connector),x||this.repaint()}},setConnector:function(r,x,u,t){let g=this.prepareConnector(r,t);this.setPreparedConnector(g,x,u,t)},paint:function(r){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){r=r||{};let x=r.timestamp,u=this.targetId,t=this.sourceId,g=1,S=0;if(x==null||x!==this._jsPlumb.lastPaintedAt){let j=this._jsPlumb.instance.updateOffset({elId:t}).o,P=this._jsPlumb.instance.updateOffset({elId:u}).o,I=this.endpoints[S],s=this.endpoints[g],l=I.anchor.getCurrentLocation({xy:[j.left,j.top],wh:[j.width,j.height],element:I,timestamp:x}),N=s.anchor.getCurrentLocation({xy:[P.left,P.top],wh:[P.width,P.height],element:s,timestamp:x});this.connector.resetBounds(),this.connector.compute({sourcePos:l,targetPos:N,sourceOrientation:I.anchor.getOrientation(I),targetOrientation:s.anchor.getOrientation(s),sourceEndpoint:this.endpoints[S],targetEndpoint:this.endpoints[g],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:j,targetInfo:P});let G={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(let n in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(n)){let y=this._jsPlumb.overlays[n];y.isVisible()&&(this._jsPlumb.overlayPlacements[n]=y.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(y)),G.minX=Math.min(G.minX,this._jsPlumb.overlayPlacements[n].minX),G.maxX=Math.max(G.maxX,this._jsPlumb.overlayPlacements[n].maxX),G.minY=Math.min(G.minY,this._jsPlumb.overlayPlacements[n].minY),G.maxY=Math.max(G.maxY,this._jsPlumb.overlayPlacements[n].maxY))}let U=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,O=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),b={xmin:Math.min(this.connector.bounds.minX-(U+O),G.minX),ymin:Math.min(this.connector.bounds.minY-(U+O),G.minY),xmax:Math.max(this.connector.bounds.maxX+(U+O),G.maxX),ymax:Math.max(this.connector.bounds.maxY+(U+O),G.maxY)};this.connector.paintExtents=b,this.connector.paint(this._jsPlumb.paintStyleInUse,null,b);for(let n in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(n)){let y=this._jsPlumb.overlays[n];y.isVisible()&&y.paint(this._jsPlumb.overlayPlacements[n],b)}}this._jsPlumb.lastPaintedAt=x}},repaint:function(r){let x=jsPlumb.extend(r||{},{});x.elId=this.sourceId,this.paint(x)},prepareEndpoint:function(r,x,u,t,g,S,j,P,I){let s;if(t)u.endpoints[g]=t,t.addConnection(u);else{S.endpoints||(S.endpoints=[null,null]);let l=I||S.endpoints[g]||S.endpoint||r.Defaults.Endpoints[g]||c.Defaults.Endpoints[g]||r.Defaults.Endpoint||c.Defaults.Endpoint;S.endpointStyles||(S.endpointStyles=[null,null]),S.endpointHoverStyles||(S.endpointHoverStyles=[null,null]);let N=S.endpointStyles[g]||S.endpointStyle||r.Defaults.EndpointStyles[g]||c.Defaults.EndpointStyles[g]||r.Defaults.EndpointStyle||c.Defaults.EndpointStyle;N.fill==null&&S.paintStyle!=null&&(N.fill=S.paintStyle.stroke),N.outlineStroke==null&&S.paintStyle!=null&&(N.outlineStroke=S.paintStyle.outlineStroke),N.outlineWidth==null&&S.paintStyle!=null&&(N.outlineWidth=S.paintStyle.outlineWidth);let G=S.endpointHoverStyles[g]||S.endpointHoverStyle||r.Defaults.EndpointHoverStyles[g]||c.Defaults.EndpointHoverStyles[g]||r.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle;S.hoverPaintStyle!=null&&(G==null&&(G={}),G.fill==null&&(G.fill=S.hoverPaintStyle.stroke));let U=S.anchors?S.anchors[g]:S.anchor?S.anchor:J(r.Defaults.Anchors[g],P,r)||J(c.Defaults.Anchors[g],P,r)||J(r.Defaults.Anchor,P,r)||J(c.Defaults.Anchor,P,r),O=S.uuids?S.uuids[g]:null;s=x({paintStyle:N,hoverPaintStyle:G,endpoint:l,connections:[u],uuid:O,anchor:U,source:j,scope:S.scope,reattach:S.reattach||r.Defaults.ReattachConnections,detachable:S.detachable||r.Defaults.ConnectionsDetachable}),t==null&&s.setDeleteOnEmpty(!0),u.endpoints[g]=s,S.drawEndpoints===!1&&s.setVisible(!1,!0,!0)}return s},replaceEndpoint:function(r,x){let u=this.endpoints[r],t=u.elementId,g=this._jsPlumb.instance.getEndpoints(t),S=g.indexOf(u),j=this.makeEndpoint(r===0,u.element,t,null,x);this.endpoints[r]=j,g.splice(S,1,j),this._jsPlumb.instance.deleteObject({endpoint:u,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:u,current:j}),this._jsPlumb.instance.anchorManager.updateOtherEndpoint(this.endpoints[0].elementId,this.endpoints[1].elementId,this.endpoints[1].elementId,this)}})}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumbUtil,H=q.jsPlumb;H.AnchorManager=function(r){let x={},u={},t={},g={},S=this,j={},P=r.jsPlumbInstance,I={},s=function(h,D,M,p,v,_,L){let m=[],a=D[v?0:1]/(p.length+1);for(let f=0;f<p.length;f++){let A=(f+1)*a,F=_*D[v?1:0];L&&(A=D[v?0:1]-A);let i=v?A:F,e=M[0]+i,d=i/D[0],E=v?F:A,w=M[1]+E,B=E/D[1];m.push([e,w,d,B,p[f][1],p[f][2]])}return m},l=function(h){return function(D,M){let p=!0;return p=D[0][0]<M[0][0],p===!1?-1:1}},N=function(h,D){let M=h[0][0]<0?-Math.PI-h[0][0]:Math.PI-h[0][0],p=D[0][0]<0?-Math.PI-D[0][0]:Math.PI-D[0][0];return M>p?1:-1},G={top:function(h,D){return h[0]>D[0]?1:-1},right:l(),bottom:l(),left:N},U=function(h,D){return h.sort(D)},O=function(h,D){let M=P.getCachedData(h),p=M.s,v=M.o,_=function(L,m,a,f,A,F,i){if(f.length>0){let e=U(f,G[L]),d=L==="right"||L==="top",E=s(L,m,a,e,A,F,d),w=function(B,W){u[B.id]=[W[0],W[1],W[2],W[3]],t[B.id]=i};for(let B=0;B<E.length;B++){let W=E[B][4],Y=W.endpoints[0].elementId===h,V=W.endpoints[1].elementId===h;Y&&w(W.endpoints[0],E[B]),V&&w(W.endpoints[1],E[B])}}};_("bottom",p,[v.left,v.top],D.bottom,!0,1,[0,1]),_("top",p,[v.left,v.top],D.top,!0,0,[0,-1]),_("left",p,[v.left,v.top],D.left,!1,0,[-1,0]),_("right",p,[v.left,v.top],D.right,!1,1,[1,0])};this.reset=function(){x={},g={},j={}},this.addFloatingConnection=function(h,D){I[h]=D},this.removeFloatingConnection=function(h){delete I[h]},this.newConnection=function(h){let D=h.sourceId,M=h.targetId,p=h.endpoints,v=!0,_=function(L,m,a,f,A){D===M&&a.isContinuous&&(h._jsPlumb.instance.removeElement(p[1].canvas),v=!1),c.addToList(g,f,[A,m,a.constructor===H.DynamicAnchor])};_(0,p[0],p[0].anchor,M,h),v&&_(1,p[1],p[1].anchor,D,h)};let b=function(h){(function(D,M){if(D){let p=function(v){return v[4]===M};c.removeWithFunction(D.top,p),c.removeWithFunction(D.left,p),c.removeWithFunction(D.bottom,p),c.removeWithFunction(D.right,p)}})(j[h.elementId],h.id)};this.connectionDetached=function(h,D){let M=h.connection||h,p=h.sourceId,v=h.targetId,_=M.endpoints,L=function(m,a,f,A,F){c.removeWithFunction(g[A],function(i){return i[0].id===F.id})};L(1,_[1],_[1].anchor,p,M),L(0,_[0],_[0].anchor,v,M),M.floatingId&&(L(M.floatingIndex,M.floatingEndpoint,M.floatingEndpoint.anchor,M.floatingId,M),b(M.floatingEndpoint)),b(M.endpoints[0]),b(M.endpoints[1]),D||(S.redraw(M.sourceId),M.targetId!==M.sourceId&&S.redraw(M.targetId))},this.add=function(h,D){c.addToList(x,D,h)},this.changeId=function(h,D){g[D]=g[h],x[D]=x[h],delete g[h],delete x[h]},this.getConnectionsFor=function(h){return g[h]||[]},this.getEndpointsFor=function(h){return x[h]||[]},this.deleteEndpoint=function(h){c.removeWithFunction(x[h.elementId],function(D){return D.id===h.id}),b(h)},this.clearFor=function(h){delete x[h],x[h]=[]};let n=function(h,D,M,p,v,_,L,m,a,f,A,F){let i=-1,e=p.endpoints[L],d=e.id,E=[1,0][L],w=[[D,M],p,v,_,d],B=h[a],W=e._continuousAnchorEdge?h[e._continuousAnchorEdge]:null,Y,V;if(W){let ot=c.findWithFunction(W,function(ct){return ct[4]===d});if(ot!==-1)for(W.splice(ot,1),Y=0;Y<W.length;Y++)V=W[Y][1],c.addWithFunction(A,V,function(ct){return ct.id===V.id}),c.addWithFunction(F,W[Y][1].endpoints[L],function(ct){return ct.id===V.endpoints[L].id}),c.addWithFunction(F,W[Y][1].endpoints[E],function(ct){return ct.id===V.endpoints[E].id})}for(Y=0;Y<B.length;Y++)V=B[Y][1],r.idx===1&&B[Y][3]===_&&i===-1&&(i=Y),c.addWithFunction(A,V,function(ot){return ot.id===V.id}),c.addWithFunction(F,B[Y][1].endpoints[L],function(ot){return ot.id===V.endpoints[L].id}),c.addWithFunction(F,B[Y][1].endpoints[E],function(ot){return ot.id===V.endpoints[E].id});{let ot=m?i!==-1?i:0:B.length;B.splice(ot,0,w)}e._continuousAnchorEdge=a};this.updateOtherEndpoint=function(h,D,M,p){let v=c.findWithFunction(g[h],function(L){return L[0].id===p.id}),_=c.findWithFunction(g[D],function(L){return L[0].id===p.id});v!==-1&&(g[h][v][0]=p,g[h][v][1]=p.endpoints[1],g[h][v][2]=p.endpoints[1].anchor.constructor===H.DynamicAnchor),_>-1&&(g[D].splice(_,1),c.addToList(g,M,[p,p.endpoints[0],p.endpoints[0].anchor.constructor===H.DynamicAnchor])),p.updateConnectedClass()},this.sourceChanged=function(h,D,M,p){if(h!==D){M.sourceId=D,M.source=p,c.removeWithFunction(g[h],function(_){return _[0].id===M.id});let v=c.findWithFunction(g[M.targetId],function(_){return _[0].id===M.id});v>-1&&(g[M.targetId][v][0]=M,g[M.targetId][v][1]=M.endpoints[0],g[M.targetId][v][2]=M.endpoints[0].anchor.constructor===H.DynamicAnchor),c.addToList(g,D,[M,M.endpoints[1],M.endpoints[1].anchor.constructor===H.DynamicAnchor]),M.endpoints[1].anchor.isContinuous&&(M.source===M.target?M._jsPlumb.instance.removeElement(M.endpoints[1].canvas):M.endpoints[1].canvas.parentNode==null&&M._jsPlumb.instance.appendElement(M.endpoints[1].canvas)),M.updateConnectedClass()}},this.rehomeEndpoint=function(h,D,M){let p=x[D]||[],v=P.getId(M);if(v!==D){let _=p.indexOf(h);if(_>-1){let L=p.splice(_,1)[0];S.add(L,v)}}for(let _=0;_<h.connections.length;_++)h.connections[_].sourceId===D?S.sourceChanged(D,h.elementId,h.connections[_],h.element):h.connections[_].targetId===D&&(h.connections[_].targetId=h.elementId,h.connections[_].target=h.element,S.updateOtherEndpoint(h.connections[_].sourceId,D,h.elementId,h.connections[_]))},this.redraw=function(h,D,M,p,v,_){if(!P.isSuspendDrawing()){let B=x[h]||[],W=g[h]||[],Y=[],V=[],ot=[];M=M||P.timestamp(),p=p||{left:0,top:0},D&&(D={left:D.left+p.left,top:D.top+p.top});let ct=P.updateOffset({elId:h,offset:D,recalc:!1,timestamp:M}),pt={};for(var L=0;L<W.length;L++){var m=W[L][0],a=m.sourceId,f=m.targetId,A=m.endpoints[0].anchor.isContinuous,F=m.endpoints[1].anchor.isContinuous;if(A||F){var i=a+"_"+f,e=pt[i],d=m.sourceId===h?1:0;A&&!j[a]&&(j[a]={top:[],right:[],bottom:[],left:[]}),F&&!j[f]&&(j[f]={top:[],right:[],bottom:[],left:[]}),h!==f&&P.updateOffset({elId:f,timestamp:M}),h!==a&&P.updateOffset({elId:a,timestamp:M});let rt=P.getCachedData(f),ft=P.getCachedData(a);f===a&&(A||F)?(n(j[a],-Math.PI/2,0,m,!1,f,0,!1,"top",a,Y,V),n(j[f],-Math.PI/2,0,m,!1,a,1,!1,"top",f,Y,V)):(e||(e=this.calculateOrientation(a,f,ft.o,rt.o,m.endpoints[0].anchor,m.endpoints[1].anchor,m),pt[i]=e),A&&n(j[a],e.theta,0,m,!1,f,0,!1,e.a[0],a,Y,V),F&&n(j[f],e.theta2,-1,m,!0,a,1,!0,e.a[1],f,Y,V)),A&&c.addWithFunction(ot,a,function(at){return at===a}),F&&c.addWithFunction(ot,f,function(at){return at===f}),c.addWithFunction(Y,m,function(at){return at.id===m.id}),(A&&d===0||F&&d===1)&&c.addWithFunction(V,m.endpoints[d],function(at){return at.id===m.endpoints[d].id})}}for(L=0;L<B.length;L++)B[L].connections.length===0&&B[L].anchor.isContinuous&&(j[h]||(j[h]={top:[],right:[],bottom:[],left:[]}),n(j[h],-Math.PI/2,0,{endpoints:[B[L],B[L]],paint:function(){}},!1,h,0,!1,B[L].anchor.getDefaultFace(),h,Y,V),c.addWithFunction(ot,h,function(rt){return rt===h}));for(L=0;L<ot.length;L++)O(ot[L],j[ot[L]]);for(L=0;L<B.length;L++)B[L].paint({timestamp:M,offset:ct,dimensions:ct.s,recalc:_!==!0});for(L=0;L<V.length;L++){let rt=P.getCachedData(V[L].elementId);V[L].paint({timestamp:null,offset:rt,dimensions:rt.s})}for(L=0;L<W.length;L++){var E=W[L][1];if(E.anchor.constructor===H.DynamicAnchor){E.paint({elementWithPrecedence:h,timestamp:M}),c.addWithFunction(Y,W[L][0],function(rt){return rt.id===W[L][0].id});for(var w=0;w<E.connections.length;w++)E.connections[w]!==W[L][0]&&c.addWithFunction(Y,E.connections[w],function(rt){return rt.id===E.connections[w].id})}else c.addWithFunction(Y,W[L][0],function(rt){return rt.id===W[L][0].id})}let $=I[h];for($&&$.paint({timestamp:M,recalc:!1,elId:h}),L=0;L<Y.length;L++)Y[L].paint({elId:h,timestamp:null,recalc:!1,clearEdits:v})}};let y=function(h){c.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;let D=h.faces||["top","right","bottom","left"],M=h.clockwise!==!1,p={},v={top:"bottom",right:"left",left:"right",bottom:"top"},_={top:"right",right:"bottom",left:"top",bottom:"left"},L={top:"left",right:"top",left:"bottom",bottom:"right"},m=M?_:L,a=M?L:_,f=h.cssClass||"",A=null,F=null,i=["left","right"],e=["top","bottom"],d=null;for(let E=0;E<D.length;E++)p[D[E]]=!0;this.getDefaultFace=function(){return D.length===0?"top":D[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(E){return p[E]?E:p[v[E]]?v[E]:p[m[E]]?m[E]:p[a[E]]?a[E]:E},this.isEdgeSupported=function(E){return d==null?F==null?p[E]===!0:F===E:d.indexOf(E)!==-1},this.setCurrentFace=function(E,w){A=E,w&&F!=null&&(F=A)},this.getCurrentFace=function(){return A},this.getSupportedFaces=function(){let E=[];for(let w in p)p[w]&&E.push(w);return E},this.lock=function(){F=A},this.unlock=function(){F=null},this.isLocked=function(){return F!=null},this.lockCurrentAxis=function(){A!=null&&(d=A==="left"||A==="right"?i:e)},this.unlockCurrentAxis=function(){d=null},this.compute=function(E){return u[E.element.id]||[0,0]},this.getCurrentLocation=function(E){return u[E.element.id]||[0,0]},this.getOrientation=function(E){return t[E.id]||[0,0]},this.getCssClass=function(){return f}};P.continuousAnchorFactory={get:function(h){return new y(h)},clear:function(h){delete u[h]}}},H.AnchorManager.prototype.calculateOrientation=function(r,x,u,t,g,S){let j={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},P=["left","top","right","bottom"];if(r===x)return{orientation:j.IDENTITY,a:["top","top"]};let I=Math.atan2(t.centery-u.centery,t.centerx-u.centerx),s=Math.atan2(u.centery-t.centery,u.centerx-t.centerx),l=[],N={};(function(O,b){for(let n=0;n<O.length;n++)N[O[n]]={left:[b[n].left,b[n].centery],right:[b[n].right,b[n].centery],top:[b[n].centerx,b[n].top],bottom:[b[n].centerx,b[n].bottom]}})(["source","target"],[u,t]);for(let O=0;O<P.length;O++)for(let b=0;b<P.length;b++)l.push({source:P[O],target:P[b],dist:Biltong.lineLength(N.source[P[O]],N.target[P[b]])});l.sort(function(O,b){return O.dist<b.dist?-1:O.dist>b.dist?1:0});let G=l[0].source,U=l[0].target;for(let O=0;O<l.length&&(!g.isContinuous||g.isEdgeSupported(l[O].source)?G=l[O].source:G=null,!S.isContinuous||S.isEdgeSupported(l[O].target)?U=l[O].target:U=null,!(G!=null&&U!=null));O++);return g.isContinuous&&g.setCurrentFace(G),S.isContinuous&&S.setCurrentFace(U),{a:[G,U],theta:I,theta2:s}},H.Anchor=function(r){this.x=r.x||0,this.y=r.y||0,this.elementId=r.elementId,this.cssClass=r.cssClass||"",this.userDefinedLocation=null,this.orientation=r.orientation||[0,0],this.lastReturnValue=null,this.offsets=r.offsets||[0,0],this.timestamp=null;let x=r.relocatable!==!1;this.isRelocatable=function(){return x},this.setRelocatable=function(g){x=g};let u=r.snapOnRelocate!==!1;this.isSnapOnRelocate=function(){return u};let t=!1;this.lock=function(){t=!0},this.unlock=function(){t=!1},this.isLocked=function(){return t},c.EventGenerator.apply(this),this.compute=function(g){let S=g.xy,j=g.wh,P=g.timestamp;return g.clearUserDefinedLocation&&(this.userDefinedLocation=null),P&&P===this.timestamp?this.lastReturnValue:(this.userDefinedLocation!=null?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[S[0]+this.x*j[0]+this.offsets[0],S[1]+this.y*j[1]+this.offsets[1],this.x,this.y],this.timestamp=P,this.lastReturnValue)},this.getCurrentLocation=function(g){return g=g||{},this.lastReturnValue==null||g.timestamp!=null&&this.timestamp!==g.timestamp?this.compute(g):this.lastReturnValue},this.setPosition=function(g,S,j,P,I){(!t||I)&&(this.x=g,this.y=S,this.orientation=[j,P],this.lastReturnValue=null)}},c.extend(H.Anchor,c.EventGenerator,{equals:function(r){if(!r)return!1;let x=r.getOrientation(),u=this.getOrientation();return this.x===r.x&&this.y===r.y&&this.offsets[0]===r.offsets[0]&&this.offsets[1]===r.offsets[1]&&u[0]===x[0]&&u[1]===x[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(r){this.userDefinedLocation=r},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),H.FloatingAnchor=function(r){H.Anchor.apply(this,arguments);let x=r.reference,u=r.referenceCanvas,t=H.getSize(u),g=0,S=0,j=null,P=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(I){let s=I.xy,l=[s[0]+t[0]/2,s[1]+t[1]/2];return P=l,l},this.getOrientation=function(I){if(j)return j;{let s=x.getOrientation(I);return[Math.abs(s[0])*g*-1,Math.abs(s[1])*S*-1]}},this.over=function(I,s){j=I.getOrientation(s)},this.out=function(){j=null},this.getCurrentLocation=function(I){return P??this.compute(I)}},c.extend(H.FloatingAnchor,H.Anchor);let Q=function(r,x,u){return r.constructor===H.Anchor?r:x.makeAnchor(r,u,x)};H.DynamicAnchor=function(r){H.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=r.elementId,this.jsPlumbInstance=r.jsPlumbInstance;for(let j=0;j<r.anchors.length;j++)this.anchors[j]=Q(r.anchors[j],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};let x=this.anchors.length>0?this.anchors[0]:null,u=x,t=this,g=function(j,P,I,s,l){let N=s[0]+j.x*l[0],G=s[1]+j.y*l[1],U=s[0]+l[0]/2,O=s[1]+l[1]/2;return Math.sqrt(Math.pow(P-N,2)+Math.pow(I-G,2))+Math.sqrt(Math.pow(U-N,2)+Math.pow(O-G,2))},S=r.selector||function(j,P,I,s,l){let N=I[0]+s[0]/2,G=I[1]+s[1]/2,U=-1,O=1/0;for(let b=0;b<l.length;b++){let n=g(l[b],N,G,j,P);n<O&&(U=b+0,O=n)}return l[U]};this.compute=function(j){let P=j.xy,I=j.wh,s=j.txy,l=j.twh;this.timestamp=j.timestamp;let N=t.getUserDefinedLocation();return N??(this.isLocked()||s==null||l==null||(j.timestamp=null,x=S(P,I,s,l,this.anchors),this.x=x.x,this.y=x.y,x!==u&&this.fire("anchorChanged",x),u=x),x.compute(j))},this.getCurrentLocation=function(j){return this.getUserDefinedLocation()||(x!=null?x.getCurrentLocation(j):null)},this.getOrientation=function(j){return x!=null?x.getOrientation(j):[0,0]},this.over=function(j,P){x!=null&&x.over(j,P)},this.out=function(){x!=null&&x.out()},this.setAnchor=function(j){x=j},this.getCssClass=function(){return x&&x.getCssClass()||""},this.setAnchorCoordinates=function(j){let P=jsPlumbUtil.findWithFunction(this.anchors,function(I){return I.x===j[0]&&I.y===j[1]});return P!==-1?(this.setAnchor(this.anchors[P]),!0):!1}},c.extend(H.DynamicAnchor,H.Anchor);let J=function(r,x,u,t,g,S){H.Anchors[g]=function(j){let P=j.jsPlumbInstance.makeAnchor([r,x,u,t,0,0],j.elementId,j.jsPlumbInstance);return P.type=g,S&&S(P,j),P}};J(.5,0,0,-1,"TopCenter"),J(.5,1,0,1,"BottomCenter"),J(0,.5,-1,0,"LeftMiddle"),J(1,.5,1,0,"RightMiddle"),J(.5,0,0,-1,"Top"),J(.5,1,0,1,"Bottom"),J(0,.5,-1,0,"Left"),J(1,.5,1,0,"Right"),J(.5,.5,0,0,"Center"),J(1,0,0,-1,"TopRight"),J(1,1,0,1,"BottomRight"),J(0,0,0,-1,"TopLeft"),J(0,1,0,1,"BottomLeft"),H.Defaults.DynamicAnchors=function(r){return r.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],r.elementId,r.jsPlumbInstance)},H.Anchors.AutoDefault=function(r){let x=r.jsPlumbInstance.makeDynamicAnchor(H.Defaults.DynamicAnchors(r));return x.type="AutoDefault",x};let X=function(r,x){H.Anchors[r]=function(u){let t=u.jsPlumbInstance.makeAnchor(["Continuous",{faces:x}],u.elementId,u.jsPlumbInstance);return t.type=r,t}};H.Anchors.Continuous=function(r){return r.jsPlumbInstance.continuousAnchorFactory.get(r)},X("ContinuousLeft",["left"]),X("ContinuousTop",["top"]),X("ContinuousBottom",["bottom"]),X("ContinuousRight",["right"]),J(0,0,0,0,"Assign",function(r,x){let u=x.position||"Fixed";r.positionFinder=u.constructor===String?x.jsPlumbInstance.AnchorPositionFinders[u]:u,r.constructorParams=x}),q.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(r,x,u){return[(r.left-x.left)/u[0],(r.top-x.top)/u[1]]},Grid:function(r,x,u,t){let g=r.left-x.left,S=r.top-x.top,j=u[0]/t.grid[0],P=u[1]/t.grid[1],I=Math.floor(g/j),s=Math.floor(S/P);return[(I*j+j/2)/u[0],(s*P+P/2)/u[1]]}},H.Anchors.Perimeter=function(r){r=r||{};let x=r.anchorCount||60,u=r.shape;if(!u)throw new Error("no shape supplied to Perimeter Anchor type");let t=function(){let N=.5,G=Math.PI*2/x,U=0,O=[];for(let b=0;b<x;b++){let n=N+N*Math.sin(U),y=N+N*Math.cos(U);O.push([n,y,0,0]),U+=G}return O},g=function(N){let G=x/N.length,U=[],O=function(b,n,y,h,D,M,p){G=x*D;let v=(y-b)/G,_=(h-n)/G;for(let L=0;L<G;L++)U.push([b+v*L,n+_*L,M??0,p??0])};for(let b=0;b<N.length;b++)O.apply(null,N[b]);return U},S=function(N){let G=[];for(let U=0;U<N.length;U++)G.push([N[U][0],N[U][1],N[U][2],N[U][3],1/N.length,N[U][4],N[U][5]]);return g(G)},j=function(){return S([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},P={Circle:t,Ellipse:t,Diamond:function(){return S([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:j,Square:j,Triangle:function(){return S([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(N){let G=N.points,U=[],O=0;for(let b=0;b<G.length-1;b++){let n=Math.sqrt(Math.pow(G[b][2]-G[b][0])+Math.pow(G[b][3]-G[b][1]));O+=n,U.push([G[b][0],G[b][1],G[b+1][0],G[b+1][1],n])}for(let b=0;b<U.length;b++)U[b][4]=U[b][4]/O;return g(U)}},I=function(N,G){let U=[],O=G/180*Math.PI;for(let b=0;b<N.length;b++){let n=N[b][0]-.5,y=N[b][1]-.5;U.push([.5+(n*Math.cos(O)-y*Math.sin(O)),.5+(n*Math.sin(O)+y*Math.cos(O)),N[b][2],N[b][3]])}return U};if(!P[u])throw new Error("Shape ["+u+"] is unknown by Perimeter Anchor type");let s=P[u](r);r.rotation&&(s=I(s,r.rotation));let l=r.jsPlumbInstance.makeDynamicAnchor(s);return l.type="Perimeter",l}}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q=q.Biltong;c.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(g,S){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}},this.lineIntersection=function(g,S,j,P){return[]},this.boxIntersection=function(g,S,j,P){let I=[];return I.push.apply(I,this.lineIntersection(g,S,g+j,S)),I.push.apply(I,this.lineIntersection(g+j,S,g+j,S+P)),I.push.apply(I,this.lineIntersection(g+j,S+P,g,S+P)),I.push.apply(I,this.lineIntersection(g,S+P,g,S)),I},this.boundingBoxIntersection=function(g){return this.boxIntersection(g.x,g.y,g.w,g.y)}},Straight:function(t){c.Segments.AbstractSegment.apply(this,arguments);let g,S,j,P,I,s,l,N=function(){g=Math.sqrt(Math.pow(I-P,2)+Math.pow(l-s,2)),S=Q.gradient({x:P,y:s},{x:I,y:l}),j=-1/S};this.type="Straight",this.getLength=function(){return g},this.getGradient=function(){return S},this.getCoordinates=function(){return{x1:P,y1:s,x2:I,y2:l}},this.setCoordinates=function(n){P=n.x1,s=n.y1,I=n.x2,l=n.y2,N()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(P,I),minY:Math.min(s,l),maxX:Math.max(P,I),maxY:Math.max(s,l)}},this.pointOnPath=function(n,y){if(n===0&&!y)return{x:P,y:s};if(n===1&&!y)return{x:I,y:l};{let h=y?n>0?n:g+n:n*g;return Q.pointOnLine({x:P,y:s},{x:I,y:l},h)}},this.gradientAtPoint=function(n){return S},this.pointAlongPathFrom=function(n,y,h){let D=this.pointOnPath(n,h),M=y<=0?{x:P,y:s}:{x:I,y:l};return y<=0&&Math.abs(y)>1&&(y*=-1),Q.pointOnLine(D,M,y)};let G=function(n,y,h){return h>=Math.min(n,y)&&h<=Math.max(n,y)},U=function(n,y,h){return Math.abs(h-n)<Math.abs(h-y)?n:y};this.findClosestPointOnPath=function(n,y){let h={d:1/0,x:null,y:null,l:null,x1:P,x2:I,y1:s,y2:l};if(S===0)h.y=s,h.x=G(P,I,n)?n:U(P,I,n);else if(S===1/0||S===-1/0)h.x=P,h.y=G(s,l,y)?y:U(s,l,y);else{let M=s-S*P,p=y-j*n,v=(p-M)/(S-j),_=S*v+M;h.x=G(P,I,v)?v:U(P,I,v),h.y=G(s,l,_)?_:U(s,l,_)}let D=Q.lineLength([h.x,h.y],[P,s]);return h.d=Q.lineLength([n,y],[h.x,h.y]),h.l=D/g,h};let O=function(n,y,h){return h>y?y<=n&&n<=h:y>=n&&n>=h},b=O;this.lineIntersection=function(n,y,h,D){let M=Math.abs(Q.gradient({x:n,y},{x:h,y:D})),p=Math.abs(S),v=p===1/0?P:s-p*P,_=[],L=M===1/0?n:y-M*n;if(M!==p)if(M===1/0&&p===0)b(n,P,I)&&b(s,y,D)&&(_=[n,s]);else if(M===0&&p===1/0)b(y,s,l)&&b(P,n,h)&&(_=[P,y]);else{let m,a;M===1/0?(m=n,b(m,P,I)&&(a=p*n+v,b(a,y,D)&&(_=[m,a]))):M===0?(a=y,b(a,s,l)&&(m=(y-v)/p,b(m,n,h)&&(_=[m,a]))):(m=(L-v)/(p-M),a=p*m+v,b(m,P,I)&&b(a,s,l)&&(_=[m,a]))}return _},this.boxIntersection=function(n,y,h,D){let M=[];return M.push.apply(M,this.lineIntersection(n,y,n+h,y)),M.push.apply(M,this.lineIntersection(n+h,y,n+h,y+D)),M.push.apply(M,this.lineIntersection(n+h,y+D,n,y+D)),M.push.apply(M,this.lineIntersection(n,y+D,n,y)),M},this.boundingBoxIntersection=function(n){return this.boxIntersection(n.x,n.y,n.w,n.h)}},Arc:function(t){c.Segments.AbstractSegment.apply(this,arguments);var g=function(U,O){return Q.theta([t.cx,t.cy],[U,O])},S=function(U,O){if(U.anticlockwise){let b=U.startAngle<U.endAngle?U.startAngle+j:U.startAngle,n=Math.abs(b-U.endAngle);return b-n*O}else{let b=U.endAngle<U.startAngle?U.endAngle+j:U.endAngle,n=Math.abs(b-U.startAngle);return U.startAngle+n*O}},j=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=g(t.x1,t.y1),this.endAngle=g(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=j),this.startAngle<0&&(this.startAngle+=j);let P=this.endAngle<this.startAngle?this.endAngle+j:this.endAngle;this.sweep=Math.abs(P-this.startAngle),this.anticlockwise&&(this.sweep=j-this.sweep);let I=2*Math.PI*this.radius,s=this.sweep/j,l=I*s;this.getLength=function(){return l},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};let N=1e-10,G=function(U){let O=Math.floor(U),b=Math.ceil(U);return U-O<N?O:b-U<N?b:U};this.pointOnPath=function(U,O){if(U===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(U===1)return{x:this.x2,y:this.y2,theta:this.endAngle};O&&(U=U/l);let b=S(this,U),n=t.cx+t.r*Math.cos(b),y=t.cy+t.r*Math.sin(b);return{x:G(n),y:G(y),theta:b}},this.gradientAtPoint=function(U,O){let b=this.pointOnPath(U,O),n=Q.normal([t.cx,t.cy],[b.x,b.y]);return!this.anticlockwise&&(n===1/0||n===-1/0)&&(n*=-1),n},this.pointAlongPathFrom=function(U,O,b){let n=this.pointOnPath(U,b),y=O/I*2*Math.PI,h=this.anticlockwise?-1:1,D=n.theta+h*y,M=t.cx+this.radius*Math.cos(D),p=t.cy+this.radius*Math.sin(D);return{x:M,y:p}}},Bezier:function(t){this.curve=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}],c.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)},this.type="Bezier";let g=function(S,j,P){return P&&(j=q.jsBezier.locationAlongCurveFrom(S,j>0?0:1,j)),j};this.pointOnPath=function(S,j){return S=g(this.curve,S,j),q.jsBezier.pointOnCurve(this.curve,S)},this.gradientAtPoint=function(S,j){return S=g(this.curve,S,j),q.jsBezier.gradientAtPoint(this.curve,S)},this.pointAlongPathFrom=function(S,j,P){return S=g(this.curve,S,P),q.jsBezier.pointAlongCurveFrom(this.curve,S,j)},this.getLength=function(){return q.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(S,j){let P=q.jsBezier.nearestPointOnCurve({x:S,y:j},this.curve);return{d:Math.sqrt(Math.pow(P.point.x-S,2)+Math.pow(P.point.y-j,2)),x:P.point.x,y:P.point.y,l:1-P.location,s:this}},this.lineIntersection=function(S,j,P,I){return q.jsBezier.lineIntersection(S,j,P,I,this.curve)}}},c.SegmentRenderer={getPath:function(t,g){return{Straight:function(S){let j=t.getCoordinates();return(S?"M "+j.x1+" "+j.y1+" ":"")+"L "+j.x2+" "+j.y2},Bezier:function(S){let j=t.params;return(S?"M "+j.x2+" "+j.y2+" ":"")+"C "+j.cp2x+" "+j.cp2y+" "+j.cp1x+" "+j.cp1y+" "+j.x1+" "+j.y1},Arc:function(S){let j=t.params,P=t.sweep>Math.PI?1:0,I=t.anticlockwise?0:1;return(S?"M"+t.x1+" "+t.y1+" ":"")+"A "+t.radius+" "+j.r+" 0 "+P+","+I+" "+t.x2+" "+t.y2}}[t.type](g)}};let J=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};c.Connectors.AbstractConnector=function(t){J.apply(this,arguments);let g=[],S=0,j=[],P=[],I=t.stub||0,s=H.isArray(I)?I[0]:I,l=H.isArray(I)?I[1]:I,N=t.gap||0,G=H.isArray(N)?N[0]:N,U=H.isArray(N)?N[1]:N,O=null,b=null;this.getPathData=function(){let p="";for(let v=0;v<g.length;v++)p+=c.SegmentRenderer.getPath(g[v],v===0),p+=" ";return p},this.findSegmentForPoint=function(p,v){let _={d:1/0,s:null,x:null,y:null,l:null};for(let L=0;L<g.length;L++){let m=g[L].findClosestPointOnPath(p,v);m.d<_.d&&(_.d=m.d,_.l=m.l,_.x=m.x,_.y=m.y,_.s=g[L],_.x1=m.x1,_.x2=m.x2,_.y1=m.y1,_.y2=m.y2,_.index=L,_.connectorLocation=j[L][0]+m.l*(j[L][1]-j[L][0]))}return _},this.lineIntersection=function(p,v,_,L){let m=[];for(let a=0;a<g.length;a++)m.push.apply(m,g[a].lineIntersection(p,v,_,L));return m},this.boxIntersection=function(p,v,_,L){let m=[];for(let a=0;a<g.length;a++)m.push.apply(m,g[a].boxIntersection(p,v,_,L));return m},this.boundingBoxIntersection=function(p){let v=[];for(let _=0;_<g.length;_++)v.push.apply(v,g[_].boundingBoxIntersection(p));return v};let n=function(){let p=0;for(let v=0;v<g.length;v++){let _=g[v].getLength();P[v]=_/S,j[v]=[p,p+=_/S]}},y=function(p,v){v&&(p=p>0?p/S:(S+p)/S);let _=j.length-1,L=1;for(let m=0;m<j.length;m++)if(j[m][1]>=p){_=m,L=p===1?1:p===0?0:(p-j[m][0])/P[m];break}return{segment:g[_],proportion:L,index:_}},h=function(p,v,_){if(_.x1===_.x2&&_.y1===_.y2)return;let L=new c.Segments[v](_);g.push(L),S+=L.getLength(),p.updateBounds(L)},D=function(){S=g.length=j.length=P.length=0};this.setSegments=function(p){O=[],S=0;for(let v=0;v<p.length;v++)O.push(p[v]),S+=p[v].getLength()},this.getLength=function(){return S};let M=function(p){this.strokeWidth=p.strokeWidth;let v=Q.quadrant(p.sourcePos,p.targetPos),_=p.targetPos[0]<p.sourcePos[0],L=p.targetPos[1]<p.sourcePos[1],m=p.strokeWidth||1,a=p.sourceEndpoint.anchor.getOrientation(p.sourceEndpoint),f=p.targetEndpoint.anchor.getOrientation(p.targetEndpoint),A=_?p.targetPos[0]:p.sourcePos[0],F=L?p.targetPos[1]:p.sourcePos[1],i=Math.abs(p.targetPos[0]-p.sourcePos[0]),e=Math.abs(p.targetPos[1]-p.sourcePos[1]);if(a[0]===0&&a[1]===0||f[0]===0&&f[1]===0){let V=i>e?0:1,ot=[1,0][V];a=[],f=[],a[V]=p.sourcePos[V]>p.targetPos[V]?-1:1,f[V]=p.sourcePos[V]>p.targetPos[V]?1:-1,a[ot]=0,f[ot]=0}let d=_?i+G*a[0]:G*a[0],E=L?e+G*a[1]:G*a[1],w=_?U*f[0]:i+U*f[0],B=L?U*f[1]:e+U*f[1],W=a[0]*f[0]+a[1]*f[1],Y={sx:d,sy:E,tx:w,ty:B,lw:m,xSpan:Math.abs(w-d),ySpan:Math.abs(B-E),mx:(d+w)/2,my:(E+B)/2,so:a,to:f,x:A,y:F,w:i,h:e,segment:v,startStubX:d+a[0]*s,startStubY:E+a[1]*s,endStubX:w+f[0]*l,endStubY:B+f[1]*l,isXGreaterThanStubTimes2:Math.abs(d-w)>s+l,isYGreaterThanStubTimes2:Math.abs(E-B)>s+l,opposite:W===-1,perpendicular:W===0,orthogonal:W===1,sourceAxis:a[0]===0?"y":"x",points:[A,F,i,e,d,E,w,B],stubs:[s,l]};return Y.anchorOrientation=Y.opposite?"opposite":Y.orthogonal?"orthogonal":"perpendicular",Y};return this.getSegments=function(){return g},this.updateBounds=function(p){let v=p.getBounds();this.bounds.minX=Math.min(this.bounds.minX,v.minX),this.bounds.maxX=Math.max(this.bounds.maxX,v.maxX),this.bounds.minY=Math.min(this.bounds.minY,v.minY),this.bounds.maxY=Math.max(this.bounds.maxY,v.maxY)},this.pointOnPath=function(p,v){let _=y(p,v);return _.segment&&_.segment.pointOnPath(_.proportion,!1)||[0,0]},this.gradientAtPoint=function(p,v){let _=y(p,v);return _.segment&&_.segment.gradientAtPoint(_.proportion,!1)||0},this.pointAlongPathFrom=function(p,v,_){let L=y(p,_);return L.segment&&L.segment.pointAlongPathFrom(L.proportion,v,!1)||[0,0]},this.compute=function(p){b=M.call(this,p),D(),this._compute(b,p),this.x=b.points[0],this.y=b.points[1],this.w=b.points[2],this.h=b.points[3],this.segment=b.segment,n()},{addSegment:h,prepareCompute:M,sourceStub:s,targetStub:l,maxStub:Math.max(s,l),sourceGap:G,targetGap:U,maxGap:Math.max(G,U)}},H.extend(c.Connectors.AbstractConnector,J),c.Endpoints.AbstractEndpoint=function(t){return J.apply(this,arguments),{compute:this.compute=function(S,j,P,I){let s=this._compute.apply(this,arguments);return this.x=s[0],this.y=s[1],this.w=s[2],this.h=s[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,s},cssClass:t.cssClass}},H.extend(c.Endpoints.AbstractEndpoint,J),c.Endpoints.Dot=function(t){this.type="Dot",c.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(g,S,j,P){this.radius=j.radius||this.radius;let I=g[0]-this.radius,s=g[1]-this.radius,l=this.radius*2,N=this.radius*2;if(j.stroke){let G=j.strokeWidth||1;I-=G,s-=G,l+=G*2,N+=G*2}return[I,s,l,N,this.radius]}},H.extend(c.Endpoints.Dot,c.Endpoints.AbstractEndpoint),c.Endpoints.Rectangle=function(t){this.type="Rectangle",c.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(g,S,j,P){let I=j.width||this.width,s=j.height||this.height,l=g[0]-I/2,N=g[1]-s/2;return[l,N,I,s]}},H.extend(c.Endpoints.Rectangle,c.Endpoints.AbstractEndpoint);let X=function(t){c.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};H.extend(X,c.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),c.Endpoints.Image=function(t){this.type="Image",X.apply(this,arguments),c.Endpoints.AbstractEndpoint.apply(this,arguments);let g=t.onload,S=t.src||t.url,j=t.cssClass?" "+t.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=t.width,this._jsPlumb.heightToUse=t.height,this._jsPlumb.endpoint=t.endpoint,this._jsPlumb.img.onload=(function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,g&&g(this))}).bind(this),this._jsPlumb.endpoint.setImage=(function(P,I){let s=P.constructor===String?P:P.src;g=I,this._jsPlumb.img.src=s,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}).bind(this),this._jsPlumb.endpoint.setImage(S,g),this._compute=function(P,I,s,l){return this.anchorPoint=P,this._jsPlumb.ready?[P[0]-this._jsPlumb.widthToUse/2,P[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=c.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+j),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(P,I,s){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);let l=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,N=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;H.sizeElement(this.canvas,l,N,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(P,I){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(P,I):q.setTimeout((function(){this.paint(P,I)}).bind(this),200))}},H.extend(c.Endpoints.Image,[X,c.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),c.Endpoints.Blank=function(t){c.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",X.apply(this,arguments),this._compute=function(S,j,P,I){return[S[0],S[1],10,0]};let g=t.cssClass?" "+t.cssClass:"";this.canvas=c.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+g),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(S,j){H.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},H.extend(c.Endpoints.Blank,[c.Endpoints.AbstractEndpoint,X],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),c.Endpoints.Triangle=function(t){this.type="Triangle",c.Endpoints.AbstractEndpoint.apply(this,arguments);let g=this;t=t||{},t.width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(S,j,P,I){let s=P.width||g.width,l=P.height||g.height,N=S[0]-s/2,G=S[1]-l/2;return[N,G,s,l]}};let r=c.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=t.location==null?.5:t.location,this.endpointLoc=t.endpointLocation==null?[.5,.5]:t.endpointLocation,this.visible=t.visible!==!1};r.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t,g){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},c.Overlays.Arrow=function(t){this.type="Arrow",r.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};let g=this;this.length=t.length||20,this.width=t.width||20,this.id=t.id,this.direction=(t.direction||1)<0?-1:1;let S=t.paintStyle||{"stroke-width":1},j=t.foldback||.623;this.computeMaxSize=function(){return g.width*1.5},this.elementCreated=function(P,I){if(this.path=P,t.events)for(let s in t.events)c.on(P,s,t.events[s])},this.draw=function(P,I){let s,l,N,G,U;if(P.pointAlongPathFrom){if(H.isString(this.loc)||this.loc>1||this.loc<0){let h=parseInt(this.loc,10),D=this.loc<0?1:0;s=P.pointAlongPathFrom(D,h,!1),l=P.pointAlongPathFrom(D,h-this.direction*this.length/2,!1),N=Q.pointOnLine(s,l,this.length)}else if(this.loc===1){if(s=P.pointOnPath(this.loc),l=P.pointAlongPathFrom(this.loc,-this.length),N=Q.pointOnLine(s,l,this.length),this.direction===-1){let h=N;N=s,s=h}}else if(this.loc===0){if(N=P.pointOnPath(this.loc),l=P.pointAlongPathFrom(this.loc,this.length),s=Q.pointOnLine(N,l,this.length),this.direction===-1){let h=N;N=s,s=h}}else s=P.pointAlongPathFrom(this.loc,this.direction*this.length/2),l=P.pointOnPath(this.loc),N=Q.pointOnLine(s,l,this.length);G=Q.perpendicularLineTo(s,N,this.width),U=Q.pointOnLine(s,N,j*this.length);let O={hxy:s,tail:G,cxy:U},b=S.stroke||I.stroke,n=S.fill||I.stroke,y=S.strokeWidth||I.strokeWidth;return{component:P,d:O,"stroke-width":y,stroke:b,fill:n,minX:Math.min(s.x,G[0].x,G[1].x),maxX:Math.max(s.x,G[0].x,G[1].x),minY:Math.min(s.y,G[0].y,G[1].y),maxY:Math.max(s.y,G[0].y,G[1].y)}}else return{component:P,minX:0,maxX:0,minY:0,maxY:0}}},H.extend(c.Overlays.Arrow,r,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=t.direction!=null?t.direction:this.direction,this.foldback=t.foldback||this.foldback},cleanup:function(){this.path&&this.canvas&&this.canvas.removeChild(this.path)}}),c.Overlays.PlainArrow=function(t){t=t||{};let g=c.extend(t,{foldback:1});c.Overlays.Arrow.call(this,g),this.type="PlainArrow"},H.extend(c.Overlays.PlainArrow,c.Overlays.Arrow),c.Overlays.Diamond=function(t){t=t||{};let g=t.length||40,S=c.extend(t,{length:g/2,foldback:2});c.Overlays.Arrow.call(this,S),this.type="Diamond"},H.extend(c.Overlays.Diamond,c.Overlays.Arrow);let x=function(t,g){return(t._jsPlumb.cachedDimensions==null||g)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},u=function(t){c.jsPlumbUIComponent.apply(this,arguments),r.apply(this,arguments);let g=this.fire;this.fire=function(){g.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=t.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){let S=this._jsPlumb.div=c.getElement(this._jsPlumb.create(this._jsPlumb.component));S.style.position="absolute",jsPlumb.addClass(S,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"")),this._jsPlumb.instance.appendElement(S),this._jsPlumb.instance.getId(S),this.canvas=S;let j="translate(-50%, -50%)";S.style.webkitTransform=j,S.style.mozTransform=j,S.style.msTransform=j,S.style.oTransform=j,S.style.transform=j,S._jsPlumb=this,t.visible===!1&&(S.style.display="none")}return this._jsPlumb.div},this.draw=function(S,j,P){let I=x(this);if(I!=null&&I.length===2){let s={x:0,y:0};if(P)s={x:P[0],y:P[1]};else if(S.pointOnPath){let G=this.loc,U=!1;(H.isString(this.loc)||this.loc<0||this.loc>1)&&(G=parseInt(this.loc,10),U=!0),s=S.pointOnPath(G,U)}else{let G=this.loc.constructor===Array?this.loc:this.endpointLoc;s={x:G[0]*S.w,y:G[1]*S.h}}let l=s.x-I[0]/2,N=s.y-I[1]/2;return{component:S,d:{minx:l,miny:N,td:I,cxy:s},minX:l,maxX:l+I[0],minY:N,maxY:N+I[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};H.extend(u,[c.jsPlumbUIComponent,r],{getDimensions:function(){return[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(x(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t,g){this._jsPlumb.div!=null&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){let t=x(this);return Math.max(t[0],t[1])},paint:function(t,g){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),c.Overlays.Custom=function(t){this.type="Custom",u.apply(this,arguments)},H.extend(c.Overlays.Custom,u),c.Overlays.GuideLines=function(){let t=this;t.length=50,t.strokeWidth=5,this.type="GuideLines",r.apply(this,arguments),c.jsPlumbUIComponent.apply(this,arguments),this.draw=function(g,S){let j=g.pointAlongPathFrom(t.loc,t.length/2),P=g.pointOnPath(t.loc),I=Q.pointOnLine(j,P,t.length),s=Q.perpendicularLineTo(j,I,40),l=Q.perpendicularLineTo(I,j,20);return{connector:g,head:j,tail:I,headLine:l,tailLine:s,minX:Math.min(j.x,I.x,l[0].x,l[1].x),minY:Math.min(j.y,I.y,l[0].y,l[1].y),maxX:Math.max(j.x,I.x,l[0].x,l[1].x),maxY:Math.max(j.y,I.y,l[0].y,l[1].y)}}},c.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;let g=c.extend({create:function(){return c.createElement("div")}},t);if(c.Overlays.Custom.call(this,g),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){let S=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",S.style.font=this.labelStyle.font,S.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(S.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){let j=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";S.style.border=this.labelStyle.borderWidth+"px solid "+j}this.labelStyle.padding&&(S.style.padding=this.labelStyle.padding)}},H.extend(c.Overlays.Label,c.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),u.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){let t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){t.label!=null&&this.setLabel(t.label)}})}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumbUtil,H=q.jsPlumbInstance,Q="jtk-group-collapsed",J="jtk-group-expanded",X="[jtk-group-content]",r="elementDraggable",x="stop",u="revert",t="_groupManager",g="_jsPlumbGroup",S="_jsPlumbGroupDrag",j="group:addMember",P="group:removeMember",I="group:add",s="group:remove",l="group:expand",N="group:collapse",G="groupDragStop",U="connectionMoved",O="internal.connectionDetached",b="removeAll",n="orphanAll",y="show",h="hide",D=function(p){let v={},_={},L={},m=this;p.bind("connection",function(e){e.source[g]!=null&&e.target[g]!=null&&e.source[g]===e.target[g]?(_[e.connection.id]=e.source[g],L[e.connection.id]=e.source[g]):(e.source[g]!=null&&(c.suggest(e.source[g].connections.source,e.connection),_[e.connection.id]=e.source[g]),e.target[g]!=null&&(c.suggest(e.target[g].connections.target,e.connection),L[e.connection.id]=e.target[g]))});function a(e){delete e.proxies;let d=_[e.id],E;d!=null&&(E=function(w){return w.id===e.id},c.removeWithFunction(d.connections.source,E),c.removeWithFunction(d.connections.target,E),delete _[e.id]),d=L[e.id],d!=null&&(E=function(w){return w.id===e.id},c.removeWithFunction(d.connections.source,E),c.removeWithFunction(d.connections.target,E),delete L[e.id])}p.bind(O,function(e){a(e.connection)}),p.bind(U,function(e){let E=(e.index===0?_:L)[e.connection.id];if(E){let w=E.connections[e.index===0?"source":"target"],B=w.indexOf(e.connection);B!==-1&&w.splice(B,1)}}),this.addGroup=function(e){p.addClass(e.getEl(),J),v[e.id]=e,e.manager=this,i(e),p.fire(I,{group:e})},this.addToGroup=function(e,d,E){if(e=this.getGroup(e),e){let w=e.getEl();if(d._isJsPlumbGroup)return;let B=d._jsPlumbGroup;if(B!==e){let W=p.getOffset(d,!0),Y=e.collapsed?p.getOffset(w,!0):p.getOffset(e.getDragArea(),!0);B!=null&&(B.remove(d,!1,E,!1,e),m.updateConnectionsForGroup(B)),e.add(d,E);let V=function(pt,$){let rt=$===0?1:0;pt.each(function(ft){ft.setVisible(!1),ft.endpoints[rt].element._jsPlumbGroup===e?(ft.endpoints[rt].setVisible(!1),F(ft,rt,e)):(ft.endpoints[$].setVisible(!1),A(ft,$,e))})};e.collapsed&&(V(p.select({source:d}),0),V(p.select({target:d}),1));let ot=p.getId(d);p.dragManager.setParent(d,ot,w,p.getId(w),W);let ct={left:W.left-Y.left,top:W.top-Y.top};if(p.setPosition(d,ct),p.dragManager.revalidateParent(d,ot,W),m.updateConnectionsForGroup(e),p.revalidate(ot),!E){let pt={group:e,el:d,pos:ct};B&&(pt.sourceGroup=B),p.fire(j,pt)}}}},this.removeFromGroup=function(e,d,E){e=this.getGroup(e),e&&e.remove(d,null,E)},this.getGroup=function(e){let d=e;if(c.isString(e)&&(d=v[e],d==null))throw new TypeError("No such group ["+e+"]");return d},this.getGroups=function(){let e=[];for(let d in v)e.push(v[d]);return e},this.removeGroup=function(e,d,E,w){e=this.getGroup(e),this.expandGroup(e,!0);let B=e[d?b:n](E,w);return p.remove(e.getEl()),delete v[e.id],delete p._groups[e.id],p.fire(s,{group:e}),B},this.removeAllGroups=function(e,d,E){for(let w in v)this.removeGroup(v[w],e,d,E)};function f(e,d){let E=e.getMembers();for(let w=0;w<E.length;w++)p[d?y:h](E[w],!0)}var A=function(e,d,E){let w=e.endpoints[d===0?1:0].element;if(w[g]&&!w[g].shouldProxy()&&w[g].collapsed)return;let B=E.getEl(),W=p.getId(B);p.proxyConnection(e,d,B,W,function(Y,V){return E.getEndpoint(Y,V)},function(Y,V){return E.getAnchor(Y,V)})};this.collapseGroup=function(e){if(e=this.getGroup(e),e==null||e.collapsed)return;let d=e.getEl();if(f(e,!1),e.shouldProxy()){let E=function(w,B){for(let W=0;W<w.length;W++){let Y=w[W];A(Y,B,e)}};E(e.connections.source,0),E(e.connections.target,1)}e.collapsed=!0,p.removeClass(d,J),p.addClass(d,Q),p.revalidate(d),p.fire(N,{group:e})};var F=function(e,d,E){p.unproxyConnection(e,d,p.getId(E.getEl()))};this.expandGroup=function(e,d){if(e=this.getGroup(e),e==null||!e.collapsed)return;let E=e.getEl();if(f(e,!0),e.shouldProxy()){let w=function(B,W){for(let Y=0;Y<B.length;Y++){let V=B[Y];F(V,W,e)}};w(e.connections.source,0),w(e.connections.target,1)}e.collapsed=!1,p.addClass(E,J),p.removeClass(E,Q),p.revalidate(E),this.repaintGroup(e),d||p.fire(l,{group:e})},this.repaintGroup=function(e){e=this.getGroup(e);let d=e.getMembers();for(let E=0;E<d.length;E++)p.revalidate(d[E])};function i(e){let d=e.getMembers(),E=p.getConnections({source:d,scope:"*"},!0),w=p.getConnections({target:d,scope:"*"},!0),B={};e.connections.source.length=0,e.connections.target.length=0;let W=function(Y){for(let V=0;V<Y.length;V++)B[Y[V].id]||(B[Y[V].id]=!0,Y[V].source._jsPlumbGroup===e?(Y[V].target._jsPlumbGroup!==e&&e.connections.source.push(Y[V]),_[Y[V].id]=e):Y[V].target._jsPlumbGroup===e&&(e.connections.target.push(Y[V]),L[Y[V].id]=e))};W(E),W(w)}this.updateConnectionsForGroup=i,this.refreshAllGroups=function(){for(let e in v)i(v[e]),p.dragManager.updateOffsets(p.getId(v[e].getEl()))}},M=function(p,v){let _=this,L=v.el;this.getEl=function(){return L},this.id=v.id||c.uuid(),L._isJsPlumbGroup=!0;let m=this.getDragArea=function(){let $=p.getSelector(L,X);return $&&$.length>0?$[0]:L},a=v.ghost===!0,f=a||v.constrain===!0,A=v.revert!==!1,F=v.orphan===!0,i=v.prune===!0,e=v.dropOverride===!0,d=v.proxied!==!1,E=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function($,rt){return v.anchor||"Continuous"},this.getEndpoint=function($,rt){return v.endpoint||["Dot",{radius:10}]},this.collapsed=!1,v.draggable!==!1){let $={stop:function(rt){p.fire(G,jsPlumb.extend(rt,{group:_}))},scope:S};v.dragOptions&&q.jsPlumb.extend($,v.dragOptions),p.draggable(v.el,$)}v.droppable!==!1&&p.droppable(v.el,{drop:function($){let rt=$.drag.el;if(rt._isJsPlumbGroup)return;let ft=rt._jsPlumbGroup;if(ft!==_){if(ft!=null&&ft.overrideDrop(rt,_))return;p.getGroupManager().addToGroup(_,rt,!1)}}});let w=function($,rt){let ft=$.nodeType==null?$:[$];for(let at=0;at<ft.length;at++)rt(ft[at])};this.overrideDrop=function($,rt){return e&&(A||i||F)},this.add=function($,rt){let ft=m();w($,function(at){if(at._jsPlumbGroup!=null){if(at._jsPlumbGroup===_)return;at._jsPlumbGroup.remove(at,!0,rt,!1)}at._jsPlumbGroup=_,E.push(at),p.isAlreadyDraggable(at)&&pt(at),at.parentNode!==ft&&ft.appendChild(at)}),p.getGroupManager().updateConnectionsForGroup(_)},this.remove=function($,rt,ft,at,ht){w($,function(Ct){if(Ct._jsPlumbGroup===_){if(delete Ct._jsPlumbGroup,c.removeWithFunction(E,function(mt){return mt===Ct}),rt)try{_.getDragArea().removeChild(Ct)}catch(mt){jsPlumbUtil.log("Could not remove element from Group "+mt)}if(ct(Ct),!ft){let mt={group:_,el:Ct};ht&&(mt.targetGroup=ht),p.fire(P,mt)}}}),at||p.getGroupManager().updateConnectionsForGroup(_)},this.removeAll=function($,rt){for(let ft=0,at=E.length;ft<at;ft++){let ht=E[0];_.remove(ht,$,rt,!0),p.remove(ht,!0)}E.length=0,p.getGroupManager().updateConnectionsForGroup(_)},this.orphanAll=function(){let $={};for(let rt=0;rt<E.length;rt++){let ft=Y(E[rt]);$[ft[0]]=ft[1]}return E.length=0,$},this.getMembers=function(){return E},L[g]=this,p.bind(r,(function($){$.el._jsPlumbGroup===this&&pt($.el)}).bind(this));function B($){return $.offsetParent}function W($,rt){let ft=B($),at=p.getSize(ft),ht=p.getSize($),Ct=rt[0],mt=Ct+ht[0],K=rt[1],tt=K+ht[1];return mt>0&&Ct<at[0]&&tt>0&&K<at[1]}function Y($){let rt=p.getId($),ft=p.getOffset($);return $.parentNode.removeChild($),p.getContainer().appendChild($),p.setPosition($,ft),ct($),p.dragManager.clearParent($,rt),[rt,ft]}function V($){let rt=[];function ft(at,ht,Ct){let mt=null;if(!W(at,[ht,Ct])){let K=at._jsPlumbGroup;i?p.remove(at):mt=Y(at),K.remove(at)}return mt}for(let at=0;at<$.selection.length;at++)rt.push(ft($.selection[at][0],$.selection[at][1].left,$.selection[at][1].top));return rt.length===1?rt[0]:rt}function ot($){let rt=p.getId($);p.revalidate($),p.dragManager.revalidateParent($,rt)}function ct($){$._katavorioDrag&&((i||F)&&$._katavorioDrag.off(x,V),!i&&!F&&A&&($._katavorioDrag.off(u,ot),$._katavorioDrag.setRevert(null)))}function pt($){$._katavorioDrag&&((i||F)&&$._katavorioDrag.on(x,V),f&&$._katavorioDrag.setConstrain(!0),a&&$._katavorioDrag.setUseGhostProxy(!0),!i&&!F&&A&&($._katavorioDrag.on(u,ot),$._katavorioDrag.setRevert(function(rt,ft){return!W(rt,ft)})))}this.shouldProxy=function(){return d},p.getGroupManager().addGroup(this)};H.prototype.addGroup=function(p){let v=this;if(v._groups=v._groups||{},v._groups[p.id]!=null)throw new TypeError("cannot create Group ["+p.id+"]; a Group with that ID exists");if(p.el[g]!=null)throw new TypeError("cannot create Group ["+p.id+"]; the given element is already a Group");let _=new M(v,p);return v._groups[_.id]=_,p.collapsed&&this.collapseGroup(_),_},H.prototype.addToGroup=function(p,v,_){let L=(function(m){let a=this.getId(m);this.manage(a,m),this.getGroupManager().addToGroup(p,m,_)}).bind(this);if(Array.isArray(v))for(let m=0;m<v.length;m++)L(v[m]);else L(v)},H.prototype.removeFromGroup=function(p,v,_){this.getGroupManager().removeFromGroup(p,v,_)},H.prototype.removeGroup=function(p,v,_,L){return this.getGroupManager().removeGroup(p,v,_,L)},H.prototype.removeAllGroups=function(p,v,_){this.getGroupManager().removeAllGroups(p,v,_)},H.prototype.getGroup=function(p){return this.getGroupManager().getGroup(p)},H.prototype.getGroups=function(){return this.getGroupManager().getGroups()},H.prototype.expandGroup=function(p){this.getGroupManager().expandGroup(p)},H.prototype.collapseGroup=function(p){this.getGroupManager().collapseGroup(p)},H.prototype.repaintGroup=function(p){this.getGroupManager().repaintGroup(p)},H.prototype.toggleGroup=function(p){p=this.getGroupManager().getGroup(p),p!=null&&this.getGroupManager()[p.collapsed?"expandGroup":"collapseGroup"](p)},H.prototype.getGroupManager=function(){let p=this[t];return p==null&&(p=this[t]=new D(this)),p},H.prototype.removeGroupManager=function(){delete this[t]},H.prototype.getGroupFor=function(p){if(p=this.getElement(p),p)return p[g]}}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q="Straight",J="Arc",X=function(r){this.type="Flowchart",r=r||{},r.stub=r.stub==null?30:r.stub;let x,u=c.Connectors.AbstractConnector.apply(this,arguments),t=r.midpoint==null?.5:r.midpoint,g=r.alwaysRespectStubs===!0,S=null,j=null,P=r.cornerRadius!=null?r.cornerRadius:0;r.loopbackRadius;let I=function(O){return O<0?-1:O===0?0:1},s=function(O){return[I(O[2]-O[0]),I(O[3]-O[1])]},l=function(O,b,n,y){if(S===b&&j===n)return;let h=S??y.sx,D=j??y.sy,M=h===b?"v":"h";S=b,j=n,O.push([h,D,b,n,M])},N=function(O){return Math.sqrt(Math.pow(O[0]-O[2],2)+Math.pow(O[1]-O[3],2))},G=function(O){let b=[];return b.push.apply(b,O),b},U=function(O,b,n){let y=null,h,D,M;for(let p=0;p<b.length-1;p++){if(y=y||G(b[p]),h=G(b[p+1]),D=s(y),M=s(h),P>0&&y[4]!==h[4]){let v=Math.min(N(y),N(h)),_=Math.min(P,v/2);y[2]-=D[0]*_,y[3]-=D[1]*_,h[0]+=M[0]*_,h[1]+=M[1]*_;let L=D[1]===M[0]&&M[0]===1||D[1]===M[0]&&M[0]===0&&D[0]!==M[1]||D[1]===M[0]&&M[0]===-1,m=h[1]>y[3]?1:-1,a=h[0]>y[2]?1:-1,f=m===a,A=f&&L||!f&&!L?h[0]:y[2],F=f&&L||!f&&!L?y[3]:h[1];u.addSegment(O,Q,{x1:y[0],y1:y[1],x2:y[2],y2:y[3]}),u.addSegment(O,J,{r:_,x1:y[2],y1:y[3],x2:h[0],y2:h[1],cx:A,cy:F,ac:L})}else{let v=y[2]===y[0]?0:y[2]>y[0]?n.lw/2:-(n.lw/2),_=y[3]===y[1]?0:y[3]>y[1]?n.lw/2:-(n.lw/2);u.addSegment(O,Q,{x1:y[0]-v,y1:y[1]-_,x2:y[2]+v,y2:y[3]+_})}y=h}h!=null&&u.addSegment(O,Q,{x1:h[0],y1:h[1],x2:h[2],y2:h[3]})};this._compute=function(O,b){x=[],S=null,j=null;let n=function(){return[O.startStubX,O.startStubY,O.endStubX,O.endStubY]},h={perpendicular:n,orthogonal:n,opposite:function(i){let e=O,d=i==="x"?0:1;return!g&&{x:function(){return e.so[d]===1&&(e.startStubX>e.endStubX&&e.tx>e.startStubX||e.sx>e.endStubX&&e.tx>e.sx)||e.so[d]===-1&&(e.startStubX<e.endStubX&&e.tx<e.startStubX||e.sx<e.endStubX&&e.tx<e.sx)},y:function(){return e.so[d]===1&&(e.startStubY>e.endStubY&&e.ty>e.startStubY||e.sy>e.endStubY&&e.ty>e.sy)||e.so[d]===-1&&(e.startStubY<e.endStubY&&e.ty<e.startStubY||e.sy<e.endStubY&&e.ty<e.sy)}}[i]()?{x:[(O.sx+O.tx)/2,O.startStubY,(O.sx+O.tx)/2,O.endStubY],y:[O.startStubX,(O.sy+O.ty)/2,O.endStubX,(O.sy+O.ty)/2]}[i]:[O.startStubX,O.startStubY,O.endStubX,O.endStubY]}}[O.anchorOrientation](O.sourceAxis),D=O.sourceAxis==="x"?0:1,M=O.sourceAxis==="x"?1:0,p=h[D],v=h[M],_=h[D+2],L=h[M+2];l(x,h[0],h[1],O);let m=O.startStubX+(O.endStubX-O.startStubX)*t,a=O.startStubY+(O.endStubY-O.startStubY)*t,f={x:[0,1],y:[1,0]},F={perpendicular:function(i){let e=O,d={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},E={x:[[e.startStubX,e.endStubX],null,[e.endStubX,e.startStubX]],y:[[e.startStubY,e.endStubY],null,[e.endStubY,e.startStubY]]},w={x:[[m,e.startStubY],[m,e.endStubY]],y:[[e.startStubX,a],[e.endStubX,a]]},B={x:[[e.endStubX,e.startStubY]],y:[[e.startStubX,e.endStubY]]},W={x:[[e.startStubX,e.endStubY],[e.endStubX,e.endStubY]],y:[[e.endStubX,e.startStubY],[e.endStubX,e.endStubY]]},Y={x:[[e.startStubX,a],[e.endStubX,a],[e.endStubX,e.endStubY]],y:[[m,e.startStubY],[m,e.endStubY],[e.endStubX,e.endStubY]]},V={x:[e.startStubY,e.endStubY],y:[e.startStubX,e.endStubX]},ot=f[i][0],ct=f[i][1],pt=e.so[ot]+1,$=e.to[ct]+1,rt=e.to[ct]===-1&&V[i][1]<V[i][0]||e.to[ct]===1&&V[i][1]>V[i][0],ft=E[i][pt][0],at=E[i][pt][1],ht=d[i][pt][$];if(e.segment===ht[3]||e.segment===ht[2]&&rt)return w[i];if(e.segment===ht[2]&&at<ft)return B[i];if(e.segment===ht[2]&&at>=ft||e.segment===ht[1]&&!rt)return Y[i];if(e.segment===ht[0]||e.segment===ht[1]&&rt)return W[i]},orthogonal:function(i,e,d,E,w){let B=O,W={x:B.so[0]===-1?Math.min(e,E):Math.max(e,E),y:B.so[1]===-1?Math.min(e,E):Math.max(e,E)}[i];return{x:[[W,d],[W,w],[E,w]],y:[[d,W],[w,W],[w,E]]}[i]},opposite:function(i,e,d,E){let w=O,B={x:"y",y:"x"}[i],W={x:"height",y:"width"}[i],Y=w["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(b.sourceEndpoint.elementId===b.targetEndpoint.elementId){let V=d+(1-b.sourceEndpoint.anchor[B])*b.sourceInfo[W]+u.maxStub;return{x:[[e,V],[E,V]],y:[[V,e],[V,E]]}[i]}else{if(!Y||w.so[D]===1&&e>E||w.so[D]===-1&&e<E)return{x:[[e,a],[E,a]],y:[[m,e],[m,E]]}[i];if(w.so[D]===1&&e<E||w.so[D]===-1&&e>E)return{x:[[m,w.sy],[m,w.ty]],y:[[w.sx,a],[w.tx,a]]}[i]}}}[O.anchorOrientation](O.sourceAxis,p,v,_,L);if(F)for(let i=0;i<F.length;i++)l(x,F[i][0],F[i][1],O);l(x,h[2],h[3],O),l(x,O.tx,O.ty,O),U(this,x,O)}};c.Connectors.Flowchart=X,H.extend(c.Connectors.Flowchart,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil;c.Connectors.AbstractBezierConnector=function(J){J=J||{};let X=J.showLoopback!==!1;J.curviness;let r=J.margin||5;J.proximityLimit;let x=J.orientation&&J.orientation==="clockwise",u=J.loopbackRadius||25,t;return this._compute=function(g,S){let j=S.sourcePos,P=S.targetPos,I=Math.abs(j[0]-P[0]),s=Math.abs(j[1]-P[1]);if(!X||S.sourceEndpoint.elementId!==S.targetEndpoint.elementId)this._computeBezier(g,S,j,P,I,s);else{let l=S.sourcePos[0],N=S.sourcePos[1]-r,G=l,U=N-u,O=G-u,b=U-u;I=2*u,s=2*u,g.points[0]=O,g.points[1]=b,g.points[2]=I,g.points[3]=s,t.addSegment(this,"Arc",{loopback:!0,x1:l-O+4,y1:N-b,startAngle:0,endAngle:2*Math.PI,r:u,ac:!x,x2:l-O-4,y2:N-b,cx:G-O,cy:U-b})}},t=c.Connectors.AbstractConnector.apply(this,arguments),t},H.extend(c.Connectors.AbstractBezierConnector,c.Connectors.AbstractConnector);let Q=function(J){J=J||{},this.type="Bezier";let X=c.Connectors.AbstractBezierConnector.apply(this,arguments),r=J.curviness||150,x=10;this.getCurviness=function(){return r},this._findControlPoint=function(u,t,g,S,j,P,I){let s=P[0]!==I[0]||P[1]===I[1],l=[];return s?(I[0]===0?l.push(g[0]<t[0]?u[0]+x:u[0]-x):l.push(u[0]+r*I[0]),I[1]===0?l.push(g[1]<t[1]?u[1]+x:u[1]-x):l.push(u[1]+r*P[1])):(P[0]===0?l.push(t[0]<g[0]?u[0]+x:u[0]-x):l.push(u[0]-r*P[0]),P[1]===0?l.push(t[1]<g[1]?u[1]+x:u[1]-x):l.push(u[1]+r*I[1])),l},this._computeBezier=function(u,t,g,S,j,P){let I,s,l=g[0]<S[0]?j:0,N=g[1]<S[1]?P:0,G=g[0]<S[0]?0:j,U=g[1]<S[1]?0:P;I=this._findControlPoint([l,N],g,S,t.sourceEndpoint,t.targetEndpoint,u.so,u.to),s=this._findControlPoint([G,U],S,g,t.targetEndpoint,t.sourceEndpoint,u.to,u.so),X.addSegment(this,"Bezier",{x1:l,y1:N,x2:G,y2:U,cp1x:I[0],cp1y:I[1],cp2x:s[0],cp2y:s[1]})}};c.Connectors.Bezier=Q,H.extend(Q,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q=function(r,x,u,t){return r<=u&&t<=x?1:r<=u&&x<=t?2:u<=r&&t>=x?3:4},J=function(r,x,u,t,g,S,j,P,I){if(P<=I)return[r,x];if(u===1)return t[3]<=0&&g[3]>=1?[r+(t[2]<.5?-1*S:S),x]:t[2]>=1&&g[2]<=0?[r,x+(t[3]<.5?-1*j:j)]:[r+-1*S,x+-1*j];if(u===2)return t[3]>=1&&g[3]<=0?[r+(t[2]<.5?-1*S:S),x]:t[2]>=1&&g[2]<=0?[r,x+(t[3]<.5?-1*j:j)]:[r+S,x+-1*j];if(u===3)return t[3]>=1&&g[3]<=0?[r+(t[2]<.5?-1*S:S),x]:t[2]<=0&&g[2]>=1?[r,x+(t[3]<.5?-1*j:j)]:[r+-1*S,x+-1*j];if(u===4)return t[3]<=0&&g[3]>=1?[r+(t[2]<.5?-1*S:S),x]:t[2]<=0&&g[2]>=1?[r,x+(t[3]<.5?-1*j:j)]:[r+S,x+-1*j]},X=function(r){r=r||{},this.type="StateMachine";let x=c.Connectors.AbstractBezierConnector.apply(this,arguments),u=r.curviness||10,t=r.margin||5,g=r.proximityLimit||80;r.orientation&&r.orientation;let S;this._computeBezier=function(j,P,I,s,l,N){let G=P.sourcePos[0]<P.targetPos[0]?0:l,U=P.sourcePos[1]<P.targetPos[1]?0:N,O=P.sourcePos[0]<P.targetPos[0]?l:0,b=P.sourcePos[1]<P.targetPos[1]?N:0;P.sourcePos[2]===0&&(G-=t),P.sourcePos[2]===1&&(G+=t),P.sourcePos[3]===0&&(U-=t),P.sourcePos[3]===1&&(U+=t),P.targetPos[2]===0&&(O-=t),P.targetPos[2]===1&&(O+=t),P.targetPos[3]===0&&(b-=t),P.targetPos[3]===1&&(b+=t);let n=(G+O)/2,y=(U+b)/2,h=Q(G,U,O,b),D=Math.sqrt(Math.pow(O-G,2)+Math.pow(b-U,2)),M,p,v,_;S=J(n,y,h,P.sourcePos,P.targetPos,u,u,D,g),M=S[0],p=S[0],v=S[1],_=S[1],x.addSegment(this,"Bezier",{x1:O,y1:b,x2:G,y2:U,cp1x:M,cp1y:v,cp2x:p,cp2y:_})}};c.Connectors.StateMachine=X,H.extend(X,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q="Straight",J=function(X){this.type=Q;let r=c.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(x,u){r.addSegment(this,Q,{x1:x.sx,y1:x.sy,x2:x.startStubX,y2:x.startStubY}),r.addSegment(this,Q,{x1:x.startStubX,y1:x.startStubY,x2:x.endStubX,y2:x.endStubY}),r.addSegment(this,Q,{x1:x.endStubX,y1:x.endStubY,x2:x.tx,y2:x.ty})}};c.Connectors.Straight=J,H.extend(J,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},J="stroke-dasharray",X="dashstyle",r="linearGradient",x="radialGradient",u="defs",t="fill",g="stop",S="stroke",j="stroke-width",P="style",I="none",s="jsplumb_gradient_",l="strokeWidth",N={svg:"http://www.w3.org/2000/svg"},G=function(v,_){for(let L in _)v.setAttribute(L,""+_[L])},U=function(v,_){return _=_||{},_.version="1.1",_.xmlns=N.svg,c.createElementNS(N.svg,v,null,null,_)},O=function(v){return"position:absolute;left:"+v[0]+"px;top:"+v[1]+"px"},b=function(v){let _=v.querySelectorAll(" defs,linearGradient,radialGradient");for(let L=0;L<_.length;L++)_[L].parentNode.removeChild(_[L])},n=function(v,_,L,m,a){let f=s+a._jsPlumb.instance.idstamp();b(v);let A;L.gradient.offset?A=U(x,{id:f}):A=U(r,{id:f,gradientUnits:"userSpaceOnUse"});let F=U(u);v.appendChild(F),F.appendChild(A);for(let e=0;e<L.gradient.stops.length;e++){let d=a.segment===1||a.segment===2?e:L.gradient.stops.length-1-e,E=L.gradient.stops[d][1],w=U(g,{offset:Math.floor(L.gradient.stops[e][0]*100)+"%","stop-color":E});A.appendChild(w)}let i=L.stroke?S:t;_.setAttribute(i,"url(#"+f+")")},y=function(v,_,L,m,a){if(_.setAttribute(t,L.fill?L.fill:I),_.setAttribute(S,L.stroke?L.stroke:I),L.gradient?n(v,_,L,m,a):(b(v),_.setAttribute(P,"")),L.strokeWidth&&_.setAttribute(j,L.strokeWidth),L[X]&&L[l]&&!L[J]){let f=L[X].indexOf(",")===-1?" ":",",A=L[X].split(f),F="";A.forEach(function(i){F+=Math.floor(i*L.strokeWidth)+f}),_.setAttribute(J,F)}else L[J]&&_.setAttribute(J,L[J]);for(let f in Q)L[f]&&_.setAttribute(Q[f],L[f])},h=function(v,_,L){v.childNodes.length>L?v.insertBefore(_,v.childNodes[L]):v.appendChild(_)};H.svg={node:U,attr:G,pos:O};let D=function(v){let _=v.pointerEventsSpec||"all",L={};c.jsPlumbUIComponent.apply(this,v.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;let m=v.cssClass+" "+(v.originalArgs[0].cssClass||""),a={style:"",width:0,height:0,"pointer-events":_,position:"absolute"};this.svg=U("svg",a),v.useDivWrapper?(this.canvas=c.createElement("div",{position:"absolute"}),H.sizeElement(this.canvas,0,0,1,1),this.canvas.className=m):(G(this.svg,{class:m}),this.canvas=this.svg),v._jsPlumb.appendElement(this.canvas,v.originalArgs[0].parent),v.useDivWrapper&&this.canvas.appendChild(this.svg);let f=[this.canvas];return this.getDisplayElements=function(){return f},this.appendDisplayElement=function(A){f.push(A)},this.paint=function(A,F,i){if(A!=null){let e=[this.x,this.y],d=[this.w,this.h],E;i!=null&&(i.xmin<0&&(e[0]+=i.xmin),i.ymin<0&&(e[1]+=i.ymin),d[0]=i.xmax+(i.xmin<0?-i.xmin:0),d[1]=i.ymax+(i.ymin<0?-i.ymin:0)),v.useDivWrapper?(H.sizeElement(this.canvas,e[0],e[1],d[0],d[1]),e[0]=0,e[1]=0,E=O([0,0])):E=O([e[0],e[1]]),L.paint.apply(this,arguments),G(this.svg,{style:E,width:d[0]||0,height:d[1]||0})}},{renderer:L}};H.extend(D,c.jsPlumbUIComponent,{cleanup:function(v){v||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(v){let _=v.getContainer();this.canvas&&this.canvas.parentNode==null&&_.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&_.appendChild(this.bgCanvas)},setVisible:function(v){this.canvas&&(this.canvas.style.display=v?"block":"none")}}),c.ConnectorRenderers.svg=function(v){let _=this,L=D.apply(this,[{cssClass:v._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:v._jsPlumb}]);L.renderer.paint=function(m,a,f){let A=_.getSegments(),F="",i=[0,0];if(f.xmin<0&&(i[0]=-f.xmin),f.ymin<0&&(i[1]=-f.ymin),A.length>0){F=_.getPathData();let e={d:F,transform:"translate("+i[0]+","+i[1]+")","pointer-events":v["pointer-events"]||"visibleStroke"},d=null,E=[_.x,_.y,_.w,_.h];if(m.outlineStroke){let w=m.outlineWidth||1,B=m.strokeWidth+2*w;d=c.extend({},m),delete d.gradient,d.stroke=m.outlineStroke,d.strokeWidth=B,_.bgPath==null?(_.bgPath=U("path",e),c.addClass(_.bgPath,c.connectorOutlineClass),h(_.svg,_.bgPath,0)):G(_.bgPath,e),y(_.svg,_.bgPath,d,E,_)}_.path==null?(_.path=U("path",e),h(_.svg,_.path,m.outlineStroke?1:0)):G(_.path,e),y(_.svg,_.path,m,E,_)}}},H.extend(c.ConnectorRenderers.svg,D);let M=c.SvgEndpoint=function(v){let _=D.apply(this,[{cssClass:v._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:v._jsPlumb}]);_.renderer.paint=(function(L){let m=c.extend({},L);m.outlineStroke&&(m.stroke=m.outlineStroke),this.node==null?(this.node=this.makeNode(m),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),y(this.svg,this.node,m,[this.x,this.y,this.w,this.h],this),O(this.node,[this.x,this.y])}).bind(this)};H.extend(M,D),c.Endpoints.svg.Dot=function(){c.Endpoints.Dot.apply(this,arguments),M.apply(this,arguments),this.makeNode=function(v){return U("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(v){G(v,{cx:this.w/2,cy:this.h/2,r:this.radius})}},H.extend(c.Endpoints.svg.Dot,[c.Endpoints.Dot,M]),c.Endpoints.svg.Rectangle=function(){c.Endpoints.Rectangle.apply(this,arguments),M.apply(this,arguments),this.makeNode=function(v){return U("rect",{width:this.w,height:this.h})},this.updateNode=function(v){G(v,{width:this.w,height:this.h})}},H.extend(c.Endpoints.svg.Rectangle,[c.Endpoints.Rectangle,M]),c.Endpoints.svg.Image=c.Endpoints.Image,c.Endpoints.svg.Blank=c.Endpoints.Blank,c.Overlays.svg.Label=c.Overlays.Label,c.Overlays.svg.Custom=c.Overlays.Custom;let p=function(v,_){v.apply(this,_),c.jsPlumbUIComponent.apply(this,_),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(m,a){if(m.component.svg&&a){this.path==null&&(this.path=U("path",{"pointer-events":"all"}),m.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,m.component),this.canvas=m.component.svg);let f=_&&_.length===1&&_[0].cssClass||"",A=[0,0];a.xmin<0&&(A[0]=-a.xmin),a.ymin<0&&(A[1]=-a.ymin),G(this.path,{d:L(m.d),class:f,stroke:m.stroke?m.stroke:null,fill:m.fill?m.fill:null,transform:"translate("+A[0]+","+A[1]+")"})}};var L=function(m){return isNaN(m.cxy.x)||isNaN(m.cxy.y)?"":"M"+m.hxy.x+","+m.hxy.y+" L"+m.tail[0].x+","+m.tail[0].y+" L"+m.cxy.x+","+m.cxy.y+" L"+m.tail[1].x+","+m.tail[1].y+" L"+m.hxy.x+","+m.hxy.y};this.transfer=function(m){m.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),m.canvas.appendChild(this.path))}};H.extend(p,[c.jsPlumbUIComponent,c.Overlays.AbstractOverlay],{cleanup:function(v){this.path!=null&&(v?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(v,_){this.path&&_.canvas&&_.canvas.appendChild(this.path)},setVisible:function(v){this.path!=null&&(this.path.style.display=v?"block":"none")}}),c.Overlays.svg.Arrow=function(){p.apply(this,[c.Overlays.Arrow,arguments])},H.extend(c.Overlays.svg.Arrow,[c.Overlays.Arrow,p]),c.Overlays.svg.PlainArrow=function(){p.apply(this,[c.Overlays.PlainArrow,arguments])},H.extend(c.Overlays.svg.PlainArrow,[c.Overlays.PlainArrow,p]),c.Overlays.svg.Diamond=function(){p.apply(this,[c.Overlays.Diamond,arguments])},H.extend(c.Overlays.svg.Diamond,[c.Overlays.Diamond,p]),c.Overlays.svg.GuideLines=function(){let v=null,_=this,L,m;c.Overlays.GuideLines.apply(this,arguments),this.paint=function(f,A){v==null&&(v=U("path"),f.connector.svg.appendChild(v),_.attachListeners(v,f.connector),_.attachListeners(v,_),L=U("path"),f.connector.svg.appendChild(L),_.attachListeners(L,f.connector),_.attachListeners(L,_),m=U("path"),f.connector.svg.appendChild(m),_.attachListeners(m,f.connector),_.attachListeners(m,_));let F=[0,0];A.xmin<0&&(F[0]=-A.xmin),A.ymin<0&&(F[1]=-A.ymin),G(v,{d:a(f.head,f.tail),stroke:"red",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),G(L,{d:a(f.tailLine[0],f.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),G(m,{d:a(f.headLine[0],f.headLine[1]),stroke:"green",fill:null,transform:"translate("+F[0]+","+F[1]+")"})};var a=function(f,A){return"M "+f.x+","+f.y+" L"+A.x+","+A.y}},H.extend(c.Overlays.svg.GuideLines,c.Overlays.GuideLines)}).call(typeof window<"u"?window:void 0);(function(){let q=this,c=q.jsPlumb,H=q.jsPlumbUtil,Q=q.Katavorio,J=q.Biltong,X=function(n){let y=n._mottle;return y||(y=n._mottle=new q.Mottle),y},r=function(n,y){y=y||"main";let h="_katavorio_"+y,D=n[h],M=n.getEventManager();return D||(D=new Q({bind:M.on,unbind:M.off,getSize:c.getSize,getConstrainingRectangle:function(p){return[p.parentNode.scrollWidth,p.parentNode.scrollHeight]},getPosition:function(p,v){let _=n.getOffset(p,v,p._katavorioDrag?p.offsetParent:null);return[_.left,_.top]},setPosition:function(p,v){p.style.left=v[0]+"px",p.style.top=v[1]+"px"},addClass:c.addClass,removeClass:c.removeClass,intersects:J.intersects,indexOf:function(p,v){return p.indexOf(v)},scope:n.getDefaultScope(),css:{noSelect:n.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),D.setZoom(n.getZoom()),n[h]=D,n.bind("zoom",D.setZoom)),D},x=function(n){let y=n.el._jsPlumbDragOptions,h=!0;return y.canDrag&&(h=y.canDrag()),h&&(this.setHoverSuspended(!0),this.select({source:n.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:n.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),h},u=function(n){let y=this.getUIPosition(arguments,this.getZoom());if(y!=null){let h=n.el._jsPlumbDragOptions;this.draw(n.el,y,null,!0),h._dragging&&this.addClass(n.el,"jtk-dragged"),h._dragging=!0}},t=function(n){let y=n.selection,h,D=(function(M){M[1]!=null&&(h=this.getUIPosition([{el:M[2].el,pos:[M[1].left,M[1].top]}]),this.draw(M[2].el,h)),M[0]._jsPlumbDragOptions!=null&&delete M[0]._jsPlumbDragOptions._dragging,this.removeClass(M[0],"jtk-dragged"),this.select({source:M[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:M[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.getDragManager().dragEnded(M[2].el)}).bind(this);for(let M=0;M<y.length;M++)D(y[M]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},g=function(n,y){let h=function(D){if(y[D]!=null)if(H.isString(y[D])){let M=y[D].match(/-=/)?-1:1,p=y[D].substring(2);return n[D]+M*p}else return y[D];else return n[D]};return[h("left"),h("top")]};var S=function(n,y){if(y==null)return[0,0];let h=l(y),D=s(h,0);return[D[n+"X"],D[n+"Y"]]},j=S.bind(this,"page"),P=S.bind(this,"screen"),I=S.bind(this,"client"),s=function(n,y){return n.item?n.item(y):n[y]},l=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]};let N=function(n){let y={},h=[],D={},M={},p={};this.register=function(v){let _=n.getId(v),L;y[_]||(y[_]=v,h.push(v),D[_]={});let m=function(a){if(a){for(let f=0;f<a.childNodes.length;f++)if(a.childNodes[f].nodeType!==3&&a.childNodes[f].nodeType!==8){let A=jsPlumb.getElement(a.childNodes[f]),F=n.getId(a.childNodes[f],null,!0);if(F&&M[F]&&M[F]>0){L||(L=n.getOffset(v));let i=n.getOffset(A);D[_][F]={id:F,offset:{left:i.left-L.left,top:i.top-L.top}},p[F]=_}m(a.childNodes[f])}}};m(v)},this.updateOffsets=function(v,_){if(v!=null){_=_||{};let L=jsPlumb.getElement(v),m=n.getId(L),a=D[m],f;if(a){for(let A in a)if(a.hasOwnProperty(A)){let F=jsPlumb.getElement(A),i=_[A]||n.getOffset(F);if(F.offsetParent==null&&D[m][A]!=null)continue;f||(f=n.getOffset(L)),D[m][A]={id:A,offset:{left:i.left-f.left,top:i.top-f.top}},p[A]=m}}}},this.endpointAdded=function(v,_){_=_||n.getId(v);let L=document.body,m=v.parentNode;for(M[_]=M[_]?M[_]+1:1;m!=null&&m!==L;){let a=n.getId(m,null,!0);if(a&&y[a]){let f=n.getOffset(m);if(D[a][_]==null){let A=n.getOffset(v);D[a][_]={id:_,offset:{left:A.left-f.left,top:A.top-f.top}},p[_]=a}break}m=m.parentNode}},this.endpointDeleted=function(v){if(M[v.elementId]&&(M[v.elementId]--,M[v.elementId]<=0))for(let _ in D)D.hasOwnProperty(_)&&D[_]&&(delete D[_][v.elementId],delete p[v.elementId])},this.changeId=function(v,_){D[_]=D[v],D[v]={},p[_]=p[v],p[v]=null},this.getElementsForDraggable=function(v){return D[v]},this.elementRemoved=function(v){let _=p[v];_&&(delete D[_][v],delete p[v])},this.reset=function(){y={},h=[],D={},M={}},this.dragEnded=function(v){if(v.offsetParent!=null){let _=n.getId(v),L=p[_];L&&this.updateOffsets(L)}},this.setParent=function(v,_,L,m,a){let f=p[_];D[m]||(D[m]={});let A=n.getOffset(L),F=a||n.getOffset(v);f&&D[f]&&delete D[f][_],D[m][_]={id:_,offset:{left:F.left-A.left,top:F.top-A.top}},p[_]=m},this.clearParent=function(v,_){let L=p[_];L&&(delete D[L][_],delete p[_])},this.revalidateParent=function(v,_,L){let m=p[_];if(m){let a={};a[_]=L,this.updateOffsets(m,a),n.revalidate(m)}},this.getDragAncestor=function(v){let _=jsPlumb.getElement(v),L=n.getId(_),m=p[L];return m?jsPlumb.getElement(m):null}},G=function(n,y,h){y=H.fastTrim(y),typeof n.className.baseVal<"u"?n.className.baseVal=y:n.className=y;try{let D=n.classList;if(D!=null){for(;D.length>0;)D.remove(D.item(0));for(let M=0;M<h.length;M++)h[M]&&D.add(h[M])}}catch(D){H.log("JSPLUMB: cannot set class list",D)}},U=function(n){return typeof n.className.baseVal>"u"?n.className:n.className.baseVal},O=function(n,y,h){y=y==null?[]:H.isArray(y)?y:y.split(/\s+/),h=h==null?[]:H.isArray(h)?h:h.split(/\s+/);let D=U(n),M=D.split(/\s+/),p=function(v,_){for(let L=0;L<_.length;L++)if(v)M.indexOf(_[L])===-1&&M.push(_[L]);else{let m=M.indexOf(_[L]);m!==-1&&M.splice(m,1)}};p(!0,y),p(!1,h),G(n,M.join(" "),M)};q.jsPlumb.extend(q.jsPlumbInstance.prototype,{headless:!1,pageLocation:j,screenLocation:P,clientLocation:I,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new N(this)),this.dragManager},recalculateOffsets:function(n){this.getDragManager().updateOffsets(n)},createElement:function(n,y,h,D){return this.createElementNS(null,n,y,h,D)},createElementNS:function(n,y,h,D,M){let p=n==null?document.createElement(y):document.createElementNS(n,y),v;h=h||{};for(v in h)p.style[v]=h[v];D&&(p.className=D),M=M||{};for(v in M)p.setAttribute(v,""+M[v]);return p},getAttribute:function(n,y){return n.getAttribute!=null?n.getAttribute(y):null},setAttribute:function(n,y,h){n.setAttribute!=null&&n.setAttribute(y,h)},setAttributes:function(n,y){for(let h in y)y.hasOwnProperty(h)&&n.setAttribute(h,y[h])},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["svg"]},getClass:U,addClass:function(n,y){jsPlumb.each(n,function(h){O(h,y)})},hasClass:function(n,y){return n=jsPlumb.getElement(n),n.classList?n.classList.contains(y):U(n).indexOf(y)!==-1},removeClass:function(n,y){jsPlumb.each(n,function(h){O(h,null,y)})},toggleClass:function(n,y){jsPlumb.hasClass(n,y)?jsPlumb.removeClass(n,y):jsPlumb.addClass(n,y)},updateClasses:function(n,y,h){jsPlumb.each(n,function(D){O(D,y,h)})},setClass:function(n,y){y!=null&&jsPlumb.each(n,function(h){G(h,y,y.split(/\s+/))})},setPosition:function(n,y){n.style.left=y.left+"px",n.style.top=y.top+"px"},getPosition:function(n){let y=function(h){let D=n.style[h];return D?D.substring(0,D.length-2):0};return{left:y("left"),top:y("top")}},getStyle:function(n,y){return typeof window.getComputedStyle<"u"?getComputedStyle(n,null).getPropertyValue(y):n.currentStyle[y]},getSelector:function(n,y){let h=null;return arguments.length===1?h=n.nodeType!=null?n:document.querySelectorAll(n):h=n.querySelectorAll(y),h},getOffset:function(n,y,h){n=jsPlumb.getElement(n),h=h||this.getContainer();let D={left:n.offsetLeft,top:n.offsetTop},M=y||h!=null&&n!==h&&n.offsetParent!==h?n.offsetParent:null,p=(function(v){v!=null&&v!==document.body&&(v.scrollTop>0||v.scrollLeft>0)&&(D.left-=v.scrollLeft,D.top-=v.scrollTop)}).bind(this);for(;M!=null;)D.left+=M.offsetLeft,D.top+=M.offsetTop,p(M),M=y?M.offsetParent:M.offsetParent===h?null:M.offsetParent;if(h!=null&&!y&&(h.scrollTop>0||h.scrollLeft>0)){let v=n.offsetParent!=null?this.getStyle(n.offsetParent,"position"):"static",_=this.getStyle(n,"position");_!=="absolute"&&_!=="fixed"&&v!=="absolute"&&v!=="fixed"&&(D.left-=h.scrollLeft,D.top-=h.scrollTop)}return D},getPositionOnElement:function(n,y,h){let D=typeof y.getBoundingClientRect<"u"?y.getBoundingClientRect():{left:0,top:0,width:0,height:0},M=document.body,p=document.documentElement,v=window.pageYOffset||p.scrollTop||M.scrollTop,_=window.pageXOffset||p.scrollLeft||M.scrollLeft,L=p.clientTop||M.clientTop||0,m=p.clientLeft||M.clientLeft||0,a=0,f=0,A=D.top+v-L+a*h,F=D.left+_-m+f*h,i=jsPlumb.pageLocation(n),e=D.width||y.offsetWidth*h,d=D.height||y.offsetHeight*h,E=(i[0]-F)/e,w=(i[1]-A)/d;return[E,w]},getAbsolutePosition:function(n){let y=function(h){let D=n.style[h];if(D)return parseFloat(D.substring(0,D.length-2))};return[y("left"),y("top")]},setAbsolutePosition:function(n,y,h,D){h?this.animate(n,{left:"+="+(y[0]-h[0]),top:"+="+(y[1]-h[1])},D):(n.style.left=y[0]+"px",n.style.top=y[1]+"px")},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(n,y){let h;return n=H.isArray(n)||n.length!=null&&!H.isString(n)?n:[n],Array.prototype.slice.call(n).forEach((function(D){h=this.info(D),h.el&&this._initDraggableIfNecessary(h.el,!0,y,h.id,!0)}).bind(this)),this},snapToGrid:function(n,y,h){let D=[],M=(function(p){let v=this.info(p);if(v.el!=null&&v.el._katavorioDrag){let _=v.el._katavorioDrag.snap(y,h);this.revalidate(v.el),D.push([v.el,_])}}).bind(this);if(arguments.length===1||arguments.length===3)M(n,y,h);else{let p=this.getManagedElements();for(let v in p)M(v,arguments[0],arguments[1])}return D},initDraggable:function(n,y,h){r(this,h).draggable(n,y),n._jsPlumbDragOptions=y},destroyDraggable:function(n,y){r(this,y).destroyDraggable(n),delete n._jsPlumbDragOptions},unbindDraggable:function(n,y,h,D){r(this,D).destroyDraggable(n,y,h)},setDraggable:function(n,y){return jsPlumb.each(n,(function(h){this.isDragSupported(h)&&(this._draggableStates[this.getAttribute(h,"id")]=y,this.setElementDraggable(h,y))}).bind(this))},_draggableStates:{},toggleDraggable:function(n){let y;return jsPlumb.each(n,(function(h){let D=this.getAttribute(h,"id");return y=this._draggableStates[D]==null?!1:this._draggableStates[D],y=!y,this._draggableStates[D]=y,this.setDraggable(h,y),y}).bind(this)),y},_initDraggableIfNecessary:function(n,y,h,D,M){if(!jsPlumb.headless&&(y??!1)&&jsPlumb.isDragSupported(n,this)){let v=h||this.Defaults.DragOptions;if(v=jsPlumb.extend({},v),jsPlumb.isAlreadyDraggable(n,this))h.force&&this.initDraggable(n,v);else{let _=jsPlumb.dragEvents.drag,L=jsPlumb.dragEvents.stop,m=jsPlumb.dragEvents.start;this.manage(D,n),v[m]=H.wrap(v[m],x.bind(this)),v[_]=H.wrap(v[_],u.bind(this)),v[L]=H.wrap(v[L],t.bind(this));let a=this.getId(n);this._draggableStates[a]=!0;let f=this._draggableStates[a];v.disabled=f==null?!1:!f,this.initDraggable(n,v),this.getDragManager().register(n),M&&this.fire("elementDraggable",{el:n,options:v})}}},animationSupported:!0,getElement:function(n){return n==null?null:(n=typeof n=="string"?n:n.length!=null&&n.enctype==null?n[0]:n,typeof n=="string"?document.getElementById(n):n)},removeElement:function(n){r(this).elementRemoved(n),this.getEventManager().remove(n)},doAnimate:function(n,y,h){h=h||{};var D=this.getOffset(n),M=g(D,y),p=M[0]-D.left,v=M[1]-D.top,_=h.duration||250,L=15,m=_/L,a=L/_*p,f=L/_*v,A=0,F=setInterval(function(){c.setPosition(n,{left:D.left+a*(A+1),top:D.top+f*(A+1)}),h.step!=null&&h.step(A,Math.ceil(m)),A++,A>=m&&(window.clearInterval(F),h.complete!=null&&h.complete())},L)},destroyDroppable:function(n,y){r(this,y).destroyDroppable(n)},unbindDroppable:function(n,y,h,D){r(this,D).destroyDroppable(n,y,h)},droppable:function(n,y){n=H.isArray(n)||n.length!=null&&!H.isString(n)?n:[n];let h;return y=y||{},y.allowLoopback=!1,Array.prototype.slice.call(n).forEach((function(D){h=this.info(D),h.el&&this.initDroppable(h.el,y)}).bind(this)),this},initDroppable:function(n,y,h){r(this,h).droppable(n,y)},isAlreadyDraggable:function(n){return n._katavorioDrag!=null},isDragSupported:function(n,y){return!0},isDropSupported:function(n,y){return!0},isElementDraggable:function(n){return n=c.getElement(n),n._katavorioDrag&&n._katavorioDrag.isEnabled()},getDragObject:function(n){return n[0].drag.getDragElement()},getDragScope:function(n){return n._katavorioDrag&&n._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(n){return n[0].e},getUIPosition:function(n,y){let h=n[0].el;if(h.offsetParent==null)return null;let D=n[0].finalPos||n[0].pos,M={left:D[0],top:D[1]};if(h._katavorioDrag&&h.offsetParent!==this.getContainer()){let p=this.getOffset(h.offsetParent);M.left+=p.left,M.top+=p.top}return M},setDragFilter:function(n,y,h){n._katavorioDrag&&n._katavorioDrag.setFilter(y,h)},setElementDraggable:function(n,y){n=c.getElement(n),n._katavorioDrag&&n._katavorioDrag.setEnabled(y)},setDragScope:function(n,y){n._katavorioDrag&&n._katavorioDrag.k.setDragScope(n,y)},setDropScope:function(n,y){n._katavorioDrop&&n._katavorioDrop.length>0&&n._katavorioDrop[0].k.setDropScope(n,y)},addToPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(n,function(M){M=[c.getElement(M)],M.push.apply(M,h),D.addToPosse.apply(D,M)})},setPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(n,function(M){M=[c.getElement(M)],M.push.apply(M,h),D.setPosse.apply(D,M)})},removeFromPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(n,function(M){M=[c.getElement(M)],M.push.apply(M,h),D.removeFromPosse.apply(D,M)})},removeFromAllPosses:function(n){let y=r(this);c.each(n,function(h){y.removeFromAllPosses(c.getElement(h))})},setPosseState:function(n,y,h){let D=r(this);c.each(n,function(M){D.setPosseState(c.getElement(M),y,h)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(n){n._katavorioDrag&&n._katavorioDrag.abort()},addToDragSelection:function(n){r(this).select(n)},removeFromDragSelection:function(n){r(this).deselect(n)},clearDragSelection:function(){r(this).deselectAll()},trigger:function(n,y,h,D){this.getEventManager().trigger(n,y,h,D)},doReset:function(){for(let n in this)n.indexOf("_katavorio_")===0&&this[n].reset()},getEventManager:function(){return X(this)},on:function(n,y,h){return this.getEventManager().on.apply(this,arguments),this},off:function(n,y,h){return this.getEventManager().off.apply(this,arguments),this}}),function(n){let y=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?n():setTimeout(y,9)};y()}(c.init)}).call(typeof window<"u"?window:void 0);const ge={jsplumbSetting:{Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"efContainer",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.1,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},Scope:"jsPlumb_DefaultScope"},jsplumbConnectOptions:{isSource:!0,isTarget:!0,anchor:"Continuous",labelStyle:{cssClass:"flowLabel"},emptyLabelStyle:{cssClass:"emptyFlowLabel"}},jsplumbSourceOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!1,connectorStyle:{stroke:"#b1b1b1",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#999999",strokeWidth:1.5}},jsplumbSourceOptions2:{filter:".flow-node-drag",filterExclude:!1,allowLoopback:!0,connector:["Flowchart",{curviness:50}],connectorStyle:{stroke:"#1089ff",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#0d6ecc",strokeWidth:1.5}},jsplumbTargetOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}}};class Mn{constructor(c){this.loadEasyFlowFinish=!1,this.jsplumb=jsPlumb.getInstance(),this.init(c)}init(c){this.jsplumb.ready(()=>{this.jsplumb.importDefaults(ge.jsplumbSetting),this.jsplumb.setSuspendDrawing(!1,!0),this.loadEasyFlow(c),this.loadEasyFlowFinish=!0,this.jsplumb.setContainer(document.querySelector("#efContainer"))})}loadEasyFlow(c){const{nodeList:H,lineList:Q}=c,J=je(ce(ge.jsplumbSourceOptions),{}),X=je(ce(ge.jsplumbTargetOptions),{});for(let r=0;r<H.length;r++){let x=H[r];this.jsplumb.makeSource(x.id,J),this.jsplumb.makeTarget(x.id,X),x.viewOnly||this.jsplumb.draggable(x.id,{containment:"parent"})}for(let r=0;r<Q.length;r++){let x=Q[r],u={source:x.from,target:x.to,label:x.label?x.label:"",connector:x.connector?x.connector:"",anchors:x.anchors?x.anchors:void 0,paintStyle:x.paintStyle?x.paintStyle:void 0};this.jsplumb.connect(u,ge.jsplumbConnectOptions)}}getConnections(c,H){return this.jsplumb.getConnections({source:c,target:H})[0]}deleteConnection(c,H){const Q=this.getConnections(c,H);this.jsplumb.deleteConnection(Q)}removeAllEndpoints(c){this.jsplumb.removeAllEndpoints(c)}addNode(c){const H=je(ce(ge.jsplumbSourceOptions),{}),Q=je(ce(ge.jsplumbTargetOptions),{});this.jsplumb.makeSource(c,H),this.jsplumb.makeTarget(c,Q),this.jsplumb.draggable(c,{containment:"parent"})}repaint(){this.jsplumb.repaint()}}let Ln={name:"流程A",nodeList:[{id:"nodeA",name:"流程A-节点A",type:"switch",left:"26px",top:"161px"},{id:"nodeB",name:"流程A-节点B",type:"common",left:"340px",top:"161px"},{id:"nodeC",name:"流程A-节点C",type:"common",left:"739px",top:"161px"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},Tn={name:"流程B",nodeList:[{id:"nodeA",name:"节点A-不可拖拽",type:"common",left:"18px",top:"223px",ico:"user",state:"success",viewOnly:!0},{id:"nodeB",type:"common",name:"流程B-节点B",left:"351px",top:"96px",ico:"bug",state:"error"},{id:"nodeC",name:"流程B-节点C",type:"common",left:"354px",top:"351px",ico:"index",state:"warning"},{id:"nodeD",name:"流程B-节点D",type:"common",left:"723px",top:"215px",ico:"printer",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"条件A"},{from:"nodeA",to:"nodeC",label:"条件B"},{from:"nodeB",to:"nodeD"},{from:"nodeC",to:"nodeD"}]},Fn={name:"流程C",nodeList:[{id:"nodeA",name:"流程C-节点A",type:"common",left:"400px",top:"15px",ico:"smile"},{id:"nodeB",name:"流程C-节点B",type:"common",left:"400px",top:"200px",ico:"smile"},{id:"nodeC",name:"流程C-节点C",type:"common",left:"400px",top:"378px",ico:"smile"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},Nn={name:"流程D",nodeList:[{id:"nodeA",name:"流程D-节点A",type:"common",left:"18px",top:"223px",ico:"smile",state:"success"},{id:"nodeB",type:"common",name:"流程D-节点B",left:"351px",top:"96px",ico:"smile",state:"error"},{id:"nodeC",name:"流程D-节点C",type:"common",left:"354px",top:"351px",ico:"smile",state:"warning"},{id:"nodeD",name:"流程D-节点D",type:"common",left:"723px",top:"215px",ico:"smile",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"直线,自定义线样式,固定锚点",connector:"Straight",anchors:["Top","Bottom"],paintStyle:{strokeWidth:2,stroke:"#1879FF"}},{from:"nodeA",to:"nodeC",label:"贝塞尔曲线,固定锚点",connector:"Bezier",anchors:["Bottom","Left"]},{from:"nodeB",to:"nodeD",label:"流程图线,动态锚点",connector:["Flowchart",{curviness:50}]},{from:"nodeC",to:"nodeD",label:"状态机,动态锚点",connector:["StateMachine",{margin:8,curviness:10,proximityLimit:80}]},{from:"nodeC",to:"nodeC",label:"自连接"}]};function Gn(q="dataB"){return ce({dataA:Ln,dataB:Tn,dataC:Fn,dataD:Nn}[q])}const Rn={class:"ef-toolbar"},Bn={style:{float:"right","margin-right":"5px"}},Un={key:0,class:"easy-flow"},Hn={class:"left-side"},Vn={class:"right-side"},Yn={name:"EasyFlow"},Xn=Object.assign(Yn,{props:{height:{type:String,default:"100%"},repeat:{type:Boolean,default:!0}},setup(q){const c=q,H=Jt(!1),Q=Jt(null),J=Jt(null),X=Jt(!1),r=Jt(!1),x=Jt({nodeList:[],lineList:[]}),u=Jt({type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}),t=Ge({show:!1,type:"",left:0,top:0});let g;He(()=>{P("dataA")});function S(a,f){const{lineList:A}=x.value;return A.findIndex(F=>F.from===a&&F.to===f)>-1}function j(a,f){return S(f,a)}async function P(a){const f=Gn(a);u.value.type="node",u.value.nodeId="",H.value=!1,x.value={nodeList:[],lineList:[]},await we(),H.value=!0,x.value=ce(f),await we(),I()}function I(){g=new Mn(x.value),g.jsplumb.bind("click",h),g.jsplumb.bind("connection",M),g.jsplumb.bind("connectionDetached",p),g.jsplumb.bind("connectionMoved",v),g.jsplumb.bind("contextmenu",(a,f)=>{f.preventDefault(),n(a,f)}),g.jsplumb.bind("beforeDrop",D),console.log("----------new plumb----------",g)}function s(){}function l(a){u.value.type="node",u.value.nodeId=a,Q.value.nodeInit(x.value,a)}function N(a){const{nodeList:f}=x.value;for(let A=0;A<f.length;A++){let F=f[A];F.id===a.nodeId&&(F.left=a.left,F.top=a.top)}}function G(a){const f=x.value.nodeList.findIndex(A=>A.id===a);x.value.nodeList.splice(f,1),we(()=>{g.removeAllEndpoints(a)})}function U(){const{type:a,nodeId:f,sourceId:A,targetId:F}=u.value;Xe.confirm({type:"warning",title:"提示",message:`确定删除当前选中的${a==="node"?"节点":"连接线"}吗?`}).then(()=>{a==="node"?G(f):a==="line"&&g.deleteConnection(A,F)}).catch(()=>{})}function O(a){a.preventDefault();let f=a.dataTransfer.getData("node"),A={};try{A=JSON.parse(f)}catch{console.log("drag data is not right json!");return}const F=J.value.getBoundingClientRect(),i=a.clientX,e=a.clientY,d=i-F.x+J.value.scrollLeft-85,E=e-F.y+J.value.scrollTop-16;let w=A.name,B=w,W=A.id;if(c.repeat){let V=1;for(;V<1e4;){let ot=!1;for(let ct=0;ct<x.value.nodeList.length;ct++)x.value.nodeList[ct].name===B&&(B=w+V,ot=!0);if(ot){V++;continue}break}W=Ye()}const Y={id:W,name:B,type:A.type,left:d+"px",top:E+"px",ico:A.ico};x.value.nodeList.push(Y),we(()=>g.addNode(W))}function b(a,f){l(a),t.show=!0,t.type="node",t.left=f.clientX+"px",t.top=f.clientY+"px"}function n(a,f){h(a),t.show=!0,t.type="line",t.left=f.clientX+"px",t.top=f.clientY+"px"}function y(){t.show=!1}Re(()=>t.show,a=>{a?document.body.addEventListener("click",y):document.body.removeEventListener("click",y)});function h(a){u.value.type="line",u.value.sourceId=a.sourceId,u.value.targetId=a.targetId,Q.value.lineInit(x.value,{from:a.sourceId,to:a.targetId,label:a.getLabel()})}function D(a){const{sourceId:f,targetId:A}=a;return f===A?!1:S(f,A)?(Ae.error("该关系已存在,不允许重复创建"),!1):j(f,A)?(Ae.error("不支持两个节点之间连线回环"),!1):(Ae.success("连接成功"),!0)}function M(a){const{sourceId:f,targetId:A}=a;g.loadEasyFlowFinish&&x.value.lineList.push({from:f,to:A})}function p(a){const{sourceId:f,targetId:A}=a,F=x.value.lineList.findIndex(i=>i.from===f&&i.to===A);x.value.lineList.splice(F,1)}function v(a){const{originalSourceId:f,originalTargetId:A}=a,F=x.value.lineList.findIndex(i=>i.from===f&&i.to===A);x.value.lineList.splice(F,1)}function _({from:a,to:f,label:A}){let F=g.getConnections(a,f);!A||A===""?(F.removeClass("flowLabel"),F.addClass("emptyFlowLabel")):F.addClass("flowLabel"),F.setLabel({label:A}),x.value.lineList.forEach(i=>{i.from===a&&i.to===f&&(i.label=A)})}function L(){g.repaint()}function m(){u.value={type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}}return(a,f)=>{const A=Ot("b-button"),F=Ot("b-divider"),i=Ot("b-dropdown-item"),e=Ot("b-dropdown-menu"),d=Ot("b-dropdown"),E=Ve("flow-drag");return wt(),At("div",{class:"easy-flow-container",style:Ie({height:q.height})},[Et("div",Rn,[bt(A,{type:"text"},{default:xt(()=>[Nt(oe(x.value.name),1)]),_:1}),bt(F,{type:"vertical"}),bt(A,{type:"text",icon:"delete",onClick:U,disabled:!u.value.type},null,8,["disabled"]),Et("div",Bn,[bt(A,{size:"small",type:"info",plain:"",icon:"filedone",onClick:f[0]||(f[0]=w=>X.value=!0)},{default:xt(()=>f[5]||(f[5]=[Nt(" 流程信息 ")])),_:1}),bt(d,{trigger:"click",style:{margin:"0 10px"},onCommand:P},{dropdown:xt(()=>[bt(e,null,{default:xt(()=>[bt(i,{name:"dataA"},{default:xt(()=>f[7]||(f[7]=[Nt("dataA")])),_:1}),bt(i,{name:"dataB"},{default:xt(()=>f[8]||(f[8]=[Nt("dataB")])),_:1}),bt(i,{name:"dataC"},{default:xt(()=>f[9]||(f[9]=[Nt("dataC")])),_:1}),bt(i,{name:"dataD"},{default:xt(()=>f[10]||(f[10]=[Nt("dataD")])),_:1})]),_:1})]),default:xt(()=>[bt(A,{size:"small",type:"info",plain:"",icon:"database"},{default:xt(()=>f[6]||(f[6]=[Nt("数据源")])),_:1})]),_:1}),bt(A,{size:"small",type:"info",plain:"",icon:"book",onClick:f[1]||(f[1]=w=>r.value=!0)},{default:xt(()=>f[11]||(f[11]=[Nt(" 帮助 ")])),_:1})])]),H.value?(wt(),At("div",Un,[Et("div",Hn,[bt(dn,{repeat:q.repeat,data:x.value},null,8,["repeat","data"])]),Rt((wt(),At("div",{class:"canvas-side",id:"efContainer",ref_key:"efContainer",ref:J,onClick:Oe(s,["self"]),onDragover:f[2]||(f[2]=Oe(()=>{},["prevent"])),onDrop:O},[(wt(!0),At(ie,null,ye(x.value.nodeList,w=>(wt(),he(en,{key:w.id,id:w.id,node:w,activeElement:u.value,onClickNode:l,onChangeNodeSite:N,onNodeRightMenu:b},null,8,["id","node","activeElement"]))),128)),f[12]||(f[12]=Et("div",{class:"move-grid",style:{position:"absolute",top:"2000px",left:"2000px"}}," ",-1))],32)),[[E]]),Et("div",Vn,[bt(Cn,{ref_key:"nodeFormRef",ref:Q,onSetLineLabel:_,onSaveNode:L,onCancelSelect:m},null,512)]),bt(Sn,{modelValue:X.value,"onUpdate:modelValue":f[3]||(f[3]=w=>X.value=w),data:x.value},null,8,["modelValue","data"]),bt(En,{data:t,onDelete:U},null,8,["data"])])):se("",!0),bt(In,{modelValue:r.value,"onUpdate:modelValue":f[4]||(f[4]=w=>r.value=w)},null,8,["modelValue"])],4)}}}),Wn=be(Xn,[["__scopeId","data-v-afc1a08e"]]),zn={class:"p16 wrapper"},Kn={__name:"index",setup(q){return(c,H)=>(wt(),At("div",zn,[bt(Wn)]))}};export{Kn as default};
