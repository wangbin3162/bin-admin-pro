import{k as D,h as U}from"./index-80424e34.js";import{P as q}from"./page-wrapper-16ef4118.js";import{B as E}from"./index-fb33e742.js";import{I as K}from"./iconfont-22d951ec.js";import{a5 as L,a as w,o as C,f as I,d as o,I as n,A as u,u as t,e as R,w as j,M as z,z as A,q as _,t as W,c as G,a9 as H,aa as J}from"./vendor-e04737d2.js";import{u as O}from"./useForm-6954fee6.js";import{a as Q}from"./chunk-bin-ui-next-cc573c7a.js";import"./chunk-brace-34d79ec3.js";function X(){return D({url:"/menu/tree",method:"get"})}const Y={name:"Menu",components:{Iconfont:K,BaseTree:E,PageWrapper:q},setup(){const s=w(null),a=w(null),i=w({}),e=w({}),{formRef:T,editStatus:F,pageStatus:p,editLoading:f,openCreate:S,openEdit:b,backNormal:m,submitForm:c,resetForm:v}=O();function y(r,d){r.selected?(a.value=r,e.value=d,x()):k()}function V(r){if(r==="root"&&g(),r==="child"){g();const d=a.value;i.value.parentPath=d.path,i.value.parentName=d.title}}function h(r="edit"){if(r==="edit"){const d=e.value,B=a.value,N=d[B.nodeKey].parent,M=N||N===0?d[N].node:{};i.value=B?{...U(B),parentPath:N===0?"":M.path,parentName:M.title}:{};return}i.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function k(){a.value=null,e.value=null,i.value={},m()}function g(){h("create"),S()}function x(){h("edit"),b()}function l(){c(()=>{f.value=!0;const r=p.value;setTimeout(()=>{Q.success(`${r.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),m();const d=a.value?[a.value.nodeKey]:[];s.value&&s.value.reloadTree(d),f.value=!1},1e3)})}function P(){h(F.value),v()}return{treeRef:s,getMenuTree:X,currentNode:a,copyNode:i,handleSelect:y,handleSubmit:l,handleResetForm:P,handleCommand:V,formRef:T,pageStatus:p,editLoading:f,submitForm:c,resetForm:v,ruleValidate:{path:[{required:!0,message:"\u83DC\u5355\u8DEF\u5F84\u5FC5\u586B",trigger:"blur"}],title:[{required:!0,message:"\u83DC\u5355\u540D\u79F0\u5FC5\u586B",trigger:"blur"}]}}}},Z=s=>(H("data-v-12ed773d"),s=s(),J(),s),$={class:"table-menu"},ee=_("\u589E\u52A0\u6839\u8282\u70B9"),te=_("\u589E\u52A0\u5B50\u8282\u70B9"),oe={class:"table-menu-right"},ae={flex:"main:justify cross:center",style:{"font-weight":"normal"}},ne={class:"top"},le=Z(()=>u("span",{class:"ml-5"},"\u7F16\u8F91\u83DC\u5355",-1)),re={style:{position:"relative","min-height":"100px",overflow:"hidden"}},de={style:{position:"absolute",width:"100%"}},se=_("\u70B9\u9009\u5DE6\u4FA7\u90E8\u95E8\uFF0C\u8FDB\u884C\u7F16\u8F91\u64CD\u4F5C"),ce={key:0,class:"pt-8"},ie=_("\u91CD\u7F6E"),ue=_("\u7CFB\u7EDF\u83DC\u5355\u6839\u8282\u70B9\u4E0D\u53EF\u7F16\u8F91");function me(s,a,i,e,T,F){const p=n("b-dropdown-item"),f=n("base-tree"),S=n("iconfont"),b=n("b-alert"),m=n("b-input"),c=n("b-form-item"),v=n("b-icon-select"),y=n("b-button"),V=n("b-form"),h=n("b-col"),k=n("b-row"),g=n("b-card"),x=n("page-wrapper");return C(),I(x,{desc:"\u9875\u9762\u5185\u5BB9\u4E3AMock\u6570\u636E\uFF0C\u4EC5\u4F5C\u793A\u4F8B\u4F7F\u7528\u3002"},{default:o(()=>[u("div",$,[t(f,{ref:"treeRef","tree-title":"\u83DC\u5355\u5217\u8868","show-filter":"","title-key":"title",fetch:e.getMenuTree,onSelectChange:e.handleSelect,onCommand:e.handleCommand},{ctrl:o(()=>[t(p,{name:"root",divided:""},{default:o(()=>[ee]),_:1}),t(p,{name:"child",disabled:!e.currentNode},{default:o(()=>[te]),_:1},8,["disabled"])]),_:1},8,["fetch","onSelectChange","onCommand"]),u("div",oe,[t(g,{bordered:!1,class:"card-panel",shadow:"never"},{header:o(()=>[u("div",ae,[u("div",ne,[t(S,{icon:"menu",color:"primary",bg:"",round:""}),le])])]),default:o(()=>[u("div",re,[t(R,{name:"fade-in"},{default:o(()=>[u("div",de,[j(t(b,null,{default:o(()=>[se]),_:1},512),[[z,e.pageStatus.isNormal]])])]),_:1}),t(R,{name:"fade-transverse"},{default:o(()=>[e.pageStatus.isNormal?G("",!0):(C(),A("div",ce,[e.copyNode.path!=="root"?(C(),I(k,{key:0},{default:o(()=>[t(h,{span:"14"},{default:o(()=>[t(V,{ref:"formRef",model:e.copyNode,rules:e.ruleValidate,"label-width":"100px","label-suffix":":"},{default:o(()=>[t(c,{label:"\u7236\u7EA7\u83DC\u5355"},{default:o(()=>[t(m,{modelValue:e.copyNode.parentName,"onUpdate:modelValue":a[0]||(a[0]=l=>e.copyNode.parentName=l),disabled:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u83DC\u5355\u540D\u79F0",prop:"title"},{default:o(()=>[t(m,{modelValue:e.copyNode.title,"onUpdate:modelValue":a[1]||(a[1]=l=>e.copyNode.title=l),placeholder:"\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u83DC\u5355\u8DEF\u5F84",prop:"path"},{default:o(()=>[t(m,{modelValue:e.copyNode.path,"onUpdate:modelValue":a[2]||(a[2]=l=>e.copyNode.path=l),placeholder:"\u8F93\u5165\u83DC\u5355\u8DEF\u5F84",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u83DC\u5355\u56FE\u6807"},{default:o(()=>[t(v,{modelValue:e.copyNode.icon,"onUpdate:modelValue":a[3]||(a[3]=l=>e.copyNode.icon=l)},null,8,["modelValue"])]),_:1}),t(c,null,{default:o(()=>[t(y,{type:"primary",onClick:e.handleSubmit,loading:e.editLoading},{default:o(()=>[_(W(e.pageStatus.isCreate?"\u63D0\u4EA4\u6570\u636E":"\u66F4\u65B0\u6570\u636E"),1)]),_:1},8,["onClick","loading"]),t(y,{onClick:e.handleResetForm},{default:o(()=>[ie]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})):(C(),I(b,{key:1,type:"error","show-icon":""},{default:o(()=>[ue]),_:1}))]))]),_:1})])]),_:1})])])]),_:1})}var Ne=L(Y,[["render",me],["__scopeId","data-v-12ed773d"]]);export{Ne as default};
