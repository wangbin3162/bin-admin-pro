import{l as ae,k as ue,o as Bt,a as Xt,b as Ot,f as Ne,a1 as ce,t as xe,g as Zt,v as ne,h as ke,q as Ae,E as It,e as je,w as wt,c as _t,a3 as He,a9 as De,F as Me,O as Oe,m as Gt,A as Re,ac as Ge,ad as Be,T as Ve,B as Ye,n as Ee,K as Xe,N as We,j as ze}from"./vendor-f584ffdc.js";import{m as le,n as Se,o as qe}from"./index-be91493d.js";import{a as we,M as $e}from"./chunk-bin-ui-next-9b299e9d.js";import"./chunk-brace-3ad28406.js";const Ke=Ot("div",{class:"ef-node-left"},null,-1),Ze={class:"ef-node-left-ico flow-node-drag"},Je={class:"ef-node-text","show-overflow-tooltip":""},Qe={class:"ef-node-right-ico"},tn={class:"b-iconfont b-icon-check-circle"},en={class:"b-iconfont b-icon-error"},nn={class:"b-iconfont b-icon-warning-circle"},sn={class:"b-iconfont b-icon-loading"},on={__name:"flow-node",props:{node:{type:Object,default:()=>({})},activeElement:Object},emits:["clickNode","changeNodeSite","nodeRightMenu"],setup(q,{emit:f}){const U=q,J=ae(null),Y=ue(()=>({top:U.node.top,left:U.node.left})),$=ue(()=>({"ef-node-container":!0,"ef-node-active":U.activeElement.type==="node"?U.activeElement.nodeId===U.node.id:!1})),l=ue(()=>{const m={};return m[`b-iconfont b-icon-${U.node.ico}`]=!0,m["flow-node-drag"]=!U.node.viewOnly,m});function O(){f("clickNode",U.node.id)}function a(){const{left:m,top:y}=U.node,j=J.value.style;if(m===j.left&&y===j.top)return;const x={nodeId:U.node.id,left:j.left,top:j.top};f("changeNodeSite",x)}function t(m){f("nodeRightMenu",U.node.id,m)}return(m,y)=>(Bt(),Xt("div",{ref_key:"nodeRef",ref:J,style:ke(ce(Y)),class:Ne(ce($)),onClick:O,onMouseup:a,onContextmenu:y[0]||(y[0]=Ae(j=>t(j),["stop","prevent"]))},[Ke,Ot("div",Ze,[Ot("i",{class:Ne(ce(l))},null,2)]),Ot("div",Je,xe(q.node.name),1),Ot("div",Qe,[Zt(Ot("i",tn,null,512),[[ne,q.node.state==="success"]]),Zt(Ot("i",en,null,512),[[ne,q.node.state==="error"]]),Zt(Ot("i",nn,null,512),[[ne,q.node.state==="warning"]]),Zt(Ot("i",sn,null,512),[[ne,q.node.state==="running"]])])],38))}},rn={__name:"flow-info",props:{data:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(q,{emit:f}){const U=q,J=ue({get:()=>U.modelValue,set:Y=>f("update:modelValue",Y)});return(Y,$)=>{const l=It("b-ace-editor"),O=It("b-modal");return Bt(),je(O,{modelValue:ce(J),"onUpdate:modelValue":$[0]||($[0]=a=>He(J)?J.value=a:null),title:"\u6D41\u7A0B\u6570\u636E\u4FE1\u606F",width:"680px","destroy-on-close":""},{default:wt(()=>[_t(l,{"model-value":JSON.stringify(q.data,null,2),height:"500px"},null,8,["model-value"])]),_:1},8,["modelValue"])}}};const an={class:"flow-menu",ref:"tool"},ln={class:"ef-node-menu-ul"},un=["type","onDragstart"],cn={__name:"flow-menu",props:{menuList:{type:Array,default:()=>[{id:"11",type:"task",name:"\u6570\u636E\u63A5\u5165",ico:"Field-time",style:{}},{id:"12",type:"task",name:"\u63A5\u53E3\u8C03\u7528",ico:"index",style:{}},{id:"21",type:"task",name:"\u6D41\u7A0B\u7ED3\u675F",ico:"caret-right",style:{}},{id:"22",type:"task",name:"\u6570\u636E\u6E05\u7406",ico:"clear",style:{}}]}},setup(q){function f(U,J){U.dataTransfer.setData("node",JSON.stringify(J))}return(U,J)=>{const Y=It("b-icon");return Bt(),Xt("div",an,[Ot("ul",ln,[(Bt(!0),Xt(Me,null,Oe(q.menuList,$=>(Bt(),Xt("li",{class:"ef-node-menu-li",key:$.id,type:$.type,draggable:"true",onDragstart:l=>f(l,$)},[_t(Y,{name:$.ico},null,8,["name"]),Gt(" "+xe($.name),1)],40,un))),128))])],512)}}},hn=De(cn,[["__scopeId","data-v-c97a791b"]]);const fn=q=>(Ge("data-v-57b7f2f8"),q=q(),Be(),q),dn={class:"ef-node-form"},pn=fn(()=>Ot("div",{class:"ef-node-form-header"},"\u7F16\u8F91",-1)),gn={class:"ef-node-form-body"},vn={class:"empty"},mn={__name:"flow-form",emits:["setLineLabel","saveNode","cancelSelect"],setup(q,{expose:f,emit:U}){const J=[{state:"success",label:"\u6210\u529F"},{state:"warning",label:"\u8B66\u544A"},{state:"error",label:"\u9519\u8BEF"},{state:"running",label:"\u8FD0\u884C\u4E2D"}],Y=Re({type:"node",node:{},line:{},data:{}}),$=ue(()=>Object.keys(Y.node).length===0&&Object.keys(Y.line).length===0);function l(y,j){Y.type="node",Y.data=y,y.nodeList.forEach(x=>{x.id===j&&(Y.node=le(x))})}function O(y,j){Y.type="line",Y.data=y,Y.line=j}function a(){U("setLineLabel",Y.line)}function t(){Y.data.nodeList.forEach(y=>{y.id===Y.node.id&&(y.name=Y.node.name,y.left=Y.node.left,y.top=Y.node.top,y.ico=Y.node.ico,y.state=Y.node.state,U("saveNode"))})}function m(){Y.type="node",Y.node={},Y.line={},Y.data={},U("cancelSelect")}return f({nodeInit:l,lineInit:O}),(y,j)=>{const x=It("b-input"),T=It("b-form-item"),s=It("b-icon-select"),c=It("b-option"),F=It("b-select"),G=It("b-button"),B=It("b-form"),M=It("b-ace-editor");return Bt(),Xt("div",dn,[pn,Ot("div",gn,[Zt(Ot("div",vn,"\u6682\u672A\u9009\u62E9\u5143\u7D20",512),[[ne,ce($)]]),Zt(_t(B,{model:Y.node,ref:"dataForm","label-width":"80px"},{default:wt(()=>[_t(T,{label:"\u7C7B\u578B"},{default:wt(()=>[_t(x,{modelValue:Y.node.type,"onUpdate:modelValue":j[0]||(j[0]=b=>Y.node.type=b),disabled:!0},null,8,["modelValue"])]),_:1}),_t(T,{label:"\u540D\u79F0"},{default:wt(()=>[_t(x,{modelValue:Y.node.name,"onUpdate:modelValue":j[1]||(j[1]=b=>Y.node.name=b),clearable:""},null,8,["modelValue"])]),_:1}),_t(T,{label:"left\u5750\u6807"},{default:wt(()=>[_t(x,{modelValue:Y.node.left,"onUpdate:modelValue":j[2]||(j[2]=b=>Y.node.left=b),disabled:!0},null,8,["modelValue"])]),_:1}),_t(T,{label:"top\u5750\u6807"},{default:wt(()=>[_t(x,{modelValue:Y.node.top,"onUpdate:modelValue":j[3]||(j[3]=b=>Y.node.top=b),disabled:!0},null,8,["modelValue"])]),_:1}),_t(T,{label:"ico\u56FE\u6807"},{default:wt(()=>[_t(s,{modelValue:Y.node.ico,"onUpdate:modelValue":j[4]||(j[4]=b=>Y.node.ico=b)},null,8,["modelValue"])]),_:1}),_t(T,{label:"\u72B6\u6001"},{default:wt(()=>[_t(F,{modelValue:Y.node.state,"onUpdate:modelValue":j[5]||(j[5]=b=>Y.node.state=b),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:wt(()=>[(Bt(),Xt(Me,null,Oe(J,b=>_t(c,{key:b.state,label:b.label,value:b.state},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),_t(T,null,{default:wt(()=>[_t(G,{icon:"close",onClick:m},{default:wt(()=>[Gt("\u53D6\u6D88")]),_:1}),_t(G,{type:"primary",icon:"check",onClick:t},{default:wt(()=>[Gt("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1},8,["model"]),[[ne,Y.type==="node"&&Y.node.type]]),Zt(_t(B,{model:Y.line,ref:"dataForm","label-width":"80px"},{default:wt(()=>[_t(T,{label:"\u7C7B\u578B"},{default:wt(()=>[_t(x,{modelValue:Y.type,"onUpdate:modelValue":j[6]||(j[6]=b=>Y.type=b),disabled:!0},null,8,["modelValue"])]),_:1}),_t(T,{label:"\u6761\u4EF6"},{default:wt(()=>[_t(x,{modelValue:Y.line.label,"onUpdate:modelValue":j[7]||(j[7]=b=>Y.line.label=b),clearable:""},null,8,["modelValue"])]),_:1}),_t(T,null,{default:wt(()=>[_t(G,{icon:"close",onClick:m},{default:wt(()=>[Gt("\u53D6\u6D88")]),_:1}),_t(G,{type:"primary",icon:"check",onClick:a},{default:wt(()=>[Gt("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1},8,["model"]),[[ne,Y.type==="line"]]),_t(M,{"model-value":JSON.stringify(Y,null,2),height:"200px"},null,8,["model-value"])])])}}},bn=De(mn,[["__scopeId","data-v-57b7f2f8"]]);const yn={__name:"context-menu",props:{data:{type:Object,default:()=>({})}},emits:["delete"],setup(q,{emit:f}){const U=q,J=ue(()=>U.data.show),Y=ue(()=>({left:U.data.left,top:U.data.top}));function $(){f("delete")}return(l,O)=>{const a=It("b-icon");return Bt(),je(Ve,{name:"zoom-in-top"},{default:wt(()=>[Zt(Ot("ul",{class:"contextmenu",style:ke(ce(Y))},[Ot("li",{onClick:$},[_t(a,{name:"delete"}),Gt(" \u5220\u9664"+xe(q.data.type==="line"?"\u7EBF":"\u8282\u70B9"),1)])],4),[[ne,ce(J)]])]),_:1})}}},_n=De(yn,[["__scopeId","data-v-0320e6da"]]);(function(){typeof Math.sgn>"u"&&(Math.sgn=function(u){return u==0?0:u>0?1:-1});var q={subtract:function(u,d){return{x:u.x-d.x,y:u.y-d.y}},dotProduct:function(u,d){return u.x*d.x+u.y*d.y},square:function(u){return Math.sqrt(u.x*u.x+u.y*u.y)},scale:function(u,d){return{x:u.x*d,y:u.y*d}}},f=64,U=Math.pow(2,-f-1),J=function(u,d){for(var P=[],k=$(u,d),N=d.length-1,i=2*N-1,e=l(k,i,P,0),n=q.subtract(u,d[0]),A=q.square(n),S=0,R=0;R<e;R++){n=q.subtract(u,m(d,N,P[R],null,null));var V=q.square(n);V<A&&(A=V,S=P[R])}return n=q.subtract(u,d[N]),V=q.square(n),V<A&&(A=V,S=1),{location:S,distance:A}},Y=function(u,d){var P=J(u,d);return{point:m(d,d.length-1,P.location,null,null),location:P.location}},$=function(u,d){for(var P=d.length-1,k=2*P-1,N=[],i=[],e=[],n=[],A=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],S=0;S<=P;S++)N[S]=q.subtract(d[S],u);for(var S=0;S<=P-1;S++)i[S]=q.subtract(d[S+1],d[S]),i[S]=q.scale(i[S],3);for(var R=0;R<=P-1;R++)for(var V=0;V<=P;V++)e[R]||(e[R]=[]),e[R][V]=q.dotProduct(i[R],N[V]);for(S=0;S<=k;S++)n[S]||(n[S]=[]),n[S].y=0,n[S].x=parseFloat(S)/k;for(var z=P,X=P-1,nt=0;nt<=z+X;nt++){var pt=Math.max(0,nt-X),ft=Math.min(nt,z);for(S=pt;S<=ft;S++){var it=nt-S;n[S+it].y+=e[it][S]*A[it][S]}}return n},l=function(u,d,P,k){var N=[],i=[],e,n,A=[],S=[];switch(O(u,d)){case 0:return 0;case 1:{if(k>=f)return P[0]=(u[0].x+u[d].x)/2,1;if(a(u,d))return P[0]=t(u,d),1;break}}m(u,d,.5,N,i),e=l(N,d,A,k+1),n=l(i,d,S,k+1);for(var R=0;R<e;R++)P[R]=A[R];for(var R=0;R<n;R++)P[R+e]=S[R];return e+n},O=function(u,d){var P=0,k,N;k=N=Math.sgn(u[0].y);for(var i=1;i<=d;i++)k=Math.sgn(u[i].y),k!=N&&P++,N=k;return P},a=function(u,d){var P,k,N,i,e,n,A,S,R,V,z,X,nt,pt,ft,it;n=u[0].y-u[d].y,A=u[d].x-u[0].x,S=u[0].x*u[d].y-u[d].x*u[0].y;var st,ht;st=ht=0;for(var dt=1;dt<d;dt++){var at=n*u[dt].x+A*u[dt].y+S;at>st?st=at:at<ht&&(ht=at)}return z=0,X=1,nt=0,pt=n,ft=A,it=S-st,R=z*ft-pt*X,V=1/R,k=(X*it-ft*nt)*V,pt=n,ft=A,it=S-ht,R=z*ft-pt*X,V=1/R,N=(X*it-ft*nt)*V,i=Math.min(k,N),e=Math.max(k,N),P=e-i,P<U?1:0},t=function(u,d){var P=1,k=0,N=u[d].x-u[0].x,i=u[d].y-u[0].y,e=u[0].x-0,n=u[0].y-0,A=N*k-i*P,S=1/A,R=(N*n-i*e)*S;return 0+P*R},m=function(u,d,P,k,N){for(var i=[[]],e=0;e<=d;e++)i[0][e]=u[e];for(var n=1;n<=d;n++)for(var e=0;e<=d-n;e++)i[n]||(i[n]=[]),i[n][e]||(i[n][e]={}),i[n][e].x=(1-P)*i[n-1][e].x+P*i[n-1][e+1].x,i[n][e].y=(1-P)*i[n-1][e].y+P*i[n-1][e+1].y;if(k!=null)for(e=0;e<=d;e++)k[e]=i[e][0];if(N!=null)for(e=0;e<=d;e++)N[e]=i[d-e][e];return i[d][0]},y={},j=function(u){var d=y[u];if(!d){d=[];var P=function(){return function(V){return Math.pow(V,u)}},k=function(){return function(V){return Math.pow(1-V,u)}},N=function(V){return function(z){return V}},i=function(){return function(V){return V}},e=function(){return function(V){return 1-V}},n=function(V){return function(z){for(var X=1,nt=0;nt<V.length;nt++)X=X*V[nt](z);return X}};d.push(new P);for(var A=1;A<u;A++){for(var S=[new N(u)],R=0;R<u-A;R++)S.push(new i);for(var R=0;R<A;R++)S.push(new e);d.push(new n(S))}d.push(new k),y[u]=d}return d},x=function(u,d){for(var P=j(u.length-1),k=0,N=0,i=0;i<u.length;i++)k=k+u[i].x*P[i](d),N=N+u[i].y*P[i](d);return{x:k,y:N}},T=function(u,d){return Math.sqrt(Math.pow(u.x-d.x,2)+Math.pow(u.y-d.y,2))},s=function(u){return u[0].x===u[1].x&&u[0].y===u[1].y},c=function(u,d,P){if(s(u))return{point:u[0],location:d};for(var k=x(u,d),N=0,i=d,e=P>0?1:-1,n=null;N<Math.abs(P);)i+=.005*e,n=x(u,i),N+=T(n,k),k=n;return{point:n,location:i}},F=function(u){if(s(u))return 0;for(var d=x(u,0),P=0,k=0,N=1,i=null;k<1;)k+=.005*N,i=x(u,k),P+=T(i,d),d=i;return P},G=function(u,d,P){return c(u,d,P).point},B=function(u,d,P){return c(u,d,P).location},M=function(u,d){var P=x(u,d),k=x(u.slice(0,u.length-1),d),N=k.y-P.y,i=k.x-P.x;return N===0?1/0:Math.atan(N/i)},b=function(u,d,P){var k=c(u,d,P);return k.location>1&&(k.location=1),k.location<0&&(k.location=0),M(u,k.location)},o=function(u,d,P,k){k=k==null?0:k;var N=c(u,d,k),i=M(u,N.location),e=Math.atan(-1/i),n=P/2*Math.sin(e),A=P/2*Math.cos(e);return[{x:N.point.x+A,y:N.point.y+n},{x:N.point.x-A,y:N.point.y-n}]},g=function(u,d,P,k,N){var i=k-d,e=u-P,n=u*(d-k)+d*(P-u),A=p(N),S=[i*A[0][0]+e*A[1][0],i*A[0][1]+e*A[1][1],i*A[0][2]+e*A[1][2],i*A[0][3]+e*A[1][3]+n],R=C.apply(null,S),V=[];if(R!=null)for(var z=0;z<3;z++){var X=R[z],nt=Math.pow(X,2),pt=Math.pow(X,3),ft=[A[0][0]*pt+A[0][1]*nt+A[0][2]*X+A[0][3],A[1][0]*pt+A[1][1]*nt+A[1][2]*X+A[1][3]],it;P-u!==0?it=(ft[0]-u)/(P-u):it=(ft[1]-d)/(k-d),X>=0&&X<=1&&it>=0&&it<=1&&V.push(ft)}return V},h=function(u,d,P,k,N){var i=[];return i.push.apply(i,g(u,d,u+P,d,N)),i.push.apply(i,g(u+P,d,u+P,d+k,N)),i.push.apply(i,g(u+P,d+k,u,d+k,N)),i.push.apply(i,g(u,d+k,u,d,N)),i},E=function(u,d){var P=[];return P.push.apply(P,g(u.x,u.y,u.x+u.w,u.y,d)),P.push.apply(P,g(u.x+u.w,u.y,u.x+u.w,u.y+u.h,d)),P.push.apply(P,g(u.x+u.w,u.y+u.h,u.x,u.y+u.h,d)),P.push.apply(P,g(u.x,u.y+u.h,u.x,u.y,d)),P};function I(u,d){return[-u[0][d]+3*u[1][d]+-3*u[2][d]+u[3][d],3*u[0][d]-6*u[1][d]+3*u[2][d],-3*u[0][d]+3*u[1][d],u[0][d]]}function p(u){return[I(u,"x"),I(u,"y")]}function v(u){return u<0?-1:u>0?1:0}function C(u,d,P,k){var N=d/u,i=P/u,e=k/u,n=(3*i-Math.pow(N,2))/9,A=(9*N*i-27*e-2*Math.pow(N,3))/54,S=Math.pow(n,3)+Math.pow(A,2),R,V,z=[];if(S>=0)R=v(A+Math.sqrt(S))*Math.pow(Math.abs(A+Math.sqrt(S)),1/3),V=v(A-Math.sqrt(S))*Math.pow(Math.abs(A-Math.sqrt(S)),1/3),z[0]=-N/3+(R+V),z[1]=-N/3-(R+V)/2,z[2]=-N/3-(R+V)/2,Math.abs(Math.sqrt(3)*(R-V)/2)!==0&&(z[1]=-1,z[2]=-1);else{var X=Math.acos(A/Math.sqrt(-Math.pow(n,3)));z[0]=2*Math.sqrt(-n)*Math.cos(X/3)-N/3,z[1]=2*Math.sqrt(-n)*Math.cos((X+2*Math.PI)/3)-N/3,z[2]=2*Math.sqrt(-n)*Math.cos((X+4*Math.PI)/3)-N/3}for(var nt=0;nt<3;nt++)(z[nt]<0||z[nt]>1)&&(z[nt]=-1);return z}var w=this.jsBezier={distanceFromCurve:J,gradientAtPoint:M,gradientAtPointAlongCurveFrom:b,nearestPointOnCurve:Y,pointOnCurve:x,pointAlongCurveFrom:G,perpendicularToCurveAt:o,locationAlongCurveFrom:B,getLength:F,lineIntersection:g,boxIntersection:h,boundingBoxIntersection:E,version:"0.9.0"};typeof exports<"u"&&(exports.jsBezier=w)}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.Biltong={version:"0.4.0"};typeof exports<"u"&&(exports.Biltong=f);var U=function(a){return Object.prototype.toString.call(a)==="[object Array]"},J=function(a,t,m){return a=U(a)?a:[a.x,a.y],t=U(t)?t:[t.x,t.y],m(a,t)},Y=f.gradient=function(a,t){return J(a,t,function(m,y){return y[0]==m[0]?y[1]>m[1]?1/0:-1/0:y[1]==m[1]?y[0]>m[0]?0:-0:(y[1]-m[1])/(y[0]-m[0])})};f.normal=function(a,t){return-1/Y(a,t)},f.lineLength=function(a,t){return J(a,t,function(m,y){return Math.sqrt(Math.pow(y[1]-m[1],2)+Math.pow(y[0]-m[0],2))})};var $=f.quadrant=function(a,t){return J(a,t,function(m,y){return y[0]>m[0]||y[0]==m[0]?y[1]>m[1]?2:1:y[1]>m[1]?3:4})};f.theta=function(a,t){return J(a,t,function(m,y){var j=Y(m,y),x=Math.atan(j),T=$(m,y);return(T==4||T==3)&&(x+=Math.PI),x<0&&(x+=2*Math.PI),x})},f.intersects=function(a,t){var m=a.x,y=a.x+a.w,j=a.y,x=a.y+a.h,T=t.x,s=t.x+t.w,c=t.y,F=t.y+t.h;return m<=T&&T<=y&&j<=c&&c<=x||m<=s&&s<=y&&j<=c&&c<=x||m<=T&&T<=y&&j<=F&&F<=x||m<=s&&T<=y&&j<=F&&F<=x||T<=m&&m<=s&&c<=j&&j<=F||T<=y&&y<=s&&c<=j&&j<=F||T<=m&&m<=s&&c<=x&&x<=F||T<=y&&m<=s&&c<=x&&x<=F},f.encloses=function(a,t,m){var y=a.x,j=a.x+a.w,x=a.y,T=a.y+a.h,s=t.x,c=t.x+t.w,F=t.y,G=t.y+t.h,B=function(M,b,o,g){return m?M<=b&&o>=g:M<b&&o>g};return B(y,s,j,c)&&B(x,F,T,G)};var l=[null,[1,-1],[1,1],[-1,1],[-1,-1]],O=[null,[-1,-1],[-1,1],[1,1],[1,-1]];f.pointOnLine=function(a,t,m){var y=Y(a,t),j=$(a,t),x=m>0?l[j]:O[j],T=Math.atan(y),s=Math.abs(m*Math.sin(T))*x[1],c=Math.abs(m*Math.cos(T))*x[0];return{x:a.x+c,y:a.y+s}},f.perpendicularLineTo=function(a,t,m){var y=Y(a,t),j=Math.atan(-1/y),x=m/2*Math.sin(j),T=m/2*Math.cos(j);return[{x:t.x+T,y:t.y+x},{x:t.x-T,y:t.y-x}]}}).call(typeof window<"u"?window:globalThis);(function(){function q(i,e,n,A,S,R,V,z){return new Touch({target:e,identifier:N(),pageX:n,pageY:A,screenX:S,screenY:R,clientX:V||S,clientY:z||R})}function f(){var i=[];return Array.prototype.push.apply(i,arguments),i.item=function(e){return this[e]},i}function U(i,e,n,A,S,R,V,z){return f(q.apply(null,arguments))}var J=this,Y=function(i,e,n){n=n||i.parentNode;for(var A=n.querySelectorAll(e),S=0;S<A.length;S++)if(A[S]===i)return!0;return!1},$=function(i){return typeof i=="string"||i.constructor===String?document.getElementById(i):i},l=function(i){return i.srcElement||i.target},O=function(i,e,n,A){if(A){if(typeof i.path<"u"&&i.path.indexOf)return{path:i.path,end:i.path.indexOf(n)};var S={path:[],end:-1},R=function(V){S.path.push(V),V===n?S.end=S.path.length-1:V.parentNode!=null&&R(V.parentNode)};return R(e),S}else return{path:[e],end:1}},a=function(i,e){for(var n=0,A=i.length;n<A&&i[n]!=e;n++);n<i.length&&i.splice(n,1)},t=1,m=function(i,e,n){var A=t++;return i.__ta=i.__ta||{},i.__ta[e]=i.__ta[e]||{},i.__ta[e][A]=n,n.__tauid=A,A},y=function(i,e,n){if(i.__ta&&i.__ta[e]&&delete i.__ta[e][n.__tauid],n.__taExtra){for(var A=0;A<n.__taExtra.length;A++)P(i,n.__taExtra[A][0],n.__taExtra[A][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()},j=function(i,e,n,A){if(i==null)return n;var S=i.split(","),R=function(V){R.__tauid=n.__tauid;var z=l(V),X=z,nt=O(V,z,e,i!=null);if(nt.end!=-1)for(var pt=0;pt<nt.end;pt++){X=nt.path[pt];for(var ft=0;ft<S.length;ft++)Y(X,S[ft],e)&&n.apply(X,arguments)}};return x(n,A,R),R},x=function(i,e,n){i.__taExtra=i.__taExtra||[],i.__taExtra.push([e,n])},T=function(i,e,n,A){if(M&&o[e]){var S=j(A,i,n,o[e]);d(i,o[e],S,n)}e==="focus"&&i.getAttribute("tabindex")==null&&i.setAttribute("tabindex","1"),d(i,e,j(A,i,n,e),n)},s=function(i,e,n,A){if(i.__taSmartClicks==null){var S=function(z){i.__tad=I(z)},R=function(z){i.__tau=I(z)},V=function(z){if(i.__tad&&i.__tau&&i.__tad[0]===i.__tau[0]&&i.__tad[1]===i.__tau[1])for(var X=0;X<i.__taSmartClicks.length;X++)i.__taSmartClicks[X].apply(l(z),[z])};T(i,"mousedown",S,A),T(i,"mouseup",R,A),T(i,"click",V,A),i.__taSmartClicks=[]}i.__taSmartClicks.push(n),n.__taUnstore=function(){a(i.__taSmartClicks,n)}},c={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},F=function(i,e){return function(n,A,S,R){if(A=="contextmenu"&&b)T(n,A,S,R);else{if(n.__taTapHandler==null){var V=n.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},z=function(ft){for(var it=l(ft),st=O(ft,it,n,R!=null),ht=!1,dt=0;dt<st.end;dt++){if(ht)return;it=st.path[dt];for(var at=0;at<V.downSelectors.length;at++)if(V.downSelectors[at]==null||Y(it,V.downSelectors[at],n)){V.down=!0,setTimeout(nt,i),setTimeout(pt,e),ht=!0;break}}},X=function(ft){if(V.down){var it=l(ft),st,ht;V.taps++;var dt=u(ft);for(var at in c)if(c.hasOwnProperty(at)){var vt=c[at];if(vt.touches===dt&&(vt.taps===1||vt.taps===V.taps))for(var bt=0;bt<V[at].length;bt++){ht=O(ft,it,n,V[at][bt][1]!=null);for(var Z=0;Z<ht.end;Z++)if(st=ht.path[Z],V[at][bt][1]==null||Y(st,V[at][bt][1],n)){V[at][bt][0].apply(st,[ft]);break}}}}},nt=function(){V.down=!1},pt=function(){V.taps=0};T(n,"mousedown",z),T(n,"mouseup",X)}n.__taTapHandler.downSelectors.push(R),n.__taTapHandler[A].push([S,R]),S.__taUnstore=function(){a(n.__taTapHandler[A],S)}}}},G=function(i,e,n,A){for(var S in n.__tamee[i])n.__tamee[i].hasOwnProperty(S)&&n.__tamee[i][S].apply(A,[e])},B=function(){var i=[];return function(e,n,A,S){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};var R=function(z){var X=l(z);(S==null&&X==e&&!e.__tamee.over||Y(X,S,e)&&(X.__tamee==null||!X.__tamee.over))&&(G("mouseenter",z,e,X),X.__tamee=X.__tamee||{},X.__tamee.over=!0,i.push(X))},V=function(z){for(var X=l(z),nt=0;nt<i.length;nt++)X==i[nt]&&!Y(z.relatedTarget||z.toElement,"*",X)&&(X.__tamee.over=!1,i.splice(nt,1),G("mouseexit",z,e,X))};d(e,"mouseover",j(S,e,R,"mouseover"),R),d(e,"mouseout",j(S,e,V,"mouseout"),V)}A.__taUnstore=function(){delete e.__tamee[n][A.__tauid]},m(e,n,A),e.__tamee[n][A.__tauid]=A}},M="ontouchstart"in document.documentElement,b="onmousedown"in document.documentElement,o={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},g=function(){var i=-1;if(navigator.appName=="Microsoft Internet Explorer"){var e=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),h=g>-1&&g<9,E=function(i,e){if(i==null)return[0,0];var n=w(i),A=C(n,0);return[A[e+"X"],A[e+"Y"]]},I=function(i){return i==null?[0,0]:h?[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop]:E(i,"page")},p=function(i){return E(i,"screen")},v=function(i){return E(i,"client")},C=function(i,e){return i.item?i.item(e):i[e]},w=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},u=function(i){return w(i).length},d=function(i,e,n,A){if(m(i,e,n),A.__tauid=n.__tauid,i.addEventListener)i.addEventListener(e,n,!1);else if(i.attachEvent){var S=e+n.__tauid;i["e"+S]=n,i[S]=function(){i["e"+S]&&i["e"+S](window.event)},i.attachEvent("on"+e,i[S])}},P=function(i,e,n){n!=null&&k(i,function(){var A=$(this);if(y(A,e,n),n.__tauid!=null){if(A.removeEventListener)A.removeEventListener(e,n,!1),M&&o[e]&&A.removeEventListener(o[e],n,!1);else if(this.detachEvent){var S=e+n.__tauid;A[S]&&A.detachEvent("on"+e,A[S]),A[S]=null,A["e"+S]=null}}n.__taTouchProxy&&P(i,n.__taTouchProxy[1],n.__taTouchProxy[0])})},k=function(i,e){if(i!=null){i=typeof Window<"u"&&typeof i.top!="unknown"&&i==i.top?[i]:typeof i!="string"&&i.tagName==null&&i.length!=null?i:typeof i=="string"?document.querySelectorAll(i):[i];for(var n=0;n<i.length;n++)e.apply(i[n])}},N=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var e=Math.random()*16|0,n=i=="x"?e:e&3|8;return n.toString(16)})};J.Mottle=function(i){i=i||{};var e=i.clickThreshold||250,n=i.dblClickThreshold||450,A=new B,S=new F(e,n),R=i.smartClicks,V=function(z,X,nt,pt){nt!=null&&k(z,function(){var ft=$(this);R&&X==="click"?s(ft,X,nt,pt):X==="tap"||X==="dbltap"||X==="contextmenu"?S(ft,X,nt,pt):X==="mouseenter"||X=="mouseexit"?A(ft,X,nt,pt):T(ft,X,nt,pt)})};this.remove=function(z){return k(z,function(){var X=$(this);if(X.__ta){for(var nt in X.__ta)if(X.__ta.hasOwnProperty(nt))for(var pt in X.__ta[nt])X.__ta[nt].hasOwnProperty(pt)&&P(X,nt,X.__ta[nt][pt])}X.parentNode&&X.parentNode.removeChild(X)}),this},this.on=function(z,X,nt,pt){var ft=arguments[0],it=arguments.length==4?arguments[2]:null,st=arguments[1],ht=arguments[arguments.length-1];return V(ft,st,ht,it),this},this.off=function(z,X,nt){return P(z,X,nt),this},this.trigger=function(z,X,nt,pt){var ft=b&&(typeof MouseEvent>"u"||nt==null||nt.constructor===MouseEvent),it=M&&!b&&o[X]?o[X]:X,st=!(M&&!b&&o[X]),ht=I(nt),dt=p(nt),at=v(nt);return k(z,function(){var vt=$(this),bt;nt=nt||{screenX:dt[0],screenY:dt[1],clientX:at[0],clientY:at[1]};var Z=function(gt){pt&&(gt.payload=pt)},K={TouchEvent:function(gt){var Dt=U(window,vt,0,ht[0],ht[1],dt[0],dt[1],at[0],at[1]),Mt=gt.initTouchEvent||gt.initEvent;Mt(it,!0,!0,window,null,dt[0],dt[1],at[0],at[1],!1,!1,!1,!1,Dt,Dt,Dt,1,0)},MouseEvents:function(gt){gt.initMouseEvent(it,!0,!0,window,0,dt[0],dt[1],at[0],at[1],!1,!1,!1,!1,1,vt)}};if(document.createEvent){var Q=!st&&!ft&&M&&o[X],rt=Q?"TouchEvent":"MouseEvents";bt=document.createEvent(rt),K[rt](bt),Z(bt),vt.dispatchEvent(bt)}else document.createEventObject&&(bt=document.createEventObject(),bt.eventType=bt.eventName=it,bt.screenX=dt[0],bt.screenY=dt[1],bt.clientX=at[0],bt.clientY=at[1],Z(bt),vt.fireEvent("on"+it,bt))}),this}},J.Mottle.consume=function(i,e){i.stopPropagation?i.stopPropagation():i.returnValue=!1,!e&&i.preventDefault&&i.preventDefault()},J.Mottle.pageLocation=I,J.Mottle.setForceTouchEvents=function(i){M=i},J.Mottle.setForceMouseEvents=function(i){b=i},J.Mottle.version="0.8.0",typeof exports<"u"&&(exports.Mottle=J.Mottle)}).call(typeof window>"u"?globalThis:window);(function(){var q=this,f=function(i,e,n){return i.indexOf(e)===-1?(n?i.unshift(e):i.push(e),!0):!1},U=function(i,e){var n=i.indexOf(e);n!==-1&&i.splice(n,1)},J=function(i,e){for(var n=[],A=0;A<i.length;A++)e.indexOf(i[A])===-1&&n.push(i[A]);return n},Y=function(i){return i==null?!1:typeof i=="string"||i.constructor===String},$=function(i){var e=i.getBoundingClientRect(),n=document.body,A=document.documentElement,S=window.pageYOffset||A.scrollTop||n.scrollTop,R=window.pageXOffset||A.scrollLeft||n.scrollLeft,V=A.clientTop||n.clientTop||0,z=A.clientLeft||n.clientLeft||0,X=e.top+S-V,nt=e.left+R-z;return{top:Math.round(X),left:Math.round(nt)}},l=function(i,e,n){n=n||i.parentNode;for(var A=n.querySelectorAll(e),S=0;S<A.length;S++)if(A[S]===i)return!0;return!1},O=function(i,e,n){if(l(e,n,i))return e;for(var A=e.parentNode;A!=null&&A!==i;){if(l(A,n,i))return A;A=A.parentNode}},a=function(i,e,n){for(var A=null,S=e.getAttribute("katavorio-draggable"),R=S!=null?"[katavorio-draggable='"+S+"'] ":"",V=0;V<i.length;V++)if(A=O(e,n,R+i[V].selector),A!=null){if(i[V].filter){var z=l(n,i[V].filter,A),X=i[V].filterExclude===!0;if(X&&!z||z)return null}return[i[V],A]}return null},t=function(){var i=-1;if(navigator.appName==="Microsoft Internet Explorer"){var e=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),m=10,y=10,j=t>-1&&t<9,x=t===9,T=function(i){if(j)return[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop];var e=c(i),n=s(e,0);return x?[n.pageX||n.clientX,n.pageY||n.clientY]:[n.pageX,n.pageY]},s=function(i,e){return i.item?i.item(e):i[e]},c=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},F={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},G="katavorio-drag-scope",B=["stop","start","drag","drop","over","out","beforeStart"],M=function(){},b=function(){return!0},o=function(i,e,n){for(var A=0;A<i.length;A++)i[A]!=n&&e(i[A])},g=function(i,e,n,A){o(i,function(S){S.setActive(e),e&&S.updatePosition(),n&&S.setHover(A,e)})},h=function(i,e){if(i!=null){i=!Y(i)&&i.tagName==null&&i.length!=null?i:[i];for(var n=0;n<i.length;n++)e.apply(i[n],[i[n]])}},E=function(i){i.stopPropagation?(i.stopPropagation(),i.preventDefault()):i.returnValue=!1},I="input,textarea,select,button,option",p=function(i,e,n){var A=i.srcElement||i.target;return!l(A,n.getInputFilterSelector(),e)},v=function(i,e,n,A){this.params=e||{},this.el=i,this.params.addClass(this.el,this._class),this.uuid=P();var S=!0;return this.setEnabled=function(R){S=R},this.isEnabled=function(){return S},this.toggleEnabled=function(){S=!S},this.setScope=function(R){this.scopes=R?R.split(/\s+/):[A]},this.addScope=function(R){var V={};h(this.scopes,function(X){V[X]=!0}),h(R?R.split(/\s+/):[],function(X){V[X]=!0}),this.scopes=[];for(var z in V)this.scopes.push(z)},this.removeScope=function(R){var V={};h(this.scopes,function(X){V[X]=!0}),h(R?R.split(/\s+/):[],function(X){delete V[X]}),this.scopes=[];for(var z in V)this.scopes.push(z)},this.toggleScope=function(R){var V={};h(this.scopes,function(X){V[X]=!0}),h(R?R.split(/\s+/):[],function(X){V[X]?delete V[X]:V[X]=!0}),this.scopes=[];for(var z in V)this.scopes.push(z)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},C=function(){return!0},w=function(){return!1},u=function(i,e,n,A){this._class=n.draggable;var S=v.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var R=[0,0],V=null,z=null,X=[0,0],nt=!1,pt=[0,0],ft=this.params.consumeStartEvent!==!1,it=this.el,st=this.params.clone;this.params.scroll;var ht=e.multipleDrop!==!1,dt=!1,at=e.ghostProxy===!0?C:e.ghostProxy&&typeof e.ghostProxy=="function"?e.ghostProxy:w,vt=function(et){return et.cloneNode(!0)},bt=null,Z=[],K=null,Q=e.ghostProxyParent,rt,gt,Dt,Mt;if(e.selector){var $t=i.getAttribute("katavorio-draggable");$t==null&&($t=""+new Date().getTime(),i.setAttribute("katavorio-draggable",$t)),Z.push(e)}var Ut=e.snapThreshold,ie=function(et,Ct,Pt,yt,St){var At=Math.floor(et[0]/Ct),Rt=Ct*At,re=Rt+Ct,r=Math.abs(et[0]-Rt)<=yt?Rt:Math.abs(re-et[0])<=yt?re:et[0],D=Math.floor(et[1]/Pt),_=Pt*D,L=_+Pt,H=Math.abs(et[1]-_)<=St?_:Math.abs(L-et[1])<=St?L:et[1];return[r,H]};this.posses=[],this.posseRoles={},this.toGrid=function(et){if(this.params.grid==null)return et;var Ct=this.params.grid?this.params.grid[0]/2:Ut||m/2,Pt=this.params.grid?this.params.grid[1]/2:Ut||y/2;return ie(et,this.params.grid[0],this.params.grid[1],Ct,Pt)},this.snap=function(et,Ct){if(it!=null){et=et||(this.params.grid?this.params.grid[0]:m),Ct=Ct||(this.params.grid?this.params.grid[1]:y);var Pt=this.params.getPosition(it),yt=this.params.grid?this.params.grid[0]/2:Ut,St=this.params.grid?this.params.grid[1]/2:Ut,At=ie(Pt,et,Ct,yt,St);return this.params.setPosition(it,At),At}},this.setUseGhostProxy=function(et){at=et?C:w};var Wt,zt=function(et){return e.allowNegative===!1?[Math.max(0,et[0]),Math.max(0,et[1])]:et},ve=function(et){Wt=typeof et=="function"?et:et?function(Ct,Pt,yt,St){return zt([Math.max(0,Math.min(yt.w-St[0],Ct[0])),Math.max(0,Math.min(yt.h-St[1],Ct[1]))])}.bind(this):function(Ct){return zt(Ct)}}.bind(this);ve(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(et){ve(et)};var he;this.setRevert=function(et){he=et},this.params.revert&&(he=this.params.revert);var me=function(et){return typeof et=="function"?(et._katavorioId=P(),et._katavorioId):et},Ht={},fe=function(et){for(var Ct in Ht){var Pt=Ht[Ct],yt=Pt[0](et);if(Pt[1]&&(yt=!yt),!yt)return!1}return!0},se=this.setFilter=function(et,Ct){if(et){var Pt=me(et);Ht[Pt]=[function(yt){var St=yt.srcElement||yt.target,At;return Y(et)?At=l(St,et,i):typeof et=="function"&&(At=et(yt,i)),At},Ct!==!1]}};this.addFilter=se,this.removeFilter=function(et){var Ct=typeof et=="function"?et._katavorioId:et;delete Ht[Ct]},this.clearAllFilters=function(){Ht={}},this.canDrag=this.params.canDrag||b;var oe,Tt=[],Yt=[];this.addSelector=function(et){et.selector&&Z.push(et)},this.downListener=function(et){if(!et.defaultPrevented){var Ct=this.rightButtonCanDrag||et.which!==3&&et.button!==2;if(Ct&&this.isEnabled()&&this.canDrag()){var Pt=fe(et)&&p(et,this.el,this.k);if(Pt){if(K=null,bt=null,Z.length>0){var yt=a(Z,this.el,et.target||et.srcElement);if(yt!=null&&(K=yt[0],bt=yt[1]),bt==null)return}else bt=this.el;if(st)if(it=bt.cloneNode(!0),this.params.addClass(it,F.clonedDrag),it.setAttribute("id",null),it.style.position="absolute",this.params.parent!=null){var St=this.params.getPosition(this.el);it.style.left=St[0]+"px",it.style.top=St[1]+"px",this.params.parent.appendChild(it)}else{var At=$(bt);it.style.left=At.left+"px",it.style.top=At.top+"px",document.body.appendChild(it)}else it=bt;ft&&E(et),R=T(et),it&&it.parentNode&&(pt=[it.parentNode.scrollLeft,it.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),S.markSelection(this),S.markPosses(this),this.params.addClass(document.body,n.noSelect),Jt("beforeStart",{el:this.el,pos:V,e:et,drag:this})}else this.params.consumeFilteredEvents&&E(et)}}}.bind(this),this.moveListener=function(et){if(R){if(!nt){var Ct=Jt("start",{el:this.el,pos:V,e:et,drag:this});if(Ct!==!1){if(!R)return;this.mark(!0),nt=!0}else this.abort()}if(R){Yt.length=0;var Pt=T(et),yt=Pt[0]-R[0],St=Pt[1]-R[1],At=this.params.ignoreZoom?1:S.getZoom();it&&it.parentNode&&(yt+=it.parentNode.scrollLeft-pt[0],St+=it.parentNode.scrollTop-pt[1]),yt/=At,St/=At,this.moveBy(yt,St,et),S.updateSelection(yt,St,this),S.updatePosses(yt,St,this)}}}.bind(this),this.upListener=function(et){R&&(R=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,n.noSelect),this.unmark(et),S.unmarkSelection(this,et),S.unmarkPosses(this,et),this.stop(et),S.notifyPosseDragStop(this,et),nt=!1,Yt.length=0,st?(it&&it.parentNode&&it.parentNode.removeChild(it),it=null):he&&he(it,this.params.getPosition(it))===!0&&(this.params.setPosition(it,V),Jt("revert",it)))}.bind(this),this.getFilters=function(){return Ht},this.abort=function(){R!=null&&this.upListener()},this.getDragElement=function(et){return et?bt||this.el:it||this.el};var jt={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};e.events.start&&jt.start.push(e.events.start),e.events.beforeStart&&jt.beforeStart.push(e.events.beforeStart),e.events.stop&&jt.stop.push(e.events.stop),e.events.drag&&jt.drag.push(e.events.drag),e.events.revert&&jt.revert.push(e.events.revert),this.on=function(et,Ct){jt[et]&&jt[et].push(Ct)},this.off=function(et,Ct){if(jt[et]){for(var Pt=[],yt=0;yt<jt[et].length;yt++)jt[et][yt]!==Ct&&Pt.push(jt[et][yt]);jt[et]=Pt}};var Jt=function(et,Ct){var Pt=null;if(K&&K[et])Pt=K[et](Ct);else if(jt[et])for(var yt=0;yt<jt[et].length;yt++)try{var St=jt[et][yt](Ct);St!=null&&(Pt=St)}catch{}return Pt};this.notifyStart=function(et){Jt("start",{el:this.el,pos:this.params.getPosition(it),e:et,drag:this})},this.stop=function(et,Ct){if(Ct||nt){var Pt=[],yt=S.getSelection(),St=this.params.getPosition(it);if(yt.length>0)for(var At=0;At<yt.length;At++){var Rt=this.params.getPosition(yt[At].el);Pt.push([yt[At].el,{left:Rt[0],top:Rt[1]},yt[At]])}else Pt.push([it,{left:St[0],top:St[1]},this]);Jt("stop",{el:it,pos:Qt||St,finalPos:St,e:et,drag:this,selection:Pt})}},this.mark=function(et){V=this.params.getPosition(it),z=this.params.getPosition(it,!0),X=[z[0]-V[0],z[1]-V[1]],this.size=this.params.getSize(it),Tt=S.getMatchingDroppables(this),g(Tt,!0,!1,this),this.params.addClass(it,this.params.dragClass||n.drag);var Ct;this.params.getConstrainingRectangle?Ct=this.params.getConstrainingRectangle(it):Ct=this.params.getSize(it.parentNode),oe={w:Ct[0],h:Ct[1]},Dt=0,Mt=0,et&&S.notifySelectionDragStart(this)};var Qt;this.unmark=function(et,Ct){if(g(Tt,!1,!0,this),dt&&at(bt,it)?(Qt=[it.offsetLeft-Dt,it.offsetTop-Mt],it.parentNode.removeChild(it),it=bt):Qt=null,this.params.removeClass(it,this.params.dragClass||n.drag),Tt.length=0,dt=!1,!Ct){Yt.length>0&&Qt&&e.setPosition(bt,Qt),Yt.sort(k);for(var Pt=0;Pt<Yt.length;Pt++){var yt=Yt[Pt].drop(this,et);if(yt===!0)break}}},this.moveBy=function(et,Ct,Pt){Yt.length=0;var yt=this.toGrid([V[0]+et,V[1]+Ct]),St=Wt(yt,it,oe,this.size);if(at(this.el,it))if(yt[0]!==St[0]||yt[1]!==St[1]){if(!dt){var At=vt(bt);e.addClass(At,F.ghostProxy),Q?(Q.appendChild(At),rt=e.getPosition(bt.parentNode,!0),gt=e.getPosition(e.ghostProxyParent,!0),Dt=rt[0]-gt[0],Mt=rt[1]-gt[1]):bt.parentNode.appendChild(At),it=At,dt=!0}St=yt}else dt&&(it.parentNode.removeChild(it),it=bt,dt=!1,rt=null,gt=null,Dt=0,Mt=0);var Rt={x:St[0],y:St[1],w:this.size[0],h:this.size[1]},re={x:Rt.x+X[0],y:Rt.y+X[1],w:Rt.w,h:Rt.h},r=null;this.params.setPosition(it,[St[0]+Dt,St[1]+Mt]);for(var D=0;D<Tt.length;D++){var _={x:Tt[D].pagePosition[0],y:Tt[D].pagePosition[1],w:Tt[D].size[0],h:Tt[D].size[1]};this.params.intersects(re,_)&&(ht||r==null||r===Tt[D].el)&&Tt[D].canDrop(this)?(r||(r=Tt[D].el),Yt.push(Tt[D]),Tt[D].setHover(this,!0,Pt)):Tt[D].isHover()&&Tt[D].setHover(this,!1,Pt)}Jt("drag",{el:this.el,pos:St,e:Pt,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?se(this.params.handle,!1):se(this.params.filter,this.params.filterExclude)},d=function(i,e,n,A){this._class=n.droppable,this.params=e||{},this.rank=e.rank||0,this._activeClass=this.params.activeClass||n.active,this._hoverClass=this.params.hoverClass||n.hover,v.apply(this,arguments);var S=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(R){this.params[R?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(R){return!0},this.isHover=function(){return S},this.setHover=function(R,V,z){(V||this.el._katavorioDragHover==null||this.el._katavorioDragHover===R.el._katavorio)&&(this.params[V?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=V?R.el._katavorio:null,S!==V&&this.params.events[V?"over":"out"]({el:this.el,e:z,drag:R,drop:this}),S=V)},this.drop=function(R,V){return this.params.events.drop({drag:R,e:V,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,S=null}},P=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var e=Math.random()*16|0,n=i==="x"?e:e&3|8;return n.toString(16)})},k=function(i,e){return i.rank<e.rank?1:i.rank>e.rank?-1:0},N=function(i){return i==null||(i=typeof i=="string"||i.constructor===String?document.getElementById(i):i,i==null)?null:(i._katavorio=i._katavorio||P(),i)};q.Katavorio=function(i){var e=[],n={};this._dragsByScope={},this._dropsByScope={};var A=1,S=function(Z,K){h(Z,function(Q){for(var rt=0;rt<Q.scopes.length;rt++)K[Q.scopes[rt]]=K[Q.scopes[rt]]||[],K[Q.scopes[rt]].push(Q)})},R=function(Z,K){var Q=0;return h(Z,function(rt){for(var gt=0;gt<rt.scopes.length;gt++)if(K[rt.scopes[gt]]){var Dt=i.indexOf(K[rt.scopes[gt]],rt);Dt!==-1&&(K[rt.scopes[gt]].splice(Dt,1),Q++)}}),Q>0};this.getMatchingDroppables=function(Z){for(var K=[],Q={},rt=0;rt<Z.scopes.length;rt++){var gt=this._dropsByScope[Z.scopes[rt]];if(gt)for(var Dt=0;Dt<gt.length;Dt++)gt[Dt].canDrop(Z)&&!Q[gt[Dt].uuid]&&(gt[Dt].allowLoopback||gt[Dt].el!==Z.el)&&(Q[gt[Dt].uuid]=!0,K.push(gt[Dt]))}return K.sort(k),K};var V=function(Z){Z=Z||{};var K={events:{}},Q;for(Q in i)K[Q]=i[Q];for(Q in Z)K[Q]=Z[Q];for(Q=0;Q<B.length;Q++)K.events[B[Q]]=Z[B[Q]]||M;return K.katavorio=this,K}.bind(this),z=function(Z,K){for(var Q=0;Q<B.length;Q++)K[B[Q]]&&Z.on(B[Q],K[B[Q]])}.bind(this),X={},nt=i.css||{},pt=i.scope||G;for(var ft in F)X[ft]=F[ft];for(var ft in nt)X[ft]=nt[ft];var it=i.inputFilterSelector||I;this.getInputFilterSelector=function(){return it},this.setInputFilterSelector=function(Z){return it=Z,this},this.draggable=function(Z,K){var Q=[];return h(Z,function(rt){if(rt=N(rt),rt!=null)if(rt._katavorioDrag==null){var gt=V(K);rt._katavorioDrag=new u(rt,gt,X,pt),S(rt._katavorioDrag,this._dragsByScope),Q.push(rt._katavorioDrag),i.addClass(rt,gt.selector?X.delegatedDraggable:X.draggable)}else z(rt._katavorioDrag,K)}.bind(this)),Q},this.droppable=function(Z,K){var Q=[];return h(Z,function(rt){if(rt=N(rt),rt!=null){var gt=new d(rt,V(K),X,pt);rt._katavorioDrop=rt._katavorioDrop||[],rt._katavorioDrop.push(gt),S(gt,this._dropsByScope),Q.push(gt),i.addClass(rt,X.droppable)}}.bind(this)),Q},this.select=function(Z){return h(Z,function(){var K=N(this);K&&K._katavorioDrag&&(n[K._katavorio]||(e.push(K._katavorioDrag),n[K._katavorio]=[K,e.length-1],i.addClass(K,X.selected)))}),this},this.deselect=function(Z){return h(Z,function(){var K=N(this);if(K&&K._katavorio){var Q=n[K._katavorio];if(Q){for(var rt=[],gt=0;gt<e.length;gt++)e[gt].el!==K&&rt.push(e[gt]);e=rt,delete n[K._katavorio],i.removeClass(K,X.selected)}}}),this},this.deselectAll=function(){for(var Z in n){var K=n[Z];i.removeClass(K[0],X.selected)}e.length=0,n={}},this.markSelection=function(Z){o(e,function(K){K.mark()},Z)},this.markPosses=function(Z){Z.posses&&h(Z.posses,function(K){Z.posseRoles[K]&&vt[K]&&o(vt[K].members,function(Q){Q.mark()},Z)})},this.unmarkSelection=function(Z,K){o(e,function(Q){Q.unmark(K)},Z)},this.unmarkPosses=function(Z,K){Z.posses&&h(Z.posses,function(Q){Z.posseRoles[Q]&&vt[Q]&&o(vt[Q].members,function(rt){rt.unmark(K,!0)},Z)})},this.getSelection=function(){return e.slice(0)},this.updateSelection=function(Z,K,Q){o(e,function(rt){rt.moveBy(Z,K)},Q)};var st=function(Z,K){K.posses&&h(K.posses,function(Q){K.posseRoles[Q]&&vt[Q]&&o(vt[Q].members,function(rt){Z(rt)},K)})};this.updatePosses=function(Z,K,Q){st(function(rt){rt.moveBy(Z,K)},Q)},this.notifyPosseDragStop=function(Z,K){st(function(Q){Q.stop(K,!0)},Z)},this.notifySelectionDragStop=function(Z,K){o(e,function(Q){Q.stop(K,!0)},Z)},this.notifySelectionDragStart=function(Z,K){o(e,function(Q){Q.notifyStart(K)},Z)},this.setZoom=function(Z){A=Z},this.getZoom=function(){return A};var ht=function(Z,K,Q,rt){h(Z,function(gt){R(gt,Q),gt[rt](K),S(gt,Q)})};h(["set","add","remove","toggle"],function(Z){this[Z+"Scope"]=function(K,Q){ht(K._katavorioDrag,Q,this._dragsByScope,Z+"Scope"),ht(K._katavorioDrop,Q,this._dropsByScope,Z+"Scope")}.bind(this),this[Z+"DragScope"]=function(K,Q){ht(K.constructor===u?K:K._katavorioDrag,Q,this._dragsByScope,Z+"Scope")}.bind(this),this[Z+"DropScope"]=function(K,Q){ht(K.constructor===d?K:K._katavorioDrop,Q,this._dropsByScope,Z+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(Z,K){for(var Q in this._dragsByScope)o(this._dragsByScope[Q],function(rt){rt.snap(Z,K)})},this.getDragsForScope=function(Z){return this._dragsByScope[Z]},this.getDropsForScope=function(Z){return this._dropsByScope[Z]};var dt=function(Z,K,Q){if(Z=N(Z),Z[K]){var rt=e.indexOf(Z[K]);rt>=0&&e.splice(rt,1),R(Z[K],Q)&&h(Z[K],function(gt){gt.destroy()}),delete Z[K]}},at=function(Z,K,Q,rt){Z=N(Z),Z[K]&&Z[K].off(Q,rt)};this.elementRemoved=function(Z){this.destroyDraggable(Z),this.destroyDroppable(Z)},this.destroyDraggable=function(Z,K,Q){arguments.length===1?dt(Z,"_katavorioDrag",this._dragsByScope):at(Z,"_katavorioDrag",K,Q)},this.destroyDroppable=function(Z,K,Q){arguments.length===1?dt(Z,"_katavorioDrop",this._dropsByScope):at(Z,"_katavorioDrop",K,Q)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},e=[],n={},vt={}};var vt={},bt=function(Z,K,Q){var rt=Y(K)?K:K.id,gt=Y(K)?!0:K.active!==!1,Dt=vt[rt]||function(){var Mt={name:rt,members:[]};return vt[rt]=Mt,Mt}();return h(Z,function(Mt){if(Mt._katavorioDrag){if(Q&&Mt._katavorioDrag.posseRoles[Dt.name]!=null)return;f(Dt.members,Mt._katavorioDrag),f(Mt._katavorioDrag.posses,Dt.name),Mt._katavorioDrag.posseRoles[Dt.name]=gt}}),Dt};this.addToPosse=function(Z,K){for(var Q=[],rt=1;rt<arguments.length;rt++)Q.push(bt(Z,arguments[rt]));return Q.length===1?Q[0]:Q},this.setPosse=function(Z,K){for(var Q=[],rt=1;rt<arguments.length;rt++)Q.push(bt(Z,arguments[rt],!0).name);return h(Z,function(gt){if(gt._katavorioDrag){var Dt=J(gt._katavorioDrag.posses,Q),Mt=[];Array.prototype.push.apply(Mt,gt._katavorioDrag.posses);for(var $t=0;$t<Dt.length;$t++)this.removeFromPosse(gt,Dt[$t])}}.bind(this)),Q.length===1?Q[0]:Q},this.removeFromPosse=function(Z,K){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var Q=1;Q<arguments.length;Q++)K=arguments[Q],h(Z,function(rt){if(rt._katavorioDrag&&rt._katavorioDrag.posses){var gt=rt._katavorioDrag;h(K,function(Dt){U(vt[Dt].members,gt),U(gt.posses,Dt),delete gt.posseRoles[Dt]})}})},this.removeFromAllPosses=function(Z){h(Z,function(K){if(K._katavorioDrag&&K._katavorioDrag.posses){var Q=K._katavorioDrag;h(Q.posses,function(rt){U(vt[rt].members,Q)}),Q.posses.length=0,Q.posseRoles={}}})},this.setPosseState=function(Z,K,Q){var rt=vt[K];rt&&h(Z,function(gt){gt._katavorioDrag&&gt._katavorioDrag.posses&&(gt._katavorioDrag.posseRoles[rt.name]=Q)})}},q.Katavorio.version="1.0.0",typeof exports<"u"&&(exports.Katavorio=q.Katavorio)}).call(typeof window<"u"?window:globalThis);(function(){var q=this;q.jsPlumbUtil=q.jsPlumbUtil||{};var f=q.jsPlumbUtil;typeof exports<"u"&&(exports.jsPlumbUtil=f);function U(d){return Object.prototype.toString.call(d)==="[object Array]"}f.isArray=U;function J(d){return Object.prototype.toString.call(d)==="[object Number]"}f.isNumber=J;function Y(d){return typeof d=="string"}f.isString=Y;function $(d){return typeof d=="boolean"}f.isBoolean=$;function l(d){return d==null}f.isNull=l;function O(d){return d==null?!1:Object.prototype.toString.call(d)==="[object Object]"}f.isObject=O;function a(d){return Object.prototype.toString.call(d)==="[object Date]"}f.isDate=a;function t(d){return Object.prototype.toString.call(d)==="[object Function]"}f.isFunction=t;function m(d){return t(d)&&d.name!=null&&d.name.length>0}f.isNamedFunction=m;function y(d){for(var P in d)if(d.hasOwnProperty(P))return!1;return!0}f.isEmpty=y;function j(d){if(Y(d))return""+d;if($(d))return!!d;if(a(d))return new Date(d.getTime());if(t(d))return d;if(U(d)){for(var P=[],k=0;k<d.length;k++)P.push(j(d[k]));return P}else if(O(d)){var N={};for(var i in d)N[i]=j(d[i]);return N}else return d}f.clone=j;function x(d,P,k,N){var i={},e,n,A={};for(k=k||[],N=N||[],n=0;n<k.length;n++)i[k[n]]=!0;for(n=0;n<N.length;n++)A[N[n]]=!0;var S=j(d);for(n in P)if(S[n]==null||A[n])S[n]=P[n];else if(Y(P[n])||$(P[n]))i[n]?(e=[],e.push.apply(e,U(S[n])?S[n]:[S[n]]),e.push.apply(e,$(P[n])?P[n]:[P[n]]),S[n]=e):S[n]=P[n];else if(U(P[n]))e=[],U(S[n])&&e.push.apply(e,S[n]),e.push.apply(e,P[n]),S[n]=e;else if(O(P[n])){O(S[n])||(S[n]={});for(var R in P[n])S[n][R]=P[n][R]}return S}f.merge=x;function T(d,P,k){if(d!=null){var N=d,i=N;return P.replace(/([^\.])+/g,function(e,n,A,S){var R=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),V=A+e.length>=S.length,z=function(){return i[R[1]]||function(){return i[R[1]]=[],i[R[1]]}()};if(V)R?z()[R[3]]=k:i[e]=k;else if(R){var X=z();i=X[R[3]]||function(){return X[R[3]]={},X[R[3]]}()}else i=i[e]||function(){return i[e]={},i[e]}();return""}),d}}f.replace=T;function s(d,P,k){for(var N=0;N<k.length;N++){var i=k[N][0][k[N][1]].apply(k[N][0],k[N][2]);if(i===P)return i}return d}f.functionChain=s;function c(d,P,k,N){var i=function(n){var A=n.match(/(\${.*?})/g);if(A!=null)for(var S=0;S<A.length;S++){var R=P[A[S].substring(2,A[S].length-1)]||"";R!=null&&(n=n.replace(A[S],R))}return n},e=function(n){if(n!=null){if(Y(n))return i(n);if(t(n)&&!N&&(k==null||(n.name||"").indexOf(k)===0))return n(P);if(U(n)){for(var A=[],S=0;S<n.length;S++)A.push(e(n[S]));return A}else if(O(n)){var R={};for(var V in n)R[V]=e(n[V]);return R}else return n}};return e(d)}f.populate=c;function F(d,P){if(d){for(var k=0;k<d.length;k++)if(P(d[k]))return k}return-1}f.findWithFunction=F;function G(d,P){var k=F(d,P);return k>-1&&d.splice(k,1),k!==-1}f.removeWithFunction=G;function B(d,P){var k=d.indexOf(P);return k>-1&&d.splice(k,1),k!==-1}f.remove=B;function M(d,P,k){F(d,k)===-1&&d.push(P)}f.addWithFunction=M;function b(d,P,k,N){var i=d[P];return i==null&&(i=[],d[P]=i),i[N?"unshift":"push"](k),i}f.addToList=b;function o(d,P,k){return d.indexOf(P)===-1?(k?d.unshift(P):d.push(P),!0):!1}f.suggest=o;function g(d,P,k){var N;P=U(P)?P:[P];var i=function(S){for(var R=S.__proto__;R!=null;)if(R.prototype!=null){for(var V in R.prototype)R.prototype.hasOwnProperty(V)&&!d.prototype.hasOwnProperty(V)&&(d.prototype[V]=R.prototype[V]);R=R.prototype.__proto__}else R=null};for(N=0;N<P.length;N++){for(var e in P[N].prototype)P[N].prototype.hasOwnProperty(e)&&!d.prototype.hasOwnProperty(e)&&(d.prototype[e]=P[N].prototype[e]);i(P[N])}var n=function(S,R){return function(){for(N=0;N<P.length;N++)P[N].prototype[S]&&P[N].prototype[S].apply(this,arguments);return R.apply(this,arguments)}},A=function(S){for(var R in S)d.prototype[R]=n(R,S[R])};if(arguments.length>2)for(N=2;N<arguments.length;N++)A(arguments[N]);return d}f.extend=g;function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var P=Math.random()*16|0,k=d==="x"?P:P&3|8;return k.toString(16)})}f.uuid=h;function E(d){if(d==null)return null;for(var P=d.replace(/^\s\s*/,""),k=/\s/,N=P.length;k.test(P.charAt(--N)););return P.slice(0,N+1)}f.fastTrim=E;function I(d,P){d=d.length==null||typeof d=="string"?[d]:d;for(var k=0;k<d.length;k++)P(d[k])}f.each=I;function p(d,P){for(var k=[],N=0;N<d.length;N++)k.push(P(d[N]));return k}f.map=p;function v(d,P,k){k=k||"parent";var N=function(S){return S?P[S]:null},i=function(S){return S?N(S[k]):null},e=function(S,R){if(S==null)return R;var V=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];R.mergeStrategy==="override"&&Array.prototype.push.apply(V,["events","overlays"]);var z=x(S,R,[],V);return e(i(S),z)},n=function(S){if(S==null)return{};if(typeof S=="string")return N(S);if(S.length){for(var R=!1,V=0,z=void 0;!R&&V<S.length;)z=n(S[V]),z?R=!0:V++;return z}},A=n(d);return A?e(i(A),A):{}}f.mergeWithParents=v,f.logEnabled=!0;function C(){if(f.logEnabled&&typeof console<"u")try{var d=arguments[arguments.length-1];console.log(d)}catch{}}f.log=C;function w(d,P,k){return function(){var N=null;try{P!=null&&(N=P.apply(this,arguments))}catch(i){C("jsPlumb function failed : "+i)}if(d!=null&&(k==null||N!==k))try{N=d.apply(this,arguments)}catch(i){C("wrapped function failed : "+i)}return N}}f.wrap=w;var u=function(){function d(){var P=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(k,N,i){var e=function(A){b(P._listeners,A,N,i),N.__jsPlumb=N.__jsPlumb||{},N.__jsPlumb[h()]=A};if(typeof k=="string")e(k);else if(k.length!=null)for(var n=0;n<k.length;n++)e(k[n]);return P},this.fire=function(k,N,i){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[k]){var e=this._listeners[k].length,n=0,A=!1,S=null;if(!this.shouldFireEvent||this.shouldFireEvent(k,N,i))for(;!A&&n<e&&S!==!1;){if(this.eventsToDieOn[k])this._listeners[k][n].apply(this,[N,i]);else try{S=this._listeners[k][n].apply(this,[N,i])}catch(R){C("jsPlumb: fire failed for event "+k+" : "+R)}n++,(this._listeners==null||this._listeners[k]==null)&&(A=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var k=P.queue.pop();k&&P.fire.apply(P,k)},this.unbind=function(k,N){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof k=="string")delete this._listeners[k];else if(k.__jsPlumb){var i=void 0;for(var e in k.__jsPlumb)i=k.__jsPlumb[e],B(this._listeners[i]||[],k)}}else arguments.length===2&&B(this._listeners[k]||[],N);return this},this.getListener=function(k){return P._listeners[k]},this.setSuspendEvents=function(k){P.eventsSuspended=k},this.isSuspendEvents=function(){return P.eventsSuspended},this.silently=function(k){P.setSuspendEvents(!0);try{k()}catch(N){C("Cannot execute silent function "+N)}P.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var k in P._listeners)P._listeners[k]=null}}return d}();f.EventGenerator=u}).call(typeof window<"u"?window:globalThis);(function(){var q=this;q.jsPlumbUtil.matchesSelector=function(f,U,J){J=J||f.parentNode;for(var Y=J.querySelectorAll(U),$=0;$<Y.length;$++)if(Y[$]===f)return!0;return!1},q.jsPlumbUtil.consume=function(f,U){f.stopPropagation?f.stopPropagation():f.returnValue=!1,!U&&f.preventDefault&&f.preventDefault()},q.jsPlumbUtil.sizeElement=function(f,U,J,Y,$){f&&(f.style.height=$+"px",f.height=$,f.style.width=Y+"px",f.width=Y,f.style.left=U+"px",f.style.top=J+"px")}}).call(typeof window<"u"?window:globalThis);(function(){var q={deriveAnchor:function(Y,$,l,O){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[Y][$]}},f=this,U=function(Y){this.count=0,this.instance=Y,this.lists={},this.instance.addList=function($,l){return this.listManager.addList($,l)},this.instance.removeList=function($){this.listManager.removeList($)},this.instance.bind("manageElement",function($){for(var l=this.instance.getSelector($.el,"[jtk-scrollable-list]"),O=0;O<l.length;O++)this.addList(l[O])}.bind(this)),this.instance.bind("unmanageElement",function($){this.removeList($.el)}),this.instance.bind("connection",function($,l){l==null&&(this._maybeUpdateParentList($.source),this._maybeUpdateParentList($.target))}.bind(this))};f.jsPlumbListManager=U,U.prototype={addList:function(Y,$){var l=this.instance.extend({},q);$=this.instance.extend(l,$||{});var O=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[O]=new J(this.instance,Y,$,O)},removeList:function(Y){var $=this.lists[Y._jsPlumbList];$&&($.destroy(),delete this.lists[Y._jsPlumbList])},_maybeUpdateParentList:function(Y){for(var $=Y.parentNode,l=this.instance.getContainer();$!=null&&$!==l;){if($._jsPlumbList!=null&&this.lists[$._jsPlumbList]!=null){$._jsPlumbScrollHandler();return}$=$.parentNode}}};var J=function(Y,$,l,O){$._jsPlumbList=O;function a(j,x,T,s){return l.anchor?l.anchor:l.deriveAnchor(j,x,T,s)}function t(j,x,T,s){return l.deriveEndpoint?l.deriveEndpoint(j,x,T,s):l.endpoint?l.endpoint:T.type}function m(j){for(var x=j.parentNode,T=Y.getContainer();x!=null&&x!==T;){if(Y.hasClass(x,"jtk-managed")){Y.recalculateOffsets(x);return}x=x.parentNode}}var y=function(j){for(var x=Y.getSelector($,".jtk-managed"),T=Y.getId($),s=0;s<x.length;s++){if(x[s].offsetTop<$.scrollTop)x[s]._jsPlumbProxies||(x[s]._jsPlumbProxies=x[s]._jsPlumbProxies||[],Y.select({source:x[s]}).each(function(F){Y.proxyConnection(F,0,$,T,function(){return t("top",0,F.endpoints[0],F)},function(){return a("top",0,F.endpoints[0],F)}),x[s]._jsPlumbProxies.push([F,0])}),Y.select({target:x[s]}).each(function(F){Y.proxyConnection(F,1,$,T,function(){return t("top",1,F.endpoints[1],F)},function(){return a("top",1,F.endpoints[1],F)}),x[s]._jsPlumbProxies.push([F,1])}));else if(x[s].offsetTop>$.scrollTop+$.offsetHeight)x[s]._jsPlumbProxies||(x[s]._jsPlumbProxies=x[s]._jsPlumbProxies||[],Y.select({source:x[s]}).each(function(F){Y.proxyConnection(F,0,$,T,function(){return t("bottom",0,F.endpoints[0],F)},function(){return a("bottom",0,F.endpoints[0],F)}),x[s]._jsPlumbProxies.push([F,0])}),Y.select({target:x[s]}).each(function(F){Y.proxyConnection(F,1,$,T,function(){return t("bottom",1,F.endpoints[1],F)},function(){return a("bottom",1,F.endpoints[1],F)}),x[s]._jsPlumbProxies.push([F,1])}));else if(x[s]._jsPlumbProxies){for(var c=0;c<x[s]._jsPlumbProxies.length;c++)Y.unproxyConnection(x[s]._jsPlumbProxies[c][0],x[s]._jsPlumbProxies[c][1],T);delete x[s]._jsPlumbProxies}Y.revalidate(x[s])}m($)};Y.setAttribute($,"jtk-scrollable-list","true"),$._jsPlumbScrollHandler=y,Y.on($,"scroll",y),y(),this.destroy=function(){Y.off($,"scroll",y),delete $._jsPlumbScrollHandler;for(var j=Y.getSelector($,".jtk-managed"),x=Y.getId($),T=0;T<j.length;T++)if(j[T]._jsPlumbProxies){for(var s=0;s<j[T]._jsPlumbProxies.length;s++)Y.unproxyConnection(j[T]._jsPlumbProxies[s][0],j[T]._jsPlumbProxies[s][1],x);delete j[T]._jsPlumbProxies}}}}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumbUtil,U=function(){return""+new Date().getTime()},J=function(s){if(s._jsPlumb.paintStyle&&s._jsPlumb.hoverPaintStyle){var c={};T.extend(c,s._jsPlumb.paintStyle),T.extend(c,s._jsPlumb.hoverPaintStyle),delete s._jsPlumb.hoverPaintStyle,c.gradient&&s._jsPlumb.paintStyle.fill&&delete c.gradient,s._jsPlumb.hoverPaintStyle=c}},Y=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],$=function(s,c,F,G){var B=s.getAttachedElements();if(B)for(var M=0,b=B.length;M<b;M++)(!G||G!==B[M])&&B[M].setHover(c,!0,F)},l=function(s){return s==null?null:s.split(" ")},O=function(s,c,F){for(var G in c)s[G]=F},a=function(s,c,F){if(s.getDefaultType){var G=s.getTypeDescriptor(),B={},M=s.getDefaultType(),b=f.merge({},M);O(B,M,"__default");for(var o=0,g=s._jsPlumb.types.length;o<g;o++){var h=s._jsPlumb.types[o];if(h!=="__default"){var E=s._jsPlumb.instance.getType(h,G);if(E!=null){var I=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],p=[];E.mergeStrategy==="override"?Array.prototype.push.apply(I,["events","overlays","cssClass"]):p.push("cssClass"),b=f.merge(b,E,p,I),O(B,E,h)}}}c&&(b=f.populate(b,c,"_")),s.applyType(b,F,B),F||s.repaint()}},t=q.jsPlumbUIComponent=function(s){f.EventGenerator.apply(this,arguments);var c=this,F=arguments,G=c.idPrefix,B=G+new Date().getTime();this._jsPlumb={instance:s._jsPlumb,parameters:s.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:s.beforeDetach,beforeDrop:s.beforeDrop,overlayPlacements:[],hoverClass:s.hoverClass||s._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(p,v,C){this._jsPlumb.typeCache[C]=this._jsPlumb.typeCache[C]||{},this._jsPlumb.typeCache[C][p]=v},this.getCachedTypeItem=function(p,v){return this._jsPlumb.typeCache[v]?this._jsPlumb.typeCache[v][p]:null},this.getId=function(){return B};var M=s.overlays||[],b={};if(this.defaultOverlayKeys){for(var o=0;o<this.defaultOverlayKeys.length;o++)Array.prototype.push.apply(M,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[o]]||[]);for(o=0;o<M.length;o++){var g=T.convertToFullOverlaySpec(M[o]);b[g[1].id]=g}}var h={overlays:b,parameters:s.parameters||{},scope:s.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return h},this.appendToDefaultType=function(p){for(var v in p)h[v]=p[v]},s.events)for(var E in s.events)c.bind(E,s.events[E]);this.clone=function(){var p=Object.create(this.constructor.prototype);return this.constructor.apply(p,F),p}.bind(this),this.isDetachAllowed=function(p){var v=!0;if(this._jsPlumb.beforeDetach)try{v=this._jsPlumb.beforeDetach(p)}catch(C){f.log("jsPlumb: beforeDetach callback failed",C)}return v},this.isDropAllowed=function(p,v,C,w,u,d,P){var k=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:p,targetId:v,scope:C,connection:w,dropEndpoint:u,source:d,target:P});if(this._jsPlumb.beforeDrop)try{k=this._jsPlumb.beforeDrop({sourceId:p,targetId:v,scope:C,connection:w,dropEndpoint:u,source:d,target:P})}catch(N){f.log("jsPlumb: beforeDrop callback failed",N)}return k};var I=[];this.setListenerComponent=function(p){for(var v=0;v<I.length;v++)I[v][3]=p}},m=function(s,c){var F=s._jsPlumb.types[c],G=s._jsPlumb.instance.getType(F,s.getTypeDescriptor());G!=null&&G.cssClass&&s.canvas&&s._jsPlumb.instance.removeClass(s.canvas,G.cssClass)};f.extend(q.jsPlumbUIComponent,f.EventGenerator,{getParameter:function(s){return this._jsPlumb.parameters[s]},setParameter:function(s,c){this._jsPlumb.parameters[s]=c},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(s){this._jsPlumb.parameters=s},getClass:function(){return T.getClass(this.canvas)},hasClass:function(s){return T.hasClass(this.canvas,s)},addClass:function(s){T.addClass(this.canvas,s)},removeClass:function(s){T.removeClass(this.canvas,s)},updateClasses:function(s,c){T.updateClasses(this.canvas,s,c)},setType:function(s,c,F){this.clearTypes(),this._jsPlumb.types=l(s)||[],a(this,c,F)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(s,c){a(this,s,c)},hasType:function(s){return this._jsPlumb.types.indexOf(s)!==-1},addType:function(s,c,F){var G=l(s),B=!1;if(G!=null){for(var M=0,b=G.length;M<b;M++)this.hasType(G[M])||(this._jsPlumb.types.push(G[M]),B=!0);B&&a(this,c,F)}},removeType:function(s,c,F){var G=l(s),B=!1,M=function(g){var h=this._jsPlumb.types.indexOf(g);return h!==-1?(m(this,h),this._jsPlumb.types.splice(h,1),!0):!1}.bind(this);if(G!=null){for(var b=0,o=G.length;b<o;b++)B=M(G[b])||B;B&&a(this,c,F)}},clearTypes:function(s,c){for(var F=this._jsPlumb.types.length,G=0;G<F;G++)m(this,0),this._jsPlumb.types.splice(0,1);a(this,s,c)},toggleType:function(s,c,F){var G=l(s);if(G!=null){for(var B=0,M=G.length;B<M;B++){var b=this._jsPlumb.types.indexOf(G[B]);b!==-1?(m(this,b),this._jsPlumb.types.splice(b,1)):this._jsPlumb.types.push(G[B])}a(this,c,F)}},applyType:function(s,c){if(this.setPaintStyle(s.paintStyle,c),this.setHoverPaintStyle(s.hoverPaintStyle,c),s.parameters)for(var F in s.parameters)this.setParameter(F,s.parameters[F]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(s,c){this._jsPlumb.paintStyle=s,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,J(this),c||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(s,c){this._jsPlumb.hoverPaintStyle=s,J(this),c||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(s){(s||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(s,c,F){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=s;var G=s?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[G](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[G](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=s?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(F=F||U(),this.repaint({timestamp:F,recalc:!1}))),this.getAttachedElements&&!c&&$(this,s,U(),this)}}});var y=0,j=function(){var s=y+1;return y++,s},x=q.jsPlumbInstance=function(s){this.version="2.12.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},s&&T.extend(this.Defaults,s),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},f.EventGenerator.apply(this);var c=this,F=j(),G=c.bind,B={},M=1,b=function(r){if(r==null)return null;if(r.nodeType===3||r.nodeType===8)return{el:r,text:!0};var D=c.getElement(r);return{el:D,id:f.isString(r)&&D==null?r:vt(D)}};this.getInstanceIndex=function(){return F},this.setZoom=function(r,D){return M=r,c.fire("zoom",M),D&&c.repaintEverything(),!0},this.getZoom=function(){return M};for(var o in this.Defaults)B[o]=this.Defaults[o];var g,h=[];this.unbindContainer=function(){if(g!=null&&h.length>0)for(var r=0;r<h.length;r++)c.off(g,h[r][0],h[r][1])},this.setContainer=function(r){this.unbindContainer(),r=this.getElement(r),this.select().each(function(ut){ut.moveParent(r)}),this.selectEndpoints().each(function(ut){ut.moveParent(r)});var D=g;g=r,h.length=0;for(var _={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},L=function(ut,lt,Et){var mt=lt.srcElement||lt.target,xt=(mt&&mt.parentNode?mt.parentNode._jsPlumb:null)||(mt?mt._jsPlumb:null)||(mt&&mt.parentNode&&mt.parentNode.parentNode?mt.parentNode.parentNode._jsPlumb:null);if(xt){xt.fire(ut,xt,lt);var kt=Et&&_[Et+ut]||ut;c.fire(kt,xt.component||xt,lt)}},H=function(ut,lt,Et){h.push([ut,Et]),c.on(g,ut,lt,Et)},W=function(ut){H(ut,".jtk-connector",function(lt){L(ut,lt)}),H(ut,".jtk-endpoint",function(lt){L(ut,lt,"endpoint")}),H(ut,".jtk-overlay",function(lt){L(ut,lt)})},tt=0;tt<Y.length;tt++)W(Y[tt]);for(var ct in w){var ot=w[ct].el;ot.parentNode===D&&(D.removeChild(ot),g.appendChild(ot))}},this.getContainer=function(){return g},this.bind=function(r,D){r==="ready"&&I?D():G.apply(c,[r,D])},c.importDefaults=function(r){for(var D in r)c.Defaults[D]=r[D];return r.Container&&c.setContainer(r.Container),c},c.restoreDefaults=function(){return c.Defaults=T.extend({},B),c};var E=null,I=!1,p=[],v={},C={},w={},u={},d={},P=!1,k=[],N=!1,i=null,e=this.Defaults.Scope,n=1,A=function(){return""+n++},S=function(r,D){g?g.appendChild(r):D?this.getElement(D).appendChild(r):this.appendToRoot(r)}.bind(this),R=function(r,D,_,L){if(!N){var H=vt(r),W,tt=c.getDragManager();tt&&(W=tt.getElementsForDraggable(H)),_==null&&(_=U());var ct=jt({elId:H,offset:D,recalc:!1,timestamp:_});if(W&&ct&&ct.o)for(var ot in W)jt({elId:W[ot].id,offset:{left:ct.o.left+W[ot].offset.left,top:ct.o.top+W[ot].offset.top},recalc:!1,timestamp:_});if(c.anchorManager.redraw(H,D,_,null,L),W)for(var ut in W)c.anchorManager.redraw(W[ut].id,D,_,W[ut].offset,L,!0)}},V=function(r){return C[r]},z=function(r,D){for(var _=r.scope.split(/\s/),L=D.scope.split(/\s/),H=0;H<_.length;H++)for(var W=0;W<L.length;W++)if(L[W]===_[H])return!0;return!1},X=function(r,D){var _=T.extend({},r);for(var L in D)D[L]&&(_[L]=D[L]);return _},nt=function(r,D){var _=T.extend({},r);if(D&&T.extend(_,D),_.source&&(_.source.endpoint?_.sourceEndpoint=_.source:_.source=c.getElement(_.source)),_.target&&(_.target.endpoint?_.targetEndpoint=_.target:_.target=c.getElement(_.target)),r.uuids&&(_.sourceEndpoint=V(r.uuids[0]),_.targetEndpoint=V(r.uuids[1])),_.sourceEndpoint&&_.sourceEndpoint.isFull()){f.log(c,"could not add connection; source endpoint is full");return}if(_.targetEndpoint&&_.targetEndpoint.isFull()){f.log(c,"could not add connection; target endpoint is full");return}if(!_.type&&_.sourceEndpoint&&(_.type=_.sourceEndpoint.connectionType),_.sourceEndpoint&&_.sourceEndpoint.connectorOverlays){_.overlays=_.overlays||[];for(var L=0,H=_.sourceEndpoint.connectorOverlays.length;L<H;L++)_.overlays.push(_.sourceEndpoint.connectorOverlays[L])}_.sourceEndpoint&&_.sourceEndpoint.scope&&(_.scope=_.sourceEndpoint.scope),!_["pointer-events"]&&_.sourceEndpoint&&_.sourceEndpoint.connectorPointerEvents&&(_["pointer-events"]=_.sourceEndpoint.connectorPointerEvents);var W=function(ct,ot,ut){var lt=X(ot,{anchor:_.anchors?_.anchors[ut]:_.anchor,endpoint:_.endpoints?_.endpoints[ut]:_.endpoint,paintStyle:_.endpointStyles?_.endpointStyles[ut]:_.endpointStyle,hoverPaintStyle:_.endpointHoverStyles?_.endpointHoverStyles[ut]:_.endpointHoverStyle});return c.addEndpoint(ct,lt)},tt=function(ct,ot,ut,lt){if(_[ct]&&!_[ct].endpoint&&!_[ct+"Endpoint"]&&!_.newConnection){var Et=vt(_[ct]),mt=ut[Et];if(mt=mt?mt[lt]:null,mt){if(!mt.enabled)return!1;var xt=T.extend({},mt.def);delete xt.label;var kt=mt.endpoint!=null&&mt.endpoint._jsPlumb?mt.endpoint:W(_[ct],xt,ot);if(kt.isFull())return!1;_[ct+"Endpoint"]=kt,!_.scope&&xt.scope&&(_.scope=xt.scope),mt.uniqueEndpoint?mt.endpoint?kt.finalEndpoint=mt.endpoint:(mt.endpoint=kt,kt.setDeleteOnEmpty(!1)):kt.setDeleteOnEmpty(!0),ot===0&&mt.def.connectorOverlays&&(_.overlays=_.overlays||[],Array.prototype.push.apply(_.overlays,mt.def.connectorOverlays))}}};if(tt("source",0,this.sourceEndpointDefinitions,_.type||"default")!==!1&&tt("target",1,this.targetEndpointDefinitions,_.type||"default")!==!1)return _.sourceEndpoint&&_.targetEndpoint&&(z(_.sourceEndpoint,_.targetEndpoint)||(_=null)),_}.bind(c),pt=function(r){var D=c.Defaults.ConnectionType||c.getDefaultConnectionType();r._jsPlumb=c,r.newConnection=pt,r.newEndpoint=it,r.endpointsByUUID=C,r.endpointsByElement=v,r.finaliseConnection=ft,r.id="con_"+A();var _=new D(r);return _.isDetachable()&&(_.endpoints[0].initDraggable("_jsPlumbSource"),_.endpoints[1].initDraggable("_jsPlumbTarget")),_},ft=c.finaliseConnection=function(r,D,_,L){if(D=D||{},r.suspendedEndpoint||p.push(r),r.pending=null,r.endpoints[0].isTemporarySource=!1,L!==!1&&c.anchorManager.newConnection(r),R(r.source),!D.doNotFireConnectionEvent&&D.fireEvent!==!1){var H={connection:r,source:r.source,target:r.target,sourceId:r.sourceId,targetId:r.targetId,sourceEndpoint:r.endpoints[0],targetEndpoint:r.endpoints[1]};c.fire("connection",H,_)}},it=function(r,D){var _=c.Defaults.EndpointType||T.Endpoint,L=T.extend({},r);L._jsPlumb=c,L.newConnection=pt,L.newEndpoint=it,L.endpointsByUUID=C,L.endpointsByElement=v,L.fireDetachEvent=K,L.elementId=D||vt(L.source);var H=new _(L);return H.id="ep_"+A(),Yt(L.elementId,L.source),T.headless||c.getDragManager().endpointAdded(L.source,D),H},st=function(r,D,_){var L=v[r];if(L&&L.length)for(var H=0,W=L.length;H<W;H++){for(var tt=0,ct=L[H].connections.length;tt<ct;tt++){var ot=D(L[H].connections[tt]);if(ot)return}_&&_(L[H])}},ht=function(r,D,_){D=D==="block";var L=null;_&&(L=function(W){W.setVisible(D,!0,!0)});var H=b(r);st(H.id,function(W){if(D&&_){var tt=W.sourceId===H.id?1:0;W.endpoints[tt].isVisible()&&W.setVisible(!0)}else W.setVisible(D)},L)},dt=function(r,D){var _=null;D&&(_=function(L){var H=L.isVisible();L.setVisible(!H)}),st(r,function(L){var H=L.isVisible();L.setVisible(!H)},_)},at=function(r){var D=u[r];return D?{o:D,s:k[r]}:jt({elId:r})},vt=function(r,D,_){if(f.isString(r))return r;if(r==null)return null;var L=c.getAttribute(r,"id");return(!L||L==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?L=D:(arguments.length===1||arguments.length===3&&!arguments[2])&&(L="jsPlumb_"+F+"_"+A()),_||c.setAttribute(r,"id",L)),L};this.setConnectionBeingDragged=function(r){P=r},this.isConnectionBeingDragged=function(){return P},this.getManagedElements=function(){return w},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(r,D,_){_=_||{};var L=T.extend({},_);T.extend(L,D),L.endpoint=L.endpoint||c.Defaults.Endpoint,L.paintStyle=L.paintStyle||c.Defaults.EndpointStyle;for(var H=[],W=f.isArray(r)||r.length!=null&&!f.isString(r)?r:[r],tt=0,ct=W.length;tt<ct;tt++){L.source=c.getElement(W[tt]),oe(L.source);var ot=vt(L.source),ut=it(L,ot),lt=Yt(ot,L.source).info.o;f.addToList(v,ot,ut),N||ut.paint({anchorLoc:ut.anchor.compute({xy:[lt.left,lt.top],wh:k[ot],element:ut,timestamp:i}),timestamp:i}),H.push(ut)}return H.length===1?H[0]:H},this.addEndpoints=function(r,D,_){for(var L=[],H=0,W=D.length;H<W;H++){var tt=c.addEndpoint(r,D[H],_);f.isArray(tt)?Array.prototype.push.apply(L,tt):L.push(tt)}return L},this.animate=function(r,D,_){if(!this.animationSupported)return!1;_=_||{};var L=c.getElement(r),H=vt(L),W=T.animEvents.step,tt=T.animEvents.complete;_[W]=f.wrap(_[W],function(){c.revalidate(H)}),_[tt]=f.wrap(_[tt],function(){c.revalidate(H)}),c.doAnimate(L,D,_)},this.checkCondition=function(r,D){var _=c.getListener(r),L=!0;if(_&&_.length>0){var H=Array.prototype.slice.call(arguments,1);try{for(var W=0,tt=_.length;W<tt;W++)L=L&&_[W].apply(_[W],H)}catch(ct){f.log(c,"cannot check condition ["+r+"]"+ct)}}return L},this.connect=function(r,D){var _=nt(r,D),L;if(_){if(_.source==null&&_.sourceEndpoint==null){f.log("Cannot establish connection - source does not exist");return}if(_.target==null&&_.targetEndpoint==null){f.log("Cannot establish connection - target does not exist");return}oe(_.source),L=pt(_),ft(L,_)}return L};var bt=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],Z=function(r,D,_,L){var H,W=bt[_],tt=r[W.elId];r[W.el];var ct,ot,ut=r.endpoints[_],lt={index:_,originalSourceId:_===0?tt:r.sourceId,newSourceId:r.sourceId,originalTargetId:_===1?tt:r.targetId,newTargetId:r.targetId,connection:r};if(D.constructor===T.Endpoint)H=D,H.addConnection(r),D=H.element;else if(ct=vt(D),ot=this[W.epDefs][ct],ct===r[W.elId])H=null;else if(ot)for(var Et in ot){if(!ot[Et].enabled)return;H=ot[Et].endpoint!=null&&ot[Et].endpoint._jsPlumb?ot[Et].endpoint:this.addEndpoint(D,ot[Et].def),ot[Et].uniqueEndpoint&&(ot[Et].endpoint=H),H.addConnection(r)}else H=r.makeEndpoint(_===0,D,ct);return H!=null&&(ut.detachFromConnection(r),r.endpoints[_]=H,r[W.el]=H.element,r[W.elId]=H.elementId,lt[_===0?"newSourceId":"newTargetId"]=H.elementId,Q(lt),L||r.repaint()),lt.element=D,lt}.bind(this);this.setSource=function(r,D,_){var L=Z(r,D,0,_);this.anchorManager.sourceChanged(L.originalSourceId,L.newSourceId,r,L.el)},this.setTarget=function(r,D,_){var L=Z(r,D,1,_);this.anchorManager.updateOtherEndpoint(L.originalSourceId,L.originalTargetId,L.newTargetId,r)},this.deleteEndpoint=function(r,D,_){var L=typeof r=="string"?C[r]:r;return L&&c.deleteObject({endpoint:L,dontUpdateHover:D,deleteAttachedObjects:_}),c},this.deleteEveryEndpoint=function(){var r=c.setSuspendDrawing(!0);for(var D in v){var _=v[D];if(_&&_.length)for(var L=0,H=_.length;L<H;L++)c.deleteEndpoint(_[L],!0)}v={},w={},C={},u={},d={},c.anchorManager.reset();var W=c.getDragManager();return W&&W.reset(),r||c.setSuspendDrawing(!1),c};var K=function(r,D,_){var L=c.Defaults.ConnectionType||c.getDefaultConnectionType(),H=r.constructor===L,W=H?{connection:r,source:r.source,target:r.target,sourceId:r.sourceId,targetId:r.targetId,sourceEndpoint:r.endpoints[0],targetEndpoint:r.endpoints[1]}:r;D&&c.fire("connectionDetached",W,_),c.fire("internal.connectionDetached",W,_),c.anchorManager.connectionDetached(W)},Q=c.fireMoveEvent=function(r,D){c.fire("connectionMoved",r,D)};this.unregisterEndpoint=function(r){r._jsPlumb.uuid&&(C[r._jsPlumb.uuid]=null),c.anchorManager.deleteEndpoint(r);for(var D in v){var _=v[D];if(_){for(var L=[],H=0,W=_.length;H<W;H++)_[H]!==r&&L.push(_[H]);v[D]=L}v[D].length<1&&delete v[D]}};var rt="isDetachAllowed",gt="beforeDetach",Dt="checkCondition";this.deleteConnection=function(r,D){return r!=null&&(D=D||{},D.force||f.functionChain(!0,!1,[[r.endpoints[0],rt,[r]],[r.endpoints[1],rt,[r]],[r,rt,[r]],[c,Dt,[gt,r]]]))?(r.setHover(!1),K(r,!r.pending&&D.fireEvent!==!1,D.originalEvent),r.endpoints[0].detachFromConnection(r),r.endpoints[1].detachFromConnection(r),f.removeWithFunction(p,function(_){return r.id===_.id}),r.cleanup(),r.destroy(),!0):!1},this.deleteEveryConnection=function(r){r=r||{};var D=p.length,_=0;return c.batch(function(){for(var L=0;L<D;L++)_+=c.deleteConnection(p[0],r)?1:0}),_},this.deleteConnectionsForElement=function(r,D){D=D||{},r=c.getElement(r);var _=vt(r),L=v[_];if(L&&L.length)for(var H=0,W=L.length;H<W;H++)L[H].deleteEveryConnection(D);return c},this.deleteObject=function(r){var D={endpoints:{},connections:{},endpointCount:0,connectionCount:0},_=r.deleteAttachedObjects!==!1,L=function(lt){lt!=null&&D.connections[lt.id]==null&&(!r.dontUpdateHover&&lt._jsPlumb!=null&&lt.setHover(!1),D.connections[lt.id]=lt,D.connectionCount++)},H=function(lt){if(lt!=null&&D.endpoints[lt.id]==null&&(!r.dontUpdateHover&&lt._jsPlumb!=null&&lt.setHover(!1),D.endpoints[lt.id]=lt,D.endpointCount++,_))for(var Et=0;Et<lt.connections.length;Et++){var mt=lt.connections[Et];L(mt)}};r.connection?L(r.connection):H(r.endpoint);for(var W in D.connections){var tt=D.connections[W];if(tt._jsPlumb){f.removeWithFunction(p,function(lt){return tt.id===lt.id}),K(tt,r.fireEvent===!1?!1:!tt.pending,r.originalEvent);var ct=r.deleteAttachedObjects==null?null:!r.deleteAttachedObjects;tt.endpoints[0].detachFromConnection(tt,null,ct),tt.endpoints[1].detachFromConnection(tt,null,ct),tt.cleanup(!0),tt.destroy(!0)}}for(var ot in D.endpoints){var ut=D.endpoints[ot];ut._jsPlumb&&(c.unregisterEndpoint(ut),ut.cleanup(!0),ut.destroy(!0))}return D};var Mt=function(r,D,_,L){for(var H=0,W=r.length;H<W;H++)r[H][D].apply(r[H],_);return L(r)},$t=function(r,D,_){for(var L=[],H=0,W=r.length;H<W;H++)L.push([r[H][D].apply(r[H],_),r[H]]);return L},Ut=function(r,D,_){return function(){return Mt(r,D,arguments,_)}},ie=function(r,D){return function(){return $t(r,D,arguments)}},Wt=function(r,D){var _=[];if(r)if(typeof r=="string"){if(r==="*")return r;_.push(r)}else if(D)_=r;else if(r.length)for(var L=0,H=r.length;L<H;L++)_.push(b(r[L]).id);else _.push(b(r).id);return _},zt=function(r,D,_){return r==="*"?!0:r.length>0?r.indexOf(D)!==-1:!_};this.getConnections=function(r,D){r?r.constructor===String&&(r={scope:r}):r={};for(var _=r.scope||c.getDefaultScope(),L=Wt(_,!0),H=Wt(r.source),W=Wt(r.target),tt=!D&&L.length>1?{}:[],ct=function(xt,kt){if(!D&&L.length>1){var Lt=tt[xt];Lt==null&&(Lt=tt[xt]=[]),Lt.push(kt)}else tt.push(kt)},ot=0,ut=p.length;ot<ut;ot++){var lt=p[ot],Et=lt.proxies&&lt.proxies[0]?lt.proxies[0].originalEp.elementId:lt.sourceId,mt=lt.proxies&&lt.proxies[1]?lt.proxies[1].originalEp.elementId:lt.targetId;zt(L,lt.scope)&&zt(H,Et)&&zt(W,mt)&&ct(lt.scope,lt)}return tt};var ve=function(r,D){return function(_){for(var L=0,H=r.length;L<H;L++)_(r[L]);return D(r)}},he=function(r){return function(D){return r[D]}},me=function(r,D){var _={length:r.length,each:ve(r,D),get:he(r)},L=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],H=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],W,tt;for(W=0,tt=L.length;W<tt;W++)_[L[W]]=Ut(r,L[W],D);for(W=0,tt=H.length;W<tt;W++)_[H[W]]=ie(r,H[W]);return _},Ht=function(r){var D=me(r,Ht);return T.extend(D,{setDetachable:Ut(r,"setDetachable",Ht),setReattach:Ut(r,"setReattach",Ht),setConnector:Ut(r,"setConnector",Ht),delete:function(){for(var _=0,L=r.length;_<L;_++)c.deleteConnection(r[_])},isDetachable:ie(r,"isDetachable"),isReattach:ie(r,"isReattach")})},fe=function(r){var D=me(r,fe);return T.extend(D,{setEnabled:Ut(r,"setEnabled",fe),setAnchor:Ut(r,"setAnchor",fe),isEnabled:ie(r,"isEnabled"),deleteEveryConnection:function(){for(var _=0,L=r.length;_<L;_++)r[_].deleteEveryConnection()},delete:function(){for(var _=0,L=r.length;_<L;_++)c.deleteEndpoint(r[_])}})};this.select=function(r){return r=r||{},r.scope=r.scope||"*",Ht(r.connections||c.getConnections(r,!0))},this.selectEndpoints=function(r){r=r||{},r.scope=r.scope||"*";var D=!r.element&&!r.source&&!r.target,_=D?"*":Wt(r.element),L=D?"*":Wt(r.source),H=D?"*":Wt(r.target),W=Wt(r.scope,!0),tt=[];for(var ct in v){var ot=zt(_,ct,!0),ut=zt(L,ct,!0),lt=L!=="*",Et=zt(H,ct,!0),mt=H!=="*";if(ot||ut||Et){t:for(var xt=0,kt=v[ct].length;xt<kt;xt++){var Lt=v[ct][xt];if(zt(W,Lt.scope,!0)){var be=lt&&L.length>0&&!Lt.isSource,ye=mt&&H.length>0&&!Lt.isTarget;if(be||ye)continue t;tt.push(Lt)}}}}return fe(tt)},this.getAllConnections=function(){return p},this.getDefaultScope=function(){return e},this.getEndpoint=V,this.getEndpoints=function(r){return v[b(r).id]||[]},this.getDefaultEndpointType=function(){return T.Endpoint},this.getDefaultConnectionType=function(){return T.Connection},this.getId=vt,this.draw=R,this.info=b,this.appendElement=S;var se=!1;this.isHoverSuspended=function(){return se},this.setHoverSuspended=function(r){se=r},this.hide=function(r,D){return ht(r,"none",D),c},this.idstamp=A;var oe=function(r){if(!g&&r){var D=c.getElement(r);D.offsetParent&&c.setContainer(D.offsetParent)}},Tt=function(){c.Defaults.Container&&c.setContainer(c.Defaults.Container)},Yt=c.manage=function(r,D,_){return w[r]||(w[r]={el:D,endpoints:[],connections:[]},w[r].info=jt({elId:r,timestamp:i}),c.addClass(D,"jtk-managed"),_||c.fire("manageElement",{id:r,info:w[r].info,el:D})),w[r]};c.unmanage=function(r){if(w[r]){var D=w[r].el;c.removeClass(D,"jtk-managed"),delete w[r],c.fire("unmanageElement",{id:r,el:D})}};var jt=function(r){var D=r.timestamp,_=r.recalc,L=r.offset,H=r.elId,W;return N&&!D&&(D=i),!_&&D&&D===d[H]?{o:r.offset||u[H],s:k[H]}:(_||!L&&u[H]==null?(W=w[H]?w[H].el:null,W!=null&&(k[H]=c.getSize(W),u[H]=c.getOffset(W),d[H]=D)):(u[H]=L||u[H],k[H]==null&&(W=w[H].el,W!=null&&(k[H]=c.getSize(W))),d[H]=D),u[H]&&!u[H].right&&(u[H].right=u[H].left+k[H][0],u[H].bottom=u[H].top+k[H][1],u[H].width=k[H][0],u[H].height=k[H][1],u[H].centerx=u[H].left+u[H].width/2,u[H].centery=u[H].top+u[H].height/2),{o:u[H],s:k[H]})};this.updateOffset=jt,this.init=function(){I||(Tt(),c.anchorManager=new q.jsPlumb.AnchorManager({jsPlumbInstance:c}),I=!0,c.fire("ready",c))}.bind(this),this.log=E,this.jsPlumbUIComponent=t,this.makeAnchor=function(){var r,D=function(tt,ct){if(q.jsPlumb.Anchors[tt])return new q.jsPlumb.Anchors[tt](ct);if(!c.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+tt+"'"}};if(arguments.length===0)return null;var _=arguments[0],L=arguments[1],H=null;if(_.compute&&_.getOrientation)return _;if(typeof _=="string")H=D(arguments[0],{elementId:L,jsPlumbInstance:c});else if(f.isArray(_))if(f.isArray(_[0])||f.isString(_[0]))_.length===2&&f.isObject(_[1])?f.isString(_[0])?(r=q.jsPlumb.extend({elementId:L,jsPlumbInstance:c},_[1]),H=D(_[0],r)):(r=q.jsPlumb.extend({elementId:L,jsPlumbInstance:c,anchors:_[0]},_[1]),H=new q.jsPlumb.DynamicAnchor(r)):H=new T.DynamicAnchor({anchors:_,selector:null,elementId:L,jsPlumbInstance:c});else{var W={x:_[0],y:_[1],orientation:_.length>=4?[_[2],_[3]]:[0,0],offsets:_.length>=6?[_[4],_[5]]:[0,0],elementId:L,jsPlumbInstance:c,cssClass:_.length===7?_[6]:null};H=new q.jsPlumb.Anchor(W),H.clone=function(){return new q.jsPlumb.Anchor(W)}}return H.id||(H.id="anchor_"+A()),H},this.makeAnchors=function(r,D,_){for(var L=[],H=0,W=r.length;H<W;H++)typeof r[H]=="string"?L.push(q.jsPlumb.Anchors[r[H]]({elementId:D,jsPlumbInstance:_})):f.isArray(r[H])&&L.push(c.makeAnchor(r[H],D,_));return L},this.makeDynamicAnchor=function(r,D){return new q.jsPlumb.DynamicAnchor({anchors:r,selector:D,elementId:null,jsPlumbInstance:c})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var Jt=function(r,D,_,L,H){for(var W=r.target||r.srcElement,tt=!1,ct=L.getSelector(D,_),ot=0;ot<ct.length;ot++)if(ct[ot]===W){tt=!0;break}return H?!tt:tt},Qt=function(r,D,_,L,H){var W=new t(D),tt=D._jsPlumb.EndpointDropHandler({jsPlumb:c,enabled:function(){return r.def.enabled},isFull:function(){var ot=c.select({target:r.id}).length;return r.def.maxConnections>0&&ot>=r.def.maxConnections},element:r.el,elementId:r.id,isSource:L,isTarget:H,addClass:function(ot){c.addClass(r.el,ot)},removeClass:function(ot){c.removeClass(r.el,ot)},onDrop:function(ot){var ut=ot.endpoints[0];ut.anchor.unlock()},isDropAllowed:function(){return W.isDropAllowed.apply(W,arguments)},isRedrop:function(ot){return ot.suspendedElement!=null&&ot.suspendedEndpoint!=null&&ot.suspendedEndpoint.element===r.el},getEndpoint:function(ot){var ut=r.def.endpoint;if(ut==null||ut._jsPlumb==null){var lt=c.deriveEndpointAndAnchorSpec(ot.getType().join(" "),!0),Et=lt.endpoints?q.jsPlumb.extend(D,{endpoint:r.def.def.endpoint||lt.endpoints[1]}):D;lt.anchors&&(Et=q.jsPlumb.extend(Et,{anchor:r.def.def.anchor||lt.anchors[1]})),ut=c.addEndpoint(r.el,Et),ut._mtNew=!0}if(D.uniqueEndpoint&&(r.def.endpoint=ut),ut.setDeleteOnEmpty(!0),ot.isDetachable()&&ut.initDraggable(),ut.anchor.positionFinder!=null){var mt=c.getUIPosition(arguments,c.getZoom()),xt=c.getOffset(r.el),kt=c.getSize(r.el),Lt=mt==null?[0,0]:ut.anchor.positionFinder(mt,xt,kt,ut.anchor.constructorParams);ut.anchor.x=Lt[0],ut.anchor.y=Lt[1]}return ut},maybeCleanup:function(ot){ot._mtNew&&ot.connections.length===0?c.deleteObject({endpoint:ot}):delete ot._mtNew}}),ct=q.jsPlumb.dragEvents.drop;return _.scope=_.scope||D.scope||c.Defaults.Scope,_[ct]=f.wrap(_[ct],tt,!0),_.rank=D.rank||0,H&&(_[q.jsPlumb.dragEvents.over]=function(){return!0}),D.allowLoopback===!1&&(_.canDrop=function(ot){var ut=ot.getDragElement()._jsPlumbRelatedElement;return ut!==r.el}),c.initDroppable(r.el,_,"internal"),tt};this.makeTarget=function(r,D,_){var L=q.jsPlumb.extend({_jsPlumb:this},_);q.jsPlumb.extend(L,D);for(var H=L.maxConnections||-1,W=function(ut){var lt=b(ut),Et=lt.id,mt=q.jsPlumb.extend({},L.dropOptions||{}),xt=L.connectionType||"default";this.targetEndpointDefinitions[Et]=this.targetEndpointDefinitions[Et]||{},oe(Et),lt.el._isJsPlumbGroup&&mt.rank==null&&(mt.rank=-1);var kt={def:q.jsPlumb.extend({},L),uniqueEndpoint:L.uniqueEndpoint,maxConnections:H,enabled:!0};L.createEndpoint&&(kt.uniqueEndpoint=!0,kt.endpoint=c.addEndpoint(ut,kt.def),kt.endpoint.setDeleteOnEmpty(!1)),lt.def=kt,this.targetEndpointDefinitions[Et][xt]=kt,Qt(lt,L,mt,L.isSource===!0,!0),lt.el._katavorioDrop[lt.el._katavorioDrop.length-1].targetDef=kt}.bind(this),tt=r.length&&r.constructor!==String?r:[r],ct=0,ot=tt.length;ct<ot;ct++)W(tt[ct]);return this},this.unmakeTarget=function(r,D){var _=b(r);return c.destroyDroppable(_.el,"internal"),D||delete this.targetEndpointDefinitions[_.id],this},this.makeSource=function(r,D,_){var L=q.jsPlumb.extend({_jsPlumb:this},_);q.jsPlumb.extend(L,D);var H=L.connectionType||"default",W=c.deriveEndpointAndAnchorSpec(H);L.endpoint=L.endpoint||W.endpoints[0],L.anchor=L.anchor||W.anchors[0];for(var tt=L.maxConnections||-1,ct=L.onMaxConnections,ot=function(mt){var xt=mt.id,kt=this.getElement(mt.el);this.sourceEndpointDefinitions[xt]=this.sourceEndpointDefinitions[xt]||{},oe(xt);var Lt={def:q.jsPlumb.extend({},L),uniqueEndpoint:L.uniqueEndpoint,maxConnections:tt,enabled:!0};L.createEndpoint&&(Lt.uniqueEndpoint=!0,Lt.endpoint=c.addEndpoint(r,Lt.def),Lt.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[xt][H]=Lt,mt.def=Lt;var be=q.jsPlumb.dragEvents.stop,ye=q.jsPlumb.dragEvents.drag,Kt=q.jsPlumb.extend({},L.dragOptions||{}),Le=Kt.drag,Te=Kt.stop,Ft=null,_e=!1;Kt.scope=Kt.scope||L.scope,Kt[ye]=f.wrap(Kt[ye],function(){Le&&Le.apply(this,arguments),_e=!1}),Kt[be]=f.wrap(Kt[be],function(){if(Te&&Te.apply(this,arguments),this.currentlyDragging=!1,Ft._jsPlumb!=null){var Vt=L.anchor||this.Defaults.Anchor,Nt=Ft.anchor,Ce=Ft.connections[0],te=this.makeAnchor(Vt,xt,this),pe=Ft.element;if(te.positionFinder!=null){var qt=c.getOffset(pe),ee=this.getSize(pe),Pe={left:qt.left+Nt.x*ee[0],top:qt.top+Nt.y*ee[1]},ge=te.positionFinder(Pe,qt,ee,te.constructorParams);te.x=ge[0],te.y=ge[1]}Ft.setAnchor(te,!0),Ft.repaint(),this.repaint(Ft.elementId),Ce!=null&&this.repaint(Ce.targetId)}}.bind(this));var Ie=function(Vt){if(!(Vt.which===3||Vt.button===2)){var Nt=this.sourceEndpointDefinitions[xt][H];if(!!Nt.enabled){if(xt=this.getId(this.getElement(mt.el)),L.filter){var Ce=f.isString(L.filter)?Jt(Vt,mt.el,L.filter,this,L.filterExclude):L.filter(Vt,mt.el);if(Ce===!1)return}var te=this.select({source:xt}).length;if(Nt.maxConnections>=0&&te>=Nt.maxConnections)return ct&&ct({element:mt.el,maxConnections:tt},Vt),!1;var pe=q.jsPlumb.getPositionOnElement(Vt,kt,M),qt={};q.jsPlumb.extend(qt,Nt.def),qt.isTemporarySource=!0,qt.anchor=[pe[0],pe[1],0,0],qt.dragOptions=Kt,Nt.def.scope&&(qt.scope=Nt.def.scope),Ft=this.addEndpoint(xt,qt),_e=!0,Ft.setDeleteOnEmpty(!0),Nt.uniqueEndpoint&&(Nt.endpoint?Ft.finalEndpoint=Nt.endpoint:(Nt.endpoint=Ft,Ft.setDeleteOnEmpty(!1)));var ee=function(){c.off(Ft.canvas,"mouseup",ee),c.off(mt.el,"mouseup",ee),_e&&(_e=!1,c.deleteEndpoint(Ft))};c.on(Ft.canvas,"mouseup",ee),c.on(mt.el,"mouseup",ee);var Pe={};if(Nt.def.extract)for(var ge in Nt.def.extract){var Fe=(Vt.srcElement||Vt.target).getAttribute(ge);Fe&&(Pe[Nt.def.extract[ge]]=Fe)}c.trigger(Ft.canvas,"mousedown",Vt,Pe),f.consume(Vt)}}}.bind(this);this.on(mt.el,"mousedown",Ie),Lt.trigger=Ie,L.filter&&(f.isString(L.filter)||f.isFunction(L.filter))&&c.setDragFilter(mt.el,L.filter);var Ue=q.jsPlumb.extend({},L.dropOptions||{});Qt(mt,L,Ue,!0,L.isTarget===!0)}.bind(this),ut=r.length&&r.constructor!==String?r:[r],lt=0,Et=ut.length;lt<Et;lt++)ot(b(ut[lt]));return this},this.unmakeSource=function(r,D,_){var L=b(r);c.destroyDroppable(L.el,"internal");var H=this.sourceEndpointDefinitions[L.id];if(H){for(var W in H)if(D==null||D===W){var tt=H[W].trigger;tt&&c.off(L.el,"mousedown",tt),_||delete this.sourceEndpointDefinitions[L.id][W]}}return this},this.unmakeEverySource=function(){for(var r in this.sourceEndpointDefinitions)c.unmakeSource(r,null,!0);return this.sourceEndpointDefinitions={},this};var et=function(r,D,_){D=f.isArray(D)?D:[D];var L=vt(r);_=_||"default";for(var H=0;H<D.length;H++){var W=this[D[H]][L];if(W&&W[_])return W[_].def.scope||this.Defaults.Scope}}.bind(this),Ct=function(r,D,_,L){_=f.isArray(_)?_:[_];var H=vt(r);L=L||"default";for(var W=0;W<_.length;W++){var tt=this[_[W]][H];tt&&tt[L]&&(tt[L].def.scope=D)}}.bind(this);this.getScope=function(r,D){return et(r,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(r){return et(r,"sourceEndpointDefinitions")},this.getTargetScope=function(r){return et(r,"targetEndpointDefinitions")},this.setScope=function(r,D,_){this.setSourceScope(r,D,_),this.setTargetScope(r,D,_)},this.setSourceScope=function(r,D,_){Ct(r,D,"sourceEndpointDefinitions",_),this.setDragScope(r,D)},this.setTargetScope=function(r,D,_){Ct(r,D,"targetEndpointDefinitions",_),this.setDropScope(r,D)},this.unmakeEveryTarget=function(){for(var r in this.targetEndpointDefinitions)c.unmakeTarget(r,!0);return this.targetEndpointDefinitions={},this};var Pt=function(r,D,_,L,H){var W=r==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,tt,ct,ot;if(H=H||"default",D.length&&!f.isString(D)){tt=[];for(var ut=0,lt=D.length;ut<lt;ut++)ct=b(D[ut]),W[ct.id]&&W[ct.id][H]&&(tt[ut]=W[ct.id][H].enabled,ot=L?!tt[ut]:_,W[ct.id][H].enabled=ot,c[ot?"removeClass":"addClass"](ct.el,"jtk-"+r+"-disabled"))}else{ct=b(D);var Et=ct.id;W[Et]&&W[Et][H]&&(tt=W[Et][H].enabled,ot=L?!tt:_,W[Et][H].enabled=ot,c[ot?"removeClass":"addClass"](ct.el,"jtk-"+r+"-disabled"))}return tt}.bind(this),yt=function(r,D){if(f.isString(r)||!r.length)return D.apply(this,[r]);if(r.length)return D.apply(this,[r[0]])}.bind(this);this.toggleSourceEnabled=function(r,D){return Pt("source",r,null,!0,D),this.isSourceEnabled(r,D)},this.setSourceEnabled=function(r,D,_){return Pt("source",r,D,null,_)},this.isSource=function(r,D){return D=D||"default",yt(r,function(_){var L=this.sourceEndpointDefinitions[b(_).id];return L!=null&&L[D]!=null}.bind(this))},this.isSourceEnabled=function(r,D){return D=D||"default",yt(r,function(_){var L=this.sourceEndpointDefinitions[b(_).id];return L&&L[D]&&L[D].enabled===!0}.bind(this))},this.toggleTargetEnabled=function(r,D){return Pt("target",r,null,!0,D),this.isTargetEnabled(r,D)},this.isTarget=function(r,D){return D=D||"default",yt(r,function(_){var L=this.targetEndpointDefinitions[b(_).id];return L!=null&&L[D]!=null}.bind(this))},this.isTargetEnabled=function(r,D){return D=D||"default",yt(r,function(_){var L=this.targetEndpointDefinitions[b(_).id];return L&&L[D]&&L[D].enabled===!0}.bind(this))},this.setTargetEnabled=function(r,D,_){return Pt("target",r,D,null,_)},this.ready=function(r){c.bind("ready",r)};var St=function(r,D){if(typeof r=="object"&&r.length)for(var _=0,L=r.length;_<L;_++)D(r[_]);else D(r);return c};this.repaint=function(r,D,_){return St(r,function(L){R(L,D,_)})},this.revalidate=function(r,D,_){return St(r,function(L){var H=_?L:c.getId(L);c.updateOffset({elId:H,recalc:!0,timestamp:D});var W=c.getDragManager();W&&W.updateOffsets(H),c.repaint(L)})},this.repaintEverything=function(){var r=U(),D;for(D in v)c.updateOffset({elId:D,recalc:!0,timestamp:r});for(D in v)R(D,null,r);return this},this.removeAllEndpoints=function(r,D,_){_=_||[];var L=function(H){var W=b(H),tt=v[W.id],ct,ot;if(tt)for(_.push(W),ct=0,ot=tt.length;ct<ot;ct++)c.deleteEndpoint(tt[ct],!1);if(delete v[W.id],D&&W.el&&W.el.nodeType!==3&&W.el.nodeType!==8)for(ct=0,ot=W.el.childNodes.length;ct<ot;ct++)L(W.el.childNodes[ct])};return L(r),this};var At=function(r,D){c.removeAllEndpoints(r.id,!0,D);for(var _=c.getDragManager(),L=function(W){_&&_.elementRemoved(W.id),c.anchorManager.clearFor(W.id),c.anchorManager.removeFloatingConnection(W.id),c.isSource(W.el)&&c.unmakeSource(W.el),c.isTarget(W.el)&&c.unmakeTarget(W.el),c.destroyDraggable(W.el),c.destroyDroppable(W.el),delete c.floatingConnections[W.id],delete w[W.id],delete u[W.id],W.el&&(c.removeElement(W.el),W.el._jsPlumb=null)},H=1;H<D.length;H++)L(D[H]);L(r)};this.remove=function(r,D){var _=b(r),L=[];return _.text&&_.el.parentNode?_.el.parentNode.removeChild(_.el):_.id&&c.batch(function(){At(_,L)},D===!0),c},this.empty=function(r,D){var _=[],L=function(H,W){var tt=b(H);if(tt.text)tt.el.parentNode.removeChild(tt.el);else if(tt.el){for(;tt.el.childNodes.length>0;)L(tt.el.childNodes[0]);W||At(tt,_)}};return c.batch(function(){L(r,!0)},D===!1),c},this.reset=function(r){c.silently(function(){se=!1,c.removeAllGroups(),c.removeGroupManager(),c.deleteEveryEndpoint(),r||c.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},p.length=0,this.doReset&&this.doReset()}.bind(this))};var Rt=function(r){r.canvas&&r.canvas.parentNode&&r.canvas.parentNode.removeChild(r.canvas),r.cleanup(),r.destroy()};this.clear=function(){c.select().each(Rt),c.selectEndpoints().each(Rt),v={},C={}},this.setDefaultScope=function(r){return e=r,c},this.deriveEndpointAndAnchorSpec=function(r,D){for(var _=((D?"":"default ")+r).split(/[\s]/),L=null,H=null,W=null,tt=null,ct=0;ct<_.length;ct++){var ot=c.getType(_[ct],"connection");ot&&(ot.endpoints&&(L=ot.endpoints),ot.endpoint&&(H=ot.endpoint),ot.anchors&&(tt=ot.anchors),ot.anchor&&(W=ot.anchor))}return{endpoints:L||[H,H],anchors:tt||[W,W]}},this.setId=function(r,D,_){var L;f.isString(r)?L=r:(r=this.getElement(r),L=this.getId(r));var H=this.getConnections({source:L,scope:"*"},!0),W=this.getConnections({target:L,scope:"*"},!0);D=""+D,_?r=this.getElement(D):(r=this.getElement(L),this.setAttribute(r,"id",D)),v[D]=v[L]||[];for(var tt=0,ct=v[D].length;tt<ct;tt++)v[D][tt].setElementId(D),v[D][tt].setReferenceElement(r);delete v[L],this.sourceEndpointDefinitions[D]=this.sourceEndpointDefinitions[L],delete this.sourceEndpointDefinitions[L],this.targetEndpointDefinitions[D]=this.targetEndpointDefinitions[L],delete this.targetEndpointDefinitions[L],this.anchorManager.changeId(L,D);var ot=this.getDragManager();ot&&ot.changeId(L,D),w[D]=w[L],delete w[L];var ut=function(lt,Et,mt){for(var xt=0,kt=lt.length;xt<kt;xt++)lt[xt].endpoints[Et].setElementId(D),lt[xt].endpoints[Et].setReferenceElement(r),lt[xt][mt+"Id"]=D,lt[xt][mt]=r};ut(H,0,"source"),ut(W,1,"target"),this.repaint(D)},this.setDebugLog=function(r){E=r},this.setSuspendDrawing=function(r,D){var _=N;return N=r,r?i=new Date().getTime():i=null,D&&this.repaintEverything(),_},this.isSuspendDrawing=function(){return N},this.getSuspendedAt=function(){return i},this.batch=function(r,D){var _=this.isSuspendDrawing();_||this.setSuspendDrawing(!0);try{r()}catch(L){f.log("Function run while suspended failed",L)}_||this.setSuspendDrawing(!1,!D)},this.doWhileSuspended=this.batch,this.getCachedData=at,this.timestamp=U,this.show=function(r,D){return ht(r,"block",D),c},this.toggleVisible=dt,this.addListener=this.bind;var re=[];this.registerFloatingConnection=function(r,D,_){re[r.id]=D,f.addToList(v,r.id,_)},this.getFloatingConnectionFor=function(r){return re[r]},this.listManager=new q.jsPlumbListManager(this)};f.extend(q.jsPlumbInstance,f.EventGenerator,{setAttribute:function(s,c,F){this.setAttribute(s,c,F)},getAttribute:function(s,c){return this.getAttribute(q.jsPlumb.getElement(s),c)},convertToFullOverlaySpec:function(s){return f.isString(s)&&(s=[s,{}]),s[1].id=s[1].id||f.uuid(),s},registerConnectionType:function(s,c){if(this._connectionTypes[s]=q.jsPlumb.extend({},c),c.overlays){for(var F={},G=0;G<c.overlays.length;G++){var B=this.convertToFullOverlaySpec(c.overlays[G]);F[B[1].id]=B}this._connectionTypes[s].overlays=F}},registerConnectionTypes:function(s){for(var c in s)this.registerConnectionType(c,s[c])},registerEndpointType:function(s,c){if(this._endpointTypes[s]=q.jsPlumb.extend({},c),c.overlays){for(var F={},G=0;G<c.overlays.length;G++){var B=this.convertToFullOverlaySpec(c.overlays[G]);F[B[1].id]=B}this._endpointTypes[s].overlays=F}},registerEndpointTypes:function(s){for(var c in s)this.registerEndpointType(c,s[c])},getType:function(s,c){return c==="connection"?this._connectionTypes[s]:this._endpointTypes[s]},setIdChanged:function(s,c){this.setId(s,c,!0)},setParent:function(s,c){var F=this.getElement(s),G=this.getId(F),B=this.getElement(c),M=this.getId(B),b=this.getDragManager();F.parentNode.removeChild(F),B.appendChild(F),b&&b.setParent(F,G,B,M)},extend:function(s,c,F){var G;if(F)for(G=0;G<F.length;G++)s[F[G]]=c[F[G]];else for(G in c)s[G]=c[G];return s},floatingConnections:{},getFloatingAnchorIndex:function(s){return s.endpoints[0].isFloating()?0:s.endpoints[1].isFloating()?1:-1},proxyConnection:function(s,c,F,G,B,M){var b,o=s.endpoints[c].elementId,g=s.endpoints[c];s.proxies=s.proxies||[],s.proxies[c]?b=s.proxies[c].ep:b=this.addEndpoint(F,{endpoint:B(s,c),anchor:M(s,c),parameters:{isProxyEndpoint:!0}}),b.setDeleteOnEmpty(!0),s.proxies[c]={ep:b,originalEp:g},c===0?this.anchorManager.sourceChanged(o,G,s,F):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,o,G,s),s.target=F,s.targetId=G),g.detachFromConnection(s,null,!0),b.connections=[s],s.endpoints[c]=b,g.setVisible(!1),s.setVisible(!0),this.revalidate(F)},unproxyConnection:function(s,c,F){if(!(s._jsPlumb==null||s.proxies==null||s.proxies[c]==null)){var G=s.proxies[c].originalEp.element,B=s.proxies[c].originalEp.elementId;s.endpoints[c]=s.proxies[c].originalEp,c===0?this.anchorManager.sourceChanged(F,B,s,G):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,F,B,s),s.target=G,s.targetId=B),s.proxies[c].ep.detachFromConnection(s,null),s.proxies[c].originalEp.addConnection(s),s.isVisible()&&s.proxies[c].originalEp.setVisible(!0),delete s.proxies[c]}}});var T=new x;q.jsPlumb=T,T.getInstance=function(s,c){var F=new x(s);if(c)for(var G in c)F[G]=c[G];return F.init(),F},T.each=function(s,c){if(s!=null)if(typeof s=="string")c(T.getElement(s));else if(s.length!=null)for(var F=0;F<s.length;F++)c(T.getElement(s[F]));else c(s)},typeof exports<"u"&&(exports.jsPlumb=T)}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J="__label",Y=function(l,O){var a={cssClass:O.cssClass,labelStyle:l.labelStyle,id:J,component:l,_jsPlumb:l._jsPlumb.instance},t=f.extend(a,O);return new f.Overlays[l._jsPlumb.instance.getRenderMode()].Label(t)},$=function(l,O){var a=null;if(U.isArray(O)){var t=O[0],m=f.extend({component:l,_jsPlumb:l._jsPlumb.instance},O[1]);O.length===3&&f.extend(m,O[2]),a=new f.Overlays[l._jsPlumb.instance.getRenderMode()][t](m)}else O.constructor===String?a=new f.Overlays[l._jsPlumb.instance.getRenderMode()][O]({component:l,_jsPlumb:l._jsPlumb.instance}):a=O;return a.id=a.id||U.uuid(),l.cacheTypeItem("overlay",a,a.id),l._jsPlumb.overlays[a.id]=a,a};f.OverlayCapableJsPlumbUIComponent=function(l){q.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},l.label?this.getDefaultType().overlays[J]=["Label",{label:l.label,location:l.labelLocation||this.defaultLabelLocation||.5,labelStyle:l.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:J}]:l.id&&(this.getDefaultType().overlays[J]=["Label",{label:l.label,location:l.labelLocation||this.defaultLabelLocation||.5,labelStyle:l.emptyLabelStyle||this._jsPlumb.instance.Defaults.emptyLabelStyle,id:J}]),this.setListenerComponent=function(O){if(this._jsPlumb)for(var a in this._jsPlumb.overlays)this._jsPlumb.overlays[a].setListenerComponent(O)}},f.OverlayCapableJsPlumbUIComponent.applyType=function(l,O){if(O.overlays){var a={},t;for(t in O.overlays){var m=l._jsPlumb.overlays[O.overlays[t][1].id];if(m)m.updateFrom(O.overlays[t][1]),a[O.overlays[t][1].id]=!0;else{var y=l.getCachedTypeItem("overlay",O.overlays[t][1].id);y!=null?(y.reattach(l._jsPlumb.instance,l),y.setVisible(!0),y.updateFrom(O.overlays[t][1]),l._jsPlumb.overlays[y.id]=y):y=l.addOverlay(O.overlays[t],!0),a[y.id]=!0}}for(t in l._jsPlumb.overlays)a[l._jsPlumb.overlays[t].id]==null&&l.removeOverlay(l._jsPlumb.overlays[t].id,!0)}},U.extend(f.OverlayCapableJsPlumbUIComponent,q.jsPlumbUIComponent,{setHover:function(l,O){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var a in this._jsPlumb.overlays)this._jsPlumb.overlays[a][l?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(l,O){var a=$(this,l);if(this.getData&&a.type==="Label"&&U.isArray(l)){var t=this.getData(),m=l[1];if(t){var y=m.labelLocationAttribute||"labelLocation",j=t?t[y]:null;j&&(a.loc=j)}}return O||this.repaint(),a},getOverlay:function(l){return this._jsPlumb.overlays[l]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(l){var O=this.getOverlay(l);O&&O.hide()},hideOverlays:function(){for(var l in this._jsPlumb.overlays)this._jsPlumb.overlays[l].hide()},showOverlay:function(l){var O=this.getOverlay(l);O&&O.show()},showOverlays:function(){for(var l in this._jsPlumb.overlays)this._jsPlumb.overlays[l].show()},removeAllOverlays:function(l){for(var O in this._jsPlumb.overlays)this._jsPlumb.overlays[O].cleanup&&this._jsPlumb.overlays[O].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},l||this.repaint()},removeOverlay:function(l,O){var a=this._jsPlumb.overlays[l];a&&(a.setVisible(!1),!O&&a.cleanup&&a.cleanup(),delete this._jsPlumb.overlays[l],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[l],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[l])},removeOverlays:function(){for(var l=0,O=arguments.length;l<O;l++)this.removeOverlay(arguments[l])},moveParent:function(l){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),l.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),l.appendChild(this.canvas);for(var O in this._jsPlumb.overlays)if(this._jsPlumb.overlays[O].isAppendedAtTopLevel){var a=this._jsPlumb.overlays[O].getElement();a.parentNode.removeChild(a),l.appendChild(a)}}},getLabel:function(){var l=this.getOverlay(J);return l!=null?l.getLabel():null},getLabelOverlay:function(){return this.getOverlay(J)},setLabel:function(l){var O=this.getOverlay(J);if(O)l.constructor===String||l.constructor===Function?O.setLabel(l):(l.label||(l.label=""),O.setLabel(l.label),l.location&&O.setLocation(l.location));else{var a=l.constructor===String||l.constructor===Function?{label:l}:l;O=Y(this,a),this._jsPlumb.overlays[J]=O}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(l){for(var O in this._jsPlumb.overlays)this._jsPlumb.overlays[O].cleanup(l),this._jsPlumb.overlays[O].destroy(l);l&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(l){this[l?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(l,O){this._jsPlumb.overlayPositions[l.id]=O},getAbsoluteOverlayPosition:function(l){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[l.id]:null},_clazzManip:function(l,O,a){if(!a)for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t][l+"Class"](O)},addClass:function(l,O){this._clazzManip("add",l,O)},removeClass:function(l,O){this._clazzManip("remove",l,O)}})}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J=function(a,t,m){var y=!1;return{drag:function(){if(y)return y=!1,!0;if(t.element){var j=m.getUIPosition(arguments,m.getZoom());j!=null&&m.setPosition(t.element,j),m.repaint(t.element,j),a.paint({anchorPoint:a.anchor.getCurrentLocation({element:a})})}},stopDrag:function(){y=!0}}},Y=function(a,t,m,y){var j=t.createElement("div",{position:"absolute"});t.appendElement(j);var x=t.getId(j);t.setPosition(j,m),j.style.width=y[0]+"px",j.style.height=y[1]+"px",t.manage(x,j,!0),a.id=x,a.element=j},$=function(a,t,m,y,j,x,T,s){var c=new f.FloatingAnchor({reference:t,referenceCanvas:y,jsPlumbInstance:x});return T({paintStyle:a,endpoint:m,anchor:c,source:j,scope:s})},l=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],O=function(a,t){var m=0;if(t!=null){for(var y=0;y<a.connections.length;y++)if(a.connections[y].sourceId===t||a.connections[y].targetId===t){m=y;break}}return a.connections[m]};f.Endpoint=function(a){var t=a._jsPlumb,m=a.newConnection,y=a.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],f.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:a.connectionType,maxConnections:a.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:a.maxConnections,paintStyle:a.endpointStyle||a.paintStyle||a.style||this._jsPlumb.instance.Defaults.EndpointStyle||f.Defaults.EndpointStyle,hoverPaintStyle:a.endpointHoverStyle||a.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||f.Defaults.EndpointHoverStyle,connectorStyle:a.connectorStyle,connectorHoverStyle:a.connectorHoverStyle,connectorClass:a.connectorClass,connectorHoverClass:a.connectorHoverClass,connectorOverlays:a.connectorOverlays,connector:a.connector,connectorTooltip:a.connectorTooltip}),this._jsPlumb.enabled=a.enabled!==!1,this._jsPlumb.visible=!0,this.element=f.getElement(a.source),this._jsPlumb.uuid=a.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(a.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=a.elementId,this.dragProxy=a.dragProxy,this._jsPlumb.connectionCost=a.connectionCost,this._jsPlumb.connectionsDirected=a.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var j=a.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(M){j=M};var x=function(){var M=t.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var b=t.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(M),this.addClass(b),f.updateClasses(this.element,b,M)}.bind(this);this.prepareAnchor=function(M){var b=this._jsPlumb.instance.makeAnchor(M,this.elementId,t);return b.bind("anchorChanged",function(o){this.fire("anchorChanged",{endpoint:this,anchor:o}),x()}.bind(this)),b},this.setPreparedAnchor=function(M,b){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=M,x(),b||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(M,b){var o=this.prepareAnchor(M);return this.setPreparedAnchor(o,b),this};var T=function(M){if(this.connections.length>0)for(var b=0;b<this.connections.length;b++)this.connections[b].setHover(M,!1);else this.setHover(M)}.bind(this);this.bind("mouseover",function(){T(!0)}),this.bind("mouseout",function(){T(!1)}),a._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(M,b){var o=function(E,I){var p=t.getRenderMode();if(f.Endpoints[p][E])return new f.Endpoints[p][E](I);if(!t.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+E+"'"}},g={_jsPlumb:this._jsPlumb.instance,cssClass:a.cssClass,container:a.container,tooltip:a.tooltip,connectorTooltip:a.connectorTooltip,endpoint:this},h;return U.isString(M)?h=o(M,g):U.isArray(M)?(g=U.merge(M[1],g),h=o(M[0],g)):h=M.clone(),h.clone=function(){if(U.isString(M))return o(M,g);if(U.isArray(M))return g=U.merge(M[1],g),o(M[0],g)}.bind(this),h.typeId=b,h},this.setEndpoint=function(M,b){var o=this.prepareEndpoint(M);this.setPreparedEndpoint(o,!0)},this.setPreparedEndpoint=function(M,b){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=M,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},f.extend(this,a,l),this.isSource=a.isSource||!1,this.isTemporarySource=a.isTemporarySource||!1,this.isTarget=a.isTarget||!1,this.connections=a.connections||[],this.connectorPointerEvents=a["connector-pointer-events"],this.scope=a.scope||t.getDefaultScope(),this.timestamp=null,this.reattachConnections=a.reattach||t.Defaults.ReattachConnections,this.connectionsDetachable=t.Defaults.ConnectionsDetachable,(a.connectionsDetachable===!1||a.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=a.dragAllowedWhenFull!==!1,a.onMaxConnections&&this.bind("maxConnections",a.onMaxConnections),this.addConnection=function(M){this.connections.push(M),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)},this.detachFromConnection=function(M,b,o){b=b==null?this.connections.indexOf(M):b,b>=0&&(this.connections.splice(b,1),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)),!o&&j&&this.connections.length===0&&t.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:o!==!0})},this.deleteEveryConnection=function(M){for(var b=this.connections.length,o=0;o<b;o++)t.deleteConnection(this.connections[0],M)},this.detachFrom=function(M,b,o){for(var g=[],h=0;h<this.connections.length;h++)(this.connections[h].endpoints[1]===M||this.connections[h].endpoints[0]===M)&&g.push(this.connections[h]);for(var E=0,I=g.length;E<I;E++)t.deleteConnection(g[0]);return this},this.getElement=function(){return this.element},this.setElement=function(M){var b=this._jsPlumb.instance.getId(M),o=this.elementId;return U.removeWithFunction(a.endpointsByElement[this.elementId],function(g){return g.id===this.id}.bind(this)),this.element=f.getElement(M),this.elementId=t.getId(this.element),t.anchorManager.rehomeEndpoint(this,o,this.element),t.dragManager.endpointAdded(this.element),U.addToList(a.endpointsByElement,b,this),this},this.makeInPlaceCopy=function(){var M=this.anchor.getCurrentLocation({element:this}),b=this.anchor.getOrientation(this),o=this.anchor.getCssClass(),g={bind:function(){},compute:function(){return[M[0],M[1]]},getCurrentLocation:function(){return[M[0],M[1]]},getOrientation:function(){return b},getCssClass:function(){return o}};return y({dropOptions:a.dropOptions,anchor:g,source:this.element,paintStyle:this.getPaintStyle(),endpoint:a.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(M){M=M||{};var b=M.timestamp,o=M.recalc!==!1;if(!b||this.timestamp!==b){var g=t.updateOffset({elId:this.elementId,timestamp:b}),h=M.offset?M.offset.o:g.o;if(h!=null){var E=M.anchorPoint,I=M.connectorPaintStyle;if(E==null){var p=M.dimensions||g.s,v={xy:[h.left,h.top],wh:p,element:this,timestamp:b};if(o&&this.anchor.isDynamic&&this.connections.length>0){var C=O(this,M.elementWithPrecedence),w=C.endpoints[0]===this?1:0,u=w===0?C.sourceId:C.targetId,d=t.getCachedData(u),P=d.o,k=d.s;v.index=w===0?1:0,v.connection=C,v.txy=[P.left,P.top],v.twh=k,v.tElement=C.endpoints[w]}else this.connections.length>0&&(v.connection=this.connections[0]);E=this.anchor.compute(v)}this.endpoint.compute(E,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,I||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=b;for(var N in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(N)){var i=this._jsPlumb.overlays[N];i.isVisible()&&(this._jsPlumb.overlayPlacements[N]=i.draw(this.endpoint,this._jsPlumb.paintStyleInUse),i.paint(this._jsPlumb.overlayPlacements[N]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var s=!1;this.initDraggable=function(){if(!s&&f.isDragSupported(this.element)){var M={id:null,element:null},b=null,o=!1,g=null,h=J(this,M,t),E=a.dragOptions||{},I={},p=f.dragEvents.start,v=f.dragEvents.stop,C=f.dragEvents.drag,w=f.dragEvents.beforeStart,u,d=function(N){u=N.e.payload||{}},P=function(N){b=this.connectorSelector();var i=!0;this.isEnabled()||(i=!1),b==null&&!this.isSource&&!this.isTemporarySource&&(i=!1),this.isSource&&this.isFull()&&!(b!=null&&this.dragAllowedWhenFull)&&(i=!1),b!=null&&!b.isDetachable(this)&&(this.isFull()?i=!1:b=null);var e=t.checkCondition(b==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:b});if(e===!1?i=!1:typeof e=="object"?f.extend(e,u||{}):e=u||{},i===!1)return t.stopDrag&&t.stopDrag(this.canvas),h.stopDrag(),!1;for(var n=0;n<this.connections.length;n++)this.connections[n].setHover(!1);this.addClass("endpointDrag"),t.setConnectionBeingDragged(!0),b&&!this.isFull()&&this.isSource&&(b=null),t.updateOffset({elId:this.elementId});var A=this._jsPlumb.instance.getOffset(this.canvas),S=this.canvas,R=this._jsPlumb.instance.getSize(this.canvas);Y(M,t,A,R),t.setAttributes(this.canvas,{dragId:M.id,elId:this.elementId});var V=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var z=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);z.endpoints[1]&&(V=z.endpoints[1])}var X=this._jsPlumb.instance.makeAnchor("Center");X.isFloating=!0,this._jsPlumb.floatingEndpoint=$(this.getPaintStyle(),X,V,this.canvas,M.element,t,y,this.scope);var nt=this._jsPlumb.floatingEndpoint.anchor;if(b==null)this.setHover(!1,!1),b=m({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:M.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:a.connectorStyle,hoverPaintStyle:a.connectorHoverStyle,connector:a.connector,overlays:a.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:a.scope,data:e}),b.pending=!0,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.anchor=nt,t.fire("connectionDrag",b),t.anchorManager.newConnection(b);else{o=!0,b.setHover(!1);var pt=b.endpoints[0].id===this.id?0:1;this.detachFromConnection(b,null,!0);var ft=t.getDragScope(S);t.setAttribute(this.canvas,"originalScope",ft),t.fire("connectionDrag",b),pt===0?(g=[b.source,b.sourceId,S,ft],t.anchorManager.sourceChanged(b.endpoints[pt].elementId,M.id,b,M.element)):(g=[b.target,b.targetId,S,ft],b.target=M.element,b.targetId=M.id,t.anchorManager.updateOtherEndpoint(b.sourceId,b.endpoints[pt].elementId,b.targetId,b)),b.suspendedEndpoint=b.endpoints[pt],b.suspendedElement=b.endpoints[pt].getElement(),b.suspendedElementId=b.endpoints[pt].elementId,b.suspendedElementType=pt===0?"source":"target",b.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=b.suspendedEndpoint,b.endpoints[pt]=this._jsPlumb.floatingEndpoint,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass)}t.registerFloatingConnection(M,b,this._jsPlumb.floatingEndpoint),t.currentlyDragging=!0}.bind(this),k=function(){if(t.setConnectionBeingDragged(!1),b&&b.endpoints!=null){var N=t.getDropEvent(arguments),i=t.getFloatingAnchorIndex(b);if(b.endpoints[i===0?1:0].anchor.unlock(),b.removeClass(t.draggingClass),this._jsPlumb&&(b.deleteConnectionNow||b.endpoints[i]===this._jsPlumb.floatingEndpoint)&&o&&b.suspendedEndpoint){i===0?(b.floatingElement=b.source,b.floatingId=b.sourceId,b.floatingEndpoint=b.endpoints[0],b.floatingIndex=0,b.source=g[0],b.sourceId=g[1]):(b.floatingElement=b.target,b.floatingId=b.targetId,b.floatingEndpoint=b.endpoints[1],b.floatingIndex=1,b.target=g[0],b.targetId=g[1]);var e=this._jsPlumb.floatingEndpoint;t.setDragScope(g[2],g[3]),b.endpoints[i]=b.suspendedEndpoint,b.isReattach()||b._forceReattach||b._forceDetach||!t.deleteConnection(b,{originalEvent:N})?(b.setHover(!1),b._forceDetach=null,b._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(b),b.suspendedEndpoint.addConnection(b),i===1?t.anchorManager.updateOtherEndpoint(b.sourceId,b.floatingId,b.targetId,b):t.anchorManager.sourceChanged(b.floatingId,b.sourceId,b,b.source),t.repaint(g[1])):t.deleteObject({endpoint:e})}this.deleteAfterDragStop?t.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),t.fire("connectionDragStop",b,N),b.pending&&t.fire("connectionAborted",b,N),t.currentlyDragging=!1,b.suspendedElement=null,b.suspendedEndpoint=null,b=null}M&&M.element&&t.remove(M.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.unlock(),this._jsPlumb.floatingEndpoint=null)}.bind(this);E=f.extend(I,E),E.scope=this.scope||E.scope,E[w]=U.wrap(E[w],d,!1),E[p]=U.wrap(E[p],P,!1),E[C]=U.wrap(E[C],h.drag),E[v]=U.wrap(E[v],k),E.multipleDrop=!1,E.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this),t.initDraggable(this.canvas,E,"internal"),this.canvas._jsPlumbRelatedElement=this.element,s=!0}};var c=a.endpoint||this._jsPlumb.instance.Defaults.Endpoint||f.Defaults.Endpoint;this.setEndpoint(c,!0);var F=a.anchor?a.anchor:a.anchors?a.anchors:t.Defaults.Anchor||"Top";this.setAnchor(F,!0);var G=["default",a.type||""].join(" ");this.addType(G,a.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var B=function(M,b,o,g){if(f.isDropSupported(this.element)){var h=a.dropOptions||t.Defaults.DropOptions||f.Defaults.DropOptions;h=f.extend({},h),h.scope=h.scope||this.scope;var E=f.dragEvents.drop,I=f.dragEvents.over,p=f.dragEvents.out,v=this,C=t.EndpointDropHandler({getEndpoint:function(){return v},jsPlumb:t,enabled:function(){return o!=null?o.isEnabled():!0},isFull:function(){return o.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(w){v.addClass(w)},removeClass:function(w){v.removeClass(w)},isDropAllowed:function(){return v.isDropAllowed.apply(v,arguments)},reference:g,isRedrop:function(w,u){return w.suspendedEndpoint&&u.reference&&w.suspendedEndpoint.id===u.reference.id}});h[E]=U.wrap(h[E],C,!0),h[I]=U.wrap(h[I],function(){var w=f.getDragObject(arguments),u=t.getAttribute(f.getElement(w),"dragId"),d=t.getFloatingConnectionFor(u);if(d!=null){var P=t.getFloatingAnchorIndex(d),k=this.isTarget&&P!==0||d.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===d.suspendedEndpoint.id;if(k){var N=t.checkCondition("checkDropAllowed",{sourceEndpoint:d.endpoints[P],targetEndpoint:this,connection:d});this[(N?"add":"remove")+"Class"](t.endpointDropAllowedClass),this[(N?"remove":"add")+"Class"](t.endpointDropForbiddenClass),d.endpoints[P].anchor.over(this.anchor,this)}}}.bind(this)),h[p]=U.wrap(h[p],function(){var w=f.getDragObject(arguments),u=w==null?null:t.getAttribute(f.getElement(w),"dragId"),d=u?t.getFloatingConnectionFor(u):null;if(d!=null){var P=t.getFloatingAnchorIndex(d),k=this.isTarget&&P!==0||d.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===d.suspendedEndpoint.id;k&&(this.removeClass(t.endpointDropAllowedClass),this.removeClass(t.endpointDropForbiddenClass),d.endpoints[P].anchor.out())}}.bind(this)),t.initDroppable(M,h,"internal",b)}}.bind(this);return this.anchor.isFloating||B(this.canvas,!(a._transient||this.anchor.isFloating),this,a.reference),this},U.extend(f.Endpoint,f.OverlayCapableJsPlumbUIComponent,{setVisible:function(a,t,m){if(this._jsPlumb.visible=a,this.canvas&&(this.canvas.style.display=a?"block":"none"),this[a?"showOverlays":"hideOverlays"](),!t){for(var y=0;y<this.connections.length;y++)if(this.connections[y].setVisible(a),!m){var j=this===this.connections[y].endpoints[0]?1:0;this.connections[y].endpoints[j].connections.length===1&&this.connections[y].endpoints[j].setVisible(a,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(a,t){this.setPaintStyle(a.endpointStyle||a.paintStyle,t),this.setHoverPaintStyle(a.endpointHoverStyle||a.hoverPaintStyle,t),a.maxConnections!=null&&(this._jsPlumb.maxConnections=a.maxConnections),a.scope&&(this.scope=a.scope),f.extend(this,a,l),a.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,a.cssClass),f.OverlayCapableJsPlumbUIComponent.applyType(this,a)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(a){this._jsPlumb.enabled=a},cleanup:function(){var a=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");f.removeClass(this.element,a),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(a){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(a)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(a){var t=!1;if(a){for(var m=0;m<this.connections.length;m++)if(this.connections[m].endpoints[1]===a||this.connections[m].endpoints[0]===a){t=!0;break}}return t},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(a){this._jsPlumb.connectionCost=a},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(a){this._jsPlumb.connectionsDirected=a},setElementId:function(a){this.elementId=a,this.anchor.elementId=a},setReferenceElement:function(a){this.element=f.getElement(a)},setDragAllowedWhenFull:function(a){this.dragAllowedWhenFull=a},equals:function(a){return this.anchor.equals(a.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(a){return this.anchor.compute(a)}}),q.jsPlumbInstance.prototype.EndpointDropHandler=function(a){return function(t){var m=a.jsPlumb;a.removeClass(m.endpointDropAllowedClass),a.removeClass(m.endpointDropForbiddenClass);var y=m.getDropEvent(arguments),j=m.getDragObject(arguments),x=m.getAttribute(j,"dragId");m.getAttribute(j,"elId");var T=m.getAttribute(j,"originalScope"),s=m.getFloatingConnectionFor(x);if(s!=null){var c=s.suspendedEndpoint!=null;if(!(c&&s.suspendedEndpoint._jsPlumb==null)){var F=a.getEndpoint(s);if(F!=null){if(a.isRedrop(s,a)){s._forceReattach=!0,s.setHover(!1),a.maybeCleanup&&a.maybeCleanup(F);return}var G=m.getFloatingAnchorIndex(s);if(G===0&&!a.isSource||G===1&&!a.isTarget){a.maybeCleanup&&a.maybeCleanup(F);return}a.onDrop&&a.onDrop(s),T&&m.setDragScope(j,T);var B=a.isFull(t);if(B&&F.fire("maxConnections",{endpoint:this,connection:s,maxConnections:F._jsPlumb.maxConnections},y),!B&&a.enabled()){var M=!0;G===0?(s.floatingElement=s.source,s.floatingId=s.sourceId,s.floatingEndpoint=s.endpoints[0],s.floatingIndex=0,s.source=a.element,s.sourceId=a.elementId):(s.floatingElement=s.target,s.floatingId=s.targetId,s.floatingEndpoint=s.endpoints[1],s.floatingIndex=1,s.target=a.element,s.targetId=a.elementId),c&&s.suspendedEndpoint.id!==F.id&&(!s.isDetachAllowed(s)||!s.endpoints[G].isDetachAllowed(s)||!s.suspendedEndpoint.isDetachAllowed(s)||!m.checkCondition("beforeDetach",s))&&(M=!1);var b=function(g){s.endpoints[G].detachFromConnection(s),s.suspendedEndpoint&&s.suspendedEndpoint.detachFromConnection(s),s.endpoints[G]=F,F.addConnection(s);var h=F.getParameters();for(var E in h)s.setParameter(E,h[E]);if(!c)h.draggable&&m.initDraggable(this.element,a.dragOptions,"internal",m);else{var I=s.suspendedEndpoint.elementId;m.fireMoveEvent({index:G,originalSourceId:G===0?I:s.sourceId,newSourceId:G===0?F.elementId:s.sourceId,originalTargetId:G===1?I:s.targetId,newTargetId:G===1?F.elementId:s.targetId,originalSourceEndpoint:G===0?s.suspendedEndpoint:s.endpoints[0],newSourceEndpoint:G===0?F:s.endpoints[0],originalTargetEndpoint:G===1?s.suspendedEndpoint:s.endpoints[1],newTargetEndpoint:G===1?F:s.endpoints[1],connection:s},y)}if(G===1?m.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):m.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),s.endpoints[0].finalEndpoint){var p=s.endpoints[0];p.detachFromConnection(s),s.endpoints[0]=s.endpoints[0].finalEndpoint,s.endpoints[0].addConnection(s)}U.isObject(g)&&s.mergeData(g),m.finaliseConnection(s,null,y,!1),s.setHover(!1),m.revalidate(s.endpoints[0].element)}.bind(this),o=function(){s.suspendedEndpoint&&(s.endpoints[G]=s.suspendedEndpoint,s.setHover(!1),s._forceDetach=!0,G===0?(s.source=s.suspendedEndpoint.element,s.sourceId=s.suspendedEndpoint.elementId):(s.target=s.suspendedEndpoint.element,s.targetId=s.suspendedEndpoint.elementId),s.suspendedEndpoint.addConnection(s),G===1?m.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):m.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),m.repaint(s.sourceId),s._forceDetach=!1)};if(M=M&&a.isDropAllowed(s.sourceId,s.targetId,s.scope,s,F),M)return b(M),!0;o()}a.maybeCleanup&&a.maybeCleanup(F),m.currentlyDragging=!1}}}}}}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J=function(l,O,a,t,m){if(f.Connectors[O]=f.Connectors[O]||{},f.Connectors[O][a]==null){if(f.Connectors[a]==null){if(l.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+a+"'")}f.Connectors[O][a]=function(){f.Connectors[a].apply(this,arguments),f.ConnectorRenderers[O].apply(this,arguments)},U.extend(f.Connectors[O][a],[f.Connectors[a],f.ConnectorRenderers[O]])}return new f.Connectors[O][a](t,m)},Y=function(l,O,a){return l?a.makeAnchor(l,O,a):null},$=function(l,O,a,t){O!=null&&(O._jsPlumbConnections=O._jsPlumbConnections||{},t?delete O._jsPlumbConnections[l.id]:O._jsPlumbConnections[l.id]=!0,U.isEmpty(O._jsPlumbConnections)?a.removeClass(O,a.connectedClass):a.addClass(O,a.connectedClass))};f.Connection=function(l){var O=l.newEndpoint;this.id=l.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=l.previousConnection,this.source=f.getElement(l.source),this.target=f.getElement(l.target),f.OverlayCapableJsPlumbUIComponent.apply(this,arguments),l.sourceEndpoint?(this.source=l.sourceEndpoint.getElement(),this.sourceId=l.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),l.targetEndpoint?(this.target=l.targetEndpoint.getElement(),this.targetId=l.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=l.scope,this.endpoints=[],this.endpointStyles=[];var a=this._jsPlumb.instance;a.manage(this.sourceId,this.source),a.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:l.cssClass,container:l.container,"pointer-events":l["pointer-events"],editorParams:l.editorParams,overlays:l.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(E,I,p,v,C){return p=p||this._jsPlumb.instance.getId(I),this.prepareEndpoint(a,O,this,v,E?0:1,l,I,p,C)},l.type&&(l.endpoints=l.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(l.type).endpoints);var t=this.makeEndpoint(!0,this.source,this.sourceId,l.sourceEndpoint),m=this.makeEndpoint(!1,this.target,this.targetId,l.targetEndpoint);t&&U.addToList(l.endpointsByElement,this.sourceId,t),m&&U.addToList(l.endpointsByElement,this.targetId,m),this.scope||(this.scope=this.endpoints[0].scope),l.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(l.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(l.deleteEndpointsOnEmpty));var y=a.Defaults.ConnectionsDetachable;l.detachable===!1&&(y=!1),this.endpoints[0].connectionsDetachable===!1&&(y=!1),this.endpoints[1].connectionsDetachable===!1&&(y=!1);var j=l.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||a.Defaults.ReattachConnections;this.appendToDefaultType({detachable:y,reattach:j,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||l.paintStyle||a.Defaults.PaintStyle||f.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||l.hoverPaintStyle||a.Defaults.HoverPaintStyle||f.Defaults.HoverPaintStyle});var x=a.getSuspendedAt();if(!a.isSuspendDrawing()){var T=a.getCachedData(this.sourceId),s=T.o,c=T.s,F=a.getCachedData(this.targetId),G=F.o,B=F.s,M=x||a.timestamp(),b=this.endpoints[0].anchor.compute({xy:[s.left,s.top],wh:c,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[G.left,G.top],twh:B,tElement:this.endpoints[1],timestamp:M});this.endpoints[0].paint({anchorLoc:b,timestamp:M}),b=this.endpoints[1].anchor.compute({xy:[G.left,G.top],wh:B,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[s.left,s.top],twh:c,tElement:this.endpoints[0],timestamp:M}),this.endpoints[1].paint({anchorLoc:b,timestamp:M})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(E){return this._jsPlumb.detachable===!1?!1:E!=null?E.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(E){this._jsPlumb.detachable=E===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(E){this._jsPlumb.reattach=E===!0},this._jsPlumb.cost=l.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=l.directed,l.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var o=f.extend({},this.endpoints[1].getParameters());f.extend(o,this.endpoints[0].getParameters()),f.extend(o,this.getParameters()),this.setParameters(o),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||l.connector||a.Defaults.Connector||f.Defaults.Connector,!0);var g=l.data==null||!U.isObject(l.data)?{}:l.data;this.getData=function(){return g},this.setData=function(E){g=E||{}},this.mergeData=function(E){g=f.extend(g,E)};var h=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,l.type].join(" ");/[^\s]/.test(h)&&this.addType(h,l.data,!0),this.updateConnectedClass()},U.extend(f.Connection,f.OverlayCapableJsPlumbUIComponent,{applyType:function(l,O,a){var t=null;l.connector!=null&&(t=this.getCachedTypeItem("connector",a.connector),t==null&&(t=this.prepareConnector(l.connector,a.connector),this.cacheTypeItem("connector",t,a.connector)),this.setPreparedConnector(t)),l.detachable!=null&&this.setDetachable(l.detachable),l.reattach!=null&&this.setReattach(l.reattach),l.scope&&(this.scope=l.scope),l.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,l.cssClass);var m=null;l.anchor?(m=this.getCachedTypeItem("anchors",a.anchor),m==null&&(m=[this._jsPlumb.instance.makeAnchor(l.anchor),this._jsPlumb.instance.makeAnchor(l.anchor)],this.cacheTypeItem("anchors",m,a.anchor))):l.anchors&&(m=this.getCachedTypeItem("anchors",a.anchors),m==null&&(m=[this._jsPlumb.instance.makeAnchor(l.anchors[0]),this._jsPlumb.instance.makeAnchor(l.anchors[1])],this.cacheTypeItem("anchors",m,a.anchors))),m!=null&&(this.endpoints[0].anchor=m[0],this.endpoints[1].anchor=m[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),f.OverlayCapableJsPlumbUIComponent.applyType(this,l)},addClass:function(l,O){O&&(this.endpoints[0].addClass(l),this.endpoints[1].addClass(l),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(l)),this.connector&&this.connector.addClass(l)},removeClass:function(l,O){O&&(this.endpoints[0].removeClass(l),this.endpoints[1].removeClass(l),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(l)),this.connector&&this.connector.removeClass(l)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(l){this._jsPlumb.visible=l,this.connector&&this.connector.setVisible(l),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(l){this._jsPlumb&&($(this,this.source,this._jsPlumb.instance,l),$(this,this.target,this._jsPlumb.instance,l))},setHover:function(l){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(l),q.jsPlumb[l?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),q.jsPlumb[l?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(l){this._jsPlumb.cost=l},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(l,O){var a={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},t=this._jsPlumb.instance.getRenderMode(),m;return U.isString(l)?m=J(this._jsPlumb.instance,t,l,a,this):U.isArray(l)&&(l.length===1?m=J(this._jsPlumb.instance,t,l[0],a,this):m=J(this._jsPlumb.instance,t,l[0],U.merge(l[1],a),this)),O!=null&&(m.typeId=O),m},setPreparedConnector:function(l,O,a,t){if(this.connector!==l){var m,y="";if(this.connector!=null&&(m=this.connector,y=m.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=l,t&&this.cacheTypeItem("connector",l,t),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(y),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),m!=null)for(var j=this.getOverlays(),x=0;x<j.length;x++)j[x].transfer&&j[x].transfer(this.connector);a||this.setListenerComponent(this.connector),O||this.repaint()}},setConnector:function(l,O,a,t){var m=this.prepareConnector(l,t);this.setPreparedConnector(m,O,a,t)},paint:function(l){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){l=l||{};var O=l.timestamp,a=!1,t=a?this.sourceId:this.targetId,m=a?this.targetId:this.sourceId,y=a?0:1,j=a?1:0;if(O==null||O!==this._jsPlumb.lastPaintedAt){var x=this._jsPlumb.instance.updateOffset({elId:m}).o,T=this._jsPlumb.instance.updateOffset({elId:t}).o,s=this.endpoints[j],c=this.endpoints[y],F=s.anchor.getCurrentLocation({xy:[x.left,x.top],wh:[x.width,x.height],element:s,timestamp:O}),G=c.anchor.getCurrentLocation({xy:[T.left,T.top],wh:[T.width,T.height],element:c,timestamp:O});this.connector.resetBounds(),this.connector.compute({sourcePos:F,targetPos:G,sourceOrientation:s.anchor.getOrientation(s),targetOrientation:c.anchor.getOrientation(c),sourceEndpoint:this.endpoints[j],targetEndpoint:this.endpoints[y],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:x,targetInfo:T});var B={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var M in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(M)){var b=this._jsPlumb.overlays[M];b.isVisible()&&(this._jsPlumb.overlayPlacements[M]=b.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(b)),B.minX=Math.min(B.minX,this._jsPlumb.overlayPlacements[M].minX),B.maxX=Math.max(B.maxX,this._jsPlumb.overlayPlacements[M].maxX),B.minY=Math.min(B.minY,this._jsPlumb.overlayPlacements[M].minY),B.maxY=Math.max(B.maxY,this._jsPlumb.overlayPlacements[M].maxY))}var o=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,g=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),h={xmin:Math.min(this.connector.bounds.minX-(o+g),B.minX),ymin:Math.min(this.connector.bounds.minY-(o+g),B.minY),xmax:Math.max(this.connector.bounds.maxX+(o+g),B.maxX),ymax:Math.max(this.connector.bounds.maxY+(o+g),B.maxY)};this.connector.paintExtents=h,this.connector.paint(this._jsPlumb.paintStyleInUse,null,h);for(var E in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(E)){var I=this._jsPlumb.overlays[E];I.isVisible()&&I.paint(this._jsPlumb.overlayPlacements[E],h)}}this._jsPlumb.lastPaintedAt=O}},repaint:function(l){var O=jsPlumb.extend(l||{},{});O.elId=this.sourceId,this.paint(O)},prepareEndpoint:function(l,O,a,t,m,y,j,x,T){var s;if(t)a.endpoints[m]=t,t.addConnection(a);else{y.endpoints||(y.endpoints=[null,null]);var c=T||y.endpoints[m]||y.endpoint||l.Defaults.Endpoints[m]||f.Defaults.Endpoints[m]||l.Defaults.Endpoint||f.Defaults.Endpoint;y.endpointStyles||(y.endpointStyles=[null,null]),y.endpointHoverStyles||(y.endpointHoverStyles=[null,null]);var F=y.endpointStyles[m]||y.endpointStyle||l.Defaults.EndpointStyles[m]||f.Defaults.EndpointStyles[m]||l.Defaults.EndpointStyle||f.Defaults.EndpointStyle;F.fill==null&&y.paintStyle!=null&&(F.fill=y.paintStyle.stroke),F.outlineStroke==null&&y.paintStyle!=null&&(F.outlineStroke=y.paintStyle.outlineStroke),F.outlineWidth==null&&y.paintStyle!=null&&(F.outlineWidth=y.paintStyle.outlineWidth);var G=y.endpointHoverStyles[m]||y.endpointHoverStyle||l.Defaults.EndpointHoverStyles[m]||f.Defaults.EndpointHoverStyles[m]||l.Defaults.EndpointHoverStyle||f.Defaults.EndpointHoverStyle;y.hoverPaintStyle!=null&&(G==null&&(G={}),G.fill==null&&(G.fill=y.hoverPaintStyle.stroke));var B=y.anchors?y.anchors[m]:y.anchor?y.anchor:Y(l.Defaults.Anchors[m],x,l)||Y(f.Defaults.Anchors[m],x,l)||Y(l.Defaults.Anchor,x,l)||Y(f.Defaults.Anchor,x,l),M=y.uuids?y.uuids[m]:null;s=O({paintStyle:F,hoverPaintStyle:G,endpoint:c,connections:[a],uuid:M,anchor:B,source:j,scope:y.scope,reattach:y.reattach||l.Defaults.ReattachConnections,detachable:y.detachable||l.Defaults.ConnectionsDetachable}),t==null&&s.setDeleteOnEmpty(!0),a.endpoints[m]=s,y.drawEndpoints===!1&&s.setVisible(!1,!0,!0)}return s},replaceEndpoint:function(l,O){var a=this.endpoints[l],t=a.elementId,m=this._jsPlumb.instance.getEndpoints(t),y=m.indexOf(a),j=this.makeEndpoint(l===0,a.element,t,null,O);this.endpoints[l]=j,m.splice(y,1,j),this._jsPlumb.instance.deleteObject({endpoint:a,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:a,current:j}),this._jsPlumb.instance.anchorManager.updateOtherEndpoint(this.endpoints[0].elementId,this.endpoints[1].elementId,this.endpoints[1].elementId,this)}})}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumbUtil,U=q.jsPlumb;U.AnchorManager=function(l){var O={},a={},t={},m={},y=this,j={},x=l.jsPlumbInstance,T={},s=function(h,E,I,p,v,C,w){for(var u=[],d=E[v?0:1]/(p.length+1),P=0;P<p.length;P++){var k=(P+1)*d,N=C*E[v?1:0];w&&(k=E[v?0:1]-k);var i=v?k:N,e=I[0]+i,n=i/E[0],A=v?N:k,S=I[1]+A,R=A/E[1];u.push([e,S,n,R,p[P][1],p[P][2]])}return u},c=function(h){return function(E,I){var p=!0;return h?p=E[0][0]<I[0][0]:p=E[0][0]>I[0][0],p===!1?-1:1}},F=function(h,E){var I=h[0][0]<0?-Math.PI-h[0][0]:Math.PI-h[0][0],p=E[0][0]<0?-Math.PI-E[0][0]:Math.PI-E[0][0];return I>p?1:-1},G={top:function(h,E){return h[0]>E[0]?1:-1},right:c(!0),bottom:c(!0),left:F},B=function(h,E){return h.sort(E)},M=function(h,E){var I=x.getCachedData(h),p=I.s,v=I.o,C=function(w,u,d,P,k,N,i){if(P.length>0)for(var e=B(P,G[w]),n=w==="right"||w==="top",A=s(w,u,d,e,k,N,n),S=function(nt,pt){a[nt.id]=[pt[0],pt[1],pt[2],pt[3]],t[nt.id]=i},R=0;R<A.length;R++){var V=A[R][4],z=V.endpoints[0].elementId===h,X=V.endpoints[1].elementId===h;z&&S(V.endpoints[0],A[R]),X&&S(V.endpoints[1],A[R])}};C("bottom",p,[v.left,v.top],E.bottom,!0,1,[0,1]),C("top",p,[v.left,v.top],E.top,!0,0,[0,-1]),C("left",p,[v.left,v.top],E.left,!1,0,[-1,0]),C("right",p,[v.left,v.top],E.right,!1,1,[1,0])};this.reset=function(){O={},m={},j={}},this.addFloatingConnection=function(h,E){T[h]=E},this.removeFloatingConnection=function(h){delete T[h]},this.newConnection=function(h){var E=h.sourceId,I=h.targetId,p=h.endpoints,v=!0,C=function(w,u,d,P,k){E===I&&d.isContinuous&&(h._jsPlumb.instance.removeElement(p[1].canvas),v=!1),f.addToList(m,P,[k,u,d.constructor===U.DynamicAnchor])};C(0,p[0],p[0].anchor,I,h),v&&C(1,p[1],p[1].anchor,E,h)};var b=function(h){(function(E,I){if(E){var p=function(v){return v[4]===I};f.removeWithFunction(E.top,p),f.removeWithFunction(E.left,p),f.removeWithFunction(E.bottom,p),f.removeWithFunction(E.right,p)}})(j[h.elementId],h.id)};this.connectionDetached=function(h,E){var I=h.connection||h,p=h.sourceId,v=h.targetId,C=I.endpoints,w=function(u,d,P,k,N){f.removeWithFunction(m[k],function(i){return i[0].id===N.id})};w(1,C[1],C[1].anchor,p,I),w(0,C[0],C[0].anchor,v,I),I.floatingId&&(w(I.floatingIndex,I.floatingEndpoint,I.floatingEndpoint.anchor,I.floatingId,I),b(I.floatingEndpoint)),b(I.endpoints[0]),b(I.endpoints[1]),E||(y.redraw(I.sourceId),I.targetId!==I.sourceId&&y.redraw(I.targetId))},this.add=function(h,E){f.addToList(O,E,h)},this.changeId=function(h,E){m[E]=m[h],O[E]=O[h],delete m[h],delete O[h]},this.getConnectionsFor=function(h){return m[h]||[]},this.getEndpointsFor=function(h){return O[h]||[]},this.deleteEndpoint=function(h){f.removeWithFunction(O[h.elementId],function(E){return E.id===h.id}),b(h)},this.clearFor=function(h){delete O[h],O[h]=[]};var o=function(h,E,I,p,v,C,w,u,d,P,k,N){var i=-1,e=p.endpoints[w],n=e.id,A=[1,0][w],S=[[E,I],p,v,C,n],R=h[d],V=e._continuousAnchorEdge?h[e._continuousAnchorEdge]:null,z,X;if(V){var nt=f.findWithFunction(V,function(ft){return ft[4]===n});if(nt!==-1)for(V.splice(nt,1),z=0;z<V.length;z++)X=V[z][1],f.addWithFunction(k,X,function(ft){return ft.id===X.id}),f.addWithFunction(N,V[z][1].endpoints[w],function(ft){return ft.id===X.endpoints[w].id}),f.addWithFunction(N,V[z][1].endpoints[A],function(ft){return ft.id===X.endpoints[A].id})}for(z=0;z<R.length;z++)X=R[z][1],l.idx===1&&R[z][3]===C&&i===-1&&(i=z),f.addWithFunction(k,X,function(ft){return ft.id===X.id}),f.addWithFunction(N,R[z][1].endpoints[w],function(ft){return ft.id===X.endpoints[w].id}),f.addWithFunction(N,R[z][1].endpoints[A],function(ft){return ft.id===X.endpoints[A].id});{var pt=u?i!==-1?i:0:R.length;R.splice(pt,0,S)}e._continuousAnchorEdge=d};this.updateOtherEndpoint=function(h,E,I,p){var v=f.findWithFunction(m[h],function(w){return w[0].id===p.id}),C=f.findWithFunction(m[E],function(w){return w[0].id===p.id});v!==-1&&(m[h][v][0]=p,m[h][v][1]=p.endpoints[1],m[h][v][2]=p.endpoints[1].anchor.constructor===U.DynamicAnchor),C>-1&&(m[E].splice(C,1),f.addToList(m,I,[p,p.endpoints[0],p.endpoints[0].anchor.constructor===U.DynamicAnchor])),p.updateConnectedClass()},this.sourceChanged=function(h,E,I,p){if(h!==E){I.sourceId=E,I.source=p,f.removeWithFunction(m[h],function(C){return C[0].id===I.id});var v=f.findWithFunction(m[I.targetId],function(C){return C[0].id===I.id});v>-1&&(m[I.targetId][v][0]=I,m[I.targetId][v][1]=I.endpoints[0],m[I.targetId][v][2]=I.endpoints[0].anchor.constructor===U.DynamicAnchor),f.addToList(m,E,[I,I.endpoints[1],I.endpoints[1].anchor.constructor===U.DynamicAnchor]),I.endpoints[1].anchor.isContinuous&&(I.source===I.target?I._jsPlumb.instance.removeElement(I.endpoints[1].canvas):I.endpoints[1].canvas.parentNode==null&&I._jsPlumb.instance.appendElement(I.endpoints[1].canvas)),I.updateConnectedClass()}},this.rehomeEndpoint=function(h,E,I){var p=O[E]||[],v=x.getId(I);if(v!==E){var C=p.indexOf(h);if(C>-1){var w=p.splice(C,1)[0];y.add(w,v)}}for(var u=0;u<h.connections.length;u++)h.connections[u].sourceId===E?y.sourceChanged(E,h.elementId,h.connections[u],h.element):h.connections[u].targetId===E&&(h.connections[u].targetId=h.elementId,h.connections[u].target=h.element,y.updateOtherEndpoint(h.connections[u].sourceId,E,h.elementId,h.connections[u]))},this.redraw=function(h,E,I,p,v,C){if(!x.isSuspendDrawing()){var w=O[h]||[],u=m[h]||[],d=[],P=[],k=[];I=I||x.timestamp(),p=p||{left:0,top:0},E&&(E={left:E.left+p.left,top:E.top+p.top});for(var N=x.updateOffset({elId:h,offset:E,recalc:!1,timestamp:I}),i={},e=0;e<u.length;e++){var n=u[e][0],A=n.sourceId,S=n.targetId,R=n.endpoints[0].anchor.isContinuous,V=n.endpoints[1].anchor.isContinuous;if(R||V){var z=A+"_"+S,X=i[z],nt=n.sourceId===h?1:0;R&&!j[A]&&(j[A]={top:[],right:[],bottom:[],left:[]}),V&&!j[S]&&(j[S]={top:[],right:[],bottom:[],left:[]}),h!==S&&x.updateOffset({elId:S,timestamp:I}),h!==A&&x.updateOffset({elId:A,timestamp:I});var pt=x.getCachedData(S),ft=x.getCachedData(A);S===A&&(R||V)?(o(j[A],-Math.PI/2,0,n,!1,S,0,!1,"top",A,d,P),o(j[S],-Math.PI/2,0,n,!1,A,1,!1,"top",S,d,P)):(X||(X=this.calculateOrientation(A,S,ft.o,pt.o,n.endpoints[0].anchor,n.endpoints[1].anchor,n),i[z]=X),R&&o(j[A],X.theta,0,n,!1,S,0,!1,X.a[0],A,d,P),V&&o(j[S],X.theta2,-1,n,!0,A,1,!0,X.a[1],S,d,P)),R&&f.addWithFunction(k,A,function(at){return at===A}),V&&f.addWithFunction(k,S,function(at){return at===S}),f.addWithFunction(d,n,function(at){return at.id===n.id}),(R&&nt===0||V&&nt===1)&&f.addWithFunction(P,n.endpoints[nt],function(at){return at.id===n.endpoints[nt].id})}}for(e=0;e<w.length;e++)w[e].connections.length===0&&w[e].anchor.isContinuous&&(j[h]||(j[h]={top:[],right:[],bottom:[],left:[]}),o(j[h],-Math.PI/2,0,{endpoints:[w[e],w[e]],paint:function(){}},!1,h,0,!1,w[e].anchor.getDefaultFace(),h,d,P),f.addWithFunction(k,h,function(at){return at===h}));for(e=0;e<k.length;e++)M(k[e],j[k[e]]);for(e=0;e<w.length;e++)w[e].paint({timestamp:I,offset:N,dimensions:N.s,recalc:C!==!0});for(e=0;e<P.length;e++){var it=x.getCachedData(P[e].elementId);P[e].paint({timestamp:null,offset:it,dimensions:it.s})}for(e=0;e<u.length;e++){var st=u[e][1];if(st.anchor.constructor===U.DynamicAnchor){st.paint({elementWithPrecedence:h,timestamp:I}),f.addWithFunction(d,u[e][0],function(at){return at.id===u[e][0].id});for(var ht=0;ht<st.connections.length;ht++)st.connections[ht]!==u[e][0]&&f.addWithFunction(d,st.connections[ht],function(at){return at.id===st.connections[ht].id})}else f.addWithFunction(d,u[e][0],function(at){return at.id===u[e][0].id})}var dt=T[h];for(dt&&dt.paint({timestamp:I,recalc:!1,elId:h}),e=0;e<d.length;e++)d[e].paint({elId:h,timestamp:null,recalc:!1,clearEdits:v})}};var g=function(h){f.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var E=h.faces||["top","right","bottom","left"],I=h.clockwise!==!1,p={},v={top:"bottom",right:"left",left:"right",bottom:"top"},C={top:"right",right:"bottom",left:"top",bottom:"left"},w={top:"left",right:"top",left:"bottom",bottom:"right"},u=I?C:w,d=I?w:C,P=h.cssClass||"",k=null,N=null,i=["left","right"],e=["top","bottom"],n=null,A=0;A<E.length;A++)p[E[A]]=!0;this.getDefaultFace=function(){return E.length===0?"top":E[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(S){return p[S]?S:p[v[S]]?v[S]:p[u[S]]?u[S]:p[d[S]]?d[S]:S},this.isEdgeSupported=function(S){return n==null?N==null?p[S]===!0:N===S:n.indexOf(S)!==-1},this.setCurrentFace=function(S,R){k=S,R&&N!=null&&(N=k)},this.getCurrentFace=function(){return k},this.getSupportedFaces=function(){var S=[];for(var R in p)p[R]&&S.push(R);return S},this.lock=function(){N=k},this.unlock=function(){N=null},this.isLocked=function(){return N!=null},this.lockCurrentAxis=function(){k!=null&&(n=k==="left"||k==="right"?i:e)},this.unlockCurrentAxis=function(){n=null},this.compute=function(S){return a[S.element.id]||[0,0]},this.getCurrentLocation=function(S){return a[S.element.id]||[0,0]},this.getOrientation=function(S){return t[S.id]||[0,0]},this.getCssClass=function(){return P}};x.continuousAnchorFactory={get:function(h){return new g(h)},clear:function(h){delete a[h]}}},U.AnchorManager.prototype.calculateOrientation=function(l,O,a,t,m,y){var j={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},x=["left","top","right","bottom"];if(l===O)return{orientation:j.IDENTITY,a:["top","top"]};var T=Math.atan2(t.centery-a.centery,t.centerx-a.centerx),s=Math.atan2(a.centery-t.centery,a.centerx-t.centerx),c=[],F={};(function(g,h){for(var E=0;E<g.length;E++)F[g[E]]={left:[h[E].left,h[E].centery],right:[h[E].right,h[E].centery],top:[h[E].centerx,h[E].top],bottom:[h[E].centerx,h[E].bottom]}})(["source","target"],[a,t]);for(var G=0;G<x.length;G++)for(var B=0;B<x.length;B++)c.push({source:x[G],target:x[B],dist:Biltong.lineLength(F.source[x[G]],F.target[x[B]])});c.sort(function(g,h){return g.dist<h.dist?-1:g.dist>h.dist?1:0});for(var M=c[0].source,b=c[0].target,o=0;o<c.length&&(!m.isContinuous||m.isEdgeSupported(c[o].source)?M=c[o].source:M=null,!y.isContinuous||y.isEdgeSupported(c[o].target)?b=c[o].target:b=null,!(M!=null&&b!=null));o++);return m.isContinuous&&m.setCurrentFace(M),y.isContinuous&&y.setCurrentFace(b),{a:[M,b],theta:T,theta2:s}},U.Anchor=function(l){this.x=l.x||0,this.y=l.y||0,this.elementId=l.elementId,this.cssClass=l.cssClass||"",this.userDefinedLocation=null,this.orientation=l.orientation||[0,0],this.lastReturnValue=null,this.offsets=l.offsets||[0,0],this.timestamp=null;var O=l.relocatable!==!1;this.isRelocatable=function(){return O},this.setRelocatable=function(m){O=m};var a=l.snapOnRelocate!==!1;this.isSnapOnRelocate=function(){return a};var t=!1;this.lock=function(){t=!0},this.unlock=function(){t=!1},this.isLocked=function(){return t},f.EventGenerator.apply(this),this.compute=function(m){var y=m.xy,j=m.wh,x=m.timestamp;return m.clearUserDefinedLocation&&(this.userDefinedLocation=null),x&&x===this.timestamp?this.lastReturnValue:(this.userDefinedLocation!=null?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[y[0]+this.x*j[0]+this.offsets[0],y[1]+this.y*j[1]+this.offsets[1],this.x,this.y],this.timestamp=x,this.lastReturnValue)},this.getCurrentLocation=function(m){return m=m||{},this.lastReturnValue==null||m.timestamp!=null&&this.timestamp!==m.timestamp?this.compute(m):this.lastReturnValue},this.setPosition=function(m,y,j,x,T){(!t||T)&&(this.x=m,this.y=y,this.orientation=[j,x],this.lastReturnValue=null)}},f.extend(U.Anchor,f.EventGenerator,{equals:function(l){if(!l)return!1;var O=l.getOrientation(),a=this.getOrientation();return this.x===l.x&&this.y===l.y&&this.offsets[0]===l.offsets[0]&&this.offsets[1]===l.offsets[1]&&a[0]===O[0]&&a[1]===O[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(l){this.userDefinedLocation=l},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),U.FloatingAnchor=function(l){U.Anchor.apply(this,arguments);var O=l.reference,a=l.referenceCanvas,t=U.getSize(a),m=0,y=0,j=null,x=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(T){var s=T.xy,c=[s[0]+t[0]/2,s[1]+t[1]/2];return x=c,c},this.getOrientation=function(T){if(j)return j;var s=O.getOrientation(T);return[Math.abs(s[0])*m*-1,Math.abs(s[1])*y*-1]},this.over=function(T,s){j=T.getOrientation(s)},this.out=function(){j=null},this.getCurrentLocation=function(T){return x==null?this.compute(T):x}},f.extend(U.FloatingAnchor,U.Anchor);var J=function(l,O,a){return l.constructor===U.Anchor?l:O.makeAnchor(l,a,O)};U.DynamicAnchor=function(l){U.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=l.elementId,this.jsPlumbInstance=l.jsPlumbInstance;for(var O=0;O<l.anchors.length;O++)this.anchors[O]=J(l.anchors[O],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var a=this.anchors.length>0?this.anchors[0]:null,t=a,m=this,y=function(x,T,s,c,F){var G=c[0]+x.x*F[0],B=c[1]+x.y*F[1],M=c[0]+F[0]/2,b=c[1]+F[1]/2;return Math.sqrt(Math.pow(T-G,2)+Math.pow(s-B,2))+Math.sqrt(Math.pow(M-G,2)+Math.pow(b-B,2))},j=l.selector||function(x,T,s,c,F){for(var G=s[0]+c[0]/2,B=s[1]+c[1]/2,M=-1,b=1/0,o=0;o<F.length;o++){var g=y(F[o],G,B,x,T);g<b&&(M=o+0,b=g)}return F[M]};this.compute=function(x){var T=x.xy,s=x.wh,c=x.txy,F=x.twh;this.timestamp=x.timestamp;var G=m.getUserDefinedLocation();return G!=null?G:(this.isLocked()||c==null||F==null||(x.timestamp=null,a=j(T,s,c,F,this.anchors),this.x=a.x,this.y=a.y,a!==t&&this.fire("anchorChanged",a),t=a),a.compute(x))},this.getCurrentLocation=function(x){return this.getUserDefinedLocation()||(a!=null?a.getCurrentLocation(x):null)},this.getOrientation=function(x){return a!=null?a.getOrientation(x):[0,0]},this.over=function(x,T){a!=null&&a.over(x,T)},this.out=function(){a!=null&&a.out()},this.setAnchor=function(x){a=x},this.getCssClass=function(){return a&&a.getCssClass()||""},this.setAnchorCoordinates=function(x){var T=jsPlumbUtil.findWithFunction(this.anchors,function(s){return s.x===x[0]&&s.y===x[1]});return T!==-1?(this.setAnchor(this.anchors[T]),!0):!1}},f.extend(U.DynamicAnchor,U.Anchor);var Y=function(l,O,a,t,m,y){U.Anchors[m]=function(j){var x=j.jsPlumbInstance.makeAnchor([l,O,a,t,0,0],j.elementId,j.jsPlumbInstance);return x.type=m,y&&y(x,j),x}};Y(.5,0,0,-1,"TopCenter"),Y(.5,1,0,1,"BottomCenter"),Y(0,.5,-1,0,"LeftMiddle"),Y(1,.5,1,0,"RightMiddle"),Y(.5,0,0,-1,"Top"),Y(.5,1,0,1,"Bottom"),Y(0,.5,-1,0,"Left"),Y(1,.5,1,0,"Right"),Y(.5,.5,0,0,"Center"),Y(1,0,0,-1,"TopRight"),Y(1,1,0,1,"BottomRight"),Y(0,0,0,-1,"TopLeft"),Y(0,1,0,1,"BottomLeft"),U.Defaults.DynamicAnchors=function(l){return l.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],l.elementId,l.jsPlumbInstance)},U.Anchors.AutoDefault=function(l){var O=l.jsPlumbInstance.makeDynamicAnchor(U.Defaults.DynamicAnchors(l));return O.type="AutoDefault",O};var $=function(l,O){U.Anchors[l]=function(a){var t=a.jsPlumbInstance.makeAnchor(["Continuous",{faces:O}],a.elementId,a.jsPlumbInstance);return t.type=l,t}};U.Anchors.Continuous=function(l){return l.jsPlumbInstance.continuousAnchorFactory.get(l)},$("ContinuousLeft",["left"]),$("ContinuousTop",["top"]),$("ContinuousBottom",["bottom"]),$("ContinuousRight",["right"]),Y(0,0,0,0,"Assign",function(l,O){var a=O.position||"Fixed";l.positionFinder=a.constructor===String?O.jsPlumbInstance.AnchorPositionFinders[a]:a,l.constructorParams=O}),q.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(l,O,a){return[(l.left-O.left)/a[0],(l.top-O.top)/a[1]]},Grid:function(l,O,a,t){var m=l.left-O.left,y=l.top-O.top,j=a[0]/t.grid[0],x=a[1]/t.grid[1],T=Math.floor(m/j),s=Math.floor(y/x);return[(T*j+j/2)/a[0],(s*x+x/2)/a[1]]}},U.Anchors.Perimeter=function(l){l=l||{};var O=l.anchorCount||60,a=l.shape;if(!a)throw new Error("no shape supplied to Perimeter Anchor type");var t=function(){for(var F=.5,G=Math.PI*2/O,B=0,M=[],b=0;b<O;b++){var o=F+F*Math.sin(B),g=F+F*Math.cos(B);M.push([o,g,0,0]),B+=G}return M},m=function(F){for(var G=O/F.length,B=[],M=function(o,g,h,E,I,p,v){G=O*I;for(var C=(h-o)/G,w=(E-g)/G,u=0;u<G;u++)B.push([o+C*u,g+w*u,p==null?0:p,v==null?0:v])},b=0;b<F.length;b++)M.apply(null,F[b]);return B},y=function(F){for(var G=[],B=0;B<F.length;B++)G.push([F[B][0],F[B][1],F[B][2],F[B][3],1/F.length,F[B][4],F[B][5]]);return m(G)},j=function(){return y([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},x={Circle:t,Ellipse:t,Diamond:function(){return y([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:j,Square:j,Triangle:function(){return y([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(F){for(var G=F.points,B=[],M=0,b=0;b<G.length-1;b++){var o=Math.sqrt(Math.pow(G[b][2]-G[b][0])+Math.pow(G[b][3]-G[b][1]));M+=o,B.push([G[b][0],G[b][1],G[b+1][0],G[b+1][1],o])}for(var g=0;g<B.length;g++)B[g][4]=B[g][4]/M;return m(B)}},T=function(F,G){for(var B=[],M=G/180*Math.PI,b=0;b<F.length;b++){var o=F[b][0]-.5,g=F[b][1]-.5;B.push([.5+(o*Math.cos(M)-g*Math.sin(M)),.5+(o*Math.sin(M)+g*Math.cos(M)),F[b][2],F[b][3]])}return B};if(!x[a])throw new Error("Shape ["+a+"] is unknown by Perimeter Anchor type");var s=x[a](l);l.rotation&&(s=T(s,l.rotation));var c=l.jsPlumbInstance.makeDynamicAnchor(s);return c.type="Perimeter",c}}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J=q.Biltong;f.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(m,y){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}},this.lineIntersection=function(m,y,j,x){return[]},this.boxIntersection=function(m,y,j,x){var T=[];return T.push.apply(T,this.lineIntersection(m,y,m+j,y)),T.push.apply(T,this.lineIntersection(m+j,y,m+j,y+x)),T.push.apply(T,this.lineIntersection(m+j,y+x,m,y+x)),T.push.apply(T,this.lineIntersection(m,y+x,m,y)),T},this.boundingBoxIntersection=function(m){return this.boxIntersection(m.x,m.y,m.w,m.y)}},Straight:function(t){f.Segments.AbstractSegment.apply(this,arguments);var m,y,j,x,T,s,c,F=function(){m=Math.sqrt(Math.pow(T-x,2)+Math.pow(c-s,2)),y=J.gradient({x,y:s},{x:T,y:c}),j=-1/y};this.type="Straight",this.getLength=function(){return m},this.getGradient=function(){return y},this.getCoordinates=function(){return{x1:x,y1:s,x2:T,y2:c}},this.setCoordinates=function(o){x=o.x1,s=o.y1,T=o.x2,c=o.y2,F()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(x,T),minY:Math.min(s,c),maxX:Math.max(x,T),maxY:Math.max(s,c)}},this.pointOnPath=function(o,g){if(o===0&&!g)return{x,y:s};if(o===1&&!g)return{x:T,y:c};var h=g?o>0?o:m+o:o*m;return J.pointOnLine({x,y:s},{x:T,y:c},h)},this.gradientAtPoint=function(o){return y},this.pointAlongPathFrom=function(o,g,h){var E=this.pointOnPath(o,h),I=g<=0?{x,y:s}:{x:T,y:c};return g<=0&&Math.abs(g)>1&&(g*=-1),J.pointOnLine(E,I,g)};var G=function(o,g,h){return h>=Math.min(o,g)&&h<=Math.max(o,g)},B=function(o,g,h){return Math.abs(h-o)<Math.abs(h-g)?o:g};this.findClosestPointOnPath=function(o,g){var h={d:1/0,x:null,y:null,l:null,x1:x,x2:T,y1:s,y2:c};if(y===0)h.y=s,h.x=G(x,T,o)?o:B(x,T,o);else if(y===1/0||y===-1/0)h.x=x,h.y=G(s,c,g)?g:B(s,c,g);else{var E=s-y*x,I=g-j*o,p=(I-E)/(y-j),v=y*p+E;h.x=G(x,T,p)?p:B(x,T,p),h.y=G(s,c,v)?v:B(s,c,v)}var C=J.lineLength([h.x,h.y],[x,s]);return h.d=J.lineLength([o,g],[h.x,h.y]),h.l=C/m,h};var M=function(o,g,h){return h>g?g<=o&&o<=h:g>=o&&o>=h},b=M;this.lineIntersection=function(o,g,h,E){var I=Math.abs(J.gradient({x:o,y:g},{x:h,y:E})),p=Math.abs(y),v=p===1/0?x:s-p*x,C=[],w=I===1/0?o:g-I*o;if(I!==p)if(I===1/0&&p===0)b(o,x,T)&&b(s,g,E)&&(C=[o,s]);else if(I===0&&p===1/0)b(g,s,c)&&b(x,o,h)&&(C=[x,g]);else{var u,d;I===1/0?(u=o,b(u,x,T)&&(d=p*o+v,b(d,g,E)&&(C=[u,d]))):I===0?(d=g,b(d,s,c)&&(u=(g-v)/p,b(u,o,h)&&(C=[u,d]))):(u=(w-v)/(p-I),d=p*u+v,b(u,x,T)&&b(d,s,c)&&(C=[u,d]))}return C},this.boxIntersection=function(o,g,h,E){var I=[];return I.push.apply(I,this.lineIntersection(o,g,o+h,g)),I.push.apply(I,this.lineIntersection(o+h,g,o+h,g+E)),I.push.apply(I,this.lineIntersection(o+h,g+E,o,g+E)),I.push.apply(I,this.lineIntersection(o,g+E,o,g)),I},this.boundingBoxIntersection=function(o){return this.boxIntersection(o.x,o.y,o.w,o.h)}},Arc:function(t){f.Segments.AbstractSegment.apply(this,arguments);var m=function(B,M){return J.theta([t.cx,t.cy],[B,M])},y=function(B,M){if(B.anticlockwise){var b=B.startAngle<B.endAngle?B.startAngle+j:B.startAngle,o=Math.abs(b-B.endAngle);return b-o*M}else{var g=B.endAngle<B.startAngle?B.endAngle+j:B.endAngle,h=Math.abs(g-B.startAngle);return B.startAngle+h*M}},j=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=m(t.x1,t.y1),this.endAngle=m(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=j),this.startAngle<0&&(this.startAngle+=j);var x=this.endAngle<this.startAngle?this.endAngle+j:this.endAngle;this.sweep=Math.abs(x-this.startAngle),this.anticlockwise&&(this.sweep=j-this.sweep);var T=2*Math.PI*this.radius,s=this.sweep/j,c=T*s;this.getLength=function(){return c},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var F=1e-10,G=function(B){var M=Math.floor(B),b=Math.ceil(B);return B-M<F?M:b-B<F?b:B};this.pointOnPath=function(B,M){if(B===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(B===1)return{x:this.x2,y:this.y2,theta:this.endAngle};M&&(B=B/c);var b=y(this,B),o=t.cx+t.r*Math.cos(b),g=t.cy+t.r*Math.sin(b);return{x:G(o),y:G(g),theta:b}},this.gradientAtPoint=function(B,M){var b=this.pointOnPath(B,M),o=J.normal([t.cx,t.cy],[b.x,b.y]);return!this.anticlockwise&&(o===1/0||o===-1/0)&&(o*=-1),o},this.pointAlongPathFrom=function(B,M,b){var o=this.pointOnPath(B,b),g=M/T*2*Math.PI,h=this.anticlockwise?-1:1,E=o.theta+h*g,I=t.cx+this.radius*Math.cos(E),p=t.cy+this.radius*Math.sin(E);return{x:I,y:p}}},Bezier:function(t){this.curve=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}],f.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)},this.type="Bezier";var m=function(y,j,x){return x&&(j=q.jsBezier.locationAlongCurveFrom(y,j>0?0:1,j)),j};this.pointOnPath=function(y,j){return y=m(this.curve,y,j),q.jsBezier.pointOnCurve(this.curve,y)},this.gradientAtPoint=function(y,j){return y=m(this.curve,y,j),q.jsBezier.gradientAtPoint(this.curve,y)},this.pointAlongPathFrom=function(y,j,x){return y=m(this.curve,y,x),q.jsBezier.pointAlongCurveFrom(this.curve,y,j)},this.getLength=function(){return q.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(y,j){var x=q.jsBezier.nearestPointOnCurve({x:y,y:j},this.curve);return{d:Math.sqrt(Math.pow(x.point.x-y,2)+Math.pow(x.point.y-j,2)),x:x.point.x,y:x.point.y,l:1-x.location,s:this}},this.lineIntersection=function(y,j,x,T){return q.jsBezier.lineIntersection(y,j,x,T,this.curve)}}},f.SegmentRenderer={getPath:function(t,m){return{Straight:function(y){var j=t.getCoordinates();return(y?"M "+j.x1+" "+j.y1+" ":"")+"L "+j.x2+" "+j.y2},Bezier:function(y){var j=t.params;return(y?"M "+j.x2+" "+j.y2+" ":"")+"C "+j.cp2x+" "+j.cp2y+" "+j.cp1x+" "+j.cp1y+" "+j.x1+" "+j.y1},Arc:function(y){var j=t.params,x=t.sweep>Math.PI?1:0,T=t.anticlockwise?0:1;return(y?"M"+t.x1+" "+t.y1+" ":"")+"A "+t.radius+" "+j.r+" 0 "+x+","+T+" "+t.x2+" "+t.y2}}[t.type](m)}};var Y=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};f.Connectors.AbstractConnector=function(t){Y.apply(this,arguments);var m=[],y=0,j=[],x=[],T=t.stub||0,s=U.isArray(T)?T[0]:T,c=U.isArray(T)?T[1]:T,F=t.gap||0,G=U.isArray(F)?F[0]:F,B=U.isArray(F)?F[1]:F,M=null,b=null;this.getPathData=function(){for(var p="",v=0;v<m.length;v++)p+=f.SegmentRenderer.getPath(m[v],v===0),p+=" ";return p},this.findSegmentForPoint=function(p,v){for(var C={d:1/0,s:null,x:null,y:null,l:null},w=0;w<m.length;w++){var u=m[w].findClosestPointOnPath(p,v);u.d<C.d&&(C.d=u.d,C.l=u.l,C.x=u.x,C.y=u.y,C.s=m[w],C.x1=u.x1,C.x2=u.x2,C.y1=u.y1,C.y2=u.y2,C.index=w,C.connectorLocation=j[w][0]+u.l*(j[w][1]-j[w][0]))}return C},this.lineIntersection=function(p,v,C,w){for(var u=[],d=0;d<m.length;d++)u.push.apply(u,m[d].lineIntersection(p,v,C,w));return u},this.boxIntersection=function(p,v,C,w){for(var u=[],d=0;d<m.length;d++)u.push.apply(u,m[d].boxIntersection(p,v,C,w));return u},this.boundingBoxIntersection=function(p){for(var v=[],C=0;C<m.length;C++)v.push.apply(v,m[C].boundingBoxIntersection(p));return v};var o=function(){for(var p=0,v=0;v<m.length;v++){var C=m[v].getLength();x[v]=C/y,j[v]=[p,p+=C/y]}},g=function(p,v){v&&(p=p>0?p/y:(y+p)/y);for(var C=j.length-1,w=1,u=0;u<j.length;u++)if(j[u][1]>=p){C=u,w=p===1?1:p===0?0:(p-j[u][0])/x[u];break}return{segment:m[C],proportion:w,index:C}},h=function(p,v,C){if(!(C.x1===C.x2&&C.y1===C.y2)){var w=new f.Segments[v](C);m.push(w),y+=w.getLength(),p.updateBounds(w)}},E=function(){y=m.length=j.length=x.length=0};this.setSegments=function(p){M=[],y=0;for(var v=0;v<p.length;v++)M.push(p[v]),y+=p[v].getLength()},this.getLength=function(){return y};var I=function(p){this.strokeWidth=p.strokeWidth;var v=J.quadrant(p.sourcePos,p.targetPos),C=p.targetPos[0]<p.sourcePos[0],w=p.targetPos[1]<p.sourcePos[1],u=p.strokeWidth||1,d=p.sourceEndpoint.anchor.getOrientation(p.sourceEndpoint),P=p.targetEndpoint.anchor.getOrientation(p.targetEndpoint),k=C?p.targetPos[0]:p.sourcePos[0],N=w?p.targetPos[1]:p.sourcePos[1],i=Math.abs(p.targetPos[0]-p.sourcePos[0]),e=Math.abs(p.targetPos[1]-p.sourcePos[1]);if(d[0]===0&&d[1]===0||P[0]===0&&P[1]===0){var n=i>e?0:1,A=[1,0][n];d=[],P=[],d[n]=p.sourcePos[n]>p.targetPos[n]?-1:1,P[n]=p.sourcePos[n]>p.targetPos[n]?1:-1,d[A]=0,P[A]=0}var S=C?i+G*d[0]:G*d[0],R=w?e+G*d[1]:G*d[1],V=C?B*P[0]:i+B*P[0],z=w?B*P[1]:e+B*P[1],X=d[0]*P[0]+d[1]*P[1],nt={sx:S,sy:R,tx:V,ty:z,lw:u,xSpan:Math.abs(V-S),ySpan:Math.abs(z-R),mx:(S+V)/2,my:(R+z)/2,so:d,to:P,x:k,y:N,w:i,h:e,segment:v,startStubX:S+d[0]*s,startStubY:R+d[1]*s,endStubX:V+P[0]*c,endStubY:z+P[1]*c,isXGreaterThanStubTimes2:Math.abs(S-V)>s+c,isYGreaterThanStubTimes2:Math.abs(R-z)>s+c,opposite:X===-1,perpendicular:X===0,orthogonal:X===1,sourceAxis:d[0]===0?"y":"x",points:[k,N,i,e,S,R,V,z],stubs:[s,c]};return nt.anchorOrientation=nt.opposite?"opposite":nt.orthogonal?"orthogonal":"perpendicular",nt};return this.getSegments=function(){return m},this.updateBounds=function(p){var v=p.getBounds();this.bounds.minX=Math.min(this.bounds.minX,v.minX),this.bounds.maxX=Math.max(this.bounds.maxX,v.maxX),this.bounds.minY=Math.min(this.bounds.minY,v.minY),this.bounds.maxY=Math.max(this.bounds.maxY,v.maxY)},this.pointOnPath=function(p,v){var C=g(p,v);return C.segment&&C.segment.pointOnPath(C.proportion,!1)||[0,0]},this.gradientAtPoint=function(p,v){var C=g(p,v);return C.segment&&C.segment.gradientAtPoint(C.proportion,!1)||0},this.pointAlongPathFrom=function(p,v,C){var w=g(p,C);return w.segment&&w.segment.pointAlongPathFrom(w.proportion,v,!1)||[0,0]},this.compute=function(p){b=I.call(this,p),E(),this._compute(b,p),this.x=b.points[0],this.y=b.points[1],this.w=b.points[2],this.h=b.points[3],this.segment=b.segment,o()},{addSegment:h,prepareCompute:I,sourceStub:s,targetStub:c,maxStub:Math.max(s,c),sourceGap:G,targetGap:B,maxGap:Math.max(G,B)}},U.extend(f.Connectors.AbstractConnector,Y),f.Endpoints.AbstractEndpoint=function(t){Y.apply(this,arguments);var m=this.compute=function(y,j,x,T){var s=this._compute.apply(this,arguments);return this.x=s[0],this.y=s[1],this.w=s[2],this.h=s[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,s};return{compute:m,cssClass:t.cssClass}},U.extend(f.Endpoints.AbstractEndpoint,Y),f.Endpoints.Dot=function(t){this.type="Dot",f.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(m,y,j,x){this.radius=j.radius||this.radius;var T=m[0]-this.radius,s=m[1]-this.radius,c=this.radius*2,F=this.radius*2;if(j.stroke){var G=j.strokeWidth||1;T-=G,s-=G,c+=G*2,F+=G*2}return[T,s,c,F,this.radius]}},U.extend(f.Endpoints.Dot,f.Endpoints.AbstractEndpoint),f.Endpoints.Rectangle=function(t){this.type="Rectangle",f.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(m,y,j,x){var T=j.width||this.width,s=j.height||this.height,c=m[0]-T/2,F=m[1]-s/2;return[c,F,T,s]}},U.extend(f.Endpoints.Rectangle,f.Endpoints.AbstractEndpoint);var $=function(t){f.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};U.extend($,f.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),f.Endpoints.Image=function(t){this.type="Image",$.apply(this,arguments),f.Endpoints.AbstractEndpoint.apply(this,arguments);var m=t.onload,y=t.src||t.url,j=t.cssClass?" "+t.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=t.width,this._jsPlumb.heightToUse=t.height,this._jsPlumb.endpoint=t.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,m&&m(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(x,T){var s=x.constructor===String?x:x.src;m=T,this._jsPlumb.img.src=s,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(y,m),this._compute=function(x,T,s,c){return this.anchorPoint=x,this._jsPlumb.ready?[x[0]-this._jsPlumb.widthToUse/2,x[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=f.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+j),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(x,T,s){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var c=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,F=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;U.sizeElement(this.canvas,c,F,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(x,T){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(x,T):q.setTimeout(function(){this.paint(x,T)}.bind(this),200))}},U.extend(f.Endpoints.Image,[$,f.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),f.Endpoints.Blank=function(t){f.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",$.apply(this,arguments),this._compute=function(y,j,x,T){return[y[0],y[1],10,0]};var m=t.cssClass?" "+t.cssClass:"";this.canvas=f.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+m),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(y,j){U.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},U.extend(f.Endpoints.Blank,[f.Endpoints.AbstractEndpoint,$],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),f.Endpoints.Triangle=function(t){this.type="Triangle",f.Endpoints.AbstractEndpoint.apply(this,arguments);var m=this;t=t||{},t.width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(y,j,x,T){var s=x.width||m.width,c=x.height||m.height,F=y[0]-s/2,G=y[1]-c/2;return[F,G,s,c]}};var l=f.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=t.location==null?.5:t.location,this.endpointLoc=t.endpointLocation==null?[.5,.5]:t.endpointLocation,this.visible=t.visible!==!1};l.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t,m){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},f.Overlays.Arrow=function(t){this.type="Arrow",l.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};var m=this;this.length=t.length||20,this.width=t.width||20,this.id=t.id,this.direction=(t.direction||1)<0?-1:1;var y=t.paintStyle||{"stroke-width":1},j=t.foldback||.623;this.computeMaxSize=function(){return m.width*1.5},this.elementCreated=function(x,T){if(this.path=x,t.events)for(var s in t.events)f.on(x,s,t.events[s])},this.draw=function(x,T){var s,c,F,G,B;if(x.pointAlongPathFrom){if(U.isString(this.loc)||this.loc>1||this.loc<0){var M=parseInt(this.loc,10),b=this.loc<0?1:0;s=x.pointAlongPathFrom(b,M,!1),c=x.pointAlongPathFrom(b,M-this.direction*this.length/2,!1),F=J.pointOnLine(s,c,this.length)}else if(this.loc===1){if(s=x.pointOnPath(this.loc),c=x.pointAlongPathFrom(this.loc,-this.length),F=J.pointOnLine(s,c,this.length),this.direction===-1){var o=F;F=s,s=o}}else if(this.loc===0){if(F=x.pointOnPath(this.loc),c=x.pointAlongPathFrom(this.loc,this.length),s=J.pointOnLine(F,c,this.length),this.direction===-1){var g=F;F=s,s=g}}else s=x.pointAlongPathFrom(this.loc,this.direction*this.length/2),c=x.pointOnPath(this.loc),F=J.pointOnLine(s,c,this.length);G=J.perpendicularLineTo(s,F,this.width),B=J.pointOnLine(s,F,j*this.length);var h={hxy:s,tail:G,cxy:B},E=y.stroke||T.stroke,I=y.fill||T.stroke,p=y.strokeWidth||T.strokeWidth;return{component:x,d:h,"stroke-width":p,stroke:E,fill:I,minX:Math.min(s.x,G[0].x,G[1].x),maxX:Math.max(s.x,G[0].x,G[1].x),minY:Math.min(s.y,G[0].y,G[1].y),maxY:Math.max(s.y,G[0].y,G[1].y)}}else return{component:x,minX:0,maxX:0,minY:0,maxY:0}}},U.extend(f.Overlays.Arrow,l,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=t.direction!=null?t.direction:this.direction,this.foldback=t.foldback||this.foldback},cleanup:function(){this.path&&this.canvas&&this.canvas.removeChild(this.path)}}),f.Overlays.PlainArrow=function(t){t=t||{};var m=f.extend(t,{foldback:1});f.Overlays.Arrow.call(this,m),this.type="PlainArrow"},U.extend(f.Overlays.PlainArrow,f.Overlays.Arrow),f.Overlays.Diamond=function(t){t=t||{};var m=t.length||40,y=f.extend(t,{length:m/2,foldback:2});f.Overlays.Arrow.call(this,y),this.type="Diamond"},U.extend(f.Overlays.Diamond,f.Overlays.Arrow);var O=function(t,m){return(t._jsPlumb.cachedDimensions==null||m)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},a=function(t){f.jsPlumbUIComponent.apply(this,arguments),l.apply(this,arguments);var m=this.fire;this.fire=function(){m.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=t.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){var y=this._jsPlumb.div=f.getElement(this._jsPlumb.create(this._jsPlumb.component));y.style.position="absolute",jsPlumb.addClass(y,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"")),this._jsPlumb.instance.appendElement(y),this._jsPlumb.instance.getId(y),this.canvas=y;var j="translate(-50%, -50%)";y.style.webkitTransform=j,y.style.mozTransform=j,y.style.msTransform=j,y.style.oTransform=j,y.style.transform=j,y._jsPlumb=this,t.visible===!1&&(y.style.display="none")}return this._jsPlumb.div},this.draw=function(y,j,x){var T=O(this);if(T!=null&&T.length===2){var s={x:0,y:0};if(x)s={x:x[0],y:x[1]};else if(y.pointOnPath){var c=this.loc,F=!1;(U.isString(this.loc)||this.loc<0||this.loc>1)&&(c=parseInt(this.loc,10),F=!0),s=y.pointOnPath(c,F)}else{var G=this.loc.constructor===Array?this.loc:this.endpointLoc;s={x:G[0]*y.w,y:G[1]*y.h}}var B=s.x-T[0]/2,M=s.y-T[1]/2;return{component:y,d:{minx:B,miny:M,td:T,cxy:s},minX:B,maxX:B+T[0],minY:M,maxY:M+T[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};U.extend(a,[f.jsPlumbUIComponent,l],{getDimensions:function(){return[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(O(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t,m){this._jsPlumb.div!=null&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var t=O(this);return Math.max(t[0],t[1])},paint:function(t,m){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),f.Overlays.Custom=function(t){this.type="Custom",a.apply(this,arguments)},U.extend(f.Overlays.Custom,a),f.Overlays.GuideLines=function(){var t=this;t.length=50,t.strokeWidth=5,this.type="GuideLines",l.apply(this,arguments),f.jsPlumbUIComponent.apply(this,arguments),this.draw=function(m,y){var j=m.pointAlongPathFrom(t.loc,t.length/2),x=m.pointOnPath(t.loc),T=J.pointOnLine(j,x,t.length),s=J.perpendicularLineTo(j,T,40),c=J.perpendicularLineTo(T,j,20);return{connector:m,head:j,tail:T,headLine:c,tailLine:s,minX:Math.min(j.x,T.x,c[0].x,c[1].x),minY:Math.min(j.y,T.y,c[0].y,c[1].y),maxX:Math.max(j.x,T.x,c[0].x,c[1].x),maxY:Math.max(j.y,T.y,c[0].y,c[1].y)}}},f.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var m=f.extend({create:function(){return f.createElement("div")}},t);if(f.Overlays.Custom.call(this,m),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){var y=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",y.style.font=this.labelStyle.font,y.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(y.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){var j=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";y.style.border=this.labelStyle.borderWidth+"px solid "+j}this.labelStyle.padding&&(y.style.padding=this.labelStyle.padding)}},U.extend(f.Overlays.Label,f.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),a.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){t.label!=null&&this.setLabel(t.label)}})}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumbUtil,U=q.jsPlumbInstance,J="jtk-group-collapsed",Y="jtk-group-expanded",$="[jtk-group-content]",l="elementDraggable",O="stop",a="revert",t="_groupManager",m="_jsPlumbGroup",y="_jsPlumbGroupDrag",j="group:addMember",x="group:removeMember",T="group:add",s="group:remove",c="group:expand",F="group:collapse",G="groupDragStop",B="connectionMoved",M="internal.connectionDetached",b="removeAll",o="orphanAll",g="show",h="hide",E=function(p){var v={},C={},w={},u=this;p.bind("connection",function(e){e.source[m]!=null&&e.target[m]!=null&&e.source[m]===e.target[m]?(C[e.connection.id]=e.source[m],w[e.connection.id]=e.source[m]):(e.source[m]!=null&&(f.suggest(e.source[m].connections.source,e.connection),C[e.connection.id]=e.source[m]),e.target[m]!=null&&(f.suggest(e.target[m].connections.target,e.connection),w[e.connection.id]=e.target[m]))});function d(e){delete e.proxies;var n=C[e.id],A;n!=null&&(A=function(S){return S.id===e.id},f.removeWithFunction(n.connections.source,A),f.removeWithFunction(n.connections.target,A),delete C[e.id]),n=w[e.id],n!=null&&(A=function(S){return S.id===e.id},f.removeWithFunction(n.connections.source,A),f.removeWithFunction(n.connections.target,A),delete w[e.id])}p.bind(M,function(e){d(e.connection)}),p.bind(B,function(e){var n=e.index===0?C:w,A=n[e.connection.id];if(A){var S=A.connections[e.index===0?"source":"target"],R=S.indexOf(e.connection);R!==-1&&S.splice(R,1)}}),this.addGroup=function(e){p.addClass(e.getEl(),Y),v[e.id]=e,e.manager=this,i(e),p.fire(T,{group:e})},this.addToGroup=function(e,n,A){if(e=this.getGroup(e),e){var S=e.getEl();if(n._isJsPlumbGroup)return;var R=n._jsPlumbGroup;if(R!==e){var V=p.getOffset(n,!0),z=e.collapsed?p.getOffset(S,!0):p.getOffset(e.getDragArea(),!0);R!=null&&(R.remove(n,!1,A,!1,e),u.updateConnectionsForGroup(R)),e.add(n,A);var X=function(it,st){var ht=st===0?1:0;it.each(function(dt){dt.setVisible(!1),dt.endpoints[ht].element._jsPlumbGroup===e?(dt.endpoints[ht].setVisible(!1),N(dt,ht,e)):(dt.endpoints[st].setVisible(!1),k(dt,st,e))})};e.collapsed&&(X(p.select({source:n}),0),X(p.select({target:n}),1));var nt=p.getId(n);p.dragManager.setParent(n,nt,S,p.getId(S),V);var pt={left:V.left-z.left,top:V.top-z.top};if(p.setPosition(n,pt),p.dragManager.revalidateParent(n,nt,V),u.updateConnectionsForGroup(e),p.revalidate(nt),!A){var ft={group:e,el:n,pos:pt};R&&(ft.sourceGroup=R),p.fire(j,ft)}}}},this.removeFromGroup=function(e,n,A){e=this.getGroup(e),e&&e.remove(n,null,A)},this.getGroup=function(e){var n=e;if(f.isString(e)&&(n=v[e],n==null))throw new TypeError("No such group ["+e+"]");return n},this.getGroups=function(){var e=[];for(var n in v)e.push(v[n]);return e},this.removeGroup=function(e,n,A,S){e=this.getGroup(e),this.expandGroup(e,!0);var R=e[n?b:o](A,S);return p.remove(e.getEl()),delete v[e.id],delete p._groups[e.id],p.fire(s,{group:e}),R},this.removeAllGroups=function(e,n,A){for(var S in v)this.removeGroup(v[S],e,n,A)};function P(e,n){for(var A=e.getMembers(),S=0;S<A.length;S++)p[n?g:h](A[S],!0)}var k=function(e,n,A){var S=e.endpoints[n===0?1:0].element;if(!(S[m]&&!S[m].shouldProxy()&&S[m].collapsed)){var R=A.getEl(),V=p.getId(R);p.proxyConnection(e,n,R,V,function(z,X){return A.getEndpoint(z,X)},function(z,X){return A.getAnchor(z,X)})}};this.collapseGroup=function(e){if(e=this.getGroup(e),!(e==null||e.collapsed)){var n=e.getEl();if(P(e,!1),e.shouldProxy()){var A=function(S,R){for(var V=0;V<S.length;V++){var z=S[V];k(z,R,e)}};A(e.connections.source,0),A(e.connections.target,1)}e.collapsed=!0,p.removeClass(n,Y),p.addClass(n,J),p.revalidate(n),p.fire(F,{group:e})}};var N=function(e,n,A){p.unproxyConnection(e,n,p.getId(A.getEl()))};this.expandGroup=function(e,n){if(e=this.getGroup(e),!(e==null||!e.collapsed)){var A=e.getEl();if(P(e,!0),e.shouldProxy()){var S=function(R,V){for(var z=0;z<R.length;z++){var X=R[z];N(X,V,e)}};S(e.connections.source,0),S(e.connections.target,1)}e.collapsed=!1,p.addClass(A,Y),p.removeClass(A,J),p.revalidate(A),this.repaintGroup(e),n||p.fire(c,{group:e})}},this.repaintGroup=function(e){e=this.getGroup(e);for(var n=e.getMembers(),A=0;A<n.length;A++)p.revalidate(n[A])};function i(e){var n=e.getMembers(),A=p.getConnections({source:n,scope:"*"},!0),S=p.getConnections({target:n,scope:"*"},!0),R={};e.connections.source.length=0,e.connections.target.length=0;var V=function(z){for(var X=0;X<z.length;X++)R[z[X].id]||(R[z[X].id]=!0,z[X].source._jsPlumbGroup===e?(z[X].target._jsPlumbGroup!==e&&e.connections.source.push(z[X]),C[z[X].id]=e):z[X].target._jsPlumbGroup===e&&(e.connections.target.push(z[X]),w[z[X].id]=e))};V(A),V(S)}this.updateConnectionsForGroup=i,this.refreshAllGroups=function(){for(var e in v)i(v[e]),p.dragManager.updateOffsets(p.getId(v[e].getEl()))}},I=function(p,v){var C=this,w=v.el;this.getEl=function(){return w},this.id=v.id||f.uuid(),w._isJsPlumbGroup=!0;var u=this.getDragArea=function(){var st=p.getSelector(w,$);return st&&st.length>0?st[0]:w},d=v.ghost===!0,P=d||v.constrain===!0,k=v.revert!==!1,N=v.orphan===!0,i=v.prune===!0,e=v.dropOverride===!0,n=v.proxied!==!1,A=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(st,ht){return v.anchor||"Continuous"},this.getEndpoint=function(st,ht){return v.endpoint||["Dot",{radius:10}]},this.collapsed=!1,v.draggable!==!1){var S={stop:function(st){p.fire(G,jsPlumb.extend(st,{group:C}))},scope:y};v.dragOptions&&q.jsPlumb.extend(S,v.dragOptions),p.draggable(v.el,S)}v.droppable!==!1&&p.droppable(v.el,{drop:function(st){var ht=st.drag.el;if(!ht._isJsPlumbGroup){var dt=ht._jsPlumbGroup;if(dt!==C){if(dt!=null&&dt.overrideDrop(ht,C))return;p.getGroupManager().addToGroup(C,ht,!1)}}}});var R=function(st,ht){for(var dt=st.nodeType==null?st:[st],at=0;at<dt.length;at++)ht(dt[at])};this.overrideDrop=function(st,ht){return e&&(k||i||N)},this.add=function(st,ht){var dt=u();R(st,function(at){if(at._jsPlumbGroup!=null){if(at._jsPlumbGroup===C)return;at._jsPlumbGroup.remove(at,!0,ht,!1)}at._jsPlumbGroup=C,A.push(at),p.isAlreadyDraggable(at)&&it(at),at.parentNode!==dt&&dt.appendChild(at)}),p.getGroupManager().updateConnectionsForGroup(C)},this.remove=function(st,ht,dt,at,vt){R(st,function(bt){if(bt._jsPlumbGroup===C){if(delete bt._jsPlumbGroup,f.removeWithFunction(A,function(K){return K===bt}),ht)try{C.getDragArea().removeChild(bt)}catch(K){jsPlumbUtil.log("Could not remove element from Group "+K)}if(ft(bt),!dt){var Z={group:C,el:bt};vt&&(Z.targetGroup=vt),p.fire(x,Z)}}}),at||p.getGroupManager().updateConnectionsForGroup(C)},this.removeAll=function(st,ht){for(var dt=0,at=A.length;dt<at;dt++){var vt=A[0];C.remove(vt,st,ht,!0),p.remove(vt,!0)}A.length=0,p.getGroupManager().updateConnectionsForGroup(C)},this.orphanAll=function(){for(var st={},ht=0;ht<A.length;ht++){var dt=X(A[ht]);st[dt[0]]=dt[1]}return A.length=0,st},this.getMembers=function(){return A},w[m]=this,p.bind(l,function(st){st.el._jsPlumbGroup===this&&it(st.el)}.bind(this));function V(st){return st.offsetParent}function z(st,ht){var dt=V(st),at=p.getSize(dt),vt=p.getSize(st),bt=ht[0],Z=bt+vt[0],K=ht[1],Q=K+vt[1];return Z>0&&bt<at[0]&&Q>0&&K<at[1]}function X(st){var ht=p.getId(st),dt=p.getOffset(st);return st.parentNode.removeChild(st),p.getContainer().appendChild(st),p.setPosition(st,dt),ft(st),p.dragManager.clearParent(st,ht),[ht,dt]}function nt(st){var ht=[];function dt(vt,bt,Z){var K=null;if(!z(vt,[bt,Z])){var Q=vt._jsPlumbGroup;i?p.remove(vt):K=X(vt),Q.remove(vt)}return K}for(var at=0;at<st.selection.length;at++)ht.push(dt(st.selection[at][0],st.selection[at][1].left,st.selection[at][1].top));return ht.length===1?ht[0]:ht}function pt(st){var ht=p.getId(st);p.revalidate(st),p.dragManager.revalidateParent(st,ht)}function ft(st){!st._katavorioDrag||((i||N)&&st._katavorioDrag.off(O,nt),!i&&!N&&k&&(st._katavorioDrag.off(a,pt),st._katavorioDrag.setRevert(null)))}function it(st){!st._katavorioDrag||((i||N)&&st._katavorioDrag.on(O,nt),P&&st._katavorioDrag.setConstrain(!0),d&&st._katavorioDrag.setUseGhostProxy(!0),!i&&!N&&k&&(st._katavorioDrag.on(a,pt),st._katavorioDrag.setRevert(function(ht,dt){return!z(ht,dt)})))}this.shouldProxy=function(){return n},p.getGroupManager().addGroup(this)};U.prototype.addGroup=function(p){var v=this;if(v._groups=v._groups||{},v._groups[p.id]!=null)throw new TypeError("cannot create Group ["+p.id+"]; a Group with that ID exists");if(p.el[m]!=null)throw new TypeError("cannot create Group ["+p.id+"]; the given element is already a Group");var C=new I(v,p);return v._groups[C.id]=C,p.collapsed&&this.collapseGroup(C),C},U.prototype.addToGroup=function(p,v,C){var w=function(d){var P=this.getId(d);this.manage(P,d),this.getGroupManager().addToGroup(p,d,C)}.bind(this);if(Array.isArray(v))for(var u=0;u<v.length;u++)w(v[u]);else w(v)},U.prototype.removeFromGroup=function(p,v,C){this.getGroupManager().removeFromGroup(p,v,C)},U.prototype.removeGroup=function(p,v,C,w){return this.getGroupManager().removeGroup(p,v,C,w)},U.prototype.removeAllGroups=function(p,v,C){this.getGroupManager().removeAllGroups(p,v,C)},U.prototype.getGroup=function(p){return this.getGroupManager().getGroup(p)},U.prototype.getGroups=function(){return this.getGroupManager().getGroups()},U.prototype.expandGroup=function(p){this.getGroupManager().expandGroup(p)},U.prototype.collapseGroup=function(p){this.getGroupManager().collapseGroup(p)},U.prototype.repaintGroup=function(p){this.getGroupManager().repaintGroup(p)},U.prototype.toggleGroup=function(p){p=this.getGroupManager().getGroup(p),p!=null&&this.getGroupManager()[p.collapsed?"expandGroup":"collapseGroup"](p)},U.prototype.getGroupManager=function(){var p=this[t];return p==null&&(p=this[t]=new E(this)),p},U.prototype.removeGroupManager=function(){delete this[t]},U.prototype.getGroupFor=function(p){if(p=this.getElement(p),p)return p[m]}}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J="Straight",Y="Arc",$=function(l){this.type="Flowchart",l=l||{},l.stub=l.stub==null?30:l.stub;var O,a=f.Connectors.AbstractConnector.apply(this,arguments),t=l.midpoint==null?.5:l.midpoint,m=l.alwaysRespectStubs===!0,y=null,j=null,x=l.cornerRadius!=null?l.cornerRadius:0;l.loopbackRadius;var T=function(M){return M<0?-1:M===0?0:1},s=function(M){return[T(M[2]-M[0]),T(M[3]-M[1])]},c=function(M,b,o,g){if(!(y===b&&j===o)){var h=y==null?g.sx:y,E=j==null?g.sy:j,I=h===b?"v":"h";y=b,j=o,M.push([h,E,b,o,I])}},F=function(M){return Math.sqrt(Math.pow(M[0]-M[2],2)+Math.pow(M[1]-M[3],2))},G=function(M){var b=[];return b.push.apply(b,M),b},B=function(M,b,o){for(var g=null,h,E,I,p=0;p<b.length-1;p++){if(g=g||G(b[p]),h=G(b[p+1]),E=s(g),I=s(h),x>0&&g[4]!==h[4]){var v=Math.min(F(g),F(h)),C=Math.min(x,v/2);g[2]-=E[0]*C,g[3]-=E[1]*C,h[0]+=I[0]*C,h[1]+=I[1]*C;var w=E[1]===I[0]&&I[0]===1||E[1]===I[0]&&I[0]===0&&E[0]!==I[1]||E[1]===I[0]&&I[0]===-1,u=h[1]>g[3]?1:-1,d=h[0]>g[2]?1:-1,P=u===d,k=P&&w||!P&&!w?h[0]:g[2],N=P&&w||!P&&!w?g[3]:h[1];a.addSegment(M,J,{x1:g[0],y1:g[1],x2:g[2],y2:g[3]}),a.addSegment(M,Y,{r:C,x1:g[2],y1:g[3],x2:h[0],y2:h[1],cx:k,cy:N,ac:w})}else{var i=g[2]===g[0]?0:g[2]>g[0]?o.lw/2:-(o.lw/2),e=g[3]===g[1]?0:g[3]>g[1]?o.lw/2:-(o.lw/2);a.addSegment(M,J,{x1:g[0]-i,y1:g[1]-e,x2:g[2]+i,y2:g[3]+e})}g=h}h!=null&&a.addSegment(M,J,{x1:h[0],y1:h[1],x2:h[2],y2:h[3]})};this._compute=function(M,b){O=[],y=null,j=null;var o=function(){return[M.startStubX,M.startStubY,M.endStubX,M.endStubY]},g={perpendicular:o,orthogonal:o,opposite:function(e){var n=M,A=e==="x"?0:1,S={x:function(){return n.so[A]===1&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||n.so[A]===-1&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return n.so[A]===1&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||n.so[A]===-1&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}};return!m&&S[e]()?{x:[(M.sx+M.tx)/2,M.startStubY,(M.sx+M.tx)/2,M.endStubY],y:[M.startStubX,(M.sy+M.ty)/2,M.endStubX,(M.sy+M.ty)/2]}[e]:[M.startStubX,M.startStubY,M.endStubX,M.endStubY]}},h=g[M.anchorOrientation](M.sourceAxis),E=M.sourceAxis==="x"?0:1,I=M.sourceAxis==="x"?1:0,p=h[E],v=h[I],C=h[E+2],w=h[I+2];c(O,h[0],h[1],M);var u=M.startStubX+(M.endStubX-M.startStubX)*t,d=M.startStubY+(M.endStubY-M.startStubY)*t,P={x:[0,1],y:[1,0]},k={perpendicular:function(e){var n=M,A={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},S={x:[[n.startStubX,n.endStubX],null,[n.endStubX,n.startStubX]],y:[[n.startStubY,n.endStubY],null,[n.endStubY,n.startStubY]]},R={x:[[u,n.startStubY],[u,n.endStubY]],y:[[n.startStubX,d],[n.endStubX,d]]},V={x:[[n.endStubX,n.startStubY]],y:[[n.startStubX,n.endStubY]]},z={x:[[n.startStubX,n.endStubY],[n.endStubX,n.endStubY]],y:[[n.endStubX,n.startStubY],[n.endStubX,n.endStubY]]},X={x:[[n.startStubX,d],[n.endStubX,d],[n.endStubX,n.endStubY]],y:[[u,n.startStubY],[u,n.endStubY],[n.endStubX,n.endStubY]]},nt={x:[n.startStubY,n.endStubY],y:[n.startStubX,n.endStubX]},pt=P[e][0],ft=P[e][1],it=n.so[pt]+1,st=n.to[ft]+1,ht=n.to[ft]===-1&&nt[e][1]<nt[e][0]||n.to[ft]===1&&nt[e][1]>nt[e][0],dt=S[e][it][0],at=S[e][it][1],vt=A[e][it][st];if(n.segment===vt[3]||n.segment===vt[2]&&ht)return R[e];if(n.segment===vt[2]&&at<dt)return V[e];if(n.segment===vt[2]&&at>=dt||n.segment===vt[1]&&!ht)return X[e];if(n.segment===vt[0]||n.segment===vt[1]&&ht)return z[e]},orthogonal:function(e,n,A,S,R){var V=M,z={x:V.so[0]===-1?Math.min(n,S):Math.max(n,S),y:V.so[1]===-1?Math.min(n,S):Math.max(n,S)}[e];return{x:[[z,A],[z,R],[S,R]],y:[[A,z],[R,z],[R,S]]}[e]},opposite:function(e,n,A,S){var R=M,V={x:"y",y:"x"}[e],z={x:"height",y:"width"}[e],X=R["is"+e.toUpperCase()+"GreaterThanStubTimes2"];if(b.sourceEndpoint.elementId===b.targetEndpoint.elementId){var nt=A+(1-b.sourceEndpoint.anchor[V])*b.sourceInfo[z]+a.maxStub;return{x:[[n,nt],[S,nt]],y:[[nt,n],[nt,S]]}[e]}else{if(!X||R.so[E]===1&&n>S||R.so[E]===-1&&n<S)return{x:[[n,d],[S,d]],y:[[u,n],[u,S]]}[e];if(R.so[E]===1&&n<S||R.so[E]===-1&&n>S)return{x:[[u,R.sy],[u,R.ty]],y:[[R.sx,d],[R.tx,d]]}[e]}}},N=k[M.anchorOrientation](M.sourceAxis,p,v,C,w);if(N)for(var i=0;i<N.length;i++)c(O,N[i][0],N[i][1],M);c(O,h[2],h[3],M),c(O,M.tx,M.ty,M),B(this,O,M)}};f.Connectors.Flowchart=$,U.extend(f.Connectors.Flowchart,f.Connectors.AbstractConnector)}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil;f.Connectors.AbstractBezierConnector=function(Y){Y=Y||{};var $=Y.showLoopback!==!1;Y.curviness;var l=Y.margin||5;Y.proximityLimit;var O=Y.orientation&&Y.orientation==="clockwise",a=Y.loopbackRadius||25,t;return this._compute=function(m,y){var j=y.sourcePos,x=y.targetPos,T=Math.abs(j[0]-x[0]),s=Math.abs(j[1]-x[1]);if(!$||y.sourceEndpoint.elementId!==y.targetEndpoint.elementId)this._computeBezier(m,y,j,x,T,s);else{var c=y.sourcePos[0],F=y.sourcePos[1]-l,G=c,B=F-a,M=G-a,b=B-a;T=2*a,s=2*a,m.points[0]=M,m.points[1]=b,m.points[2]=T,m.points[3]=s,t.addSegment(this,"Arc",{loopback:!0,x1:c-M+4,y1:F-b,startAngle:0,endAngle:2*Math.PI,r:a,ac:!O,x2:c-M-4,y2:F-b,cx:G-M,cy:B-b})}},t=f.Connectors.AbstractConnector.apply(this,arguments),t},U.extend(f.Connectors.AbstractBezierConnector,f.Connectors.AbstractConnector);var J=function(Y){Y=Y||{},this.type="Bezier";var $=f.Connectors.AbstractBezierConnector.apply(this,arguments),l=Y.curviness||150,O=10;this.getCurviness=function(){return l},this._findControlPoint=function(a,t,m,y,j,x,T){var s=x[0]!==T[0]||x[1]===T[1],c=[];return s?(T[0]===0?c.push(m[0]<t[0]?a[0]+O:a[0]-O):c.push(a[0]+l*T[0]),T[1]===0?c.push(m[1]<t[1]?a[1]+O:a[1]-O):c.push(a[1]+l*x[1])):(x[0]===0?c.push(t[0]<m[0]?a[0]+O:a[0]-O):c.push(a[0]-l*x[0]),x[1]===0?c.push(t[1]<m[1]?a[1]+O:a[1]-O):c.push(a[1]+l*T[1])),c},this._computeBezier=function(a,t,m,y,j,x){var T,s,c=m[0]<y[0]?j:0,F=m[1]<y[1]?x:0,G=m[0]<y[0]?0:j,B=m[1]<y[1]?0:x;T=this._findControlPoint([c,F],m,y,t.sourceEndpoint,t.targetEndpoint,a.so,a.to),s=this._findControlPoint([G,B],y,m,t.targetEndpoint,t.sourceEndpoint,a.to,a.so),$.addSegment(this,"Bezier",{x1:c,y1:F,x2:G,y2:B,cp1x:T[0],cp1y:T[1],cp2x:s[0],cp2y:s[1]})}};f.Connectors.Bezier=J,U.extend(J,f.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J=function(l,O,a,t){return l<=a&&t<=O?1:l<=a&&O<=t?2:a<=l&&t>=O?3:4},Y=function(l,O,a,t,m,y,j,x,T){if(x<=T)return[l,O];if(a===1)return t[3]<=0&&m[3]>=1?[l+(t[2]<.5?-1*y:y),O]:t[2]>=1&&m[2]<=0?[l,O+(t[3]<.5?-1*j:j)]:[l+-1*y,O+-1*j];if(a===2)return t[3]>=1&&m[3]<=0?[l+(t[2]<.5?-1*y:y),O]:t[2]>=1&&m[2]<=0?[l,O+(t[3]<.5?-1*j:j)]:[l+y,O+-1*j];if(a===3)return t[3]>=1&&m[3]<=0?[l+(t[2]<.5?-1*y:y),O]:t[2]<=0&&m[2]>=1?[l,O+(t[3]<.5?-1*j:j)]:[l+-1*y,O+-1*j];if(a===4)return t[3]<=0&&m[3]>=1?[l+(t[2]<.5?-1*y:y),O]:t[2]<=0&&m[2]>=1?[l,O+(t[3]<.5?-1*j:j)]:[l+y,O+-1*j]},$=function(l){l=l||{},this.type="StateMachine";var O=f.Connectors.AbstractBezierConnector.apply(this,arguments),a=l.curviness||10,t=l.margin||5,m=l.proximityLimit||80;l.orientation&&l.orientation;var y;this._computeBezier=function(j,x,T,s,c,F){var G=x.sourcePos[0]<x.targetPos[0]?0:c,B=x.sourcePos[1]<x.targetPos[1]?0:F,M=x.sourcePos[0]<x.targetPos[0]?c:0,b=x.sourcePos[1]<x.targetPos[1]?F:0;x.sourcePos[2]===0&&(G-=t),x.sourcePos[2]===1&&(G+=t),x.sourcePos[3]===0&&(B-=t),x.sourcePos[3]===1&&(B+=t),x.targetPos[2]===0&&(M-=t),x.targetPos[2]===1&&(M+=t),x.targetPos[3]===0&&(b-=t),x.targetPos[3]===1&&(b+=t);var o=(G+M)/2,g=(B+b)/2,h=J(G,B,M,b),E=Math.sqrt(Math.pow(M-G,2)+Math.pow(b-B,2)),I,p,v,C;y=Y(o,g,h,x.sourcePos,x.targetPos,a,a,E,m),I=y[0],p=y[0],v=y[1],C=y[1],O.addSegment(this,"Bezier",{x1:M,y1:b,x2:G,y2:B,cp1x:I,cp1y:v,cp2x:p,cp2y:C})}};f.Connectors.StateMachine=$,U.extend($,f.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J="Straight",Y=function($){this.type=J;var l=f.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(O,a){l.addSegment(this,J,{x1:O.sx,y1:O.sy,x2:O.startStubX,y2:O.startStubY}),l.addSegment(this,J,{x1:O.startStubX,y1:O.startStubY,x2:O.endStubX,y2:O.endStubY}),l.addSegment(this,J,{x1:O.endStubX,y1:O.endStubY,x2:O.tx,y2:O.ty})}};f.Connectors.Straight=Y,U.extend(Y,f.Connectors.AbstractConnector)}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},Y="stroke-dasharray",$="dashstyle",l="linearGradient",O="radialGradient",a="defs",t="fill",m="stop",y="stroke",j="stroke-width",x="style",T="none",s="jsplumb_gradient_",c="strokeWidth",F={svg:"http://www.w3.org/2000/svg"},G=function(v,C){for(var w in C)v.setAttribute(w,""+C[w])},B=function(v,C){return C=C||{},C.version="1.1",C.xmlns=F.svg,f.createElementNS(F.svg,v,null,null,C)},M=function(v){return"position:absolute;left:"+v[0]+"px;top:"+v[1]+"px"},b=function(v){for(var C=v.querySelectorAll(" defs,linearGradient,radialGradient"),w=0;w<C.length;w++)C[w].parentNode.removeChild(C[w])},o=function(v,C,w,u,d){var P=s+d._jsPlumb.instance.idstamp();b(v);var k;w.gradient.offset?k=B(O,{id:P}):k=B(l,{id:P,gradientUnits:"userSpaceOnUse"});var N=B(a);v.appendChild(N),N.appendChild(k);for(var i=0;i<w.gradient.stops.length;i++){var e=d.segment===1||d.segment===2?i:w.gradient.stops.length-1-i,n=w.gradient.stops[e][1],A=B(m,{offset:Math.floor(w.gradient.stops[i][0]*100)+"%","stop-color":n});k.appendChild(A)}var S=w.stroke?y:t;C.setAttribute(S,"url(#"+P+")")},g=function(v,C,w,u,d){if(C.setAttribute(t,w.fill?w.fill:T),C.setAttribute(y,w.stroke?w.stroke:T),w.gradient?o(v,C,w,u,d):(b(v),C.setAttribute(x,"")),w.strokeWidth&&C.setAttribute(j,w.strokeWidth),w[$]&&w[c]&&!w[Y]){var P=w[$].indexOf(",")===-1?" ":",",k=w[$].split(P),N="";k.forEach(function(e){N+=Math.floor(e*w.strokeWidth)+P}),C.setAttribute(Y,N)}else w[Y]&&C.setAttribute(Y,w[Y]);for(var i in J)w[i]&&C.setAttribute(J[i],w[i])},h=function(v,C,w){v.childNodes.length>w?v.insertBefore(C,v.childNodes[w]):v.appendChild(C)};U.svg={node:B,attr:G,pos:M};var E=function(v){var C=v.pointerEventsSpec||"all",w={};f.jsPlumbUIComponent.apply(this,v.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var u=v.cssClass+" "+(v.originalArgs[0].cssClass||""),d={style:"",width:0,height:0,"pointer-events":C,position:"absolute"};this.svg=B("svg",d),v.useDivWrapper?(this.canvas=f.createElement("div",{position:"absolute"}),U.sizeElement(this.canvas,0,0,1,1),this.canvas.className=u):(G(this.svg,{class:u}),this.canvas=this.svg),v._jsPlumb.appendElement(this.canvas,v.originalArgs[0].parent),v.useDivWrapper&&this.canvas.appendChild(this.svg);var P=[this.canvas];return this.getDisplayElements=function(){return P},this.appendDisplayElement=function(k){P.push(k)},this.paint=function(k,N,i){if(k!=null){var e=[this.x,this.y],n=[this.w,this.h],A;i!=null&&(i.xmin<0&&(e[0]+=i.xmin),i.ymin<0&&(e[1]+=i.ymin),n[0]=i.xmax+(i.xmin<0?-i.xmin:0),n[1]=i.ymax+(i.ymin<0?-i.ymin:0)),v.useDivWrapper?(U.sizeElement(this.canvas,e[0],e[1],n[0],n[1]),e[0]=0,e[1]=0,A=M([0,0])):A=M([e[0],e[1]]),w.paint.apply(this,arguments),G(this.svg,{style:A,width:n[0]||0,height:n[1]||0})}},{renderer:w}};U.extend(E,f.jsPlumbUIComponent,{cleanup:function(v){v||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(v){var C=v.getContainer();this.canvas&&this.canvas.parentNode==null&&C.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&C.appendChild(this.bgCanvas)},setVisible:function(v){this.canvas&&(this.canvas.style.display=v?"block":"none")}}),f.ConnectorRenderers.svg=function(v){var C=this,w=E.apply(this,[{cssClass:v._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:v._jsPlumb}]);w.renderer.paint=function(u,d,P){var k=C.getSegments(),N="",i=[0,0];if(P.xmin<0&&(i[0]=-P.xmin),P.ymin<0&&(i[1]=-P.ymin),k.length>0){N=C.getPathData();var e={d:N,transform:"translate("+i[0]+","+i[1]+")","pointer-events":v["pointer-events"]||"visibleStroke"},n=null,A=[C.x,C.y,C.w,C.h];if(u.outlineStroke){var S=u.outlineWidth||1,R=u.strokeWidth+2*S;n=f.extend({},u),delete n.gradient,n.stroke=u.outlineStroke,n.strokeWidth=R,C.bgPath==null?(C.bgPath=B("path",e),f.addClass(C.bgPath,f.connectorOutlineClass),h(C.svg,C.bgPath,0)):G(C.bgPath,e),g(C.svg,C.bgPath,n,A,C)}C.path==null?(C.path=B("path",e),h(C.svg,C.path,u.outlineStroke?1:0)):G(C.path,e),g(C.svg,C.path,u,A,C)}}},U.extend(f.ConnectorRenderers.svg,E);var I=f.SvgEndpoint=function(v){var C=E.apply(this,[{cssClass:v._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:v._jsPlumb}]);C.renderer.paint=function(w){var u=f.extend({},w);u.outlineStroke&&(u.stroke=u.outlineStroke),this.node==null?(this.node=this.makeNode(u),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),g(this.svg,this.node,u,[this.x,this.y,this.w,this.h],this),M(this.node,[this.x,this.y])}.bind(this)};U.extend(I,E),f.Endpoints.svg.Dot=function(){f.Endpoints.Dot.apply(this,arguments),I.apply(this,arguments),this.makeNode=function(v){return B("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(v){G(v,{cx:this.w/2,cy:this.h/2,r:this.radius})}},U.extend(f.Endpoints.svg.Dot,[f.Endpoints.Dot,I]),f.Endpoints.svg.Rectangle=function(){f.Endpoints.Rectangle.apply(this,arguments),I.apply(this,arguments),this.makeNode=function(v){return B("rect",{width:this.w,height:this.h})},this.updateNode=function(v){G(v,{width:this.w,height:this.h})}},U.extend(f.Endpoints.svg.Rectangle,[f.Endpoints.Rectangle,I]),f.Endpoints.svg.Image=f.Endpoints.Image,f.Endpoints.svg.Blank=f.Endpoints.Blank,f.Overlays.svg.Label=f.Overlays.Label,f.Overlays.svg.Custom=f.Overlays.Custom;var p=function(v,C){v.apply(this,C),f.jsPlumbUIComponent.apply(this,C),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(u,d){if(u.component.svg&&d){this.path==null&&(this.path=B("path",{"pointer-events":"all"}),u.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,u.component),this.canvas=u.component.svg);var P=C&&C.length===1&&C[0].cssClass||"",k=[0,0];d.xmin<0&&(k[0]=-d.xmin),d.ymin<0&&(k[1]=-d.ymin),G(this.path,{d:w(u.d),class:P,stroke:u.stroke?u.stroke:null,fill:u.fill?u.fill:null,transform:"translate("+k[0]+","+k[1]+")"})}};var w=function(u){return isNaN(u.cxy.x)||isNaN(u.cxy.y)?"":"M"+u.hxy.x+","+u.hxy.y+" L"+u.tail[0].x+","+u.tail[0].y+" L"+u.cxy.x+","+u.cxy.y+" L"+u.tail[1].x+","+u.tail[1].y+" L"+u.hxy.x+","+u.hxy.y};this.transfer=function(u){u.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),u.canvas.appendChild(this.path))}};U.extend(p,[f.jsPlumbUIComponent,f.Overlays.AbstractOverlay],{cleanup:function(v){this.path!=null&&(v?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(v,C){this.path&&C.canvas&&C.canvas.appendChild(this.path)},setVisible:function(v){this.path!=null&&(this.path.style.display=v?"block":"none")}}),f.Overlays.svg.Arrow=function(){p.apply(this,[f.Overlays.Arrow,arguments])},U.extend(f.Overlays.svg.Arrow,[f.Overlays.Arrow,p]),f.Overlays.svg.PlainArrow=function(){p.apply(this,[f.Overlays.PlainArrow,arguments])},U.extend(f.Overlays.svg.PlainArrow,[f.Overlays.PlainArrow,p]),f.Overlays.svg.Diamond=function(){p.apply(this,[f.Overlays.Diamond,arguments])},U.extend(f.Overlays.svg.Diamond,[f.Overlays.Diamond,p]),f.Overlays.svg.GuideLines=function(){var v=null,C=this,w,u;f.Overlays.GuideLines.apply(this,arguments),this.paint=function(P,k){v==null&&(v=B("path"),P.connector.svg.appendChild(v),C.attachListeners(v,P.connector),C.attachListeners(v,C),w=B("path"),P.connector.svg.appendChild(w),C.attachListeners(w,P.connector),C.attachListeners(w,C),u=B("path"),P.connector.svg.appendChild(u),C.attachListeners(u,P.connector),C.attachListeners(u,C));var N=[0,0];k.xmin<0&&(N[0]=-k.xmin),k.ymin<0&&(N[1]=-k.ymin),G(v,{d:d(P.head,P.tail),stroke:"red",fill:null,transform:"translate("+N[0]+","+N[1]+")"}),G(w,{d:d(P.tailLine[0],P.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+N[0]+","+N[1]+")"}),G(u,{d:d(P.headLine[0],P.headLine[1]),stroke:"green",fill:null,transform:"translate("+N[0]+","+N[1]+")"})};var d=function(P,k){return"M "+P.x+","+P.y+" L"+k.x+","+k.y}},U.extend(f.Overlays.svg.GuideLines,f.Overlays.GuideLines)}).call(typeof window<"u"?window:globalThis);(function(){var q=this,f=q.jsPlumb,U=q.jsPlumbUtil,J=q.Katavorio,Y=q.Biltong,$=function(o){var g=o._mottle;return g||(g=o._mottle=new q.Mottle),g},l=function(o,g){g=g||"main";var h="_katavorio_"+g,E=o[h],I=o.getEventManager();return E||(E=new J({bind:I.on,unbind:I.off,getSize:f.getSize,getConstrainingRectangle:function(p){return[p.parentNode.scrollWidth,p.parentNode.scrollHeight]},getPosition:function(p,v){var C=o.getOffset(p,v,p._katavorioDrag?p.offsetParent:null);return[C.left,C.top]},setPosition:function(p,v){p.style.left=v[0]+"px",p.style.top=v[1]+"px"},addClass:f.addClass,removeClass:f.removeClass,intersects:Y.intersects,indexOf:function(p,v){return p.indexOf(v)},scope:o.getDefaultScope(),css:{noSelect:o.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),E.setZoom(o.getZoom()),o[h]=E,o.bind("zoom",E.setZoom)),E},O=function(o){var g=o.el._jsPlumbDragOptions,h=!0;return g.canDrag&&(h=g.canDrag()),h&&(this.setHoverSuspended(!0),this.select({source:o.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:o.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),h},a=function(o){var g=this.getUIPosition(arguments,this.getZoom());if(g!=null){var h=o.el._jsPlumbDragOptions;this.draw(o.el,g,null,!0),h._dragging&&this.addClass(o.el,"jtk-dragged"),h._dragging=!0}},t=function(o){for(var g=o.selection,h,E=function(p){p[1]!=null&&(h=this.getUIPosition([{el:p[2].el,pos:[p[1].left,p[1].top]}]),this.draw(p[2].el,h)),p[0]._jsPlumbDragOptions!=null&&delete p[0]._jsPlumbDragOptions._dragging,this.removeClass(p[0],"jtk-dragged"),this.select({source:p[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:p[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.getDragManager().dragEnded(p[2].el)}.bind(this),I=0;I<g.length;I++)E(g[I]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},m=function(o,g){var h=function(E){if(g[E]!=null)if(U.isString(g[E])){var I=g[E].match(/-=/)?-1:1,p=g[E].substring(2);return o[E]+I*p}else return g[E];else return o[E]};return[h("left"),h("top")]},y=function(o,g){if(g==null)return[0,0];var h=c(g),E=s(h,0);return[E[o+"X"],E[o+"Y"]]},j=y.bind(this,"page"),x=y.bind(this,"screen"),T=y.bind(this,"client"),s=function(o,g){return o.item?o.item(g):o[g]},c=function(o){return o.touches&&o.touches.length>0?o.touches:o.changedTouches&&o.changedTouches.length>0?o.changedTouches:o.targetTouches&&o.targetTouches.length>0?o.targetTouches:[o]},F=function(o){var g={},h=[],E={},I={},p={};this.register=function(v){var C=o.getId(v),w;g[C]||(g[C]=v,h.push(v),E[C]={});var u=function(d){if(d){for(var P=0;P<d.childNodes.length;P++)if(d.childNodes[P].nodeType!==3&&d.childNodes[P].nodeType!==8){var k=jsPlumb.getElement(d.childNodes[P]),N=o.getId(d.childNodes[P],null,!0);if(N&&I[N]&&I[N]>0){w||(w=o.getOffset(v));var i=o.getOffset(k);E[C][N]={id:N,offset:{left:i.left-w.left,top:i.top-w.top}},p[N]=C}u(d.childNodes[P])}}};u(v)},this.updateOffsets=function(v,C){if(v!=null){C=C||{};var w=jsPlumb.getElement(v),u=o.getId(w),d=E[u],P;if(d){for(var k in d)if(d.hasOwnProperty(k)){var N=jsPlumb.getElement(k),i=C[k]||o.getOffset(N);if(N.offsetParent==null&&E[u][k]!=null)continue;P||(P=o.getOffset(w)),E[u][k]={id:k,offset:{left:i.left-P.left,top:i.top-P.top}},p[k]=u}}}},this.endpointAdded=function(v,C){C=C||o.getId(v);var w=document.body,u=v.parentNode;for(I[C]=I[C]?I[C]+1:1;u!=null&&u!==w;){var d=o.getId(u,null,!0);if(d&&g[d]){var P=o.getOffset(u);if(E[d][C]==null){var k=o.getOffset(v);E[d][C]={id:C,offset:{left:k.left-P.left,top:k.top-P.top}},p[C]=d}break}u=u.parentNode}},this.endpointDeleted=function(v){if(I[v.elementId]&&(I[v.elementId]--,I[v.elementId]<=0))for(var C in E)E.hasOwnProperty(C)&&E[C]&&(delete E[C][v.elementId],delete p[v.elementId])},this.changeId=function(v,C){E[C]=E[v],E[v]={},p[C]=p[v],p[v]=null},this.getElementsForDraggable=function(v){return E[v]},this.elementRemoved=function(v){var C=p[v];C&&(delete E[C][v],delete p[v])},this.reset=function(){g={},h=[],E={},I={}},this.dragEnded=function(v){if(v.offsetParent!=null){var C=o.getId(v),w=p[C];w&&this.updateOffsets(w)}},this.setParent=function(v,C,w,u,d){var P=p[C];E[u]||(E[u]={});var k=o.getOffset(w),N=d||o.getOffset(v);P&&E[P]&&delete E[P][C],E[u][C]={id:C,offset:{left:N.left-k.left,top:N.top-k.top}},p[C]=u},this.clearParent=function(v,C){var w=p[C];w&&(delete E[w][C],delete p[C])},this.revalidateParent=function(v,C,w){var u=p[C];if(u){var d={};d[C]=w,this.updateOffsets(u,d),o.revalidate(u)}},this.getDragAncestor=function(v){var C=jsPlumb.getElement(v),w=o.getId(C),u=p[w];return u?jsPlumb.getElement(u):null}},G=function(o,g,h){g=U.fastTrim(g),typeof o.className.baseVal<"u"?o.className.baseVal=g:o.className=g;try{var E=o.classList;if(E!=null){for(;E.length>0;)E.remove(E.item(0));for(var I=0;I<h.length;I++)h[I]&&E.add(h[I])}}catch(p){U.log("JSPLUMB: cannot set class list",p)}},B=function(o){return typeof o.className.baseVal>"u"?o.className:o.className.baseVal},M=function(o,g,h){g=g==null?[]:U.isArray(g)?g:g.split(/\s+/),h=h==null?[]:U.isArray(h)?h:h.split(/\s+/);var E=B(o),I=E.split(/\s+/),p=function(v,C){for(var w=0;w<C.length;w++)if(v)I.indexOf(C[w])===-1&&I.push(C[w]);else{var u=I.indexOf(C[w]);u!==-1&&I.splice(u,1)}};p(!0,g),p(!1,h),G(o,I.join(" "),I)};q.jsPlumb.extend(q.jsPlumbInstance.prototype,{headless:!1,pageLocation:j,screenLocation:x,clientLocation:T,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new F(this)),this.dragManager},recalculateOffsets:function(o){this.getDragManager().updateOffsets(o)},createElement:function(o,g,h,E){return this.createElementNS(null,o,g,h,E)},createElementNS:function(o,g,h,E,I){var p=o==null?document.createElement(g):document.createElementNS(o,g),v;h=h||{};for(v in h)p.style[v]=h[v];E&&(p.className=E),I=I||{};for(v in I)p.setAttribute(v,""+I[v]);return p},getAttribute:function(o,g){return o.getAttribute!=null?o.getAttribute(g):null},setAttribute:function(o,g,h){o.setAttribute!=null&&o.setAttribute(g,h)},setAttributes:function(o,g){for(var h in g)g.hasOwnProperty(h)&&o.setAttribute(h,g[h])},appendToRoot:function(o){document.body.appendChild(o)},getRenderModes:function(){return["svg"]},getClass:B,addClass:function(o,g){jsPlumb.each(o,function(h){M(h,g)})},hasClass:function(o,g){return o=jsPlumb.getElement(o),o.classList?o.classList.contains(g):B(o).indexOf(g)!==-1},removeClass:function(o,g){jsPlumb.each(o,function(h){M(h,null,g)})},toggleClass:function(o,g){jsPlumb.hasClass(o,g)?jsPlumb.removeClass(o,g):jsPlumb.addClass(o,g)},updateClasses:function(o,g,h){jsPlumb.each(o,function(E){M(E,g,h)})},setClass:function(o,g){g!=null&&jsPlumb.each(o,function(h){G(h,g,g.split(/\s+/))})},setPosition:function(o,g){o.style.left=g.left+"px",o.style.top=g.top+"px"},getPosition:function(o){var g=function(h){var E=o.style[h];return E?E.substring(0,E.length-2):0};return{left:g("left"),top:g("top")}},getStyle:function(o,g){return typeof window.getComputedStyle<"u"?getComputedStyle(o,null).getPropertyValue(g):o.currentStyle[g]},getSelector:function(o,g){var h=null;return arguments.length===1?h=o.nodeType!=null?o:document.querySelectorAll(o):h=o.querySelectorAll(g),h},getOffset:function(o,g,h){o=jsPlumb.getElement(o),h=h||this.getContainer();for(var E={left:o.offsetLeft,top:o.offsetTop},I=g||h!=null&&o!==h&&o.offsetParent!==h?o.offsetParent:null,p=function(w){w!=null&&w!==document.body&&(w.scrollTop>0||w.scrollLeft>0)&&(E.left-=w.scrollLeft,E.top-=w.scrollTop)}.bind(this);I!=null;)E.left+=I.offsetLeft,E.top+=I.offsetTop,p(I),I=g?I.offsetParent:I.offsetParent===h?null:I.offsetParent;if(h!=null&&!g&&(h.scrollTop>0||h.scrollLeft>0)){var v=o.offsetParent!=null?this.getStyle(o.offsetParent,"position"):"static",C=this.getStyle(o,"position");C!=="absolute"&&C!=="fixed"&&v!=="absolute"&&v!=="fixed"&&(E.left-=h.scrollLeft,E.top-=h.scrollTop)}return E},getPositionOnElement:function(o,g,h){var E=typeof g.getBoundingClientRect<"u"?g.getBoundingClientRect():{left:0,top:0,width:0,height:0},I=document.body,p=document.documentElement,v=window.pageYOffset||p.scrollTop||I.scrollTop,C=window.pageXOffset||p.scrollLeft||I.scrollLeft,w=p.clientTop||I.clientTop||0,u=p.clientLeft||I.clientLeft||0,d=0,P=0,k=E.top+v-w+d*h,N=E.left+C-u+P*h,i=jsPlumb.pageLocation(o),e=E.width||g.offsetWidth*h,n=E.height||g.offsetHeight*h,A=(i[0]-N)/e,S=(i[1]-k)/n;return[A,S]},getAbsolutePosition:function(o){var g=function(h){var E=o.style[h];if(E)return parseFloat(E.substring(0,E.length-2))};return[g("left"),g("top")]},setAbsolutePosition:function(o,g,h,E){h?this.animate(o,{left:"+="+(g[0]-h[0]),top:"+="+(g[1]-h[1])},E):(o.style.left=g[0]+"px",o.style.top=g[1]+"px")},getSize:function(o){return[o.offsetWidth,o.offsetHeight]},getWidth:function(o){return o.offsetWidth},getHeight:function(o){return o.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(o,g){var h;return o=U.isArray(o)||o.length!=null&&!U.isString(o)?o:[o],Array.prototype.slice.call(o).forEach(function(E){h=this.info(E),h.el&&this._initDraggableIfNecessary(h.el,!0,g,h.id,!0)}.bind(this)),this},snapToGrid:function(o,g,h){var E=[],I=function(C){var w=this.info(C);if(w.el!=null&&w.el._katavorioDrag){var u=w.el._katavorioDrag.snap(g,h);this.revalidate(w.el),E.push([w.el,u])}}.bind(this);if(arguments.length===1||arguments.length===3)I(o,g,h);else{var p=this.getManagedElements();for(var v in p)I(v,arguments[0],arguments[1])}return E},initDraggable:function(o,g,h){l(this,h).draggable(o,g),o._jsPlumbDragOptions=g},destroyDraggable:function(o,g){l(this,g).destroyDraggable(o),delete o._jsPlumbDragOptions},unbindDraggable:function(o,g,h,E){l(this,E).destroyDraggable(o,g,h)},setDraggable:function(o,g){return jsPlumb.each(o,function(h){this.isDragSupported(h)&&(this._draggableStates[this.getAttribute(h,"id")]=g,this.setElementDraggable(h,g))}.bind(this))},_draggableStates:{},toggleDraggable:function(o){var g;return jsPlumb.each(o,function(h){var E=this.getAttribute(h,"id");return g=this._draggableStates[E]==null?!1:this._draggableStates[E],g=!g,this._draggableStates[E]=g,this.setDraggable(h,g),g}.bind(this)),g},_initDraggableIfNecessary:function(o,g,h,E,I){if(!jsPlumb.headless){var p=g==null?!1:g;if(p&&jsPlumb.isDragSupported(o,this)){var v=h||this.Defaults.DragOptions;if(v=jsPlumb.extend({},v),jsPlumb.isAlreadyDraggable(o,this))h.force&&this.initDraggable(o,v);else{var C=jsPlumb.dragEvents.drag,w=jsPlumb.dragEvents.stop,u=jsPlumb.dragEvents.start;this.manage(E,o),v[u]=U.wrap(v[u],O.bind(this)),v[C]=U.wrap(v[C],a.bind(this)),v[w]=U.wrap(v[w],t.bind(this));var d=this.getId(o);this._draggableStates[d]=!0;var P=this._draggableStates[d];v.disabled=P==null?!1:!P,this.initDraggable(o,v),this.getDragManager().register(o),I&&this.fire("elementDraggable",{el:o,options:v})}}}},animationSupported:!0,getElement:function(o){return o==null?null:(o=typeof o=="string"?o:o.length!=null&&o.enctype==null?o[0]:o,typeof o=="string"?document.getElementById(o):o)},removeElement:function(o){l(this).elementRemoved(o),this.getEventManager().remove(o)},doAnimate:function(o,g,h){h=h||{};var E=this.getOffset(o),I=m(E,g),p=I[0]-E.left,v=I[1]-E.top,C=h.duration||250,w=15,u=C/w,d=w/C*p,P=w/C*v,k=0,N=setInterval(function(){f.setPosition(o,{left:E.left+d*(k+1),top:E.top+P*(k+1)}),h.step!=null&&h.step(k,Math.ceil(u)),k++,k>=u&&(window.clearInterval(N),h.complete!=null&&h.complete())},w)},destroyDroppable:function(o,g){l(this,g).destroyDroppable(o)},unbindDroppable:function(o,g,h,E){l(this,E).destroyDroppable(o,g,h)},droppable:function(o,g){o=U.isArray(o)||o.length!=null&&!U.isString(o)?o:[o];var h;return g=g||{},g.allowLoopback=!1,Array.prototype.slice.call(o).forEach(function(E){h=this.info(E),h.el&&this.initDroppable(h.el,g)}.bind(this)),this},initDroppable:function(o,g,h){l(this,h).droppable(o,g)},isAlreadyDraggable:function(o){return o._katavorioDrag!=null},isDragSupported:function(o,g){return!0},isDropSupported:function(o,g){return!0},isElementDraggable:function(o){return o=f.getElement(o),o._katavorioDrag&&o._katavorioDrag.isEnabled()},getDragObject:function(o){return o[0].drag.getDragElement()},getDragScope:function(o){return o._katavorioDrag&&o._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(o){return o[0].e},getUIPosition:function(o,g){var h=o[0].el;if(h.offsetParent==null)return null;var E=o[0].finalPos||o[0].pos,I={left:E[0],top:E[1]};if(h._katavorioDrag&&h.offsetParent!==this.getContainer()){var p=this.getOffset(h.offsetParent);I.left+=p.left,I.top+=p.top}return I},setDragFilter:function(o,g,h){o._katavorioDrag&&o._katavorioDrag.setFilter(g,h)},setElementDraggable:function(o,g){o=f.getElement(o),o._katavorioDrag&&o._katavorioDrag.setEnabled(g)},setDragScope:function(o,g){o._katavorioDrag&&o._katavorioDrag.k.setDragScope(o,g)},setDropScope:function(o,g){o._katavorioDrop&&o._katavorioDrop.length>0&&o._katavorioDrop[0].k.setDropScope(o,g)},addToPosse:function(o,g){var h=Array.prototype.slice.call(arguments,1),E=l(this);f.each(o,function(I){I=[f.getElement(I)],I.push.apply(I,h),E.addToPosse.apply(E,I)})},setPosse:function(o,g){var h=Array.prototype.slice.call(arguments,1),E=l(this);f.each(o,function(I){I=[f.getElement(I)],I.push.apply(I,h),E.setPosse.apply(E,I)})},removeFromPosse:function(o,g){var h=Array.prototype.slice.call(arguments,1),E=l(this);f.each(o,function(I){I=[f.getElement(I)],I.push.apply(I,h),E.removeFromPosse.apply(E,I)})},removeFromAllPosses:function(o){var g=l(this);f.each(o,function(h){g.removeFromAllPosses(f.getElement(h))})},setPosseState:function(o,g,h){var E=l(this);f.each(o,function(I){E.setPosseState(f.getElement(I),g,h)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(o){o._katavorioDrag&&o._katavorioDrag.abort()},addToDragSelection:function(o){l(this).select(o)},removeFromDragSelection:function(o){l(this).deselect(o)},clearDragSelection:function(){l(this).deselectAll()},trigger:function(o,g,h,E){this.getEventManager().trigger(o,g,h,E)},doReset:function(){for(var o in this)o.indexOf("_katavorio_")===0&&this[o].reset()},getEventManager:function(){return $(this)},on:function(o,g,h){return this.getEventManager().on.apply(this,arguments),this},off:function(o,g,h){return this.getEventManager().off.apply(this,arguments),this}});var b=function(o){var g=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?o():setTimeout(g,9)};g()};b(f.init)}).call(typeof window<"u"?window:globalThis);const de={jsplumbSetting:{Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"efContainer",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.1,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},Scope:"jsPlumb_DefaultScope"},jsplumbConnectOptions:{isSource:!0,isTarget:!0,anchor:"Continuous",labelStyle:{cssClass:"flowLabel"},emptyLabelStyle:{cssClass:"emptyFlowLabel"}},jsplumbSourceOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!1,connectorStyle:{stroke:"#b1b1b1",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#999999",strokeWidth:2}},jsplumbSourceOptions2:{filter:".flow-node-drag",filterExclude:!1,allowLoopback:!0,connector:["Flowchart",{curviness:50}],connectorStyle:{stroke:"red",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"red",strokeWidth:1.5}},jsplumbTargetOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}}};class Cn{constructor(f){this.loadEasyFlowFinish=!1,this.jsplumb=jsPlumb.getInstance(),this.init(f)}init(f){this.jsplumb.ready(()=>{this.jsplumb.importDefaults(de.jsplumbSetting),this.jsplumb.setSuspendDrawing(!1,!0),this.loadEasyFlow(f),this.loadEasyFlowFinish=!0,this.jsplumb.setContainer(document.querySelector("#efContainer"))})}loadEasyFlow(f){const{nodeList:U,lineList:J}=f,Y=Se(le(de.jsplumbSourceOptions),{}),$=Se(le(de.jsplumbTargetOptions),{});for(let l=0;l<U.length;l++){let O=U[l];this.jsplumb.makeSource(O.id,Y),this.jsplumb.makeTarget(O.id,$),O.viewOnly||this.jsplumb.draggable(O.id,{containment:"parent"})}for(let l=0;l<J.length;l++){let O=J[l],a={source:O.from,target:O.to,label:O.label?O.label:"",connector:O.connector?O.connector:"",anchors:O.anchors?O.anchors:void 0,paintStyle:O.paintStyle?O.paintStyle:void 0};this.jsplumb.connect(a,de.jsplumbConnectOptions)}}getConnections(f,U){return this.jsplumb.getConnections({source:f,target:U})[0]}deleteConnection(f,U){const J=this.getConnections(f,U);this.jsplumb.deleteConnection(J)}removeAllEndpoints(f){this.jsplumb.removeAllEndpoints(f)}addNode(f){const U=Se(le(de.jsplumbSourceOptions),{}),J=Se(le(de.jsplumbTargetOptions),{});this.jsplumb.makeSource(f,U),this.jsplumb.makeTarget(f,J),this.jsplumb.draggable(f,{containment:"parent"})}repaint(){this.jsplumb.repaint()}}let Pn={name:"\u6D41\u7A0BA",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BA-\u8282\u70B9A",type:"task",left:"26px",top:"161px",ico:"smile"},{id:"nodeB",name:"\u6D41\u7A0BA-\u8282\u70B9B",type:"task",left:"340px",top:"161px",ico:"smile"},{id:"nodeC",name:"\u6D41\u7A0BA-\u8282\u70B9C",type:"task",left:"739px",top:"161px",ico:"smile"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},En={name:"\u6D41\u7A0BB",nodeList:[{id:"nodeA",name:"\u8282\u70B9A-\u4E0D\u53EF\u62D6\u62FD",type:"task",left:"18px",top:"223px",ico:"user",state:"success",viewOnly:!0},{id:"nodeB",type:"task",name:"\u6D41\u7A0BB-\u8282\u70B9B",left:"351px",top:"96px",ico:"bug",state:"error"},{id:"nodeC",name:"\u6D41\u7A0BB-\u8282\u70B9C",type:"task",left:"354px",top:"351px",ico:"index",state:"warning"},{id:"nodeD",name:"\u6D41\u7A0BB-\u8282\u70B9D",type:"task",left:"723px",top:"215px",ico:"printer",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"\u6761\u4EF6A"},{from:"nodeA",to:"nodeC",label:"\u6761\u4EF6B"},{from:"nodeB",to:"nodeD"},{from:"nodeC",to:"nodeD"}]},Sn={name:"\u6D41\u7A0BC",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BC-\u8282\u70B9A",type:"task",left:"400px",top:"15px",ico:"smile"},{id:"nodeB",name:"\u6D41\u7A0BC-\u8282\u70B9B",type:"task",left:"400px",top:"200px",ico:"smile"},{id:"nodeC",name:"\u6D41\u7A0BC-\u8282\u70B9C",type:"task",left:"400px",top:"378px",ico:"smile"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},xn={name:"\u6D41\u7A0BD",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BD-\u8282\u70B9A",type:"task",left:"18px",top:"223px",ico:"smile",state:"success"},{id:"nodeB",type:"task",name:"\u6D41\u7A0BD-\u8282\u70B9B",left:"351px",top:"96px",ico:"smile",state:"error"},{id:"nodeC",name:"\u6D41\u7A0BD-\u8282\u70B9C",type:"task",left:"354px",top:"351px",ico:"smile",state:"warning"},{id:"nodeD",name:"\u6D41\u7A0BD-\u8282\u70B9D",type:"task",left:"723px",top:"215px",ico:"smile",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"\u76F4\u7EBF,\u81EA\u5B9A\u4E49\u7EBF\u6837\u5F0F,\u56FA\u5B9A\u951A\u70B9",connector:"Straight",anchors:["Top","Bottom"],paintStyle:{strokeWidth:2,stroke:"#1879FF"}},{from:"nodeA",to:"nodeC",label:"\u8D1D\u585E\u5C14\u66F2\u7EBF,\u56FA\u5B9A\u951A\u70B9",connector:"Bezier",anchors:["Bottom","Left"]},{from:"nodeB",to:"nodeD",label:"\u6D41\u7A0B\u56FE\u7EBF,\u52A8\u6001\u951A\u70B9",connector:["Flowchart",{curviness:50}]},{from:"nodeC",to:"nodeD",label:"\u72B6\u6001\u673A,\u52A8\u6001\u951A\u70B9",connector:["StateMachine",{margin:8,curviness:10,proximityLimit:80}]},{from:"nodeC",to:"nodeC",label:"\u81EA\u8FDE\u63A5"}]};function Dn(q="dataB"){return le({dataA:Pn,dataB:En,dataC:Sn,dataD:xn}[q])}const wn=q=>(Ge("data-v-fab6f765"),q=q(),Be(),q),An={class:"ef-toolbar"},kn={style:{float:"right","margin-right":"5px"}},jn={key:0,class:"easy-flow"},Mn={class:"left-side"},On=["onClick"],Ln=wn(()=>Ot("div",{class:"move-grid",style:{position:"absolute",top:"2000px",left:"2000px"}},"\xA0",-1)),Tn={class:"right-side"},In={name:"EasyFlow"},Fn=Object.assign(In,{props:{height:{type:String,default:"100%"}},setup(q){const f=ae(!1),U=ae(null),J=ae(null),Y=ae(!1),$=ae({nodeList:[],lineList:[]}),l=ae({type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}),O=Re({show:!1,type:"",left:0,top:0});let a;Ye(()=>{y("dataB")});function t(w,u){const{lineList:d}=$.value;return d.findIndex(P=>P.from===w&&P.to===u)>-1}function m(w,u){return t(u,w)}async function y(w){const u=Dn(w);f.value=!1,$.value={nodeList:[],lineList:[]},await Ee(),f.value=!0,$.value=le(u),await Ee(),j()}function j(){a=new Cn($.value),a.jsplumb.bind("click",o),a.jsplumb.bind("connection",h),a.jsplumb.bind("connectionDetached",E),a.jsplumb.bind("connectionMoved",I),a.jsplumb.bind("contextmenu",(w,u)=>{u.preventDefault(),M(w,u)}),a.jsplumb.bind("beforeDrop",g),console.log("----------new plumb----------",a)}function x(){}function T(w){l.value.type="node",l.value.nodeId=w,U.value.nodeInit($.value,w)}function s(w){const{nodeList:u}=$.value;for(let d=0;d<u.length;d++){let P=u[d];P.id===w.nodeId&&(P.left=w.left,P.top=w.top)}}function c(w){const u=$.value.nodeList.findIndex(d=>d.id===w);$.value.nodeList.splice(u,1),Ee(()=>{a.removeAllEndpoints(w)})}function F(){const{type:w,nodeId:u,sourceId:d,targetId:P}=l.value;$e.confirm({type:"warning",title:"\u63D0\u793A",message:`\u786E\u5B9A\u5220\u9664\u5F53\u524D\u9009\u4E2D\u7684${w==="node"?"\u8282\u70B9":"\u8FDE\u63A5\u7EBF"}\u5417?`}).then(()=>{w==="node"?c(u):w==="line"&&a.deleteConnection(d,P)}).catch(()=>{})}function G(w){w.preventDefault();let u=w.dataTransfer.getData("node");const d=JSON.parse(u),P=J.value.getBoundingClientRect(),k=w.clientX,N=w.clientY,i=k-P.x+J.value.scrollLeft-85,e=N-P.y+J.value.scrollTop-16;let n=d.name,A=n,S=1;for(;S<1e4;){let z=!1;for(let X=0;X<$.value.nodeList.length;X++)$.value.nodeList[X].name===A&&(A=n+S,z=!0);if(z){S++;continue}break}const R=qe(),V={id:R,name:A,type:d.type,left:i+"px",top:e+"px",ico:d.ico};$.value.nodeList.push(V),Ee(()=>a.addNode(R))}function B(w,u){T(w),O.show=!0,O.type="node",O.left=u.clientX+"px",O.top=u.clientY+"px"}function M(w,u){o(w),O.show=!0,O.type="line",O.left=u.clientX+"px",O.top=u.clientY+"px"}function b(){O.show=!1}Xe(()=>O.show,w=>{w?document.body.addEventListener("click",b):document.body.removeEventListener("click",b)});function o(w){l.value.type="line",l.value.sourceId=w.sourceId,l.value.targetId=w.targetId,U.value.lineInit($.value,{from:w.sourceId,to:w.targetId,label:w.getLabel()})}function g(w){const{sourceId:u,targetId:d}=w;return u===d?!1:t(u,d)?(we.error("\u8BE5\u5173\u7CFB\u5DF2\u5B58\u5728,\u4E0D\u5141\u8BB8\u91CD\u590D\u521B\u5EFA"),!1):m(u,d)?(we.error("\u4E0D\u652F\u6301\u4E24\u4E2A\u8282\u70B9\u4E4B\u95F4\u8FDE\u7EBF\u56DE\u73AF"),!1):(we.success("\u8FDE\u63A5\u6210\u529F"),!0)}function h(w){const{sourceId:u,targetId:d}=w;a.loadEasyFlowFinish&&$.value.lineList.push({from:u,to:d})}function E(w){const{sourceId:u,targetId:d}=w,P=$.value.lineList.findIndex(k=>k.from===u&&k.to===d);$.value.lineList.splice(P,1)}function I(w){const{originalSourceId:u,originalTargetId:d}=w,P=$.value.lineList.findIndex(k=>k.from===u&&k.to===d);$.value.lineList.splice(P,1)}function p({from:w,to:u,label:d}){let P=a.getConnections(w,u);!d||d===""?(P.removeClass("flowLabel"),P.addClass("emptyFlowLabel")):P.addClass("flowLabel"),P.setLabel({label:d}),$.value.lineList.forEach(k=>{k.from===w&&k.to===u&&(k.label=d)})}function v(){a.repaint()}function C(){l.value={type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}}return(w,u)=>{const d=It("b-button"),P=It("b-divider"),k=It("b-dropdown-item"),N=It("b-dropdown-menu"),i=It("b-dropdown"),e=We("flow-drag");return Bt(),Xt("div",{class:"easy-flow-container",style:ke({height:q.height})},[Ot("div",An,[_t(d,{type:"text"},{default:wt(()=>[Gt(xe($.value.name),1)]),_:1}),_t(P,{type:"vertical"}),_t(d,{type:"text",icon:"delete",onClick:F,disabled:!l.value.type},null,8,["disabled"]),Ot("div",kn,[_t(d,{size:"small",type:"info",plain:"",icon:"filedone",onClick:u[0]||(u[0]=n=>Y.value=!0)},{default:wt(()=>[Gt(" \u6D41\u7A0B\u4FE1\u606F ")]),_:1}),_t(i,{trigger:"click",style:{margin:"0 10px"},onCommand:y},{dropdown:wt(()=>[_t(N,null,{default:wt(()=>[_t(k,{name:"dataA"},{default:wt(()=>[Gt("dataA")]),_:1}),_t(k,{name:"dataB"},{default:wt(()=>[Gt("dataB")]),_:1}),_t(k,{name:"dataC"},{default:wt(()=>[Gt("dataC")]),_:1}),_t(k,{name:"dataD"},{default:wt(()=>[Gt("dataD")]),_:1})]),_:1})]),default:wt(()=>[_t(d,{size:"small",type:"info",plain:"",icon:"database"},{default:wt(()=>[Gt("\u6570\u636E\u6E90")]),_:1})]),_:1}),_t(d,{size:"small",type:"info",plain:"",icon:"book"},{default:wt(()=>[Gt("\u5E2E\u52A9")]),_:1})])]),f.value?(Bt(),Xt("div",jn,[Ot("div",Mn,[_t(hn)]),Zt((Bt(),Xt("div",{class:"canvas-side",id:"efContainer",ref_key:"efContainer",ref:J,onClick:Ae(x,["self"]),onDragover:u[1]||(u[1]=Ae(()=>{},["prevent"])),onDrop:G},[(Bt(!0),Xt(Me,null,Oe($.value.nodeList,n=>(Bt(),je(on,{key:n.id,id:n.id,node:n,activeElement:l.value,onClickNode:T,onChangeNodeSite:s,onNodeRightMenu:B},null,8,["id","node","activeElement"]))),128)),Ln],40,On)),[[e]]),Ot("div",Tn,[_t(bn,{ref_key:"nodeFormRef",ref:U,onSetLineLabel:p,onSaveNode:v,onCancelSelect:C},null,512)]),_t(rn,{modelValue:Y.value,"onUpdate:modelValue":u[2]||(u[2]=n=>Y.value=n),data:$.value},null,8,["modelValue","data"]),_t(_n,{data:O,onDelete:F},null,8,["data"])])):ze("",!0)],4)}}}),Nn=De(Fn,[["__scopeId","data-v-fab6f765"]]);const Rn={class:"p16 wrapper"},Vn={__name:"index",setup(q){return(f,U)=>(Bt(),Xt("div",Rn,[_t(Nn)]))}};export{Vn as default};
