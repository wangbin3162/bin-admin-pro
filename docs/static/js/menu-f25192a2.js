var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{k as d,g as u}from"./index-22ae5226.js";import{_ as i}from"./page-wrapper-17a7ae57.js";import{_ as s}from"./index-8df926ea.js";import{_ as p}from"./iconfont-e4dff209.js";import{f as c,a7 as m,a8 as f,J as b,o as h,c as v,w as y,B as g,u as _,T as N,d as w,z as j,A as V,q as k,t as C,a as S}from"./vendor-4890bdfb.js";import{u as O}from"./useForm-aaa7189f.js";import{a as P}from"./chunk-bin-ui-next-e393e6f7.js";import"./chunk-brace-7f859248.js";function x(){return d({url:"/menu/tree",method:"get"})}const F={name:"Menu",components:{Iconfont:p,BaseTree:s,PageWrapper:i},setup(){const e=c(null),d=c(null),i=c({}),s=c({}),{formRef:p,editStatus:m,pageStatus:f,editLoading:b,openCreate:h,openEdit:v,backNormal:y,submitForm:g,resetForm:_}=O();function N(e="edit"){if("edit"!==e){var p,c;i.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}else{const e=s.value,m=d.value,f=e[m.nodeKey].parent,b=f||0===f?e[f].node:{};i.value=m?(p=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))r.call(a,t)&&n(e,t,a[t]);return e})({},u(m)),c={parentPath:0===f?"":b.path,parentName:b.title},a(p,t(c))):{}}}function w(){N("create"),h()}return{treeRef:e,getMenuTree:x,currentNode:d,copyNode:i,handleSelect:function(e,a){e.selected?(d.value=e,s.value=a,N("edit"),v()):(d.value=null,s.value=null,i.value={},y())},handleSubmit:function(){g((()=>{b.value=!0;const a=f.value;setTimeout((()=>{P.success((a.isCreate?"新增":"修改")+"成功！"),y();const t=d.value?[d.value.nodeKey]:[];e.value&&e.value.reloadTree(t),b.value=!1}),1e3)}))},handleResetForm:function(){N(m.value),_()},handleCommand:function(e){if("root"===e&&w(),"child"===e){w();const e=d.value;i.value.parentPath=e.path,i.value.parentName=e.title}},formRef:p,pageStatus:f,editLoading:b,submitForm:g,resetForm:_,ruleValidate:{path:[{required:!0,message:"菜单路径必填",trigger:"blur"}],title:[{required:!0,message:"菜单名称必填",trigger:"blur"}]}}}};m("data-v-12ed773d");const R={class:"table-menu"},T=k("增加根节点"),M=k("增加子节点"),U={class:"table-menu-right"},q={flex:"main:justify cross:center",style:{"font-weight":"normal"}},I={class:"top"},L=g("span",{class:"ml-5"},"编辑菜单",-1),B={style:{position:"relative","min-height":"100px",overflow:"hidden"}},E={style:{position:"absolute",width:"100%"}},K=k("点选左侧部门，进行编辑操作"),z={key:0,class:"pt-8"},A=k("重置"),D=k("系统菜单根节点不可编辑");f(),F.render=function(e,a,t,l,o,r){const n=b("b-dropdown-item"),d=b("base-tree"),u=b("iconfont"),i=b("b-alert"),s=b("b-input"),p=b("b-form-item"),c=b("b-icon-select"),m=b("b-button"),f=b("b-form"),O=b("b-col"),P=b("b-row"),x=b("b-card"),F=b("page-wrapper");return h(),v(F,{desc:"页面内容为Mock数据，仅作示例使用。"},{default:y((()=>[g("div",R,[_(d,{ref:"treeRef","tree-title":"菜单列表","show-filter":"","title-key":"title",fetch:l.getMenuTree,onSelectChange:l.handleSelect,onCommand:l.handleCommand},{ctrl:y((()=>[_(n,{name:"root",divided:""},{default:y((()=>[T])),_:1}),_(n,{name:"child",disabled:!l.currentNode},{default:y((()=>[M])),_:1},8,["disabled"])])),_:1},8,["fetch","onSelectChange","onCommand"]),g("div",U,[_(x,{bordered:!1,class:"card-panel",shadow:"never"},{header:y((()=>[g("div",q,[g("div",I,[_(u,{icon:"menu",color:"primary",bg:"",round:""}),L])])])),default:y((()=>[g("div",B,[_(N,{name:"fade-in"},{default:y((()=>[g("div",E,[w(_(i,null,{default:y((()=>[K])),_:1},512),[[j,l.pageStatus.isNormal]])])])),_:1}),_(N,{name:"fade-transverse"},{default:y((()=>[l.pageStatus.isNormal?S("",!0):(h(),V("div",z,["root"!==l.copyNode.path?(h(),v(P,{key:0},{default:y((()=>[_(O,{span:"14"},{default:y((()=>[_(f,{ref:"formRef",model:l.copyNode,rules:l.ruleValidate,"label-width":"100px","label-suffix":":"},{default:y((()=>[_(p,{label:"父级菜单"},{default:y((()=>[_(s,{modelValue:l.copyNode.parentName,"onUpdate:modelValue":a[0]||(a[0]=e=>l.copyNode.parentName=e),disabled:""},null,8,["modelValue"])])),_:1}),_(p,{label:"菜单名称",prop:"title"},{default:y((()=>[_(s,{modelValue:l.copyNode.title,"onUpdate:modelValue":a[1]||(a[1]=e=>l.copyNode.title=e),placeholder:"输入菜单名称",clearable:""},null,8,["modelValue"])])),_:1}),_(p,{label:"菜单路径",prop:"path"},{default:y((()=>[_(s,{modelValue:l.copyNode.path,"onUpdate:modelValue":a[2]||(a[2]=e=>l.copyNode.path=e),placeholder:"输入菜单路径",clearable:""},null,8,["modelValue"])])),_:1}),_(p,{label:"菜单图标"},{default:y((()=>[_(c,{modelValue:l.copyNode.icon,"onUpdate:modelValue":a[3]||(a[3]=e=>l.copyNode.icon=e)},null,8,["modelValue"])])),_:1}),_(p,null,{default:y((()=>[_(m,{type:"primary",onClick:l.handleSubmit,loading:l.editLoading},{default:y((()=>[k(C(l.pageStatus.isCreate?"提交数据":"更新数据"),1)])),_:1},8,["onClick","loading"]),_(m,{onClick:l.handleResetForm},{default:y((()=>[A])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})):(h(),v(i,{key:1,type:"error","show-icon":""},{default:y((()=>[D])),_:1}))]))])),_:1})])])),_:1})])])])),_:1})},F.__scopeId="data-v-12ed773d";export{F as default};
