import{g as K}from"./depart.api-3687e5bc.js";import{a5 as j,l as N,e as U,w as t,E as n,o as D,c as o,b as i,j as E,T as I,g as q,v as z,a as L,m,t as M}from"./vendor-88b93d8c.js";import{i as A}from"./index-f99750e2.js";import{a as G}from"./chunk-bin-ui-next-26581f77.js";import{u as H}from"./useForm-ab68f277.js";import"./chunk-brace-34d79ec3.js";const J={name:"Depart",setup(){const h=N(null),a=N(null),c=N({}),e=N({}),{formRef:F,editStatus:R,pageStatus:_,editLoading:p,openCreate:C,openEdit:f,backNormal:v,submitForm:u,resetForm:d}=H();function V(r,s){r.selected?(a.value=r,e.value=s,S()):x()}function w(r){if(r==="root"&&g(),r==="child"){g();const s=a.value;c.value.parentId=s.id,c.value.parentName=s.text}}function b(r="edit"){if(r==="edit"){const s=e.value,T=a.value,y=s[T.nodeKey].parent,B=y||y===0?s[y].node:{};c.value=T?{...A(T),parentId:y===0?"":B.id,parentName:B.title}:{};return}c.value={text:"",deptCode:"",status:"1",desc:"",parentId:"",parentName:void 0}}function x(){a.value=null,e.value=null,c.value={},v()}function g(){b("create"),C()}function S(){b("edit"),f()}function k(){u(()=>{p.value=!0;const r=_.value;setTimeout(()=>{G.success(`${r.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),v();const s=a.value?[a.value.nodeKey]:[];h.value&&h.value.reloadTree(s),p.value=!1},1e3)})}function l(){b(R.value),d()}return{treeRef:h,getDepartTree:K,currentNode:a,copyNode:c,handleSelect:V,handleSubmit:k,handleResetForm:l,handleCommand:w,formRef:F,pageStatus:_,editLoading:p,submitForm:u,resetForm:d,ruleValidate:{text:[{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u5FC5\u586B",trigger:"blur"}],deptCode:[{required:!0,message:"\u90E8\u95E8\u7F16\u7801\u5FC5\u586B",trigger:"blur"}]}}}},O=m("\u589E\u52A0\u6839\u8282\u70B9"),P=m("\u589E\u52A0\u5B50\u8282\u70B9"),Q={class:"pl-16"},W={flex:"main:justify cross:center",style:{"font-weight":"normal"}},X={class:"top"},Y=i("span",{class:"ml-5"},"\u7F16\u8F91\u90E8\u95E8",-1),Z={class:"right"},$=m(" \u65B0\u589E\u5B50\u90E8\u95E8 "),ee={style:{position:"relative","min-height":"100px",overflow:"hidden"}},te={style:{position:"absolute",width:"100%"}},oe=m("\u70B9\u9009\u5DE6\u4FA7\u90E8\u95E8\uFF0C\u8FDB\u884C\u7F16\u8F91\u64CD\u4F5C"),ae={key:0,class:"pt-8"},ne=i("span",null,"\u542F\u7528",-1),le=i("span",null,"\u7981\u7528",-1),de=m("\u91CD\u7F6E");function re(h,a,c,e,F,R){const _=n("b-dropdown-item"),p=n("base-tree"),C=n("iconfont"),f=n("b-button"),v=n("b-alert"),u=n("b-input"),d=n("b-form-item"),V=n("b-switch"),w=n("b-form"),b=n("b-col"),x=n("b-row"),g=n("b-card"),S=n("page-cube-wrapper"),k=n("page-container");return D(),U(k,{"hide-header":"","inner-scroll":""},{default:t(()=>[o(S,null,{left:t(()=>[o(p,{ref:"treeRef","tree-title":"\u90E8\u95E8\u5217\u8868","show-filter":"",fetch:e.getDepartTree,onSelectChange:e.handleSelect,onCommand:e.handleCommand},{ctrl:t(()=>[o(_,{name:"root",divided:""},{default:t(()=>[O]),_:1}),o(_,{name:"child",disabled:!e.currentNode},{default:t(()=>[P]),_:1},8,["disabled"])]),_:1},8,["fetch","onSelectChange","onCommand"])]),default:t(()=>[i("div",Q,[o(g,{bordered:!1,class:"card-panel",shadow:"never"},{header:t(()=>[i("div",W,[i("div",X,[o(C,{icon:"apartment",color:"primary",bg:"",round:""}),Y]),i("div",Z,[e.currentNode?(D(),U(f,{key:0,type:"text",size:"small",onClick:a[0]||(a[0]=l=>e.handleCommand("child"))},{default:t(()=>[$]),_:1})):E("",!0)])])]),default:t(()=>[i("div",ee,[o(I,{name:"fade-in"},{default:t(()=>[i("div",te,[q(o(v,null,{default:t(()=>[oe]),_:1},512),[[z,e.pageStatus.isNormal]])])]),_:1}),o(I,{name:"fade-transverse"},{default:t(()=>[e.pageStatus.isNormal?E("",!0):(D(),L("div",ae,[o(x,null,{default:t(()=>[o(b,{span:"14"},{default:t(()=>[o(w,{ref:"formRef",model:e.copyNode,rules:e.ruleValidate,"label-width":"100px","label-suffix":":"},{default:t(()=>[o(d,{label:"\u7236\u7EA7\u7EC4\u7EC7"},{default:t(()=>[o(u,{modelValue:e.copyNode.parentName,"onUpdate:modelValue":a[1]||(a[1]=l=>e.copyNode.parentName=l),disabled:""},null,8,["modelValue"])]),_:1}),o(d,{label:"\u90E8\u95E8\u540D\u79F0",prop:"text"},{default:t(()=>[o(u,{modelValue:e.copyNode.text,"onUpdate:modelValue":a[2]||(a[2]=l=>e.copyNode.text=l),placeholder:"\u8F93\u5165\u90E8\u95E8\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"\u90E8\u95E8\u7F16\u7801",prop:"deptCode"},{default:t(()=>[o(u,{modelValue:e.copyNode.deptCode,"onUpdate:modelValue":a[3]||(a[3]=l=>e.copyNode.deptCode=l),placeholder:"\u8F93\u5165\u90E8\u95E8\u7F16\u7801",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"\u90E8\u95E8\u72B6\u6001"},{default:t(()=>[o(V,{size:"large",modelValue:e.copyNode.status,"onUpdate:modelValue":a[4]||(a[4]=l=>e.copyNode.status=l),"true-value":"1","false-value":"0"},{open:t(()=>[ne]),close:t(()=>[le]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"\u90E8\u95E8\u63CF\u8FF0"},{default:t(()=>[o(u,{modelValue:e.copyNode.desc,"onUpdate:modelValue":a[5]||(a[5]=l=>e.copyNode.desc=l),type:"textarea",placeholder:"\u8F93\u5165\u90E8\u95E8\u63CF\u8FF0"},null,8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[o(f,{type:"primary",onClick:e.handleSubmit,loading:e.editLoading},{default:t(()=>[m(M(e.pageStatus.isCreate?"\u63D0\u4EA4\u6570\u636E":"\u66F4\u65B0\u6570\u636E"),1)]),_:1},8,["onClick","loading"]),o(f,{onClick:e.handleResetForm},{default:t(()=>[de]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]))]),_:1})])]),_:1})])]),_:1})]),_:1})}var pe=j(J,[["render",re]]);export{pe as default};
