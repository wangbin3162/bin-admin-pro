import{a6 as be,e as Jt,b as Kt,g as wt,j as At,l as Et,s as me,F as ie,t as se,u as oe,y as Gt,z as Ut,k as Te,C as Me,a7 as Ae,a8 as ke,f as Ot,P as ye,v as he,G as Be,c as bt,x as xt,q as Nt,T as Ye,w as Ue,o as Xe,n as we,O as We}from"./vendor-a6c5ad11.js";import{m as ce,k as je,n as ze}from"./index-92c56bc9.js";import{a as Oe,M as qe}from"./chunk-bin-ui-next-1e71edb3.js";import"./chunk-brace-6f23dcf5.js";import"./chunk-mockjs-c013c588.js";const Le="/bin-admin-pro/static/svg/node-bea77eab.svg",Fe="/bin-admin-pro/static/svg/switch-89450647.svg";const $e=W=>(Ae("data-v-a5f8614c"),W=W(),ke(),W),Je=$e(()=>Et("div",{class:"ef-node-left"},null,-1)),Ke={key:0,src:Le,class:"node-ico"},Ze={key:1,src:Fe,class:"switch-ico"},Qe=["title"],tn={key:0,class:"ef-node-right-ico"},en={class:"b-iconfont b-icon-check-circle"},nn={class:"b-iconfont b-icon-error"},sn={class:"b-iconfont b-icon-warning-circle"},on={class:"b-iconfont b-icon-loading"},ln={__name:"flow-node",props:{node:{type:Object,default:()=>({})},showState:{type:Boolean,default:!0},activeElement:Object},emits:["clickNode","changeNodeSite","nodeRightMenu"],setup(W,{emit:c}){const U=W,et=Jt(null),Y=Kt(()=>({top:U.node.top,left:U.node.left})),K=Kt(()=>U.activeElement.type==="node"&&U.activeElement.nodeId===U.node.id),r=Kt(()=>["ef-node-container",`el-node-${U.node.type}`,{"ef-node-active":K.value},{"view-only":U.node.viewOnly}]),E=Kt(()=>{const P={};return P[`b-iconfont b-icon-${U.node.ico}`]=!0,P});function a(){c("clickNode",U.node.id)}function e(){const{left:P,top:w}=U.node,S=et.value.style;if(P===S.left&&w===S.top)return;const L={nodeId:U.node.id,left:S.left,top:S.top};c("changeNodeSite",L)}function p(P){c("nodeRightMenu",U.node.id,P)}return(P,w)=>(wt(),At("div",{ref_key:"nodeRef",ref:et,style:Te(Y.value),class:me(r.value),onClick:a,onMouseup:e,onContextmenu:w[0]||(w[0]=Me(S=>p(S),["stop","prevent"]))},[Je,Et("div",{class:me(["ef-node-left-ico",{" flow-node-drag":!W.node.viewOnly}])},[W.node.ico?(wt(),At("i",{key:0,class:me(E.value)},null,2)):(wt(),At(ie,{key:1},[W.node.type==="common"?(wt(),At("img",Ke)):se("",!0),W.node.type==="switch"?(wt(),At("img",Ze)):se("",!0)],64))],2),Et("div",{class:"ef-node-text",title:W.node.name},oe(W.node.name),9,Qe),W.showState?(wt(),At("div",tn,[Gt(Et("i",en,null,512),[[Ut,W.node.state==="success"]]),Gt(Et("i",nn,null,512),[[Ut,W.node.state==="error"]]),Gt(Et("i",sn,null,512),[[Ut,W.node.state==="warning"]]),Gt(Et("i",on,null,512),[[Ut,W.node.state==="running"]])])):se("",!0)],38))}},rn=be(ln,[["__scopeId","data-v-a5f8614c"]]);const He=W=>(Ae("data-v-51893b01"),W=W(),ke(),W),an={class:"flow-menu",ref:"tool"},un={class:"type-box"},cn=He(()=>Et("img",{src:Le,alt:"node",style:{width:"24px",height:"24px"}},null,-1)),hn=[cn],dn=He(()=>Et("img",{src:Fe,alt:"switch",style:{width:"20px",height:"20px"}},null,-1)),fn=[dn],pn={class:"ef-node-menu-ul"},gn=["type","draggable","onDragstart"],mn={class:"ef-node-left-ico"},yn={key:0,src:Le,alt:"node",style:{width:"24px",height:"24px"}},bn={key:1,src:Fe,alt:"switch",style:{width:"20px",height:"20px"}},_n={class:"ef-node-text"},Ie="common",Ge="switch",vn={__name:"flow-menu",props:{repeat:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},menuList:{type:Object,default:()=>({common:[{id:"11",type:"common",name:"\u6570\u636E\u63A5\u5165",ico:"index",style:{}},{id:"12",type:"common",name:"\u63A5\u53E3\u8C03\u7528",style:{}}],switch:[{id:"13",type:"switch",name:"\u6D41\u7A0B\u7ED3\u675F",style:{}},{id:"14",type:"switch",name:"\u6570\u636E\u6E05\u7406",ico:"clear",style:{}}]})}},setup(W){const c=W,U=Jt(Ie),et=Kt(()=>c.menuList[U.value]);function Y(r){return c.data.nodeList.findIndex(E=>E.id===r)>-1}function K(r,E){r.dataTransfer.setData("node",JSON.stringify(E))}return(r,E)=>{const a=Ot("b-icon");return wt(),At("div",an,[Et("div",un,[Et("div",{class:me(["type-item",{active:U.value===Ie}]),title:"\u901A\u7528\u8282\u70B9",onClick:E[0]||(E[0]=e=>U.value=Ie)},hn,2),Et("div",{class:me(["type-item",{active:U.value===Ge}]),title:"\u6761\u4EF6\u8282\u70B9",onClick:E[1]||(E[1]=e=>U.value=Ge)},fn,2)]),Et("ul",pn,[(wt(!0),At(ie,null,ye(et.value,e=>(wt(),At("li",{class:me(["ef-node-menu-li",[e.type,{disabled:Y(e.id)}]]),key:e.id,type:e.type,draggable:!Y(e.id),onDragstart:p=>K(p,e)},[Et("div",mn,[e.ico?(wt(),he(a,{key:0,name:e.ico},null,8,["name"])):(wt(),At(ie,{key:1},[e.type==="common"?(wt(),At("img",yn)):se("",!0),e.type==="switch"?(wt(),At("img",bn)):se("",!0)],64))]),Et("span",_n,oe(e.name),1)],42,gn))),128))])],512)}}},Pn=be(vn,[["__scopeId","data-v-51893b01"]]);const Cn=W=>(Ae("data-v-9adb8357"),W=W(),ke(),W),xn={class:"ef-node-form"},En=Cn(()=>Et("div",{class:"ef-node-form-header"},"\u7F16\u8F91",-1)),Sn={class:"ef-node-form-body"},Dn={class:"empty"},wn={class:"mr-8"},jn={class:"b-iconfont b-icon-check-circle"},An={class:"b-iconfont b-icon-error"},kn={class:"b-iconfont b-icon-warning-circle"},On={class:"b-iconfont b-icon-loading"},In={__name:"flow-form",props:{showIco:{type:Boolean,default:!0},showState:{type:Boolean,default:!0}},emits:["setLineLabel","saveNode","cancelSelect"],setup(W,{expose:c,emit:U}){const et=[{state:"success",label:"\u6210\u529F"},{state:"warning",label:"\u8B66\u544A"},{state:"error",label:"\u9519\u8BEF"},{state:"running",label:"\u8FD0\u884C\u4E2D"}],Y=Be({type:"node",node:{},line:{},data:{}}),K=Kt(()=>Object.keys(Y.node).length===0&&Object.keys(Y.line).length===0);function r(P,w){Y.type="node",Y.data=P,P.nodeList.forEach(S=>{S.id===w&&(Y.node=ce(S))})}function E(P,w){Y.type="line",Y.data=P,Y.line=w}function a(){U("setLineLabel",Y.line)}function e(){Y.data.nodeList.forEach(P=>{P.id===Y.node.id&&(P.name=Y.node.name,P.left=Y.node.left,P.top=Y.node.top,P.ico=Y.node.ico,P.state=Y.node.state,U("saveNode",P))})}function p(){Y.type="node",Y.node={},Y.line={},Y.data={},U("cancelSelect")}return c({nodeInit:r,lineInit:E}),(P,w)=>{const S=Ot("b-input"),L=Ot("b-form-item"),s=Ot("b-icon-select"),l=Ot("b-option"),R=Ot("b-select"),N=Ot("b-button"),H=Ot("b-form"),O=Ot("b-ace-editor");return wt(),At("div",xn,[En,Et("div",Sn,[Gt(Et("div",Dn,"\u6682\u672A\u9009\u62E9\u5143\u7D20",512),[[Ut,K.value]]),Gt(bt(H,{model:Y.node,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(L,{label:"\u7C7B\u578B"},{default:xt(()=>[bt(S,{modelValue:Y.node.type,"onUpdate:modelValue":w[0]||(w[0]=g=>Y.node.type=g),disabled:!0},null,8,["modelValue"])]),_:1}),bt(L,{label:"\u540D\u79F0"},{default:xt(()=>[bt(S,{modelValue:Y.node.name,"onUpdate:modelValue":w[1]||(w[1]=g=>Y.node.name=g),clearable:""},null,8,["modelValue"])]),_:1}),bt(L,{label:"left\u5750\u6807"},{default:xt(()=>[bt(S,{modelValue:Y.node.left,"onUpdate:modelValue":w[2]||(w[2]=g=>Y.node.left=g),disabled:""},null,8,["modelValue"])]),_:1}),bt(L,{label:"top\u5750\u6807"},{default:xt(()=>[bt(S,{modelValue:Y.node.top,"onUpdate:modelValue":w[3]||(w[3]=g=>Y.node.top=g),disabled:""},null,8,["modelValue"])]),_:1}),W.showIco?(wt(),he(L,{key:0,label:"ico\u56FE\u6807"},{default:xt(()=>[bt(s,{modelValue:Y.node.ico,"onUpdate:modelValue":w[4]||(w[4]=g=>Y.node.ico=g)},null,8,["modelValue"])]),_:1})):se("",!0),W.showState?(wt(),he(L,{key:1,label:"\u72B6\u6001"},{default:xt(()=>[bt(R,{modelValue:Y.node.state,"onUpdate:modelValue":w[5]||(w[5]=g=>Y.node.state=g),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:xt(()=>[(wt(),At(ie,null,ye(et,g=>bt(l,{key:g.state,label:g.label,value:g.state},{default:xt(()=>[Et("span",wn,[Gt(Et("i",jn,null,512),[[Ut,g.state==="success"]]),Gt(Et("i",An,null,512),[[Ut,g.state==="error"]]),Gt(Et("i",kn,null,512),[[Ut,g.state==="warning"]]),Gt(Et("i",On,null,512),[[Ut,g.state==="running"]])]),Et("span",null,oe(g.label),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})):se("",!0),bt(L,null,{default:xt(()=>[bt(N,{icon:"close",onClick:p},{default:xt(()=>[Nt("\u53D6\u6D88")]),_:1}),bt(N,{type:"primary",icon:"check",onClick:e},{default:xt(()=>[Nt("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,Y.type==="node"&&Y.node.type]]),Gt(bt(H,{model:Y.line,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(L,{label:"\u7C7B\u578B"},{default:xt(()=>[bt(S,{modelValue:Y.type,"onUpdate:modelValue":w[6]||(w[6]=g=>Y.type=g),disabled:!0},null,8,["modelValue"])]),_:1}),bt(L,{label:"\u6761\u4EF6"},{default:xt(()=>[bt(S,{modelValue:Y.line.label,"onUpdate:modelValue":w[7]||(w[7]=g=>Y.line.label=g),clearable:""},null,8,["modelValue"])]),_:1}),bt(L,null,{default:xt(()=>[bt(N,{icon:"close",onClick:p},{default:xt(()=>[Nt("\u53D6\u6D88")]),_:1}),bt(N,{type:"primary",icon:"check",onClick:a},{default:xt(()=>[Nt("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,Y.type==="line"]]),bt(O,{"model-value":JSON.stringify(Y,null,2),height:"200px"},null,8,["model-value"])])])}}},Mn=be(In,[["__scopeId","data-v-9adb8357"]]);const Tn={__name:"context-menu",props:{data:{type:Object,default:()=>({})}},emits:["delete"],setup(W,{emit:c}){const U=W,et=Kt(()=>U.data.show),Y=Kt(()=>({left:U.data.left,top:U.data.top}));function K(){c("delete")}return(r,E)=>{const a=Ot("b-icon");return wt(),he(Ye,{name:"zoom-in-top"},{default:xt(()=>[Gt(Et("ul",{class:"contextmenu",style:Te(Y.value)},[Et("li",{onClick:K},[bt(a,{name:"delete"}),Nt(" \u5220\u9664"+oe(W.data.type==="line"?"\u7EBF":"\u8282\u70B9"),1)])],4),[[Ut,et.value]])]),_:1})}}},Ln=be(Tn,[["__scopeId","data-v-0d15390a"]]),Fn={__name:"flow-info",props:{data:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(W,{emit:c}){const U=W,et=Kt({get:()=>U.modelValue,set:Y=>c("update:modelValue",Y)});return(Y,K)=>{const r=Ot("b-ace-editor"),E=Ot("b-modal");return wt(),he(E,{modelValue:et.value,"onUpdate:modelValue":K[0]||(K[0]=a=>et.value=a),title:"\u6D41\u7A0B\u6570\u636E\u4FE1\u606F",width:"680px","destroy-on-close":""},{default:xt(()=>[bt(r,{"model-value":JSON.stringify(W.data,null,2),height:"500px"},null,8,["model-value"])]),_:1},8,["modelValue"])}}};const Nn={style:{overflow:"hidden"},flex:""},Rn={style:{width:"30%","border-right":"1px solid #f0f0f0"}},Gn={class:"scroll-box"},Bn=["id"],Un={class:"title"},Hn={__name:"helper",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(W,{emit:c}){const U=W,et=Jt("add"),Y=[{id:"add",icon:"plus-circle",title:"\u5982\u4F55\u65B0\u589E",message:["\u6309\u4F4F\u9F20\u6807\u62D6\u62FD\u5DE6\u4FA7\u7EC4\u4EF6\u5230\u4E2D\u95F4\u753B\u5E03\u4E2D\u677E\u5F00\u9F20\u6807\u5373\u53EF"]},{id:"delete",icon:"delete",title:"\u5982\u4F55\u5220\u9664",message:["1\u3001\u9F20\u6807\u70B9\u4E2D\u9700\u8981\u5220\u9664\u7684\u8282\u70B9\u6216\u8FDE\u7EBF\uFF0C\u70B9\u51FB\u5DE6\u4E0A\u89D2\u7684\u5220\u9664\u56FE\u6807","2\u3001\u9F20\u6807\u53F3\u952E\u9700\u8981\u5220\u9664\u7684\u8282\u70B9\u6216\u8FDE\u7EBF\uFF0C\u9009\u62E9\u5220\u9664\u8282\u70B9\u6216\u5220\u9664\u7EBF"]},{id:"move",icon:"drag",title:"\u5982\u4F55\u79FB\u52A8",message:["\u9F20\u6807\u79FB\u52A8\u5230\u8282\u70B9\u4E2D\uFF0C\u5F53\u9F20\u6807\u53D8\u4E3A\u53EF\u62D6\u62FD\u7684\u56FE\u6807\u65F6\u6309\u4E0B\u9F20\u6807\u79FB\u52A8\u5230\u65B0\u7684\u4F4D\u7F6E\u677E\u5F00\u9F20\u6807"]},{id:"line",icon:"index",title:"\u5982\u4F55\u8FDE\u7EBF",message:["\u9F20\u6807\u79FB\u52A8\u5230\u8282\u70B9\u4E2D\u5DE6\u4FA7\u7684\u56FE\u6807\u4E0A\uFF0C\u5F53\u9F20\u6807\u53D8\u4E3A + \u65F6\u6309\u4E0B\u9F20\u6807\u79FB\u52A8\u5230\u53E6\u4E00\u4E2A\u8282\u70B9\u4E2D\u677E\u5F00\u9F20\u6807"]},{id:"condition",icon:"sisternode",title:"\u5982\u4F55\u6DFB\u52A0\u6761\u4EF6",message:["\u70B9\u51FB\u753B\u5E03\u4E2D\u7684\u8FDE\u7EBF\uFF0C\u5728\u9875\u9762\u53F3\u4FA7\u4F1A\u51FA\u73B0\u4E00\u4E2A\u8868\u5355\uFF0C\u8F93\u5165\u65B0\u7684\u6761\u4EF6\uFF0C\u70B9\u51FB\u3010\u4FDD\u5B58\u3011"]}],K=Kt({get:()=>U.modelValue,set:r=>c("update:modelValue",r)});return Ue(()=>K.value,r=>{r&&(et.value="add")}),(r,E)=>{const a=Ot("b-icon"),e=Ot("b-menu-item"),p=Ot("b-menu"),P=Ot("b-divider"),w=Ot("b-modal");return wt(),he(w,{modelValue:K.value,"onUpdate:modelValue":E[1]||(E[1]=S=>K.value=S),title:"\u5E2E\u52A9",width:"680px","body-styles":{padding:0}},{default:xt(()=>[Et("div",Nn,[Et("div",Rn,[bt(p,{"default-active":et.value,onSelect:E[0]||(E[0]=S=>et.value=S)},{default:xt(()=>[(wt(),At(ie,null,ye(Y,S=>bt(e,{key:S.id,index:S.id},{title:xt(()=>[Nt(oe(S.title),1)]),default:xt(()=>[bt(a,{name:S.icon},null,8,["name"])]),_:2},1032,["index"])),64))]),_:1},8,["default-active"])]),Et("div",Gn,[(wt(),At(ie,null,ye(Y,S=>Gt(Et("div",{key:S.id,class:"scroll-page",id:S.id},[Et("div",Un,[bt(P,{align:"left",style:{margin:"0"}},{default:xt(()=>[Nt(oe(S.title),1)]),_:2},1024)]),(wt(!0),At(ie,null,ye(S.message,(L,s)=>(wt(),At("p",{key:s},oe(L),1))),128))],8,Bn),[[Ut,S.id===et.value]])),64))])])]),_:1},8,["modelValue"])}}},Vn=be(Hn,[["__scopeId","data-v-01b8b5ef"]]);(function(){typeof Math.sgn>"u"&&(Math.sgn=function(m){return m==0?0:m>0?1:-1});let W={subtract:function(m,u){return{x:m.x-u.x,y:m.y-u.y}},dotProduct:function(m,u){return m.x*u.x+m.y*u.y},square:function(m){return Math.sqrt(m.x*m.x+m.y*m.y)},scale:function(m,u){return{x:m.x*u,y:m.y*u}}},c=64,U=Math.pow(2,-c-1),et=function(m,u){let y=[],A=K(m,u),F=u.length-1,n=2*F-1,t=r(A,n,y,0),d=W.subtract(m,u[0]),x=W.square(d),j=0;for(let z=0;z<t;z++){d=W.subtract(m,p(u,F,y[z],null,null));var B=W.square(d);B<x&&(x=B,j=y[z])}return d=W.subtract(m,u[F]),B=W.square(d),B<x&&(x=B,j=1),{location:j,distance:x}},Y=function(m,u){let y=et(m,u);return{point:p(u,u.length-1,y.location,null,null),location:y.location}};var K=function(m,u){let y=u.length-1,A=2*y-1,F=[],n=[],t=[],d=[],x=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];for(var j=0;j<=y;j++)F[j]=W.subtract(u[j],m);for(var j=0;j<=y-1;j++)n[j]=W.subtract(u[j+1],u[j]),n[j]=W.scale(n[j],3);for(let X=0;X<=y-1;X++)for(let V=0;V<=y;V++)t[X]||(t[X]=[]),t[X][V]=W.dotProduct(n[X],F[V]);for(j=0;j<=A;j++)d[j]||(d[j]=[]),d[j].y=0,d[j].x=parseFloat(j)/A;let B=y,z=y-1;for(let X=0;X<=B+z;X++){let V=Math.max(0,X-z),ot=Math.min(X,B);for(j=V;j<=ot;j++){let ct=X-j;d[j+ct].y+=t[ct][j]*x[ct][j]}}return d},r=function(m,u,y,A){let F=[],n=[],t,d,x=[],j=[];switch(E(m,u)){case 0:return 0;case 1:{if(A>=c)return y[0]=(m[0].x+m[u].x)/2,1;if(a(m,u))return y[0]=e(m,u),1;break}}p(m,u,.5,F,n),t=r(F,u,x,A+1),d=r(n,u,j,A+1);for(var B=0;B<t;B++)y[B]=x[B];for(var B=0;B<d;B++)y[B+t]=j[B];return t+d},E=function(m,u){let y=0,A,F;A=F=Math.sgn(m[0].y);for(let n=1;n<=u;n++)A=Math.sgn(m[n].y),A!=F&&y++,F=A;return y},a=function(m,u){let y,A,F,n,t,d,x,j,B,z,X,V,ot,ct,pt,$;d=m[0].y-m[u].y,x=m[u].x-m[0].x,j=m[0].x*m[u].y-m[u].x*m[0].y;let rt,ft;rt=ft=0;for(let ut=1;ut<u;ut++){let ht=d*m[ut].x+x*m[ut].y+j;ht>rt?rt=ht:ht<ft&&(ft=ht)}return X=0,V=1,ot=0,ct=d,pt=x,$=j-rt,B=X*pt-ct*V,z=1/B,A=(V*$-pt*ot)*z,ct=d,pt=x,$=j-ft,B=X*pt-ct*V,z=1/B,F=(V*$-pt*ot)*z,n=Math.min(A,F),t=Math.max(A,F),y=t-n,y<U?1:0},e=function(m,u){let y=1,A=0,F=m[u].x-m[0].x,n=m[u].y-m[0].y,t=m[0].x-0,d=m[0].y-0,x=F*A-n*y,j=1/x,B=(F*d-n*t)*j;return 0+y*B},p=function(m,u,y,A,F){let n=[[]];for(var t=0;t<=u;t++)n[0][t]=m[t];for(let d=1;d<=u;d++)for(var t=0;t<=u-d;t++)n[d]||(n[d]=[]),n[d][t]||(n[d][t]={}),n[d][t].x=(1-y)*n[d-1][t].x+y*n[d-1][t+1].x,n[d][t].y=(1-y)*n[d-1][t].y+y*n[d-1][t+1].y;if(A!=null)for(t=0;t<=u;t++)A[t]=n[t][0];if(F!=null)for(t=0;t<=u;t++)F[t]=n[u-t][t];return n[u][0]};let P={},w=function(m){let u=P[m];if(!u){u=[];let A=function(){return function(j){return Math.pow(j,m)}},F=function(){return function(j){return Math.pow(1-j,m)}},n=function(j){return function(B){return j}},t=function(){return function(j){return j}},d=function(){return function(j){return 1-j}},x=function(j){return function(B){let z=1;for(let X=0;X<j.length;X++)z=z*j[X](B);return z}};u.push(new A);for(let j=1;j<m;j++){let B=[new n(m)];for(var y=0;y<m-j;y++)B.push(new t);for(var y=0;y<j;y++)B.push(new d);u.push(new x(B))}u.push(new F),P[m]=u}return u},S=function(m,u){let y=w(m.length-1),A=0,F=0;for(let n=0;n<m.length;n++)A=A+m[n].x*y[n](u),F=F+m[n].y*y[n](u);return{x:A,y:F}},L=function(m,u){return Math.sqrt(Math.pow(m.x-u.x,2)+Math.pow(m.y-u.y,2))},s=function(m){return m[0].x===m[1].x&&m[0].y===m[1].y},l=function(m,u,y){if(s(m))return{point:m[0],location:u};let A=S(m,u),F=0,n=u,t=y>0?1:-1,d=null;for(;F<Math.abs(y);)n+=.005*t,d=S(m,n),F+=L(d,A),A=d;return{point:d,location:n}},R=function(m){if(s(m))return 0;let u=S(m,0),y=0,A=0,F=1,n=null;for(;A<1;)A+=.005*F,n=S(m,A),y+=L(n,u),u=n;return y},N=function(m,u,y){return l(m,u,y).point},H=function(m,u,y){return l(m,u,y).location},O=function(m,u){let y=S(m,u),A=S(m.slice(0,m.length-1),u),F=A.y-y.y,n=A.x-y.x;return F===0?1/0:Math.atan(F/n)},g=function(m,u,y){let A=l(m,u,y);return A.location>1&&(A.location=1),A.location<0&&(A.location=0),O(m,A.location)},i=function(m,u,y,A){A=A==null?0:A;let F=l(m,u,A),n=O(m,F.location),t=Math.atan(-1/n),d=y/2*Math.sin(t),x=y/2*Math.cos(t);return[{x:F.point.x+x,y:F.point.y+d},{x:F.point.x-x,y:F.point.y-d}]},b=function(m,u,y,A,F){let n=A-u,t=m-y,d=m*(u-A)+u*(y-m),x=f(F),j=[n*x[0][0]+t*x[1][0],n*x[0][1]+t*x[1][1],n*x[0][2]+t*x[1][2],n*x[0][3]+t*x[1][3]+d],B=v.apply(null,j),z=[];if(B!=null)for(let V=0;V<3;V++){let ot=B[V],ct=Math.pow(ot,2),pt=Math.pow(ot,3),$=[x[0][0]*pt+x[0][1]*ct+x[0][2]*ot+x[0][3],x[1][0]*pt+x[1][1]*ct+x[1][2]*ot+x[1][3]];var X;y-m!==0?X=($[0]-m)/(y-m):X=($[1]-u)/(A-u),ot>=0&&ot<=1&&X>=0&&X<=1&&z.push($)}return z},h=function(m,u,y,A,F){let n=[];return n.push.apply(n,b(m,u,m+y,u,F)),n.push.apply(n,b(m+y,u,m+y,u+A,F)),n.push.apply(n,b(m+y,u+A,m,u+A,F)),n.push.apply(n,b(m,u+A,m,u,F)),n},D=function(m,u){let y=[];return y.push.apply(y,b(m.x,m.y,m.x+m.w,m.y,u)),y.push.apply(y,b(m.x+m.w,m.y,m.x+m.w,m.y+m.h,u)),y.push.apply(y,b(m.x+m.w,m.y+m.h,m.x,m.y+m.h,u)),y.push.apply(y,b(m.x,m.y+m.h,m.x,m.y,u)),y};function I(m,u){return[-m[0][u]+3*m[1][u]+-3*m[2][u]+m[3][u],3*m[0][u]-6*m[1][u]+3*m[2][u],-3*m[0][u]+3*m[1][u],m[0][u]]}function f(m){return[I(m,"x"),I(m,"y")]}function _(m){return m<0?-1:m>0?1:0}function v(m,u,y,A){let F=u/m,n=y/m,t=A/m,d=(3*n-Math.pow(F,2))/9,x=(9*F*n-27*t-2*Math.pow(F,3))/54,j=Math.pow(d,3)+Math.pow(x,2),B,z,X=[];if(j>=0)B=_(x+Math.sqrt(j))*Math.pow(Math.abs(x+Math.sqrt(j)),1/3),z=_(x-Math.sqrt(j))*Math.pow(Math.abs(x-Math.sqrt(j)),1/3),X[0]=-F/3+(B+z),X[1]=-F/3-(B+z)/2,X[2]=-F/3-(B+z)/2,Math.abs(Math.sqrt(3)*(B-z)/2)!==0&&(X[1]=-1,X[2]=-1);else{let V=Math.acos(x/Math.sqrt(-Math.pow(d,3)));X[0]=2*Math.sqrt(-d)*Math.cos(V/3)-F/3,X[1]=2*Math.sqrt(-d)*Math.cos((V+2*Math.PI)/3)-F/3,X[2]=2*Math.sqrt(-d)*Math.cos((V+4*Math.PI)/3)-F/3}for(let V=0;V<3;V++)(X[V]<0||X[V]>1)&&(X[V]=-1);return X}let M=this.jsBezier={distanceFromCurve:et,gradientAtPoint:O,gradientAtPointAlongCurveFrom:g,nearestPointOnCurve:Y,pointOnCurve:S,pointAlongCurveFrom:N,perpendicularToCurveAt:i,locationAlongCurveFrom:H,getLength:R,lineIntersection:b,boxIntersection:h,boundingBoxIntersection:D,version:"0.9.0"};typeof exports<"u"&&(exports.jsBezier=M)}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.Biltong={version:"0.4.0"};typeof exports<"u"&&(exports.Biltong=c);let U=function(a){return Object.prototype.toString.call(a)==="[object Array]"},et=function(a,e,p){return a=U(a)?a:[a.x,a.y],e=U(e)?e:[e.x,e.y],p(a,e)},Y=c.gradient=function(a,e){return et(a,e,function(p,P){return P[0]==p[0]?P[1]>p[1]?1/0:-1/0:P[1]==p[1]?P[0]>p[0]?0:-0:(P[1]-p[1])/(P[0]-p[0])})};c.normal=function(a,e){return-1/Y(a,e)},c.lineLength=function(a,e){return et(a,e,function(p,P){return Math.sqrt(Math.pow(P[1]-p[1],2)+Math.pow(P[0]-p[0],2))})};let K=c.quadrant=function(a,e){return et(a,e,function(p,P){return P[0]>p[0]||P[0]==p[0]?P[1]>p[1]?2:1:P[1]>p[1]?3:4})};c.theta=function(a,e){return et(a,e,function(p,P){let w=Y(p,P),S=Math.atan(w),L=K(p,P);return(L==4||L==3)&&(S+=Math.PI),S<0&&(S+=2*Math.PI),S})},c.intersects=function(a,e){let p=a.x,P=a.x+a.w,w=a.y,S=a.y+a.h,L=e.x,s=e.x+e.w,l=e.y,R=e.y+e.h;return p<=L&&L<=P&&w<=l&&l<=S||p<=s&&s<=P&&w<=l&&l<=S||p<=L&&L<=P&&w<=R&&R<=S||p<=s&&L<=P&&w<=R&&R<=S||L<=p&&p<=s&&l<=w&&w<=R||L<=P&&P<=s&&l<=w&&w<=R||L<=p&&p<=s&&l<=S&&S<=R||L<=P&&p<=s&&l<=S&&S<=R},c.encloses=function(a,e,p){let P=a.x,w=a.x+a.w,S=a.y,L=a.y+a.h,s=e.x,l=e.x+e.w,R=e.y,N=e.y+e.h,H=function(O,g,i,b){return p?O<=g&&i>=b:O<g&&i>b};return H(P,s,w,l)&&H(S,R,L,N)};let r=[null,[1,-1],[1,1],[-1,1],[-1,-1]],E=[null,[-1,-1],[-1,1],[1,1],[1,-1]];c.pointOnLine=function(a,e,p){let P=Y(a,e),w=K(a,e),S=p>0?r[w]:E[w],L=Math.atan(P),s=Math.abs(p*Math.sin(L))*S[1],l=Math.abs(p*Math.cos(L))*S[0];return{x:a.x+l,y:a.y+s}},c.perpendicularLineTo=function(a,e,p){let P=Y(a,e),w=Math.atan(-1/P),S=p/2*Math.sin(w),L=p/2*Math.cos(w);return[{x:e.x+L,y:e.y+S},{x:e.x-L,y:e.y-S}]}}).call(typeof window<"u"?window:globalThis);(function(){function W(n,t,d,x,j,B,z,X){return new Touch({target:t,identifier:F(),pageX:d,pageY:x,screenX:j,screenY:B,clientX:z||j,clientY:X||B})}function c(){let n=[];return Array.prototype.push.apply(n,arguments),n.item=function(t){return this[t]},n}function U(n,t,d,x,j,B,z,X){return c(W.apply(null,arguments))}var et=this,Y=function(n,t,d){d=d||n.parentNode;let x=d.querySelectorAll(t);for(let j=0;j<x.length;j++)if(x[j]===n)return!0;return!1},K=function(n){return typeof n=="string"||n.constructor===String?document.getElementById(n):n},r=function(n){return n.srcElement||n.target},E=function(n,t,d,x){if(x){if(typeof n.path<"u"&&n.path.indexOf)return{path:n.path,end:n.path.indexOf(d)};{let j={path:[],end:-1},B=function(z){j.path.push(z),z===d?j.end=j.path.length-1:z.parentNode!=null&&B(z.parentNode)};return B(t),j}}else return{path:[t],end:1}},a=function(n,t){for(var d=0,x=n.length;d<x&&n[d]!=t;d++);d<n.length&&n.splice(d,1)},e=1,p=function(n,t,d){let x=e++;return n.__ta=n.__ta||{},n.__ta[t]=n.__ta[t]||{},n.__ta[t][x]=d,d.__tauid=x,x},P=function(n,t,d){if(n.__ta&&n.__ta[t]&&delete n.__ta[t][d.__tauid],d.__taExtra){for(let x=0;x<d.__taExtra.length;x++)y(n,d.__taExtra[x][0],d.__taExtra[x][1]);d.__taExtra.length=0}d.__taUnstore&&d.__taUnstore()},w=function(n,t,d,x){if(n==null)return d;{let j=n.split(","),B=function(z){B.__tauid=d.__tauid;let X=r(z),V=X,ot=E(z,X,t,n!=null);if(ot.end!=-1)for(let ct=0;ct<ot.end;ct++){V=ot.path[ct];for(let pt=0;pt<j.length;pt++)Y(V,j[pt],t)&&d.apply(V,arguments)}};return S(d,x,B),B}},S=function(n,t,d){n.__taExtra=n.__taExtra||[],n.__taExtra.push([t,d])},L=function(n,t,d,x){if(O&&i[t]){let j=w(x,n,d,i[t]);u(n,i[t],j,d)}t==="focus"&&n.getAttribute("tabindex")==null&&n.setAttribute("tabindex","1"),u(n,t,w(x,n,d,t),d)},s=function(n,t,d,x){if(n.__taSmartClicks==null){let j=function(X){n.__tad=I(X)},B=function(X){n.__tau=I(X)},z=function(X){if(n.__tad&&n.__tau&&n.__tad[0]===n.__tau[0]&&n.__tad[1]===n.__tau[1])for(let V=0;V<n.__taSmartClicks.length;V++)n.__taSmartClicks[V].apply(r(X),[X])};L(n,"mousedown",j,x),L(n,"mouseup",B,x),L(n,"click",z,x),n.__taSmartClicks=[]}n.__taSmartClicks.push(d),d.__taUnstore=function(){a(n.__taSmartClicks,d)}},l={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},R=function(n,t){return function(d,x,j,B){if(x=="contextmenu"&&g)L(d,x,j,B);else{if(d.__taTapHandler==null){let ct=d.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]};var z=function(pt){let $=r(pt),rt=E(pt,$,d,B!=null),ft=!1;for(let ut=0;ut<rt.end;ut++){if(ft)return;$=rt.path[ut];for(let ht=0;ht<ct.downSelectors.length;ht++)if(ct.downSelectors[ht]==null||Y($,ct.downSelectors[ht],d)){ct.down=!0,setTimeout(V,n),setTimeout(ot,t),ft=!0;break}}},X=function(pt){if(ct.down){let $=r(pt),rt,ft;ct.taps++;let ut=m(pt);for(let ht in l)if(l.hasOwnProperty(ht)){let Ct=l[ht];if(Ct.touches===ut&&(Ct.taps===1||Ct.taps===ct.taps))for(let mt=0;mt<ct[ht].length;mt++){ft=E(pt,$,d,ct[ht][mt][1]!=null);for(let Z=0;Z<ft.end;Z++)if(rt=ft.path[Z],ct[ht][mt][1]==null||Y(rt,ct[ht][mt][1],d)){ct[ht][mt][0].apply(rt,[pt]);break}}}}},V=function(){ct.down=!1},ot=function(){ct.taps=0};L(d,"mousedown",z),L(d,"mouseup",X)}d.__taTapHandler.downSelectors.push(B),d.__taTapHandler[x].push([j,B]),j.__taUnstore=function(){a(d.__taTapHandler[x],j)}}}},N=function(n,t,d,x){for(let j in d.__tamee[n])d.__tamee[n].hasOwnProperty(j)&&d.__tamee[n][j].apply(x,[t])},H=function(){let n=[];return function(t,d,x,j){if(!t.__tamee){t.__tamee={over:!1,mouseenter:[],mouseexit:[]};let B=function(X){let V=r(X);(j==null&&V==t&&!t.__tamee.over||Y(V,j,t)&&(V.__tamee==null||!V.__tamee.over))&&(N("mouseenter",X,t,V),V.__tamee=V.__tamee||{},V.__tamee.over=!0,n.push(V))},z=function(X){let V=r(X);for(let ot=0;ot<n.length;ot++)V==n[ot]&&!Y(X.relatedTarget||X.toElement,"*",V)&&(V.__tamee.over=!1,n.splice(ot,1),N("mouseexit",X,t,V))};u(t,"mouseover",w(j,t,B,"mouseover"),B),u(t,"mouseout",w(j,t,z,"mouseout"),z)}x.__taUnstore=function(){delete t.__tamee[d][x.__tauid]},p(t,d,x),t.__tamee[d][x.__tauid]=x}},O="ontouchstart"in document.documentElement,g="onmousedown"in document.documentElement,i={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},b=function(){let n=-1;if(navigator.appName=="Microsoft Internet Explorer"){let t=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(t)!=null&&(n=parseFloat(RegExp.$1))}return n}(),h=b>-1&&b<9,D=function(n,t){if(n==null)return[0,0];let d=M(n),x=v(d,0);return[x[t+"X"],x[t+"Y"]]},I=function(n){return n==null?[0,0]:h?[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop]:D(n,"page")},f=function(n){return D(n,"screen")},_=function(n){return D(n,"client")},v=function(n,t){return n.item?n.item(t):n[t]},M=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},m=function(n){return M(n).length},u=function(n,t,d,x){if(p(n,t,d),x.__tauid=d.__tauid,n.addEventListener)n.addEventListener(t,d,!1);else if(n.attachEvent){let j=t+d.__tauid;n["e"+j]=d,n[j]=function(){n["e"+j]&&n["e"+j](window.event)},n.attachEvent("on"+t,n[j])}},y=function(n,t,d){d!=null&&A(n,function(){let x=K(this);if(P(x,t,d),d.__tauid!=null){if(x.removeEventListener)x.removeEventListener(t,d,!1),O&&i[t]&&x.removeEventListener(i[t],d,!1);else if(this.detachEvent){let j=t+d.__tauid;x[j]&&x.detachEvent("on"+t,x[j]),x[j]=null,x["e"+j]=null}}d.__taTouchProxy&&y(n,d.__taTouchProxy[1],d.__taTouchProxy[0])})},A=function(n,t){if(n!=null){n=typeof Window<"u"&&typeof n.top!="unknown"&&n==n.top?[n]:typeof n!="string"&&n.tagName==null&&n.length!=null?n:typeof n=="string"?document.querySelectorAll(n):[n];for(let d=0;d<n.length;d++)t.apply(n[d])}},F=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})};et.Mottle=function(n){n=n||{};let t=n.clickThreshold||250,d=n.dblClickThreshold||450,x=new H,j=new R(t,d),B=n.smartClicks,z=function(X,V,ot,ct){ot!=null&&A(X,function(){let pt=K(this);B&&V==="click"?s(pt,V,ot,ct):V==="tap"||V==="dbltap"||V==="contextmenu"?j(pt,V,ot,ct):V==="mouseenter"||V=="mouseexit"?x(pt,V,ot,ct):L(pt,V,ot,ct)})};this.remove=function(X){return A(X,function(){let V=K(this);if(V.__ta){for(let ot in V.__ta)if(V.__ta.hasOwnProperty(ot))for(let ct in V.__ta[ot])V.__ta[ot].hasOwnProperty(ct)&&y(V,ot,V.__ta[ot][ct])}V.parentNode&&V.parentNode.removeChild(V)}),this},this.on=function(X,V,ot,ct){let pt=arguments[0],$=arguments.length==4?arguments[2]:null,rt=arguments[1],ft=arguments[arguments.length-1];return z(pt,rt,ft,$),this},this.off=function(X,V,ot){return y(X,V,ot),this},this.trigger=function(X,V,ot,ct){let pt=g&&(typeof MouseEvent>"u"||ot==null||ot.constructor===MouseEvent),$=O&&!g&&i[V]?i[V]:V,rt=!(O&&!g&&i[V]),ft=I(ot),ut=f(ot),ht=_(ot);return A(X,function(){let Ct=K(this),mt;ot=ot||{screenX:ut[0],screenY:ut[1],clientX:ht[0],clientY:ht[1]};let Z=function(tt){ct&&(tt.payload=ct)},Q={TouchEvent:function(tt){let lt=U(window,Ct,0,ft[0],ft[1],ut[0],ut[1],ht[0],ht[1]);(tt.initTouchEvent||tt.initEvent)($,!0,!0,window,null,ut[0],ut[1],ht[0],ht[1],!1,!1,!1,!1,lt,lt,lt,1,0)},MouseEvents:function(tt){tt.initMouseEvent($,!0,!0,window,0,ut[0],ut[1],ht[0],ht[1],!1,!1,!1,!1,1,Ct)}};if(document.createEvent){let tt=!rt&&!pt&&O&&i[V],lt=tt?"TouchEvent":"MouseEvents";mt=document.createEvent(lt),Q[lt](mt),Z(mt),Ct.dispatchEvent(mt)}else document.createEventObject&&(mt=document.createEventObject(),mt.eventType=mt.eventName=$,mt.screenX=ut[0],mt.screenY=ut[1],mt.clientX=ht[0],mt.clientY=ht[1],Z(mt),Ct.fireEvent("on"+$,mt))}),this}},et.Mottle.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1,!t&&n.preventDefault&&n.preventDefault()},et.Mottle.pageLocation=I,et.Mottle.setForceTouchEvents=function(n){O=n},et.Mottle.setForceMouseEvents=function(n){g=n},et.Mottle.version="0.8.0",typeof exports<"u"&&(exports.Mottle=et.Mottle)}).call(typeof window>"u"?globalThis:window);(function(){let W=this,c=function(n,t,d){return n.indexOf(t)===-1?(d?n.unshift(t):n.push(t),!0):!1},U=function(n,t){let d=n.indexOf(t);d!==-1&&n.splice(d,1)},et=function(n,t){let d=[];for(let x=0;x<n.length;x++)t.indexOf(n[x])===-1&&d.push(n[x]);return d},Y=function(n){return n==null?!1:typeof n=="string"||n.constructor===String},K=function(n){let t=n.getBoundingClientRect(),d=document.body,x=document.documentElement,j=window.pageYOffset||x.scrollTop||d.scrollTop,B=window.pageXOffset||x.scrollLeft||d.scrollLeft,z=x.clientTop||d.clientTop||0,X=x.clientLeft||d.clientLeft||0,V=t.top+j-z,ot=t.left+B-X;return{top:Math.round(V),left:Math.round(ot)}},r=function(n,t,d){d=d||n.parentNode;let x=d.querySelectorAll(t);for(let j=0;j<x.length;j++)if(x[j]===n)return!0;return!1},E=function(n,t,d){if(r(t,d,n))return t;{let x=t.parentNode;for(;x!=null&&x!==n;){if(r(x,d,n))return x;x=x.parentNode}}},a=function(n,t,d){let x=null,j=t.getAttribute("katavorio-draggable"),B=j!=null?"[katavorio-draggable='"+j+"'] ":"";for(let z=0;z<n.length;z++)if(x=E(t,d,B+n[z].selector),x!=null){if(n[z].filter){let X=r(d,n[z].filter,x);if(n[z].filterExclude===!0&&!X||X)return null}return[n[z],x]}return null};var e=function(){let n=-1;if(navigator.appName==="Microsoft Internet Explorer"){let t=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(t)!=null&&(n=parseFloat(RegExp.$1))}return n}(),p=10,P=10,w=e>-1&&e<9,S=e===9,L=function(n){if(w)return[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop];{let t=l(n),d=s(t,0);return S?[d.pageX||d.clientX,d.pageY||d.clientY]:[d.pageX,d.pageY]}},s=function(n,t){return n.item?n.item(t):n[t]},l=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},R={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},N="katavorio-drag-scope",H=["stop","start","drag","drop","over","out","beforeStart"],O=function(){},g=function(){return!0},i=function(n,t,d){for(let x=0;x<n.length;x++)n[x]!=d&&t(n[x])},b=function(n,t,d,x){i(n,function(j){j.setActive(t),t&&j.updatePosition(),d&&j.setHover(x,t)})},h=function(n,t){if(n!=null){n=!Y(n)&&n.tagName==null&&n.length!=null?n:[n];for(let d=0;d<n.length;d++)t.apply(n[d],[n[d]])}},D=function(n){n.stopPropagation?(n.stopPropagation(),n.preventDefault()):n.returnValue=!1},I="input,textarea,select,button,option",f=function(n,t,d){let x=n.srcElement||n.target;return!r(x,d.getInputFilterSelector(),t)};let _=function(n,t,d,x){this.params=t||{},this.el=n,this.params.addClass(this.el,this._class),this.uuid=y();let j=!0;return this.setEnabled=function(B){j=B},this.isEnabled=function(){return j},this.toggleEnabled=function(){j=!j},this.setScope=function(B){this.scopes=B?B.split(/\s+/):[x]},this.addScope=function(B){let z={};h(this.scopes,function(X){z[X]=!0}),h(B?B.split(/\s+/):[],function(X){z[X]=!0}),this.scopes=[];for(let X in z)this.scopes.push(X)},this.removeScope=function(B){let z={};h(this.scopes,function(X){z[X]=!0}),h(B?B.split(/\s+/):[],function(X){delete z[X]}),this.scopes=[];for(let X in z)this.scopes.push(X)},this.toggleScope=function(B){let z={};h(this.scopes,function(X){z[X]=!0}),h(B?B.split(/\s+/):[],function(X){z[X]?delete z[X]:z[X]=!0}),this.scopes=[];for(let X in z)this.scopes.push(X)},this.setScope(t.scope),this.k=t.katavorio,t.katavorio},v=function(){return!0},M=function(){return!1},m=function(n,t,d,x){this._class=d.draggable;let j=_.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;let B=[0,0],z=null,X=null,V=[0,0],ot=!1,ct=[0,0],pt=this.params.consumeStartEvent!==!1,$=this.el,rt=this.params.clone;this.params.scroll;let ft=t.multipleDrop!==!1,ut=!1,ht=t.ghostProxy===!0?v:t.ghostProxy&&typeof t.ghostProxy=="function"?t.ghostProxy:M,Ct=function(it){return it.cloneNode(!0)},mt=null,Z=[],Q=null,tt=t.ghostProxyParent,lt,yt,Dt,Mt;if(t.selector){let it=n.getAttribute("katavorio-draggable");it==null&&(it=""+new Date().getTime(),n.setAttribute("katavorio-draggable",it)),Z.push(t)}let Bt=t.snapThreshold,le=function(it,_t,Pt,gt,St){let kt=Math.floor(it[0]/_t),Xt=_t*kt,$t=Xt+_t,o=Math.abs(it[0]-Xt)<=gt?Xt:Math.abs($t-it[0])<=gt?$t:it[0],k=Math.floor(it[1]/Pt),C=Pt*k,T=C+Pt,G=Math.abs(it[1]-C)<=St?C:Math.abs(T-it[1])<=St?T:it[1];return[o,G]};this.posses=[],this.posseRoles={},this.toGrid=function(it){if(this.params.grid==null)return it;{let _t=this.params.grid?this.params.grid[0]/2:Bt||p/2,Pt=this.params.grid?this.params.grid[1]/2:Bt||P/2;return le(it,this.params.grid[0],this.params.grid[1],_t,Pt)}},this.snap=function(it,_t){if($==null)return;it=it||(this.params.grid?this.params.grid[0]:p),_t=_t||(this.params.grid?this.params.grid[1]:P);let Pt=this.params.getPosition($),gt=this.params.grid?this.params.grid[0]/2:Bt,St=this.params.grid?this.params.grid[1]/2:Bt,kt=le(Pt,it,_t,gt,St);return this.params.setPosition($,kt),kt},this.setUseGhostProxy=function(it){ht=it?v:M};let zt,qt=function(it){return t.allowNegative===!1?[Math.max(0,it[0]),Math.max(0,it[1])]:it},Pe=function(it){zt=typeof it=="function"?it:it?function(_t,Pt,gt,St){return qt([Math.max(0,Math.min(gt.w-St[0],_t[0])),Math.max(0,Math.min(gt.h-St[1],_t[1]))])}.bind(this):function(_t){return qt(_t)}}.bind(this);Pe(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(it){Pe(it)};let de;this.setRevert=function(it){de=it},this.params.revert&&(de=this.params.revert);let Ce=function(it){return typeof it=="function"?(it._katavorioId=y(),it._katavorioId):it},Ht={},fe=function(it){for(let _t in Ht){let Pt=Ht[_t],gt=Pt[0](it);if(Pt[1]&&(gt=!gt),!gt)return!1}return!0},re=this.setFilter=function(it,_t){if(it){let Pt=Ce(it);Ht[Pt]=[function(gt){let St=gt.srcElement||gt.target,kt;return Y(it)?kt=r(St,it,n):typeof it=="function"&&(kt=it(gt,n)),kt},_t!==!1]}};this.addFilter=re,this.removeFilter=function(it){let _t=typeof it=="function"?it._katavorioId:it;delete Ht[_t]},this.clearAllFilters=function(){Ht={}},this.canDrag=this.params.canDrag||g;let ae,Tt=[],Yt=[];this.addSelector=function(it){it.selector&&Z.push(it)},this.downListener=function(it){if(it.defaultPrevented)return;if((this.rightButtonCanDrag||it.which!==3&&it.button!==2)&&this.isEnabled()&&this.canDrag())if(fe(it)&&f(it,this.el,this.k)){if(Q=null,mt=null,Z.length>0){let gt=a(Z,this.el,it.target||it.srcElement);if(gt!=null&&(Q=gt[0],mt=gt[1]),mt==null)return}else mt=this.el;if(rt)if($=mt.cloneNode(!0),this.params.addClass($,R.clonedDrag),$.setAttribute("id",null),$.style.position="absolute",this.params.parent!=null){let gt=this.params.getPosition(this.el);$.style.left=gt[0]+"px",$.style.top=gt[1]+"px",this.params.parent.appendChild($)}else{let gt=K(mt);$.style.left=gt.left+"px",$.style.top=gt.top+"px",document.body.appendChild($)}else $=mt;pt&&D(it),B=L(it),$&&$.parentNode&&(ct=[$.parentNode.scrollLeft,$.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),j.markSelection(this),j.markPosses(this),this.params.addClass(document.body,d.noSelect),te("beforeStart",{el:this.el,pos:z,e:it,drag:this})}else this.params.consumeFilteredEvents&&D(it)}.bind(this),this.moveListener=function(it){if(B){if(!ot)if(te("start",{el:this.el,pos:z,e:it,drag:this})!==!1){if(!B)return;this.mark(!0),ot=!0}else this.abort();if(B){Yt.length=0;let _t=L(it),Pt=_t[0]-B[0],gt=_t[1]-B[1],St=this.params.ignoreZoom?1:j.getZoom();$&&$.parentNode&&(Pt+=$.parentNode.scrollLeft-ct[0],gt+=$.parentNode.scrollTop-ct[1]),Pt/=St,gt/=St,this.moveBy(Pt,gt,it),j.updateSelection(Pt,gt,this),j.updatePosses(Pt,gt,this)}}}.bind(this),this.upListener=function(it){B&&(B=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,d.noSelect),this.unmark(it),j.unmarkSelection(this,it),j.unmarkPosses(this,it),this.stop(it),j.notifyPosseDragStop(this,it),ot=!1,Yt.length=0,rt?($&&$.parentNode&&$.parentNode.removeChild($),$=null):de&&de($,this.params.getPosition($))===!0&&(this.params.setPosition($,z),te("revert",$)))}.bind(this),this.getFilters=function(){return Ht},this.abort=function(){B!=null&&this.upListener()},this.getDragElement=function(it){return it?mt||this.el:$||this.el};let It={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};t.events.start&&It.start.push(t.events.start),t.events.beforeStart&&It.beforeStart.push(t.events.beforeStart),t.events.stop&&It.stop.push(t.events.stop),t.events.drag&&It.drag.push(t.events.drag),t.events.revert&&It.revert.push(t.events.revert),this.on=function(it,_t){It[it]&&It[it].push(_t)},this.off=function(it,_t){if(It[it]){let Pt=[];for(let gt=0;gt<It[it].length;gt++)It[it][gt]!==_t&&Pt.push(It[it][gt]);It[it]=Pt}};var te=function(it,_t){let Pt=null;if(Q&&Q[it])Pt=Q[it](_t);else if(It[it])for(let gt=0;gt<It[it].length;gt++)try{let St=It[it][gt](_t);St!=null&&(Pt=St)}catch{}return Pt};this.notifyStart=function(it){te("start",{el:this.el,pos:this.params.getPosition($),e:it,drag:this})},this.stop=function(it,_t){if(_t||ot){let Pt=[],gt=j.getSelection(),St=this.params.getPosition($);if(gt.length>0)for(let kt=0;kt<gt.length;kt++){let Xt=this.params.getPosition(gt[kt].el);Pt.push([gt[kt].el,{left:Xt[0],top:Xt[1]},gt[kt]])}else Pt.push([$,{left:St[0],top:St[1]},this]);te("stop",{el:$,pos:ee||St,finalPos:St,e:it,drag:this,selection:Pt})}},this.mark=function(it){z=this.params.getPosition($),X=this.params.getPosition($,!0),V=[X[0]-z[0],X[1]-z[1]],this.size=this.params.getSize($),Tt=j.getMatchingDroppables(this),b(Tt,!0,!1,this),this.params.addClass($,this.params.dragClass||d.drag);let _t;this.params.getConstrainingRectangle?_t=this.params.getConstrainingRectangle($):_t=this.params.getSize($.parentNode),ae={w:_t[0],h:_t[1]},Dt=0,Mt=0,it&&j.notifySelectionDragStart(this)};let ee;this.unmark=function(it,_t){if(b(Tt,!1,!0,this),ut&&ht(mt,$)?(ee=[$.offsetLeft-Dt,$.offsetTop-Mt],$.parentNode.removeChild($),$=mt):ee=null,this.params.removeClass($,this.params.dragClass||d.drag),Tt.length=0,ut=!1,!_t){Yt.length>0&&ee&&t.setPosition(mt,ee),Yt.sort(A);for(let Pt=0;Pt<Yt.length&&Yt[Pt].drop(this,it)!==!0;Pt++);}},this.moveBy=function(it,_t,Pt){Yt.length=0;let gt=this.toGrid([z[0]+it,z[1]+_t]),St=zt(gt,$,ae,this.size);if(ht(this.el,$))if(gt[0]!==St[0]||gt[1]!==St[1]){if(!ut){let o=Ct(mt);t.addClass(o,R.ghostProxy),tt?(tt.appendChild(o),lt=t.getPosition(mt.parentNode,!0),yt=t.getPosition(t.ghostProxyParent,!0),Dt=lt[0]-yt[0],Mt=lt[1]-yt[1]):mt.parentNode.appendChild(o),$=o,ut=!0}St=gt}else ut&&($.parentNode.removeChild($),$=mt,ut=!1,lt=null,yt=null,Dt=0,Mt=0);let kt={x:St[0],y:St[1],w:this.size[0],h:this.size[1]},Xt={x:kt.x+V[0],y:kt.y+V[1],w:kt.w,h:kt.h},$t=null;this.params.setPosition($,[St[0]+Dt,St[1]+Mt]);for(let o=0;o<Tt.length;o++){let k={x:Tt[o].pagePosition[0],y:Tt[o].pagePosition[1],w:Tt[o].size[0],h:Tt[o].size[1]};this.params.intersects(Xt,k)&&(ft||$t==null||$t===Tt[o].el)&&Tt[o].canDrop(this)?($t||($t=Tt[o].el),Yt.push(Tt[o]),Tt[o].setHover(this,!0,Pt)):Tt[o].isHover()&&Tt[o].setHover(this,!1,Pt)}te("drag",{el:this.el,pos:St,e:Pt,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?re(this.params.handle,!1):re(this.params.filter,this.params.filterExclude)},u=function(n,t,d,x){this._class=d.droppable,this.params=t||{},this.rank=t.rank||0,this._activeClass=this.params.activeClass||d.active,this._hoverClass=this.params.hoverClass||d.hover,_.apply(this,arguments);let j=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(B){this.params[B?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(B){return!0},this.isHover=function(){return j},this.setHover=function(B,z,X){(z||this.el._katavorioDragHover==null||this.el._katavorioDragHover===B.el._katavorio)&&(this.params[z?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=z?B.el._katavorio:null,j!==z&&this.params.events[z?"over":"out"]({el:this.el,e:X,drag:B,drop:this}),j=z)},this.drop=function(B,z){return this.params.events.drop({drag:B,e:z,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,j=null}};var y=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let t=Math.random()*16|0;return(n==="x"?t:t&3|8).toString(16)})},A=function(n,t){return n.rank<t.rank?1:n.rank>t.rank?-1:0};let F=function(n){return n==null||(n=typeof n=="string"||n.constructor===String?document.getElementById(n):n,n==null)?null:(n._katavorio=n._katavorio||y(),n)};W.Katavorio=function(n){let t=[],d={};this._dragsByScope={},this._dropsByScope={};let x=1,j=function(Z,Q){h(Z,function(tt){for(let lt=0;lt<tt.scopes.length;lt++)Q[tt.scopes[lt]]=Q[tt.scopes[lt]]||[],Q[tt.scopes[lt]].push(tt)})},B=function(Z,Q){let tt=0;return h(Z,function(lt){for(let yt=0;yt<lt.scopes.length;yt++)if(Q[lt.scopes[yt]]){let Dt=n.indexOf(Q[lt.scopes[yt]],lt);Dt!==-1&&(Q[lt.scopes[yt]].splice(Dt,1),tt++)}}),tt>0};this.getMatchingDroppables=function(Z){let Q=[],tt={};for(let lt=0;lt<Z.scopes.length;lt++){let yt=this._dropsByScope[Z.scopes[lt]];if(yt)for(let Dt=0;Dt<yt.length;Dt++)yt[Dt].canDrop(Z)&&!tt[yt[Dt].uuid]&&(yt[Dt].allowLoopback||yt[Dt].el!==Z.el)&&(tt[yt[Dt].uuid]=!0,Q.push(yt[Dt]))}return Q.sort(A),Q};let z=function(Z){Z=Z||{};let Q={events:{}},tt;for(tt in n)Q[tt]=n[tt];for(tt in Z)Q[tt]=Z[tt];for(tt=0;tt<H.length;tt++)Q.events[H[tt]]=Z[H[tt]]||O;return Q.katavorio=this,Q}.bind(this),X=function(Z,Q){for(let tt=0;tt<H.length;tt++)Q[H[tt]]&&Z.on(H[tt],Q[H[tt]])}.bind(this),V={},ot=n.css||{},ct=n.scope||N;for(var pt in R)V[pt]=R[pt];for(var pt in ot)V[pt]=ot[pt];let $=n.inputFilterSelector||I;this.getInputFilterSelector=function(){return $},this.setInputFilterSelector=function(Z){return $=Z,this},this.draggable=function(Z,Q){let tt=[];return h(Z,function(lt){if(lt=F(lt),lt!=null)if(lt._katavorioDrag==null){let yt=z(Q);lt._katavorioDrag=new m(lt,yt,V,ct),j(lt._katavorioDrag,this._dragsByScope),tt.push(lt._katavorioDrag),n.addClass(lt,yt.selector?V.delegatedDraggable:V.draggable)}else X(lt._katavorioDrag,Q)}.bind(this)),tt},this.droppable=function(Z,Q){let tt=[];return h(Z,function(lt){if(lt=F(lt),lt!=null){let yt=new u(lt,z(Q),V,ct);lt._katavorioDrop=lt._katavorioDrop||[],lt._katavorioDrop.push(yt),j(yt,this._dropsByScope),tt.push(yt),n.addClass(lt,V.droppable)}}.bind(this)),tt},this.select=function(Z){return h(Z,function(){let Q=F(this);Q&&Q._katavorioDrag&&(d[Q._katavorio]||(t.push(Q._katavorioDrag),d[Q._katavorio]=[Q,t.length-1],n.addClass(Q,V.selected)))}),this},this.deselect=function(Z){return h(Z,function(){let Q=F(this);if(Q&&Q._katavorio&&d[Q._katavorio]){let lt=[];for(let yt=0;yt<t.length;yt++)t[yt].el!==Q&&lt.push(t[yt]);t=lt,delete d[Q._katavorio],n.removeClass(Q,V.selected)}}),this},this.deselectAll=function(){for(let Z in d){let Q=d[Z];n.removeClass(Q[0],V.selected)}t.length=0,d={}},this.markSelection=function(Z){i(t,function(Q){Q.mark()},Z)},this.markPosses=function(Z){Z.posses&&h(Z.posses,function(Q){Z.posseRoles[Q]&&Ct[Q]&&i(Ct[Q].members,function(tt){tt.mark()},Z)})},this.unmarkSelection=function(Z,Q){i(t,function(tt){tt.unmark(Q)},Z)},this.unmarkPosses=function(Z,Q){Z.posses&&h(Z.posses,function(tt){Z.posseRoles[tt]&&Ct[tt]&&i(Ct[tt].members,function(lt){lt.unmark(Q,!0)},Z)})},this.getSelection=function(){return t.slice(0)},this.updateSelection=function(Z,Q,tt){i(t,function(lt){lt.moveBy(Z,Q)},tt)};let rt=function(Z,Q){Q.posses&&h(Q.posses,function(tt){Q.posseRoles[tt]&&Ct[tt]&&i(Ct[tt].members,function(lt){Z(lt)},Q)})};this.updatePosses=function(Z,Q,tt){rt(function(lt){lt.moveBy(Z,Q)},tt)},this.notifyPosseDragStop=function(Z,Q){rt(function(tt){tt.stop(Q,!0)},Z)},this.notifySelectionDragStop=function(Z,Q){i(t,function(tt){tt.stop(Q,!0)},Z)},this.notifySelectionDragStart=function(Z,Q){i(t,function(tt){tt.notifyStart(Q)},Z)},this.setZoom=function(Z){x=Z},this.getZoom=function(){return x};let ft=function(Z,Q,tt,lt){h(Z,function(yt){B(yt,tt),yt[lt](Q),j(yt,tt)})};h(["set","add","remove","toggle"],function(Z){this[Z+"Scope"]=function(Q,tt){ft(Q._katavorioDrag,tt,this._dragsByScope,Z+"Scope"),ft(Q._katavorioDrop,tt,this._dropsByScope,Z+"Scope")}.bind(this),this[Z+"DragScope"]=function(Q,tt){ft(Q.constructor===m?Q:Q._katavorioDrag,tt,this._dragsByScope,Z+"Scope")}.bind(this),this[Z+"DropScope"]=function(Q,tt){ft(Q.constructor===u?Q:Q._katavorioDrop,tt,this._dropsByScope,Z+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(Z,Q){for(let tt in this._dragsByScope)i(this._dragsByScope[tt],function(lt){lt.snap(Z,Q)})},this.getDragsForScope=function(Z){return this._dragsByScope[Z]},this.getDropsForScope=function(Z){return this._dropsByScope[Z]};let ut=function(Z,Q,tt){if(Z=F(Z),Z[Q]){let lt=t.indexOf(Z[Q]);lt>=0&&t.splice(lt,1),B(Z[Q],tt)&&h(Z[Q],function(yt){yt.destroy()}),delete Z[Q]}},ht=function(Z,Q,tt,lt){Z=F(Z),Z[Q]&&Z[Q].off(tt,lt)};this.elementRemoved=function(Z){this.destroyDraggable(Z),this.destroyDroppable(Z)},this.destroyDraggable=function(Z,Q,tt){arguments.length===1?ut(Z,"_katavorioDrag",this._dragsByScope):ht(Z,"_katavorioDrag",Q,tt)},this.destroyDroppable=function(Z,Q,tt){arguments.length===1?ut(Z,"_katavorioDrop",this._dropsByScope):ht(Z,"_katavorioDrop",Q,tt)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},t=[],d={},Ct={}};var Ct={};let mt=function(Z,Q,tt){let lt=Y(Q)?Q:Q.id,yt=Y(Q)?!0:Q.active!==!1,Dt=Ct[lt]||function(){let Mt={name:lt,members:[]};return Ct[lt]=Mt,Mt}();return h(Z,function(Mt){if(Mt._katavorioDrag){if(tt&&Mt._katavorioDrag.posseRoles[Dt.name]!=null)return;c(Dt.members,Mt._katavorioDrag),c(Mt._katavorioDrag.posses,Dt.name),Mt._katavorioDrag.posseRoles[Dt.name]=yt}}),Dt};this.addToPosse=function(Z,Q){let tt=[];for(let lt=1;lt<arguments.length;lt++)tt.push(mt(Z,arguments[lt]));return tt.length===1?tt[0]:tt},this.setPosse=function(Z,Q){let tt=[];for(let lt=1;lt<arguments.length;lt++)tt.push(mt(Z,arguments[lt],!0).name);return h(Z,function(lt){if(lt._katavorioDrag){let yt=et(lt._katavorioDrag.posses,tt),Dt=[];Array.prototype.push.apply(Dt,lt._katavorioDrag.posses);for(let Mt=0;Mt<yt.length;Mt++)this.removeFromPosse(lt,yt[Mt])}}.bind(this)),tt.length===1?tt[0]:tt},this.removeFromPosse=function(Z,Q){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(let tt=1;tt<arguments.length;tt++)Q=arguments[tt],h(Z,function(lt){if(lt._katavorioDrag&&lt._katavorioDrag.posses){let yt=lt._katavorioDrag;h(Q,function(Dt){U(Ct[Dt].members,yt),U(yt.posses,Dt),delete yt.posseRoles[Dt]})}})},this.removeFromAllPosses=function(Z){h(Z,function(Q){if(Q._katavorioDrag&&Q._katavorioDrag.posses){let tt=Q._katavorioDrag;h(tt.posses,function(lt){U(Ct[lt].members,tt)}),tt.posses.length=0,tt.posseRoles={}}})},this.setPosseState=function(Z,Q,tt){let lt=Ct[Q];lt&&h(Z,function(yt){yt._katavorioDrag&&yt._katavorioDrag.posses&&(yt._katavorioDrag.posseRoles[lt.name]=tt)})}},W.Katavorio.version="1.0.0",typeof exports<"u"&&(exports.Katavorio=W.Katavorio)}).call(typeof window<"u"?window:globalThis);(function(){let W=this;W.jsPlumbUtil=W.jsPlumbUtil||{};let c=W.jsPlumbUtil;typeof exports<"u"&&(exports.jsPlumbUtil=c);function U(u){return Object.prototype.toString.call(u)==="[object Array]"}c.isArray=U;function et(u){return Object.prototype.toString.call(u)==="[object Number]"}c.isNumber=et;function Y(u){return typeof u=="string"}c.isString=Y;function K(u){return typeof u=="boolean"}c.isBoolean=K;function r(u){return u==null}c.isNull=r;function E(u){return u==null?!1:Object.prototype.toString.call(u)==="[object Object]"}c.isObject=E;function a(u){return Object.prototype.toString.call(u)==="[object Date]"}c.isDate=a;function e(u){return Object.prototype.toString.call(u)==="[object Function]"}c.isFunction=e;function p(u){return e(u)&&u.name!=null&&u.name.length>0}c.isNamedFunction=p;function P(u){for(let y in u)if(u.hasOwnProperty(y))return!1;return!0}c.isEmpty=P;function w(u){if(Y(u))return""+u;if(K(u))return!!u;if(a(u))return new Date(u.getTime());if(e(u))return u;if(U(u)){let y=[];for(let A=0;A<u.length;A++)y.push(w(u[A]));return y}else if(E(u)){let y={};for(let A in u)y[A]=w(u[A]);return y}else return u}c.clone=w;function S(u,y,A,F){let n={},t,d,x={};for(A=A||[],F=F||[],d=0;d<A.length;d++)n[A[d]]=!0;for(d=0;d<F.length;d++)x[F[d]]=!0;let j=w(u);for(d in y)if(j[d]==null||x[d])j[d]=y[d];else if(Y(y[d])||K(y[d]))n[d]?(t=[],t.push.apply(t,U(j[d])?j[d]:[j[d]]),t.push.apply(t,K(y[d])?y[d]:[y[d]]),j[d]=t):j[d]=y[d];else if(U(y[d]))t=[],U(j[d])&&t.push.apply(t,j[d]),t.push.apply(t,y[d]),j[d]=t;else if(E(y[d])){E(j[d])||(j[d]={});for(let B in y[d])j[d][B]=y[d][B]}return j}c.merge=S;function L(u,y,A){if(u==null)return;let F=u,n=F;return y.replace(/([^\.])+/g,function(t,d,x,j){let B=t.match(/([^\[0-9]+){1}(\[)([0-9+])/),z=x+t.length>=j.length,X=function(){return n[B[1]]||function(){return n[B[1]]=[],n[B[1]]}()};if(z)B?X()[B[3]]=A:n[t]=A;else if(B){let V=X();n=V[B[3]]||function(){return V[B[3]]={},V[B[3]]}()}else n=n[t]||function(){return n[t]={},n[t]}();return""}),u}c.replace=L;function s(u,y,A){for(let F=0;F<A.length;F++){let n=A[F][0][A[F][1]].apply(A[F][0],A[F][2]);if(n===y)return n}return u}c.functionChain=s;function l(u,y,A,F){let n=function(d){let x=d.match(/(\${.*?})/g);if(x!=null)for(let j=0;j<x.length;j++){let B=y[x[j].substring(2,x[j].length-1)]||"";B!=null&&(d=d.replace(x[j],B))}return d},t=function(d){if(d!=null){if(Y(d))return n(d);if(e(d)&&!F&&(A==null||(d.name||"").indexOf(A)===0))return d(y);if(U(d)){let x=[];for(let j=0;j<d.length;j++)x.push(t(d[j]));return x}else if(E(d)){let x={};for(let j in d)x[j]=t(d[j]);return x}else return d}};return t(u)}c.populate=l;function R(u,y){if(u){for(let A=0;A<u.length;A++)if(y(u[A]))return A}return-1}c.findWithFunction=R;function N(u,y){let A=R(u,y);return A>-1&&u.splice(A,1),A!==-1}c.removeWithFunction=N;function H(u,y){let A=u.indexOf(y);return A>-1&&u.splice(A,1),A!==-1}c.remove=H;function O(u,y,A){R(u,A)===-1&&u.push(y)}c.addWithFunction=O;function g(u,y,A,F){let n=u[y];return n==null&&(n=[],u[y]=n),n[F?"unshift":"push"](A),n}c.addToList=g;function i(u,y,A){return u.indexOf(y)===-1?(A?u.unshift(y):u.push(y),!0):!1}c.suggest=i;function b(u,y,A){let F;y=U(y)?y:[y];let n=function(x){let j=x.__proto__;for(;j!=null;)if(j.prototype!=null){for(let B in j.prototype)j.prototype.hasOwnProperty(B)&&!u.prototype.hasOwnProperty(B)&&(u.prototype[B]=j.prototype[B]);j=j.prototype.__proto__}else j=null};for(F=0;F<y.length;F++){for(let x in y[F].prototype)y[F].prototype.hasOwnProperty(x)&&!u.prototype.hasOwnProperty(x)&&(u.prototype[x]=y[F].prototype[x]);n(y[F])}let t=function(x,j){return function(){for(F=0;F<y.length;F++)y[F].prototype[x]&&y[F].prototype[x].apply(this,arguments);return j.apply(this,arguments)}},d=function(x){for(let j in x)u.prototype[j]=t(j,x[j])};if(arguments.length>2)for(F=2;F<arguments.length;F++)d(arguments[F]);return u}c.extend=b;function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){let y=Math.random()*16|0;return(u==="x"?y:y&3|8).toString(16)})}c.uuid=h;function D(u){if(u==null)return null;let y=u.replace(/^\s\s*/,""),A=/\s/,F=y.length;for(;A.test(y.charAt(--F)););return y.slice(0,F+1)}c.fastTrim=D;function I(u,y){u=u.length==null||typeof u=="string"?[u]:u;for(let A=0;A<u.length;A++)y(u[A])}c.each=I;function f(u,y){let A=[];for(let F=0;F<u.length;F++)A.push(y(u[F]));return A}c.map=f;function _(u,y,A){A=A||"parent";let F=function(j){return j?y[j]:null},n=function(j){return j?F(j[A]):null},t=function(j,B){if(j==null)return B;{let z=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];B.mergeStrategy==="override"&&Array.prototype.push.apply(z,["events","overlays"]);let X=S(j,B,[],z);return t(n(j),X)}},d=function(j){if(j==null)return{};if(typeof j=="string")return F(j);if(j.length){let B=!1,z=0,X;for(;!B&&z<j.length;)X=d(j[z]),X?B=!0:z++;return X}},x=d(u);return x?t(n(x),x):{}}c.mergeWithParents=_,c.logEnabled=!0;function v(){if(c.logEnabled&&typeof console<"u")try{let u=arguments[arguments.length-1];console.log(u)}catch{}}c.log=v;function M(u,y,A){return function(){let F=null;try{y!=null&&(F=y.apply(this,arguments))}catch(n){v("jsPlumb function failed : "+n)}if(u!=null&&(A==null||F!==A))try{F=u.apply(this,arguments)}catch(n){v("wrapped function failed : "+n)}return F}}c.wrap=M;let m=function(){function u(){let y=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(A,F,n){let t=function(d){g(y._listeners,d,F,n),F.__jsPlumb=F.__jsPlumb||{},F.__jsPlumb[h()]=d};if(typeof A=="string")t(A);else if(A.length!=null)for(let d=0;d<A.length;d++)t(A[d]);return y},this.fire=function(A,F,n){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[A]){let t=this._listeners[A].length,d=0,x=!1,j=null;if(!this.shouldFireEvent||this.shouldFireEvent(A,F,n))for(;!x&&d<t&&j!==!1;){if(this.eventsToDieOn[A])this._listeners[A][d].apply(this,[F,n]);else try{j=this._listeners[A][d].apply(this,[F,n])}catch(B){v("jsPlumb: fire failed for event "+A+" : "+B)}d++,(this._listeners==null||this._listeners[A]==null)&&(x=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){let A=y.queue.pop();A&&y.fire.apply(y,A)},this.unbind=function(A,F){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof A=="string")delete this._listeners[A];else if(A.__jsPlumb){let n;for(let t in A.__jsPlumb)n=A.__jsPlumb[t],H(this._listeners[n]||[],A)}}else arguments.length===2&&H(this._listeners[A]||[],F);return this},this.getListener=function(A){return y._listeners[A]},this.setSuspendEvents=function(A){y.eventsSuspended=A},this.isSuspendEvents=function(){return y.eventsSuspended},this.silently=function(A){y.setSuspendEvents(!0);try{A()}catch(F){v("Cannot execute silent function "+F)}y.setSuspendEvents(!1)},this.cleanupListeners=function(){for(let A in y._listeners)y._listeners[A]=null}}return u}();c.EventGenerator=m}).call(typeof window<"u"?window:globalThis);(function(){let W=this;W.jsPlumbUtil.matchesSelector=function(c,U,et){et=et||c.parentNode;let Y=et.querySelectorAll(U);for(let K=0;K<Y.length;K++)if(Y[K]===c)return!0;return!1},W.jsPlumbUtil.consume=function(c,U){c.stopPropagation?c.stopPropagation():c.returnValue=!1,!U&&c.preventDefault&&c.preventDefault()},W.jsPlumbUtil.sizeElement=function(c,U,et,Y,K){c&&(c.style.height=K+"px",c.height=K,c.style.width=Y+"px",c.width=Y,c.style.left=U+"px",c.style.top=et+"px")}}).call(typeof window<"u"?window:globalThis);(function(){let W={deriveAnchor:function(Y,K,r,E){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[Y][K]}},c=this,U=function(Y){this.count=0,this.instance=Y,this.lists={},this.instance.addList=function(K,r){return this.listManager.addList(K,r)},this.instance.removeList=function(K){this.listManager.removeList(K)},this.instance.bind("manageElement",function(K){let r=this.instance.getSelector(K.el,"[jtk-scrollable-list]");for(let E=0;E<r.length;E++)this.addList(r[E])}.bind(this)),this.instance.bind("unmanageElement",function(K){this.removeList(K.el)}),this.instance.bind("connection",function(K,r){r==null&&(this._maybeUpdateParentList(K.source),this._maybeUpdateParentList(K.target))}.bind(this))};c.jsPlumbListManager=U,U.prototype={addList:function(Y,K){let r=this.instance.extend({},W);K=this.instance.extend(r,K||{});let E=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[E]=new et(this.instance,Y,K,E)},removeList:function(Y){let K=this.lists[Y._jsPlumbList];K&&(K.destroy(),delete this.lists[Y._jsPlumbList])},_maybeUpdateParentList:function(Y){let K=Y.parentNode,r=this.instance.getContainer();for(;K!=null&&K!==r;){if(K._jsPlumbList!=null&&this.lists[K._jsPlumbList]!=null){K._jsPlumbScrollHandler();return}K=K.parentNode}}};var et=function(Y,K,r,E){K._jsPlumbList=E;function a(w,S,L,s){return r.anchor?r.anchor:r.deriveAnchor(w,S,L,s)}function e(w,S,L,s){return r.deriveEndpoint?r.deriveEndpoint(w,S,L,s):r.endpoint?r.endpoint:L.type}function p(w){let S=w.parentNode,L=Y.getContainer();for(;S!=null&&S!==L;){if(Y.hasClass(S,"jtk-managed")){Y.recalculateOffsets(S);return}S=S.parentNode}}let P=function(w){let S=Y.getSelector(K,".jtk-managed"),L=Y.getId(K);for(var s=0;s<S.length;s++){if(S[s].offsetTop<K.scrollTop)S[s]._jsPlumbProxies||(S[s]._jsPlumbProxies=S[s]._jsPlumbProxies||[],Y.select({source:S[s]}).each(function(l){Y.proxyConnection(l,0,K,L,function(){return e("top",0,l.endpoints[0],l)},function(){return a("top",0,l.endpoints[0],l)}),S[s]._jsPlumbProxies.push([l,0])}),Y.select({target:S[s]}).each(function(l){Y.proxyConnection(l,1,K,L,function(){return e("top",1,l.endpoints[1],l)},function(){return a("top",1,l.endpoints[1],l)}),S[s]._jsPlumbProxies.push([l,1])}));else if(S[s].offsetTop>K.scrollTop+K.offsetHeight)S[s]._jsPlumbProxies||(S[s]._jsPlumbProxies=S[s]._jsPlumbProxies||[],Y.select({source:S[s]}).each(function(l){Y.proxyConnection(l,0,K,L,function(){return e("bottom",0,l.endpoints[0],l)},function(){return a("bottom",0,l.endpoints[0],l)}),S[s]._jsPlumbProxies.push([l,0])}),Y.select({target:S[s]}).each(function(l){Y.proxyConnection(l,1,K,L,function(){return e("bottom",1,l.endpoints[1],l)},function(){return a("bottom",1,l.endpoints[1],l)}),S[s]._jsPlumbProxies.push([l,1])}));else if(S[s]._jsPlumbProxies){for(let l=0;l<S[s]._jsPlumbProxies.length;l++)Y.unproxyConnection(S[s]._jsPlumbProxies[l][0],S[s]._jsPlumbProxies[l][1],L);delete S[s]._jsPlumbProxies}Y.revalidate(S[s])}p(K)};Y.setAttribute(K,"jtk-scrollable-list","true"),K._jsPlumbScrollHandler=P,Y.on(K,"scroll",P),P(),this.destroy=function(){Y.off(K,"scroll",P),delete K._jsPlumbScrollHandler;let w=Y.getSelector(K,".jtk-managed"),S=Y.getId(K);for(let L=0;L<w.length;L++)if(w[L]._jsPlumbProxies){for(let s=0;s<w[L]._jsPlumbProxies.length;s++)Y.unproxyConnection(w[L]._jsPlumbProxies[s][0],w[L]._jsPlumbProxies[s][1],S);delete w[L]._jsPlumbProxies}}}}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumbUtil,U=function(){return""+new Date().getTime()},et=function(s){if(s._jsPlumb.paintStyle&&s._jsPlumb.hoverPaintStyle){let l={};L.extend(l,s._jsPlumb.paintStyle),L.extend(l,s._jsPlumb.hoverPaintStyle),delete s._jsPlumb.hoverPaintStyle,l.gradient&&s._jsPlumb.paintStyle.fill&&delete l.gradient,s._jsPlumb.hoverPaintStyle=l}},Y=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],K=function(s,l,R,N){let H=s.getAttachedElements();if(H)for(let O=0,g=H.length;O<g;O++)(!N||N!==H[O])&&H[O].setHover(l,!0,R)},r=function(s){return s==null?null:s.split(" ")},E=function(s,l,R){for(let N in l)s[N]=R},a=function(s,l,R){if(s.getDefaultType){let N=s.getTypeDescriptor(),H={},O=s.getDefaultType(),g=c.merge({},O);E(H,O,"__default");for(let i=0,b=s._jsPlumb.types.length;i<b;i++){let h=s._jsPlumb.types[i];if(h!=="__default"){let D=s._jsPlumb.instance.getType(h,N);if(D!=null){let I=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],f=[];D.mergeStrategy==="override"?Array.prototype.push.apply(I,["events","overlays","cssClass"]):f.push("cssClass"),g=c.merge(g,D,f,I),E(H,D,h)}}}l&&(g=c.populate(g,l,"_")),s.applyType(g,R,H),R||s.repaint()}},e=W.jsPlumbUIComponent=function(s){c.EventGenerator.apply(this,arguments);let l=this,R=arguments,N=l.idPrefix,H=N+new Date().getTime();this._jsPlumb={instance:s._jsPlumb,parameters:s.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:s.beforeDetach,beforeDrop:s.beforeDrop,overlayPlacements:[],hoverClass:s.hoverClass||s._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(D,I,f){this._jsPlumb.typeCache[f]=this._jsPlumb.typeCache[f]||{},this._jsPlumb.typeCache[f][D]=I},this.getCachedTypeItem=function(D,I){return this._jsPlumb.typeCache[I]?this._jsPlumb.typeCache[I][D]:null},this.getId=function(){return H};let O=s.overlays||[],g={};if(this.defaultOverlayKeys){for(var i=0;i<this.defaultOverlayKeys.length;i++)Array.prototype.push.apply(O,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[i]]||[]);for(i=0;i<O.length;i++){let D=L.convertToFullOverlaySpec(O[i]);g[D[1].id]=D}}let b={overlays:g,parameters:s.parameters||{},scope:s.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return b},this.appendToDefaultType=function(D){for(let I in D)b[I]=D[I]},s.events)for(let D in s.events)l.bind(D,s.events[D]);this.clone=function(){let D=Object.create(this.constructor.prototype);return this.constructor.apply(D,R),D}.bind(this),this.isDetachAllowed=function(D){let I=!0;if(this._jsPlumb.beforeDetach)try{I=this._jsPlumb.beforeDetach(D)}catch(f){c.log("jsPlumb: beforeDetach callback failed",f)}return I},this.isDropAllowed=function(D,I,f,_,v,M,m){let u=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:D,targetId:I,scope:f,connection:_,dropEndpoint:v,source:M,target:m});if(this._jsPlumb.beforeDrop)try{u=this._jsPlumb.beforeDrop({sourceId:D,targetId:I,scope:f,connection:_,dropEndpoint:v,source:M,target:m})}catch(y){c.log("jsPlumb: beforeDrop callback failed",y)}return u};let h=[];this.setListenerComponent=function(D){for(let I=0;I<h.length;I++)h[I][3]=D}},p=function(s,l){let R=s._jsPlumb.types[l],N=s._jsPlumb.instance.getType(R,s.getTypeDescriptor());N!=null&&N.cssClass&&s.canvas&&s._jsPlumb.instance.removeClass(s.canvas,N.cssClass)};c.extend(W.jsPlumbUIComponent,c.EventGenerator,{getParameter:function(s){return this._jsPlumb.parameters[s]},setParameter:function(s,l){this._jsPlumb.parameters[s]=l},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(s){this._jsPlumb.parameters=s},getClass:function(){return L.getClass(this.canvas)},hasClass:function(s){return L.hasClass(this.canvas,s)},addClass:function(s){L.addClass(this.canvas,s)},removeClass:function(s){L.removeClass(this.canvas,s)},updateClasses:function(s,l){L.updateClasses(this.canvas,s,l)},setType:function(s,l,R){this.clearTypes(),this._jsPlumb.types=r(s)||[],a(this,l,R)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(s,l){a(this,s,l)},hasType:function(s){return this._jsPlumb.types.indexOf(s)!==-1},addType:function(s,l,R){let N=r(s),H=!1;if(N!=null){for(let O=0,g=N.length;O<g;O++)this.hasType(N[O])||(this._jsPlumb.types.push(N[O]),H=!0);H&&a(this,l,R)}},removeType:function(s,l,R){let N=r(s),H=!1,O=function(g){let i=this._jsPlumb.types.indexOf(g);return i!==-1?(p(this,i),this._jsPlumb.types.splice(i,1),!0):!1}.bind(this);if(N!=null){for(let g=0,i=N.length;g<i;g++)H=O(N[g])||H;H&&a(this,l,R)}},clearTypes:function(s,l){let R=this._jsPlumb.types.length;for(let N=0;N<R;N++)p(this,0),this._jsPlumb.types.splice(0,1);a(this,s,l)},toggleType:function(s,l,R){let N=r(s);if(N!=null){for(let H=0,O=N.length;H<O;H++){let g=this._jsPlumb.types.indexOf(N[H]);g!==-1?(p(this,g),this._jsPlumb.types.splice(g,1)):this._jsPlumb.types.push(N[H])}a(this,l,R)}},applyType:function(s,l){if(this.setPaintStyle(s.paintStyle,l),this.setHoverPaintStyle(s.hoverPaintStyle,l),s.parameters)for(let R in s.parameters)this.setParameter(R,s.parameters[R]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(s,l){this._jsPlumb.paintStyle=s,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,et(this),l||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(s,l){this._jsPlumb.hoverPaintStyle=s,et(this),l||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(s){(s||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(s,l,R){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=s;let N=s?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[N](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[N](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=s?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(R=R||U(),this.repaint({timestamp:R,recalc:!1}))),this.getAttachedElements&&!l&&K(this,s,U(),this)}}});let P=0,w=function(){let s=P+1;return P++,s},S=W.jsPlumbInstance=function(s){this.version="2.12.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},s&&L.extend(this.Defaults,s),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},c.EventGenerator.apply(this);let l=this,R=w(),N=l.bind,H={},O=1,g=function(o){if(o==null)return null;if(o.nodeType===3||o.nodeType===8)return{el:o,text:!0};{let k=l.getElement(o);return{el:k,id:c.isString(o)&&k==null?o:ht(k)}}};this.getInstanceIndex=function(){return R},this.setZoom=function(o,k){return O=o,l.fire("zoom",O),k&&l.repaintEverything(),!0},this.getZoom=function(){return O};for(let o in this.Defaults)H[o]=this.Defaults[o];let i,b=[];this.unbindContainer=function(){if(i!=null&&b.length>0)for(let o=0;o<b.length;o++)l.off(i,b[o][0],b[o][1])},this.setContainer=function(o){this.unbindContainer(),o=this.getElement(o),this.select().each(function(J){J.moveParent(o)}),this.selectEndpoints().each(function(J){J.moveParent(o)});let k=i;i=o,b.length=0;let C={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},T=function(J,st,nt){let dt=st.srcElement||st.target,at=(dt&&dt.parentNode?dt.parentNode._jsPlumb:null)||(dt?dt._jsPlumb:null)||(dt&&dt.parentNode&&dt.parentNode.parentNode?dt.parentNode.parentNode._jsPlumb:null);if(at){at.fire(J,at,st);let vt=nt&&C[nt+J]||J;l.fire(vt,at.component||at,st)}},G=function(J,st,nt){b.push([J,nt]),l.on(i,J,st,nt)},q=function(J){G(J,".jtk-connector",function(st){T(J,st)}),G(J,".jtk-endpoint",function(st){T(J,st,"endpoint")}),G(J,".jtk-overlay",function(st){T(J,st)})};for(let J=0;J<Y.length;J++)q(Y[J]);for(let J in v){let st=v[J].el;st.parentNode===k&&(k.removeChild(st),i.appendChild(st))}},this.getContainer=function(){return i},this.bind=function(o,k){o==="ready"&&D?k():N.apply(l,[o,k])},l.importDefaults=function(o){for(let k in o)l.Defaults[k]=o[k];return o.Container&&l.setContainer(o.Container),l},l.restoreDefaults=function(){return l.Defaults=L.extend({},H),l};var h=null,D=!1,I=[],f={},_={},v={},M={},m={},u=!1,y=[],A=!1,F=null,n=this.Defaults.Scope,t=1,d=function(){return""+t++},x=function(o,k){i?i.appendChild(o):k?this.getElement(k).appendChild(o):this.appendToRoot(o)}.bind(this),j=function(o,k,C,T){if(!A){let G=ht(o),q,J=l.getDragManager();J&&(q=J.getElementsForDraggable(G)),C==null&&(C=U());let st=It({elId:G,offset:k,recalc:!1,timestamp:C});if(q&&st&&st.o)for(let nt in q)It({elId:q[nt].id,offset:{left:st.o.left+q[nt].offset.left,top:st.o.top+q[nt].offset.top},recalc:!1,timestamp:C});if(l.anchorManager.redraw(G,k,C,null,T),q)for(let nt in q)l.anchorManager.redraw(q[nt].id,k,C,q[nt].offset,T,!0)}},B=function(o){return _[o]},z=function(o,k){let C=o.scope.split(/\s/),T=k.scope.split(/\s/);for(let G=0;G<C.length;G++)for(let q=0;q<T.length;q++)if(T[q]===C[G])return!0;return!1},X=function(o,k){let C=L.extend({},o);for(let T in k)k[T]&&(C[T]=k[T]);return C},V=function(o,k){let C=L.extend({},o);if(k&&L.extend(C,k),C.source&&(C.source.endpoint?C.sourceEndpoint=C.source:C.source=l.getElement(C.source)),C.target&&(C.target.endpoint?C.targetEndpoint=C.target:C.target=l.getElement(C.target)),o.uuids&&(C.sourceEndpoint=B(o.uuids[0]),C.targetEndpoint=B(o.uuids[1])),C.sourceEndpoint&&C.sourceEndpoint.isFull()){c.log(l,"could not add connection; source endpoint is full");return}if(C.targetEndpoint&&C.targetEndpoint.isFull()){c.log(l,"could not add connection; target endpoint is full");return}if(!C.type&&C.sourceEndpoint&&(C.type=C.sourceEndpoint.connectionType),C.sourceEndpoint&&C.sourceEndpoint.connectorOverlays){C.overlays=C.overlays||[];for(let q=0,J=C.sourceEndpoint.connectorOverlays.length;q<J;q++)C.overlays.push(C.sourceEndpoint.connectorOverlays[q])}C.sourceEndpoint&&C.sourceEndpoint.scope&&(C.scope=C.sourceEndpoint.scope),!C["pointer-events"]&&C.sourceEndpoint&&C.sourceEndpoint.connectorPointerEvents&&(C["pointer-events"]=C.sourceEndpoint.connectorPointerEvents);let T=function(q,J,st){let nt=X(J,{anchor:C.anchors?C.anchors[st]:C.anchor,endpoint:C.endpoints?C.endpoints[st]:C.endpoint,paintStyle:C.endpointStyles?C.endpointStyles[st]:C.endpointStyle,hoverPaintStyle:C.endpointHoverStyles?C.endpointHoverStyles[st]:C.endpointHoverStyle});return l.addEndpoint(q,nt)},G=function(q,J,st,nt){if(C[q]&&!C[q].endpoint&&!C[q+"Endpoint"]&&!C.newConnection){let dt=ht(C[q]),at=st[dt];if(at=at?at[nt]:null,at){if(!at.enabled)return!1;let vt=L.extend({},at.def);delete vt.label;let jt=at.endpoint!=null&&at.endpoint._jsPlumb?at.endpoint:T(C[q],vt,J);if(jt.isFull())return!1;C[q+"Endpoint"]=jt,!C.scope&&vt.scope&&(C.scope=vt.scope),at.uniqueEndpoint?at.endpoint?jt.finalEndpoint=at.endpoint:(at.endpoint=jt,jt.setDeleteOnEmpty(!1)):jt.setDeleteOnEmpty(!0),J===0&&at.def.connectorOverlays&&(C.overlays=C.overlays||[],Array.prototype.push.apply(C.overlays,at.def.connectorOverlays))}}};if(G("source",0,this.sourceEndpointDefinitions,C.type||"default")!==!1&&G("target",1,this.targetEndpointDefinitions,C.type||"default")!==!1)return C.sourceEndpoint&&C.targetEndpoint&&(z(C.sourceEndpoint,C.targetEndpoint)||(C=null)),C}.bind(l),ot=function(o){let k=l.Defaults.ConnectionType||l.getDefaultConnectionType();o._jsPlumb=l,o.newConnection=ot,o.newEndpoint=pt,o.endpointsByUUID=_,o.endpointsByElement=f,o.finaliseConnection=ct,o.id="con_"+d();let C=new k(o);return C.isDetachable()&&(C.endpoints[0].initDraggable("_jsPlumbSource"),C.endpoints[1].initDraggable("_jsPlumbTarget")),C},ct=l.finaliseConnection=function(o,k,C,T){if(k=k||{},o.suspendedEndpoint||I.push(o),o.pending=null,o.endpoints[0].isTemporarySource=!1,T!==!1&&l.anchorManager.newConnection(o),j(o.source),!k.doNotFireConnectionEvent&&k.fireEvent!==!1){let G={connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]};l.fire("connection",G,C)}},pt=function(o,k){let C=l.Defaults.EndpointType||L.Endpoint,T=L.extend({},o);T._jsPlumb=l,T.newConnection=ot,T.newEndpoint=pt,T.endpointsByUUID=_,T.endpointsByElement=f,T.fireDetachEvent=Z,T.elementId=k||ht(T.source);let G=new C(T);return G.id="ep_"+d(),Yt(T.elementId,T.source),L.headless||l.getDragManager().endpointAdded(T.source,k),G},$=function(o,k,C){let T=f[o];if(T&&T.length)for(let G=0,q=T.length;G<q;G++){for(let J=0,st=T[G].connections.length;J<st;J++)if(k(T[G].connections[J]))return;C&&C(T[G])}},rt=function(o,k,C){k=k==="block";let T=null;C&&(T=function(q){q.setVisible(k,!0,!0)});let G=g(o);$(G.id,function(q){if(k&&C){let J=q.sourceId===G.id?1:0;q.endpoints[J].isVisible()&&q.setVisible(!0)}else q.setVisible(k)},T)},ft=function(o,k){let C=null;k&&(C=function(T){let G=T.isVisible();T.setVisible(!G)}),$(o,function(T){let G=T.isVisible();T.setVisible(!G)},C)},ut=function(o){let k=M[o];return k?{o:k,s:y[o]}:It({elId:o})},ht=function(o,k,C){if(c.isString(o))return o;if(o==null)return null;let T=l.getAttribute(o,"id");return(!T||T==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?T=k:(arguments.length===1||arguments.length===3&&!arguments[2])&&(T="jsPlumb_"+R+"_"+d()),C||l.setAttribute(o,"id",T)),T};this.setConnectionBeingDragged=function(o){u=o},this.isConnectionBeingDragged=function(){return u},this.getManagedElements=function(){return v},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(o,k,C){C=C||{};let T=L.extend({},C);L.extend(T,k),T.endpoint=T.endpoint||l.Defaults.Endpoint,T.paintStyle=T.paintStyle||l.Defaults.EndpointStyle;let G=[],q=c.isArray(o)||o.length!=null&&!c.isString(o)?o:[o];for(let J=0,st=q.length;J<st;J++){T.source=l.getElement(q[J]),ae(T.source);let nt=ht(T.source),dt=pt(T,nt),at=Yt(nt,T.source).info.o;c.addToList(f,nt,dt),A||dt.paint({anchorLoc:dt.anchor.compute({xy:[at.left,at.top],wh:y[nt],element:dt,timestamp:F}),timestamp:F}),G.push(dt)}return G.length===1?G[0]:G},this.addEndpoints=function(o,k,C){let T=[];for(let G=0,q=k.length;G<q;G++){let J=l.addEndpoint(o,k[G],C);c.isArray(J)?Array.prototype.push.apply(T,J):T.push(J)}return T},this.animate=function(o,k,C){if(!this.animationSupported)return!1;C=C||{};let T=l.getElement(o),G=ht(T),q=L.animEvents.step,J=L.animEvents.complete;C[q]=c.wrap(C[q],function(){l.revalidate(G)}),C[J]=c.wrap(C[J],function(){l.revalidate(G)}),l.doAnimate(T,k,C)},this.checkCondition=function(o,k){let C=l.getListener(o),T=!0;if(C&&C.length>0){let G=Array.prototype.slice.call(arguments,1);try{for(let q=0,J=C.length;q<J;q++)T=T&&C[q].apply(C[q],G)}catch(q){c.log(l,"cannot check condition ["+o+"]"+q)}}return T},this.connect=function(o,k){let C=V(o,k),T;if(C){if(C.source==null&&C.sourceEndpoint==null){c.log("Cannot establish connection - source does not exist");return}if(C.target==null&&C.targetEndpoint==null){c.log("Cannot establish connection - target does not exist");return}ae(C.source),T=ot(C),ct(T,C)}return T};let Ct=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],mt=function(o,k,C,T){let G,q=Ct[C],J=o[q.elId];o[q.el];let st,nt,dt=o.endpoints[C],at={index:C,originalSourceId:C===0?J:o.sourceId,newSourceId:o.sourceId,originalTargetId:C===1?J:o.targetId,newTargetId:o.targetId,connection:o};if(k.constructor===L.Endpoint)G=k,G.addConnection(o),k=G.element;else if(st=ht(k),nt=this[q.epDefs][st],st===o[q.elId])G=null;else if(nt)for(let vt in nt){if(!nt[vt].enabled)return;G=nt[vt].endpoint!=null&&nt[vt].endpoint._jsPlumb?nt[vt].endpoint:this.addEndpoint(k,nt[vt].def),nt[vt].uniqueEndpoint&&(nt[vt].endpoint=G),G.addConnection(o)}else G=o.makeEndpoint(C===0,k,st);return G!=null&&(dt.detachFromConnection(o),o.endpoints[C]=G,o[q.el]=G.element,o[q.elId]=G.elementId,at[C===0?"newSourceId":"newTargetId"]=G.elementId,Q(at),T||o.repaint()),at.element=k,at}.bind(this);this.setSource=function(o,k,C){let T=mt(o,k,0,C);this.anchorManager.sourceChanged(T.originalSourceId,T.newSourceId,o,T.el)},this.setTarget=function(o,k,C){let T=mt(o,k,1,C);this.anchorManager.updateOtherEndpoint(T.originalSourceId,T.originalTargetId,T.newTargetId,o)},this.deleteEndpoint=function(o,k,C){let T=typeof o=="string"?_[o]:o;return T&&l.deleteObject({endpoint:T,dontUpdateHover:k,deleteAttachedObjects:C}),l},this.deleteEveryEndpoint=function(){let o=l.setSuspendDrawing(!0);for(let C in f){let T=f[C];if(T&&T.length)for(let G=0,q=T.length;G<q;G++)l.deleteEndpoint(T[G],!0)}f={},v={},_={},M={},m={},l.anchorManager.reset();let k=l.getDragManager();return k&&k.reset(),o||l.setSuspendDrawing(!1),l};var Z=function(o,k,C){let T=l.Defaults.ConnectionType||l.getDefaultConnectionType(),G=o.constructor===T,q=G?{connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]}:o;k&&l.fire("connectionDetached",q,C),l.fire("internal.connectionDetached",q,C),l.anchorManager.connectionDetached(q)},Q=l.fireMoveEvent=function(o,k){l.fire("connectionMoved",o,k)};this.unregisterEndpoint=function(o){o._jsPlumb.uuid&&(_[o._jsPlumb.uuid]=null),l.anchorManager.deleteEndpoint(o);for(let k in f){let C=f[k];if(C){let T=[];for(let G=0,q=C.length;G<q;G++)C[G]!==o&&T.push(C[G]);f[k]=T}f[k].length<1&&delete f[k]}};let tt="isDetachAllowed",lt="beforeDetach",yt="checkCondition";this.deleteConnection=function(o,k){return o!=null&&(k=k||{},k.force||c.functionChain(!0,!1,[[o.endpoints[0],tt,[o]],[o.endpoints[1],tt,[o]],[o,tt,[o]],[l,yt,[lt,o]]]))?(o.setHover(!1),Z(o,!o.pending&&k.fireEvent!==!1,k.originalEvent),o.endpoints[0].detachFromConnection(o),o.endpoints[1].detachFromConnection(o),c.removeWithFunction(I,function(C){return o.id===C.id}),o.cleanup(),o.destroy(),!0):!1},this.deleteEveryConnection=function(o){o=o||{};let k=I.length,C=0;return l.batch(function(){for(let T=0;T<k;T++)C+=l.deleteConnection(I[0],o)?1:0}),C},this.deleteConnectionsForElement=function(o,k){k=k||{},o=l.getElement(o);let C=ht(o),T=f[C];if(T&&T.length)for(let G=0,q=T.length;G<q;G++)T[G].deleteEveryConnection(k);return l},this.deleteObject=function(o){let k={endpoints:{},connections:{},endpointCount:0,connectionCount:0},C=o.deleteAttachedObjects!==!1,T=function(J){J!=null&&k.connections[J.id]==null&&(!o.dontUpdateHover&&J._jsPlumb!=null&&J.setHover(!1),k.connections[J.id]=J,k.connectionCount++)},G=function(J){if(J!=null&&k.endpoints[J.id]==null&&(!o.dontUpdateHover&&J._jsPlumb!=null&&J.setHover(!1),k.endpoints[J.id]=J,k.endpointCount++,C))for(let st=0;st<J.connections.length;st++){let nt=J.connections[st];T(nt)}};o.connection?T(o.connection):G(o.endpoint);for(let J in k.connections){var q=k.connections[J];if(q._jsPlumb){c.removeWithFunction(I,function(nt){return q.id===nt.id}),Z(q,o.fireEvent===!1?!1:!q.pending,o.originalEvent);let st=o.deleteAttachedObjects==null?null:!o.deleteAttachedObjects;q.endpoints[0].detachFromConnection(q,null,st),q.endpoints[1].detachFromConnection(q,null,st),q.cleanup(!0),q.destroy(!0)}}for(let J in k.endpoints){let st=k.endpoints[J];st._jsPlumb&&(l.unregisterEndpoint(st),st.cleanup(!0),st.destroy(!0))}return k};let Dt=function(o,k,C,T){for(let G=0,q=o.length;G<q;G++)o[G][k].apply(o[G],C);return T(o)},Mt=function(o,k,C){let T=[];for(let G=0,q=o.length;G<q;G++)T.push([o[G][k].apply(o[G],C),o[G]]);return T},Bt=function(o,k,C){return function(){return Dt(o,k,arguments,C)}},le=function(o,k){return function(){return Mt(o,k,arguments)}},zt=function(o,k){let C=[];if(o)if(typeof o=="string"){if(o==="*")return o;C.push(o)}else if(k)C=o;else if(o.length)for(let T=0,G=o.length;T<G;T++)C.push(g(o[T]).id);else C.push(g(o).id);return C},qt=function(o,k,C){return o==="*"?!0:o.length>0?o.indexOf(k)!==-1:!C};this.getConnections=function(o,k){o?o.constructor===String&&(o={scope:o}):o={};let C=o.scope||l.getDefaultScope(),T=zt(C,!0),G=zt(o.source),q=zt(o.target),J=!k&&T.length>1?{}:[],st=function(nt,dt){if(!k&&T.length>1){let at=J[nt];at==null&&(at=J[nt]=[]),at.push(dt)}else J.push(dt)};for(let nt=0,dt=I.length;nt<dt;nt++){let at=I[nt],vt=at.proxies&&at.proxies[0]?at.proxies[0].originalEp.elementId:at.sourceId,jt=at.proxies&&at.proxies[1]?at.proxies[1].originalEp.elementId:at.targetId;qt(T,at.scope)&&qt(G,vt)&&qt(q,jt)&&st(at.scope,at)}return J};let Pe=function(o,k){return function(C){for(let T=0,G=o.length;T<G;T++)C(o[T]);return k(o)}},de=function(o){return function(k){return o[k]}},Ce=function(o,k){let C={length:o.length,each:Pe(o,k),get:de(o)},T=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],G=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],q,J;for(q=0,J=T.length;q<J;q++)C[T[q]]=Bt(o,T[q],k);for(q=0,J=G.length;q<J;q++)C[G[q]]=le(o,G[q]);return C},Ht=function(o){let k=Ce(o,Ht);return L.extend(k,{setDetachable:Bt(o,"setDetachable",Ht),setReattach:Bt(o,"setReattach",Ht),setConnector:Bt(o,"setConnector",Ht),delete:function(){for(let C=0,T=o.length;C<T;C++)l.deleteConnection(o[C])},isDetachable:le(o,"isDetachable"),isReattach:le(o,"isReattach")})},fe=function(o){let k=Ce(o,fe);return L.extend(k,{setEnabled:Bt(o,"setEnabled",fe),setAnchor:Bt(o,"setAnchor",fe),isEnabled:le(o,"isEnabled"),deleteEveryConnection:function(){for(let C=0,T=o.length;C<T;C++)o[C].deleteEveryConnection()},delete:function(){for(let C=0,T=o.length;C<T;C++)l.deleteEndpoint(o[C])}})};this.select=function(o){return o=o||{},o.scope=o.scope||"*",Ht(o.connections||l.getConnections(o,!0))},this.selectEndpoints=function(o){o=o||{},o.scope=o.scope||"*";let k=!o.element&&!o.source&&!o.target,C=k?"*":zt(o.element),T=k?"*":zt(o.source),G=k?"*":zt(o.target),q=zt(o.scope,!0),J=[];for(let st in f){let nt=qt(C,st,!0),dt=qt(T,st,!0),at=T!=="*",vt=qt(G,st,!0),jt=G!=="*";if(nt||dt||vt){t:for(let Rt=0,xe=f[st].length;Rt<xe;Rt++){let ue=f[st][Rt];if(qt(q,ue.scope,!0)){let Wt=at&&T.length>0&&!ue.isSource,Ee=jt&&G.length>0&&!ue.isTarget;if(Wt||Ee)continue t;J.push(ue)}}}}return fe(J)},this.getAllConnections=function(){return I},this.getDefaultScope=function(){return n},this.getEndpoint=B,this.getEndpoints=function(o){return f[g(o).id]||[]},this.getDefaultEndpointType=function(){return L.Endpoint},this.getDefaultConnectionType=function(){return L.Connection},this.getId=ht,this.draw=j,this.info=g,this.appendElement=x;let re=!1;this.isHoverSuspended=function(){return re},this.setHoverSuspended=function(o){re=o},this.hide=function(o,k){return rt(o,"none",k),l},this.idstamp=d;var ae=function(o){if(!i&&o){let k=l.getElement(o);k.offsetParent&&l.setContainer(k.offsetParent)}};let Tt=function(){l.Defaults.Container&&l.setContainer(l.Defaults.Container)};var Yt=l.manage=function(o,k,C){return v[o]||(v[o]={el:k,endpoints:[],connections:[]},v[o].info=It({elId:o,timestamp:F}),l.addClass(k,"jtk-managed"),C||l.fire("manageElement",{id:o,info:v[o].info,el:k})),v[o]};l.unmanage=function(o){if(v[o]){let k=v[o].el;l.removeClass(k,"jtk-managed"),delete v[o],l.fire("unmanageElement",{id:o,el:k})}};var It=function(o){let k=o.timestamp,C=o.recalc,T=o.offset,G=o.elId,q;return A&&!k&&(k=F),!C&&k&&k===m[G]?{o:o.offset||M[G],s:y[G]}:(C||!T&&M[G]==null?(q=v[G]?v[G].el:null,q!=null&&(y[G]=l.getSize(q),M[G]=l.getOffset(q),m[G]=k)):(M[G]=T||M[G],y[G]==null&&(q=v[G].el,q!=null&&(y[G]=l.getSize(q))),m[G]=k),M[G]&&!M[G].right&&(M[G].right=M[G].left+y[G][0],M[G].bottom=M[G].top+y[G][1],M[G].width=y[G][0],M[G].height=y[G][1],M[G].centerx=M[G].left+M[G].width/2,M[G].centery=M[G].top+M[G].height/2),{o:M[G],s:y[G]})};this.updateOffset=It,this.init=function(){D||(Tt(),l.anchorManager=new W.jsPlumb.AnchorManager({jsPlumbInstance:l}),D=!0,l.fire("ready",l))}.bind(this),this.log=h,this.jsPlumbUIComponent=e,this.makeAnchor=function(){let o,k=function(q,J){if(W.jsPlumb.Anchors[q])return new W.jsPlumb.Anchors[q](J);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+q+"'"}};if(arguments.length===0)return null;let C=arguments[0],T=arguments[1],G=null;if(C.compute&&C.getOrientation)return C;if(typeof C=="string")G=k(arguments[0],{elementId:T,jsPlumbInstance:l});else if(c.isArray(C))if(c.isArray(C[0])||c.isString(C[0]))C.length===2&&c.isObject(C[1])?c.isString(C[0])?(o=W.jsPlumb.extend({elementId:T,jsPlumbInstance:l},C[1]),G=k(C[0],o)):(o=W.jsPlumb.extend({elementId:T,jsPlumbInstance:l,anchors:C[0]},C[1]),G=new W.jsPlumb.DynamicAnchor(o)):G=new L.DynamicAnchor({anchors:C,selector:null,elementId:T,jsPlumbInstance:l});else{let q={x:C[0],y:C[1],orientation:C.length>=4?[C[2],C[3]]:[0,0],offsets:C.length>=6?[C[4],C[5]]:[0,0],elementId:T,jsPlumbInstance:l,cssClass:C.length===7?C[6]:null};G=new W.jsPlumb.Anchor(q),G.clone=function(){return new W.jsPlumb.Anchor(q)}}return G.id||(G.id="anchor_"+d()),G},this.makeAnchors=function(o,k,C){let T=[];for(let G=0,q=o.length;G<q;G++)typeof o[G]=="string"?T.push(W.jsPlumb.Anchors[o[G]]({elementId:k,jsPlumbInstance:C})):c.isArray(o[G])&&T.push(l.makeAnchor(o[G],k,C));return T},this.makeDynamicAnchor=function(o,k){return new W.jsPlumb.DynamicAnchor({anchors:o,selector:k,elementId:null,jsPlumbInstance:l})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};let te=function(o,k,C,T,G){let q=o.target||o.srcElement,J=!1,st=T.getSelector(k,C);for(let nt=0;nt<st.length;nt++)if(st[nt]===q){J=!0;break}return G?!J:J},ee=function(o,k,C,T,G){let q=new e(k),J=k._jsPlumb.EndpointDropHandler({jsPlumb:l,enabled:function(){return o.def.enabled},isFull:function(){let nt=l.select({target:o.id}).length;return o.def.maxConnections>0&&nt>=o.def.maxConnections},element:o.el,elementId:o.id,isSource:T,isTarget:G,addClass:function(nt){l.addClass(o.el,nt)},removeClass:function(nt){l.removeClass(o.el,nt)},onDrop:function(nt){nt.endpoints[0].anchor.unlock()},isDropAllowed:function(){return q.isDropAllowed.apply(q,arguments)},isRedrop:function(nt){return nt.suspendedElement!=null&&nt.suspendedEndpoint!=null&&nt.suspendedEndpoint.element===o.el},getEndpoint:function(nt){let dt=o.def.endpoint;if(dt==null||dt._jsPlumb==null){let at=l.deriveEndpointAndAnchorSpec(nt.getType().join(" "),!0),vt=at.endpoints?W.jsPlumb.extend(k,{endpoint:o.def.def.endpoint||at.endpoints[1]}):k;at.anchors&&(vt=W.jsPlumb.extend(vt,{anchor:o.def.def.anchor||at.anchors[1]})),dt=l.addEndpoint(o.el,vt),dt._mtNew=!0}if(k.uniqueEndpoint&&(o.def.endpoint=dt),dt.setDeleteOnEmpty(!0),nt.isDetachable()&&dt.initDraggable(),dt.anchor.positionFinder!=null){let at=l.getUIPosition(arguments,l.getZoom()),vt=l.getOffset(o.el),jt=l.getSize(o.el),Rt=at==null?[0,0]:dt.anchor.positionFinder(at,vt,jt,dt.anchor.constructorParams);dt.anchor.x=Rt[0],dt.anchor.y=Rt[1]}return dt},maybeCleanup:function(nt){nt._mtNew&&nt.connections.length===0?l.deleteObject({endpoint:nt}):delete nt._mtNew}}),st=W.jsPlumb.dragEvents.drop;return C.scope=C.scope||k.scope||l.Defaults.Scope,C[st]=c.wrap(C[st],J,!0),C.rank=k.rank||0,G&&(C[W.jsPlumb.dragEvents.over]=function(){return!0}),k.allowLoopback===!1&&(C.canDrop=function(nt){return nt.getDragElement()._jsPlumbRelatedElement!==o.el}),l.initDroppable(o.el,C,"internal"),J};this.makeTarget=function(o,k,C){let T=W.jsPlumb.extend({_jsPlumb:this},C);W.jsPlumb.extend(T,k);let G=T.maxConnections||-1,q=function(st){let nt=g(st),dt=nt.id,at=W.jsPlumb.extend({},T.dropOptions||{}),vt=T.connectionType||"default";this.targetEndpointDefinitions[dt]=this.targetEndpointDefinitions[dt]||{},ae(dt),nt.el._isJsPlumbGroup&&at.rank==null&&(at.rank=-1);let jt={def:W.jsPlumb.extend({},T),uniqueEndpoint:T.uniqueEndpoint,maxConnections:G,enabled:!0};T.createEndpoint&&(jt.uniqueEndpoint=!0,jt.endpoint=l.addEndpoint(st,jt.def),jt.endpoint.setDeleteOnEmpty(!1)),nt.def=jt,this.targetEndpointDefinitions[dt][vt]=jt,ee(nt,T,at,T.isSource===!0,!0),nt.el._katavorioDrop[nt.el._katavorioDrop.length-1].targetDef=jt}.bind(this),J=o.length&&o.constructor!==String?o:[o];for(let st=0,nt=J.length;st<nt;st++)q(J[st]);return this},this.unmakeTarget=function(o,k){let C=g(o);return l.destroyDroppable(C.el,"internal"),k||delete this.targetEndpointDefinitions[C.id],this},this.makeSource=function(o,k,C){let T=W.jsPlumb.extend({_jsPlumb:this},C);W.jsPlumb.extend(T,k);let G=T.connectionType||"default",q=l.deriveEndpointAndAnchorSpec(G);T.endpoint=T.endpoint||q.endpoints[0],T.anchor=T.anchor||q.anchors[0];let J=T.maxConnections||-1,st=T.onMaxConnections,nt=function(at){let vt=at.id,jt=this.getElement(at.el);this.sourceEndpointDefinitions[vt]=this.sourceEndpointDefinitions[vt]||{},ae(vt);let Rt={def:W.jsPlumb.extend({},T),uniqueEndpoint:T.uniqueEndpoint,maxConnections:J,enabled:!0};T.createEndpoint&&(Rt.uniqueEndpoint=!0,Rt.endpoint=l.addEndpoint(o,Rt.def),Rt.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[vt][G]=Rt,at.def=Rt;let xe=W.jsPlumb.dragEvents.stop,ue=W.jsPlumb.dragEvents.drag,Wt=W.jsPlumb.extend({},T.dragOptions||{}),Ee=Wt.drag,Ne=Wt.stop,Lt=null,Se=!1;Wt.scope=Wt.scope||T.scope,Wt[ue]=c.wrap(Wt[ue],function(){Ee&&Ee.apply(this,arguments),Se=!1}),Wt[xe]=c.wrap(Wt[xe],function(){if(Ne&&Ne.apply(this,arguments),this.currentlyDragging=!1,Lt._jsPlumb!=null){let Vt=T.anchor||this.Defaults.Anchor,Ft=Lt.anchor,De=Lt.connections[0],Zt=this.makeAnchor(Vt,vt,this),Qt=Lt.element;if(Zt.positionFinder!=null){let ne=l.getOffset(Qt),pe=this.getSize(Qt),_e={left:ne.left+Ft.x*pe[0],top:ne.top+Ft.y*pe[1]},ve=Zt.positionFinder(_e,ne,pe,Zt.constructorParams);Zt.x=ve[0],Zt.y=ve[1]}Lt.setAnchor(Zt,!0),Lt.repaint(),this.repaint(Lt.elementId),De!=null&&this.repaint(De.targetId)}}.bind(this));let Re=function(Vt){if(Vt.which===3||Vt.button===2)return;let Ft=this.sourceEndpointDefinitions[vt][G];if(!Ft.enabled||(vt=this.getId(this.getElement(at.el)),T.filter&&(c.isString(T.filter)?te(Vt,at.el,T.filter,this,T.filterExclude):T.filter(Vt,at.el))===!1))return;let De=this.select({source:vt}).length;if(Ft.maxConnections>=0&&De>=Ft.maxConnections)return st&&st({element:at.el,maxConnections:J},Vt),!1;let Zt=W.jsPlumb.getPositionOnElement(Vt,jt,O),Qt={};W.jsPlumb.extend(Qt,Ft.def),Qt.isTemporarySource=!0,Qt.anchor=[Zt[0],Zt[1],0,0],Qt.dragOptions=Wt,Ft.def.scope&&(Qt.scope=Ft.def.scope),Lt=this.addEndpoint(vt,Qt),Se=!0,Lt.setDeleteOnEmpty(!0),Ft.uniqueEndpoint&&(Ft.endpoint?Lt.finalEndpoint=Ft.endpoint:(Ft.endpoint=Lt,Lt.setDeleteOnEmpty(!1)));let ne=function(){l.off(Lt.canvas,"mouseup",ne),l.off(at.el,"mouseup",ne),Se&&(Se=!1,l.deleteEndpoint(Lt))};l.on(Lt.canvas,"mouseup",ne),l.on(at.el,"mouseup",ne);let pe={};if(Ft.def.extract)for(let _e in Ft.def.extract){let ve=(Vt.srcElement||Vt.target).getAttribute(_e);ve&&(pe[Ft.def.extract[_e]]=ve)}l.trigger(Lt.canvas,"mousedown",Vt,pe),c.consume(Vt)}.bind(this);this.on(at.el,"mousedown",Re),Rt.trigger=Re,T.filter&&(c.isString(T.filter)||c.isFunction(T.filter))&&l.setDragFilter(at.el,T.filter);let Ve=W.jsPlumb.extend({},T.dropOptions||{});ee(at,T,Ve,!0,T.isTarget===!0)}.bind(this),dt=o.length&&o.constructor!==String?o:[o];for(let at=0,vt=dt.length;at<vt;at++)nt(g(dt[at]));return this},this.unmakeSource=function(o,k,C){let T=g(o);l.destroyDroppable(T.el,"internal");let G=this.sourceEndpointDefinitions[T.id];if(G){for(let q in G)if(k==null||k===q){let J=G[q].trigger;J&&l.off(T.el,"mousedown",J),C||delete this.sourceEndpointDefinitions[T.id][q]}}return this},this.unmakeEverySource=function(){for(let o in this.sourceEndpointDefinitions)l.unmakeSource(o,null,!0);return this.sourceEndpointDefinitions={},this};let it=function(o,k,C){k=c.isArray(k)?k:[k];let T=ht(o);C=C||"default";for(let G=0;G<k.length;G++){let q=this[k[G]][T];if(q&&q[C])return q[C].def.scope||this.Defaults.Scope}}.bind(this),_t=function(o,k,C,T){C=c.isArray(C)?C:[C];let G=ht(o);T=T||"default";for(let q=0;q<C.length;q++){let J=this[C[q]][G];J&&J[T]&&(J[T].def.scope=k)}}.bind(this);this.getScope=function(o,k){return it(o,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(o){return it(o,"sourceEndpointDefinitions")},this.getTargetScope=function(o){return it(o,"targetEndpointDefinitions")},this.setScope=function(o,k,C){this.setSourceScope(o,k,C),this.setTargetScope(o,k,C)},this.setSourceScope=function(o,k,C){_t(o,k,"sourceEndpointDefinitions",C),this.setDragScope(o,k)},this.setTargetScope=function(o,k,C){_t(o,k,"targetEndpointDefinitions",C),this.setDropScope(o,k)},this.unmakeEveryTarget=function(){for(let o in this.targetEndpointDefinitions)l.unmakeTarget(o,!0);return this.targetEndpointDefinitions={},this};let Pt=function(o,k,C,T,G){let q=o==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,J,st,nt;if(G=G||"default",k.length&&!c.isString(k)){J=[];for(let dt=0,at=k.length;dt<at;dt++)st=g(k[dt]),q[st.id]&&q[st.id][G]&&(J[dt]=q[st.id][G].enabled,nt=T?!J[dt]:C,q[st.id][G].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}else{st=g(k);let dt=st.id;q[dt]&&q[dt][G]&&(J=q[dt][G].enabled,nt=T?!J:C,q[dt][G].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}return J}.bind(this),gt=function(o,k){if(c.isString(o)||!o.length)return k.apply(this,[o]);if(o.length)return k.apply(this,[o[0]])}.bind(this);this.toggleSourceEnabled=function(o,k){return Pt("source",o,null,!0,k),this.isSourceEnabled(o,k)},this.setSourceEnabled=function(o,k,C){return Pt("source",o,k,null,C)},this.isSource=function(o,k){return k=k||"default",gt(o,function(C){let T=this.sourceEndpointDefinitions[g(C).id];return T!=null&&T[k]!=null}.bind(this))},this.isSourceEnabled=function(o,k){return k=k||"default",gt(o,function(C){let T=this.sourceEndpointDefinitions[g(C).id];return T&&T[k]&&T[k].enabled===!0}.bind(this))},this.toggleTargetEnabled=function(o,k){return Pt("target",o,null,!0,k),this.isTargetEnabled(o,k)},this.isTarget=function(o,k){return k=k||"default",gt(o,function(C){let T=this.targetEndpointDefinitions[g(C).id];return T!=null&&T[k]!=null}.bind(this))},this.isTargetEnabled=function(o,k){return k=k||"default",gt(o,function(C){let T=this.targetEndpointDefinitions[g(C).id];return T&&T[k]&&T[k].enabled===!0}.bind(this))},this.setTargetEnabled=function(o,k,C){return Pt("target",o,k,null,C)},this.ready=function(o){l.bind("ready",o)};let St=function(o,k){if(typeof o=="object"&&o.length)for(let C=0,T=o.length;C<T;C++)k(o[C]);else k(o);return l};this.repaint=function(o,k,C){return St(o,function(T){j(T,k,C)})},this.revalidate=function(o,k,C){return St(o,function(T){let G=C?T:l.getId(T);l.updateOffset({elId:G,recalc:!0,timestamp:k});let q=l.getDragManager();q&&q.updateOffsets(G),l.repaint(T)})},this.repaintEverything=function(){let o=U(),k;for(k in f)l.updateOffset({elId:k,recalc:!0,timestamp:o});for(k in f)j(k,null,o);return this},this.removeAllEndpoints=function(o,k,C){C=C||[];let T=function(G){let q=g(G),J=f[q.id],st,nt;if(J)for(C.push(q),st=0,nt=J.length;st<nt;st++)l.deleteEndpoint(J[st],!1);if(delete f[q.id],k&&q.el&&q.el.nodeType!==3&&q.el.nodeType!==8)for(st=0,nt=q.el.childNodes.length;st<nt;st++)T(q.el.childNodes[st])};return T(o),this};let kt=function(o,k){l.removeAllEndpoints(o.id,!0,k);let C=l.getDragManager(),T=function(G){C&&C.elementRemoved(G.id),l.anchorManager.clearFor(G.id),l.anchorManager.removeFloatingConnection(G.id),l.isSource(G.el)&&l.unmakeSource(G.el),l.isTarget(G.el)&&l.unmakeTarget(G.el),l.destroyDraggable(G.el),l.destroyDroppable(G.el),delete l.floatingConnections[G.id],delete v[G.id],delete M[G.id],G.el&&(l.removeElement(G.el),G.el._jsPlumb=null)};for(let G=1;G<k.length;G++)T(k[G]);T(o)};this.remove=function(o,k){let C=g(o),T=[];return C.text&&C.el.parentNode?C.el.parentNode.removeChild(C.el):C.id&&l.batch(function(){kt(C,T)},k===!0),l},this.empty=function(o,k){let C=[],T=function(G,q){let J=g(G);if(J.text)J.el.parentNode.removeChild(J.el);else if(J.el){for(;J.el.childNodes.length>0;)T(J.el.childNodes[0]);q||kt(J,C)}};return l.batch(function(){T(o,!0)},k===!1),l},this.reset=function(o){l.silently(function(){re=!1,l.removeAllGroups(),l.removeGroupManager(),l.deleteEveryEndpoint(),o||l.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},I.length=0,this.doReset&&this.doReset()}.bind(this))};let Xt=function(o){o.canvas&&o.canvas.parentNode&&o.canvas.parentNode.removeChild(o.canvas),o.cleanup(),o.destroy()};this.clear=function(){l.select().each(Xt),l.selectEndpoints().each(Xt),f={},_={}},this.setDefaultScope=function(o){return n=o,l},this.deriveEndpointAndAnchorSpec=function(o,k){let C=((k?"":"default ")+o).split(/[\s]/),T=null,G=null,q=null,J=null;for(let st=0;st<C.length;st++){let nt=l.getType(C[st],"connection");nt&&(nt.endpoints&&(T=nt.endpoints),nt.endpoint&&(G=nt.endpoint),nt.anchors&&(J=nt.anchors),nt.anchor&&(q=nt.anchor))}return{endpoints:T||[G,G],anchors:J||[q,q]}},this.setId=function(o,k,C){let T;c.isString(o)?T=o:(o=this.getElement(o),T=this.getId(o));let G=this.getConnections({source:T,scope:"*"},!0),q=this.getConnections({target:T,scope:"*"},!0);k=""+k,C?o=this.getElement(k):(o=this.getElement(T),this.setAttribute(o,"id",k)),f[k]=f[T]||[];for(let nt=0,dt=f[k].length;nt<dt;nt++)f[k][nt].setElementId(k),f[k][nt].setReferenceElement(o);delete f[T],this.sourceEndpointDefinitions[k]=this.sourceEndpointDefinitions[T],delete this.sourceEndpointDefinitions[T],this.targetEndpointDefinitions[k]=this.targetEndpointDefinitions[T],delete this.targetEndpointDefinitions[T],this.anchorManager.changeId(T,k);let J=this.getDragManager();J&&J.changeId(T,k),v[k]=v[T],delete v[T];let st=function(nt,dt,at){for(let vt=0,jt=nt.length;vt<jt;vt++)nt[vt].endpoints[dt].setElementId(k),nt[vt].endpoints[dt].setReferenceElement(o),nt[vt][at+"Id"]=k,nt[vt][at]=o};st(G,0,"source"),st(q,1,"target"),this.repaint(k)},this.setDebugLog=function(o){h=o},this.setSuspendDrawing=function(o,k){let C=A;return A=o,o?F=new Date().getTime():F=null,k&&this.repaintEverything(),C},this.isSuspendDrawing=function(){return A},this.getSuspendedAt=function(){return F},this.batch=function(o,k){let C=this.isSuspendDrawing();C||this.setSuspendDrawing(!0);try{o()}catch(T){c.log("Function run while suspended failed",T)}C||this.setSuspendDrawing(!1,!k)},this.doWhileSuspended=this.batch,this.getCachedData=ut,this.timestamp=U,this.show=function(o,k){return rt(o,"block",k),l},this.toggleVisible=ft,this.addListener=this.bind;let $t=[];this.registerFloatingConnection=function(o,k,C){$t[o.id]=k,c.addToList(f,o.id,C)},this.getFloatingConnectionFor=function(o){return $t[o]},this.listManager=new W.jsPlumbListManager(this)};c.extend(W.jsPlumbInstance,c.EventGenerator,{setAttribute:function(s,l,R){this.setAttribute(s,l,R)},getAttribute:function(s,l){return this.getAttribute(W.jsPlumb.getElement(s),l)},convertToFullOverlaySpec:function(s){return c.isString(s)&&(s=[s,{}]),s[1].id=s[1].id||c.uuid(),s},registerConnectionType:function(s,l){if(this._connectionTypes[s]=W.jsPlumb.extend({},l),l.overlays){let R={};for(let N=0;N<l.overlays.length;N++){let H=this.convertToFullOverlaySpec(l.overlays[N]);R[H[1].id]=H}this._connectionTypes[s].overlays=R}},registerConnectionTypes:function(s){for(let l in s)this.registerConnectionType(l,s[l])},registerEndpointType:function(s,l){if(this._endpointTypes[s]=W.jsPlumb.extend({},l),l.overlays){let R={};for(let N=0;N<l.overlays.length;N++){let H=this.convertToFullOverlaySpec(l.overlays[N]);R[H[1].id]=H}this._endpointTypes[s].overlays=R}},registerEndpointTypes:function(s){for(let l in s)this.registerEndpointType(l,s[l])},getType:function(s,l){return l==="connection"?this._connectionTypes[s]:this._endpointTypes[s]},setIdChanged:function(s,l){this.setId(s,l,!0)},setParent:function(s,l){let R=this.getElement(s),N=this.getId(R),H=this.getElement(l),O=this.getId(H),g=this.getDragManager();R.parentNode.removeChild(R),H.appendChild(R),g&&g.setParent(R,N,H,O)},extend:function(s,l,R){let N;if(R)for(N=0;N<R.length;N++)s[R[N]]=l[R[N]];else for(N in l)s[N]=l[N];return s},floatingConnections:{},getFloatingAnchorIndex:function(s){return s.endpoints[0].isFloating()?0:s.endpoints[1].isFloating()?1:-1},proxyConnection:function(s,l,R,N,H,O){let g,i=s.endpoints[l].elementId,b=s.endpoints[l];s.proxies=s.proxies||[],s.proxies[l]?g=s.proxies[l].ep:g=this.addEndpoint(R,{endpoint:H(s,l),anchor:O(s,l),parameters:{isProxyEndpoint:!0}}),g.setDeleteOnEmpty(!0),s.proxies[l]={ep:g,originalEp:b},l===0?this.anchorManager.sourceChanged(i,N,s,R):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,i,N,s),s.target=R,s.targetId=N),b.detachFromConnection(s,null,!0),g.connections=[s],s.endpoints[l]=g,b.setVisible(!1),s.setVisible(!0),this.revalidate(R)},unproxyConnection:function(s,l,R){if(s._jsPlumb==null||s.proxies==null||s.proxies[l]==null)return;let N=s.proxies[l].originalEp.element,H=s.proxies[l].originalEp.elementId;s.endpoints[l]=s.proxies[l].originalEp,l===0?this.anchorManager.sourceChanged(R,H,s,N):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,R,H,s),s.target=N,s.targetId=H),s.proxies[l].ep.detachFromConnection(s,null),s.proxies[l].originalEp.addConnection(s),s.isVisible()&&s.proxies[l].originalEp.setVisible(!0),delete s.proxies[l]}});var L=new S;W.jsPlumb=L,L.getInstance=function(s,l){let R=new S(s);if(l)for(let N in l)R[N]=l[N];return R.init(),R},L.each=function(s,l){if(s!=null)if(typeof s=="string")l(L.getElement(s));else if(s.length!=null)for(let R=0;R<s.length;R++)l(L.getElement(s[R]));else l(s)},typeof exports<"u"&&(exports.jsPlumb=L)}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et="__label",Y=function(r,E){let a={cssClass:E.cssClass,labelStyle:r.labelStyle,id:et,component:r,_jsPlumb:r._jsPlumb.instance},e=c.extend(a,E);return new c.Overlays[r._jsPlumb.instance.getRenderMode()].Label(e)},K=function(r,E){let a=null;if(U.isArray(E)){let e=E[0],p=c.extend({component:r,_jsPlumb:r._jsPlumb.instance},E[1]);E.length===3&&c.extend(p,E[2]),a=new c.Overlays[r._jsPlumb.instance.getRenderMode()][e](p)}else E.constructor===String?a=new c.Overlays[r._jsPlumb.instance.getRenderMode()][E]({component:r,_jsPlumb:r._jsPlumb.instance}):a=E;return a.id=a.id||U.uuid(),r.cacheTypeItem("overlay",a,a.id),r._jsPlumb.overlays[a.id]=a,a};c.OverlayCapableJsPlumbUIComponent=function(r){W.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},r.label?this.getDefaultType().overlays[et]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:et}]:r.id&&(this.getDefaultType().overlays[et]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.emptyLabelStyle||this._jsPlumb.instance.Defaults.emptyLabelStyle,id:et}]),this.setListenerComponent=function(E){if(this._jsPlumb)for(let a in this._jsPlumb.overlays)this._jsPlumb.overlays[a].setListenerComponent(E)}},c.OverlayCapableJsPlumbUIComponent.applyType=function(r,E){if(E.overlays){let a={},e;for(e in E.overlays){let p=r._jsPlumb.overlays[E.overlays[e][1].id];if(p)p.updateFrom(E.overlays[e][1]),a[E.overlays[e][1].id]=!0;else{let P=r.getCachedTypeItem("overlay",E.overlays[e][1].id);P!=null?(P.reattach(r._jsPlumb.instance,r),P.setVisible(!0),P.updateFrom(E.overlays[e][1]),r._jsPlumb.overlays[P.id]=P):P=r.addOverlay(E.overlays[e],!0),a[P.id]=!0}}for(e in r._jsPlumb.overlays)a[r._jsPlumb.overlays[e].id]==null&&r.removeOverlay(r._jsPlumb.overlays[e].id,!0)}},U.extend(c.OverlayCapableJsPlumbUIComponent,W.jsPlumbUIComponent,{setHover:function(r,E){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(let a in this._jsPlumb.overlays)this._jsPlumb.overlays[a][r?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(r,E){let a=K(this,r);if(this.getData&&a.type==="Label"&&U.isArray(r)){let e=this.getData(),p=r[1];if(e){let P=p.labelLocationAttribute||"labelLocation",w=e?e[P]:null;w&&(a.loc=w)}}return E||this.repaint(),a},getOverlay:function(r){return this._jsPlumb.overlays[r]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(r){let E=this.getOverlay(r);E&&E.hide()},hideOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].hide()},showOverlay:function(r){let E=this.getOverlay(r);E&&E.show()},showOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].show()},removeAllOverlays:function(r){for(let E in this._jsPlumb.overlays)this._jsPlumb.overlays[E].cleanup&&this._jsPlumb.overlays[E].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},r||this.repaint()},removeOverlay:function(r,E){let a=this._jsPlumb.overlays[r];a&&(a.setVisible(!1),!E&&a.cleanup&&a.cleanup(),delete this._jsPlumb.overlays[r],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[r],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[r])},removeOverlays:function(){for(let r=0,E=arguments.length;r<E;r++)this.removeOverlay(arguments[r])},moveParent:function(r){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),r.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),r.appendChild(this.canvas);for(let E in this._jsPlumb.overlays)if(this._jsPlumb.overlays[E].isAppendedAtTopLevel){let a=this._jsPlumb.overlays[E].getElement();a.parentNode.removeChild(a),r.appendChild(a)}}},getLabel:function(){let r=this.getOverlay(et);return r!=null?r.getLabel():null},getLabelOverlay:function(){return this.getOverlay(et)},setLabel:function(r){let E=this.getOverlay(et);if(E)r.constructor===String||r.constructor===Function?E.setLabel(r):(r.label||(r.label=""),E.setLabel(r.label),r.location&&E.setLocation(r.location));else{let a=r.constructor===String||r.constructor===Function?{label:r}:r;E=Y(this,a),this._jsPlumb.overlays[et]=E}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(r){for(let E in this._jsPlumb.overlays)this._jsPlumb.overlays[E].cleanup(r),this._jsPlumb.overlays[E].destroy(r);r&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(r){this[r?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(r,E){this._jsPlumb.overlayPositions[r.id]=E},getAbsoluteOverlayPosition:function(r){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[r.id]:null},_clazzManip:function(r,E,a){if(!a)for(let e in this._jsPlumb.overlays)this._jsPlumb.overlays[e][r+"Class"](E)},addClass:function(r,E){this._clazzManip("add",r,E)},removeClass:function(r,E){this._clazzManip("remove",r,E)}})}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et=function(a,e,p){let P=!1;return{drag:function(){if(P)return P=!1,!0;if(e.element){let w=p.getUIPosition(arguments,p.getZoom());w!=null&&p.setPosition(e.element,w),p.repaint(e.element,w),a.paint({anchorPoint:a.anchor.getCurrentLocation({element:a})})}},stopDrag:function(){P=!0}}},Y=function(a,e,p,P){let w=e.createElement("div",{position:"absolute"});e.appendElement(w);let S=e.getId(w);e.setPosition(w,p),w.style.width=P[0]+"px",w.style.height=P[1]+"px",e.manage(S,w,!0),a.id=S,a.element=w},K=function(a,e,p,P,w,S,L,s){let l=new c.FloatingAnchor({reference:e,referenceCanvas:P,jsPlumbInstance:S});return L({paintStyle:a,endpoint:p,anchor:l,source:w,scope:s})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],E=function(a,e){let p=0;if(e!=null){for(let P=0;P<a.connections.length;P++)if(a.connections[P].sourceId===e||a.connections[P].targetId===e){p=P;break}}return a.connections[p]};c.Endpoint=function(a){let e=a._jsPlumb,p=a.newConnection,P=a.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:a.connectionType,maxConnections:a.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:a.maxConnections,paintStyle:a.endpointStyle||a.paintStyle||a.style||this._jsPlumb.instance.Defaults.EndpointStyle||c.Defaults.EndpointStyle,hoverPaintStyle:a.endpointHoverStyle||a.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle,connectorStyle:a.connectorStyle,connectorHoverStyle:a.connectorHoverStyle,connectorClass:a.connectorClass,connectorHoverClass:a.connectorHoverClass,connectorOverlays:a.connectorOverlays,connector:a.connector,connectorTooltip:a.connectorTooltip}),this._jsPlumb.enabled=a.enabled!==!1,this._jsPlumb.visible=!0,this.element=c.getElement(a.source),this._jsPlumb.uuid=a.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(a.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=a.elementId,this.dragProxy=a.dragProxy,this._jsPlumb.connectionCost=a.connectionCost,this._jsPlumb.connectionsDirected=a.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};let w=a.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(O){w=O};let S=function(){let O=e.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();let g=e.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(O),this.addClass(g),c.updateClasses(this.element,g,O)}.bind(this);this.prepareAnchor=function(O){let g=this._jsPlumb.instance.makeAnchor(O,this.elementId,e);return g.bind("anchorChanged",function(i){this.fire("anchorChanged",{endpoint:this,anchor:i}),S()}.bind(this)),g},this.setPreparedAnchor=function(O,g){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=O,S(),g||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(O,g){let i=this.prepareAnchor(O);return this.setPreparedAnchor(i,g),this};let L=function(O){if(this.connections.length>0)for(let g=0;g<this.connections.length;g++)this.connections[g].setHover(O,!1);else this.setHover(O)}.bind(this);this.bind("mouseover",function(){L(!0)}),this.bind("mouseout",function(){L(!1)}),a._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(O,g){let i=function(D,I){let f=e.getRenderMode();if(c.Endpoints[f][D])return new c.Endpoints[f][D](I);if(!e.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+D+"'"}},b={_jsPlumb:this._jsPlumb.instance,cssClass:a.cssClass,container:a.container,tooltip:a.tooltip,connectorTooltip:a.connectorTooltip,endpoint:this},h;return U.isString(O)?h=i(O,b):U.isArray(O)?(b=U.merge(O[1],b),h=i(O[0],b)):h=O.clone(),h.clone=function(){if(U.isString(O))return i(O,b);if(U.isArray(O))return b=U.merge(O[1],b),i(O[0],b)}.bind(this),h.typeId=g,h},this.setEndpoint=function(O,g){let i=this.prepareEndpoint(O);this.setPreparedEndpoint(i,!0)},this.setPreparedEndpoint=function(O,g){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=O,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},c.extend(this,a,r),this.isSource=a.isSource||!1,this.isTemporarySource=a.isTemporarySource||!1,this.isTarget=a.isTarget||!1,this.connections=a.connections||[],this.connectorPointerEvents=a["connector-pointer-events"],this.scope=a.scope||e.getDefaultScope(),this.timestamp=null,this.reattachConnections=a.reattach||e.Defaults.ReattachConnections,this.connectionsDetachable=e.Defaults.ConnectionsDetachable,(a.connectionsDetachable===!1||a.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=a.dragAllowedWhenFull!==!1,a.onMaxConnections&&this.bind("maxConnections",a.onMaxConnections),this.addConnection=function(O){this.connections.push(O),this[(this.connections.length>0?"add":"remove")+"Class"](e.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](e.endpointFullClass)},this.detachFromConnection=function(O,g,i){g=g==null?this.connections.indexOf(O):g,g>=0&&(this.connections.splice(g,1),this[(this.connections.length>0?"add":"remove")+"Class"](e.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](e.endpointFullClass)),!i&&w&&this.connections.length===0&&e.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:i!==!0})},this.deleteEveryConnection=function(O){let g=this.connections.length;for(let i=0;i<g;i++)e.deleteConnection(this.connections[0],O)},this.detachFrom=function(O,g,i){let b=[];for(let h=0;h<this.connections.length;h++)(this.connections[h].endpoints[1]===O||this.connections[h].endpoints[0]===O)&&b.push(this.connections[h]);for(let h=0,D=b.length;h<D;h++)e.deleteConnection(b[0]);return this},this.getElement=function(){return this.element},this.setElement=function(O){let g=this._jsPlumb.instance.getId(O),i=this.elementId;return U.removeWithFunction(a.endpointsByElement[this.elementId],function(b){return b.id===this.id}.bind(this)),this.element=c.getElement(O),this.elementId=e.getId(this.element),e.anchorManager.rehomeEndpoint(this,i,this.element),e.dragManager.endpointAdded(this.element),U.addToList(a.endpointsByElement,g,this),this},this.makeInPlaceCopy=function(){let O=this.anchor.getCurrentLocation({element:this}),g=this.anchor.getOrientation(this),i=this.anchor.getCssClass(),b={bind:function(){},compute:function(){return[O[0],O[1]]},getCurrentLocation:function(){return[O[0],O[1]]},getOrientation:function(){return g},getCssClass:function(){return i}};return P({dropOptions:a.dropOptions,anchor:b,source:this.element,paintStyle:this.getPaintStyle(),endpoint:a.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(O){O=O||{};let g=O.timestamp,i=O.recalc!==!1;if(!g||this.timestamp!==g){let b=e.updateOffset({elId:this.elementId,timestamp:g}),h=O.offset?O.offset.o:b.o;if(h!=null){let D=O.anchorPoint,I=O.connectorPaintStyle;if(D==null){let f=O.dimensions||b.s,_={xy:[h.left,h.top],wh:f,element:this,timestamp:g};if(i&&this.anchor.isDynamic&&this.connections.length>0){let v=E(this,O.elementWithPrecedence),M=v.endpoints[0]===this?1:0,m=M===0?v.sourceId:v.targetId,u=e.getCachedData(m),y=u.o,A=u.s;_.index=M===0?1:0,_.connection=v,_.txy=[y.left,y.top],_.twh=A,_.tElement=v.endpoints[M]}else this.connections.length>0&&(_.connection=this.connections[0]);D=this.anchor.compute(_)}this.endpoint.compute(D,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,I||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=g;for(let f in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(f)){let _=this._jsPlumb.overlays[f];_.isVisible()&&(this._jsPlumb.overlayPlacements[f]=_.draw(this.endpoint,this._jsPlumb.paintStyleInUse),_.paint(this._jsPlumb.overlayPlacements[f]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;let s=!1;this.initDraggable=function(){if(!s&&c.isDragSupported(this.element)){let O={id:null,element:null},g=null,i=!1,b=null,h=et(this,O,e),D=a.dragOptions||{},I={},f=c.dragEvents.start,_=c.dragEvents.stop,v=c.dragEvents.drag,M=c.dragEvents.beforeStart,m,u=function(F){m=F.e.payload||{}},y=function(F){g=this.connectorSelector();let n=!0;this.isEnabled()||(n=!1),g==null&&!this.isSource&&!this.isTemporarySource&&(n=!1),this.isSource&&this.isFull()&&!(g!=null&&this.dragAllowedWhenFull)&&(n=!1),g!=null&&!g.isDetachable(this)&&(this.isFull()?n=!1:g=null);let t=e.checkCondition(g==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:g});if(t===!1?n=!1:typeof t=="object"?c.extend(t,m||{}):t=m||{},n===!1)return e.stopDrag&&e.stopDrag(this.canvas),h.stopDrag(),!1;for(let V=0;V<this.connections.length;V++)this.connections[V].setHover(!1);this.addClass("endpointDrag"),e.setConnectionBeingDragged(!0),g&&!this.isFull()&&this.isSource&&(g=null),e.updateOffset({elId:this.elementId});let d=this._jsPlumb.instance.getOffset(this.canvas),x=this.canvas,j=this._jsPlumb.instance.getSize(this.canvas);Y(O,e,d,j),e.setAttributes(this.canvas,{dragId:O.id,elId:this.elementId});let B=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){let V=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);V.endpoints[1]&&(B=V.endpoints[1])}let z=this._jsPlumb.instance.makeAnchor("Center");z.isFloating=!0,this._jsPlumb.floatingEndpoint=K(this.getPaintStyle(),z,B,this.canvas,O.element,e,P,this.scope);let X=this._jsPlumb.floatingEndpoint.anchor;if(g==null)this.setHover(!1,!1),g=p({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:O.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:a.connectorStyle,hoverPaintStyle:a.connectorHoverStyle,connector:a.connector,overlays:a.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:a.scope,data:t}),g.pending=!0,g.addClass(e.draggingClass),this._jsPlumb.floatingEndpoint.addClass(e.draggingClass),this._jsPlumb.floatingEndpoint.anchor=X,e.fire("connectionDrag",g),e.anchorManager.newConnection(g);else{i=!0,g.setHover(!1);let V=g.endpoints[0].id===this.id?0:1;this.detachFromConnection(g,null,!0);let ot=e.getDragScope(x);e.setAttribute(this.canvas,"originalScope",ot),e.fire("connectionDrag",g),V===0?(b=[g.source,g.sourceId,x,ot],e.anchorManager.sourceChanged(g.endpoints[V].elementId,O.id,g,O.element)):(b=[g.target,g.targetId,x,ot],g.target=O.element,g.targetId=O.id,e.anchorManager.updateOtherEndpoint(g.sourceId,g.endpoints[V].elementId,g.targetId,g)),g.suspendedEndpoint=g.endpoints[V],g.suspendedElement=g.endpoints[V].getElement(),g.suspendedElementId=g.endpoints[V].elementId,g.suspendedElementType=V===0?"source":"target",g.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=g.suspendedEndpoint,g.endpoints[V]=this._jsPlumb.floatingEndpoint,g.addClass(e.draggingClass),this._jsPlumb.floatingEndpoint.addClass(e.draggingClass)}e.registerFloatingConnection(O,g,this._jsPlumb.floatingEndpoint),e.currentlyDragging=!0}.bind(this),A=function(){if(e.setConnectionBeingDragged(!1),g&&g.endpoints!=null){let F=e.getDropEvent(arguments),n=e.getFloatingAnchorIndex(g);if(g.endpoints[n===0?1:0].anchor.unlock(),g.removeClass(e.draggingClass),this._jsPlumb&&(g.deleteConnectionNow||g.endpoints[n]===this._jsPlumb.floatingEndpoint)&&i&&g.suspendedEndpoint){n===0?(g.floatingElement=g.source,g.floatingId=g.sourceId,g.floatingEndpoint=g.endpoints[0],g.floatingIndex=0,g.source=b[0],g.sourceId=b[1]):(g.floatingElement=g.target,g.floatingId=g.targetId,g.floatingEndpoint=g.endpoints[1],g.floatingIndex=1,g.target=b[0],g.targetId=b[1]);let t=this._jsPlumb.floatingEndpoint;e.setDragScope(b[2],b[3]),g.endpoints[n]=g.suspendedEndpoint,g.isReattach()||g._forceReattach||g._forceDetach||!e.deleteConnection(g,{originalEvent:F})?(g.setHover(!1),g._forceDetach=null,g._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(g),g.suspendedEndpoint.addConnection(g),n===1?e.anchorManager.updateOtherEndpoint(g.sourceId,g.floatingId,g.targetId,g):e.anchorManager.sourceChanged(g.floatingId,g.sourceId,g,g.source),e.repaint(b[1])):e.deleteObject({endpoint:t})}this.deleteAfterDragStop?e.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),e.fire("connectionDragStop",g,F),g.pending&&e.fire("connectionAborted",g,F),e.currentlyDragging=!1,g.suspendedElement=null,g.suspendedEndpoint=null,g=null}O&&O.element&&e.remove(O.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.unlock(),this._jsPlumb.floatingEndpoint=null)}.bind(this);D=c.extend(I,D),D.scope=this.scope||D.scope,D[M]=U.wrap(D[M],u,!1),D[f]=U.wrap(D[f],y,!1),D[v]=U.wrap(D[v],h.drag),D[_]=U.wrap(D[_],A),D.multipleDrop=!1,D.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this),e.initDraggable(this.canvas,D,"internal"),this.canvas._jsPlumbRelatedElement=this.element,s=!0}};let l=a.endpoint||this._jsPlumb.instance.Defaults.Endpoint||c.Defaults.Endpoint;this.setEndpoint(l,!0);let R=a.anchor?a.anchor:a.anchors?a.anchors:e.Defaults.Anchor||"Top";this.setAnchor(R,!0);let N=["default",a.type||""].join(" ");this.addType(N,a.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();let H=function(O,g,i,b){if(c.isDropSupported(this.element)){let h=a.dropOptions||e.Defaults.DropOptions||c.Defaults.DropOptions;h=c.extend({},h),h.scope=h.scope||this.scope;let D=c.dragEvents.drop,I=c.dragEvents.over,f=c.dragEvents.out,_=this,v=e.EndpointDropHandler({getEndpoint:function(){return _},jsPlumb:e,enabled:function(){return i!=null?i.isEnabled():!0},isFull:function(){return i.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(M){_.addClass(M)},removeClass:function(M){_.removeClass(M)},isDropAllowed:function(){return _.isDropAllowed.apply(_,arguments)},reference:b,isRedrop:function(M,m){return M.suspendedEndpoint&&m.reference&&M.suspendedEndpoint.id===m.reference.id}});h[D]=U.wrap(h[D],v,!0),h[I]=U.wrap(h[I],function(){let M=c.getDragObject(arguments),m=e.getAttribute(c.getElement(M),"dragId"),u=e.getFloatingConnectionFor(m);if(u!=null){let y=e.getFloatingAnchorIndex(u);if(this.isTarget&&y!==0||u.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===u.suspendedEndpoint.id){let F=e.checkCondition("checkDropAllowed",{sourceEndpoint:u.endpoints[y],targetEndpoint:this,connection:u});this[(F?"add":"remove")+"Class"](e.endpointDropAllowedClass),this[(F?"remove":"add")+"Class"](e.endpointDropForbiddenClass),u.endpoints[y].anchor.over(this.anchor,this)}}}.bind(this)),h[f]=U.wrap(h[f],function(){let M=c.getDragObject(arguments),m=M==null?null:e.getAttribute(c.getElement(M),"dragId"),u=m?e.getFloatingConnectionFor(m):null;if(u!=null){let y=e.getFloatingAnchorIndex(u);(this.isTarget&&y!==0||u.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===u.suspendedEndpoint.id)&&(this.removeClass(e.endpointDropAllowedClass),this.removeClass(e.endpointDropForbiddenClass),u.endpoints[y].anchor.out())}}.bind(this)),e.initDroppable(O,h,"internal",g)}}.bind(this);return this.anchor.isFloating||H(this.canvas,!(a._transient||this.anchor.isFloating),this,a.reference),this},U.extend(c.Endpoint,c.OverlayCapableJsPlumbUIComponent,{setVisible:function(a,e,p){if(this._jsPlumb.visible=a,this.canvas&&(this.canvas.style.display=a?"block":"none"),this[a?"showOverlays":"hideOverlays"](),!e){for(let P=0;P<this.connections.length;P++)if(this.connections[P].setVisible(a),!p){let w=this===this.connections[P].endpoints[0]?1:0;this.connections[P].endpoints[w].connections.length===1&&this.connections[P].endpoints[w].setVisible(a,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(a,e){this.setPaintStyle(a.endpointStyle||a.paintStyle,e),this.setHoverPaintStyle(a.endpointHoverStyle||a.hoverPaintStyle,e),a.maxConnections!=null&&(this._jsPlumb.maxConnections=a.maxConnections),a.scope&&(this.scope=a.scope),c.extend(this,a,r),a.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,a.cssClass),c.OverlayCapableJsPlumbUIComponent.applyType(this,a)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(a){this._jsPlumb.enabled=a},cleanup:function(){let a=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");c.removeClass(this.element,a),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(a){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(a)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(a){let e=!1;if(a){for(let p=0;p<this.connections.length;p++)if(this.connections[p].endpoints[1]===a||this.connections[p].endpoints[0]===a){e=!0;break}}return e},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(a){this._jsPlumb.connectionCost=a},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(a){this._jsPlumb.connectionsDirected=a},setElementId:function(a){this.elementId=a,this.anchor.elementId=a},setReferenceElement:function(a){this.element=c.getElement(a)},setDragAllowedWhenFull:function(a){this.dragAllowedWhenFull=a},equals:function(a){return this.anchor.equals(a.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(a){return this.anchor.compute(a)}}),W.jsPlumbInstance.prototype.EndpointDropHandler=function(a){return function(e){let p=a.jsPlumb;a.removeClass(p.endpointDropAllowedClass),a.removeClass(p.endpointDropForbiddenClass);let P=p.getDropEvent(arguments),w=p.getDragObject(arguments),S=p.getAttribute(w,"dragId");p.getAttribute(w,"elId");let L=p.getAttribute(w,"originalScope"),s=p.getFloatingConnectionFor(S);if(s==null)return;let l=s.suspendedEndpoint!=null;if(l&&s.suspendedEndpoint._jsPlumb==null)return;let R=a.getEndpoint(s);if(R==null)return;if(a.isRedrop(s,a)){s._forceReattach=!0,s.setHover(!1),a.maybeCleanup&&a.maybeCleanup(R);return}let N=p.getFloatingAnchorIndex(s);if(N===0&&!a.isSource||N===1&&!a.isTarget){a.maybeCleanup&&a.maybeCleanup(R);return}a.onDrop&&a.onDrop(s),L&&p.setDragScope(w,L);let H=a.isFull(e);if(H&&R.fire("maxConnections",{endpoint:this,connection:s,maxConnections:R._jsPlumb.maxConnections},P),!H&&a.enabled()){let O=!0;N===0?(s.floatingElement=s.source,s.floatingId=s.sourceId,s.floatingEndpoint=s.endpoints[0],s.floatingIndex=0,s.source=a.element,s.sourceId=a.elementId):(s.floatingElement=s.target,s.floatingId=s.targetId,s.floatingEndpoint=s.endpoints[1],s.floatingIndex=1,s.target=a.element,s.targetId=a.elementId),l&&s.suspendedEndpoint.id!==R.id&&(!s.isDetachAllowed(s)||!s.endpoints[N].isDetachAllowed(s)||!s.suspendedEndpoint.isDetachAllowed(s)||!p.checkCondition("beforeDetach",s))&&(O=!1);let g=function(b){s.endpoints[N].detachFromConnection(s),s.suspendedEndpoint&&s.suspendedEndpoint.detachFromConnection(s),s.endpoints[N]=R,R.addConnection(s);let h=R.getParameters();for(let D in h)s.setParameter(D,h[D]);if(!l)h.draggable&&p.initDraggable(this.element,a.dragOptions,"internal",p);else{let D=s.suspendedEndpoint.elementId;p.fireMoveEvent({index:N,originalSourceId:N===0?D:s.sourceId,newSourceId:N===0?R.elementId:s.sourceId,originalTargetId:N===1?D:s.targetId,newTargetId:N===1?R.elementId:s.targetId,originalSourceEndpoint:N===0?s.suspendedEndpoint:s.endpoints[0],newSourceEndpoint:N===0?R:s.endpoints[0],originalTargetEndpoint:N===1?s.suspendedEndpoint:s.endpoints[1],newTargetEndpoint:N===1?R:s.endpoints[1],connection:s},P)}N===1?p.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):p.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),s.endpoints[0].finalEndpoint&&(s.endpoints[0].detachFromConnection(s),s.endpoints[0]=s.endpoints[0].finalEndpoint,s.endpoints[0].addConnection(s)),U.isObject(b)&&s.mergeData(b),p.finaliseConnection(s,null,P,!1),s.setHover(!1),p.revalidate(s.endpoints[0].element)}.bind(this),i=function(){s.suspendedEndpoint&&(s.endpoints[N]=s.suspendedEndpoint,s.setHover(!1),s._forceDetach=!0,N===0?(s.source=s.suspendedEndpoint.element,s.sourceId=s.suspendedEndpoint.elementId):(s.target=s.suspendedEndpoint.element,s.targetId=s.suspendedEndpoint.elementId),s.suspendedEndpoint.addConnection(s),N===1?p.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):p.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),p.repaint(s.sourceId),s._forceDetach=!1)};if(O=O&&a.isDropAllowed(s.sourceId,s.targetId,s.scope,s,R),O)return g(O),!0;i()}a.maybeCleanup&&a.maybeCleanup(R),p.currentlyDragging=!1}}}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et=function(r,E,a,e,p){if(c.Connectors[E]=c.Connectors[E]||{},c.Connectors[E][a]==null){if(c.Connectors[a]==null){if(r.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+a+"'")}c.Connectors[E][a]=function(){c.Connectors[a].apply(this,arguments),c.ConnectorRenderers[E].apply(this,arguments)},U.extend(c.Connectors[E][a],[c.Connectors[a],c.ConnectorRenderers[E]])}return new c.Connectors[E][a](e,p)},Y=function(r,E,a){return r?a.makeAnchor(r,E,a):null},K=function(r,E,a,e){E!=null&&(E._jsPlumbConnections=E._jsPlumbConnections||{},e?delete E._jsPlumbConnections[r.id]:E._jsPlumbConnections[r.id]=!0,U.isEmpty(E._jsPlumbConnections)?a.removeClass(E,a.connectedClass):a.addClass(E,a.connectedClass))};c.Connection=function(r){let E=r.newEndpoint;this.id=r.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=r.previousConnection,this.source=c.getElement(r.source),this.target=c.getElement(r.target),c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),r.sourceEndpoint?(this.source=r.sourceEndpoint.getElement(),this.sourceId=r.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),r.targetEndpoint?(this.target=r.targetEndpoint.getElement(),this.targetId=r.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=r.scope,this.endpoints=[],this.endpointStyles=[];let a=this._jsPlumb.instance;a.manage(this.sourceId,this.source),a.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:r.cssClass,container:r.container,"pointer-events":r["pointer-events"],editorParams:r.editorParams,overlays:r.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(R,N,H,O,g){return H=H||this._jsPlumb.instance.getId(N),this.prepareEndpoint(a,E,this,O,R?0:1,r,N,H,g)},r.type&&(r.endpoints=r.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(r.type).endpoints);let e=this.makeEndpoint(!0,this.source,this.sourceId,r.sourceEndpoint),p=this.makeEndpoint(!1,this.target,this.targetId,r.targetEndpoint);e&&U.addToList(r.endpointsByElement,this.sourceId,e),p&&U.addToList(r.endpointsByElement,this.targetId,p),this.scope||(this.scope=this.endpoints[0].scope),r.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(r.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(r.deleteEndpointsOnEmpty));let P=a.Defaults.ConnectionsDetachable;r.detachable===!1&&(P=!1),this.endpoints[0].connectionsDetachable===!1&&(P=!1),this.endpoints[1].connectionsDetachable===!1&&(P=!1);let w=r.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||a.Defaults.ReattachConnections;this.appendToDefaultType({detachable:P,reattach:w,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||r.paintStyle||a.Defaults.PaintStyle||c.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||r.hoverPaintStyle||a.Defaults.HoverPaintStyle||c.Defaults.HoverPaintStyle});let S=a.getSuspendedAt();if(!a.isSuspendDrawing()){let R=a.getCachedData(this.sourceId),N=R.o,H=R.s,O=a.getCachedData(this.targetId),g=O.o,i=O.s,b=S||a.timestamp(),h=this.endpoints[0].anchor.compute({xy:[N.left,N.top],wh:H,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[g.left,g.top],twh:i,tElement:this.endpoints[1],timestamp:b});this.endpoints[0].paint({anchorLoc:h,timestamp:b}),h=this.endpoints[1].anchor.compute({xy:[g.left,g.top],wh:i,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[N.left,N.top],twh:H,tElement:this.endpoints[0],timestamp:b}),this.endpoints[1].paint({anchorLoc:h,timestamp:b})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(R){return this._jsPlumb.detachable===!1?!1:R!=null?R.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(R){this._jsPlumb.detachable=R===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(R){this._jsPlumb.reattach=R===!0},this._jsPlumb.cost=r.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=r.directed,r.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());let L=c.extend({},this.endpoints[1].getParameters());c.extend(L,this.endpoints[0].getParameters()),c.extend(L,this.getParameters()),this.setParameters(L),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||r.connector||a.Defaults.Connector||c.Defaults.Connector,!0);let s=r.data==null||!U.isObject(r.data)?{}:r.data;this.getData=function(){return s},this.setData=function(R){s=R||{}},this.mergeData=function(R){s=c.extend(s,R)};let l=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,r.type].join(" ");/[^\s]/.test(l)&&this.addType(l,r.data,!0),this.updateConnectedClass()},U.extend(c.Connection,c.OverlayCapableJsPlumbUIComponent,{applyType:function(r,E,a){let e=null;r.connector!=null&&(e=this.getCachedTypeItem("connector",a.connector),e==null&&(e=this.prepareConnector(r.connector,a.connector),this.cacheTypeItem("connector",e,a.connector)),this.setPreparedConnector(e)),r.detachable!=null&&this.setDetachable(r.detachable),r.reattach!=null&&this.setReattach(r.reattach),r.scope&&(this.scope=r.scope),r.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,r.cssClass);let p=null;r.anchor?(p=this.getCachedTypeItem("anchors",a.anchor),p==null&&(p=[this._jsPlumb.instance.makeAnchor(r.anchor),this._jsPlumb.instance.makeAnchor(r.anchor)],this.cacheTypeItem("anchors",p,a.anchor))):r.anchors&&(p=this.getCachedTypeItem("anchors",a.anchors),p==null&&(p=[this._jsPlumb.instance.makeAnchor(r.anchors[0]),this._jsPlumb.instance.makeAnchor(r.anchors[1])],this.cacheTypeItem("anchors",p,a.anchors))),p!=null&&(this.endpoints[0].anchor=p[0],this.endpoints[1].anchor=p[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),c.OverlayCapableJsPlumbUIComponent.applyType(this,r)},addClass:function(r,E){E&&(this.endpoints[0].addClass(r),this.endpoints[1].addClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(r)),this.connector&&this.connector.addClass(r)},removeClass:function(r,E){E&&(this.endpoints[0].removeClass(r),this.endpoints[1].removeClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(r)),this.connector&&this.connector.removeClass(r)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(r){this._jsPlumb.visible=r,this.connector&&this.connector.setVisible(r),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(r){this._jsPlumb&&(K(this,this.source,this._jsPlumb.instance,r),K(this,this.target,this._jsPlumb.instance,r))},setHover:function(r){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(r),W.jsPlumb[r?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),W.jsPlumb[r?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(r){this._jsPlumb.cost=r},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(r,E){let a={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},e=this._jsPlumb.instance.getRenderMode(),p;return U.isString(r)?p=et(this._jsPlumb.instance,e,r,a,this):U.isArray(r)&&(r.length===1?p=et(this._jsPlumb.instance,e,r[0],a,this):p=et(this._jsPlumb.instance,e,r[0],U.merge(r[1],a),this)),E!=null&&(p.typeId=E),p},setPreparedConnector:function(r,E,a,e){if(this.connector!==r){let p,P="";if(this.connector!=null&&(p=this.connector,P=p.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=r,e&&this.cacheTypeItem("connector",r,e),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(P),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),p!=null){let w=this.getOverlays();for(let S=0;S<w.length;S++)w[S].transfer&&w[S].transfer(this.connector)}a||this.setListenerComponent(this.connector),E||this.repaint()}},setConnector:function(r,E,a,e){let p=this.prepareConnector(r,e);this.setPreparedConnector(p,E,a,e)},paint:function(r){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){r=r||{};let E=r.timestamp,a=this.targetId,e=this.sourceId,p=1,P=0;if(E==null||E!==this._jsPlumb.lastPaintedAt){let w=this._jsPlumb.instance.updateOffset({elId:e}).o,S=this._jsPlumb.instance.updateOffset({elId:a}).o,L=this.endpoints[P],s=this.endpoints[p],l=L.anchor.getCurrentLocation({xy:[w.left,w.top],wh:[w.width,w.height],element:L,timestamp:E}),R=s.anchor.getCurrentLocation({xy:[S.left,S.top],wh:[S.width,S.height],element:s,timestamp:E});this.connector.resetBounds(),this.connector.compute({sourcePos:l,targetPos:R,sourceOrientation:L.anchor.getOrientation(L),targetOrientation:s.anchor.getOrientation(s),sourceEndpoint:this.endpoints[P],targetEndpoint:this.endpoints[p],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:w,targetInfo:S});let N={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(let i in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(i)){let b=this._jsPlumb.overlays[i];b.isVisible()&&(this._jsPlumb.overlayPlacements[i]=b.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(b)),N.minX=Math.min(N.minX,this._jsPlumb.overlayPlacements[i].minX),N.maxX=Math.max(N.maxX,this._jsPlumb.overlayPlacements[i].maxX),N.minY=Math.min(N.minY,this._jsPlumb.overlayPlacements[i].minY),N.maxY=Math.max(N.maxY,this._jsPlumb.overlayPlacements[i].maxY))}let H=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,O=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),g={xmin:Math.min(this.connector.bounds.minX-(H+O),N.minX),ymin:Math.min(this.connector.bounds.minY-(H+O),N.minY),xmax:Math.max(this.connector.bounds.maxX+(H+O),N.maxX),ymax:Math.max(this.connector.bounds.maxY+(H+O),N.maxY)};this.connector.paintExtents=g,this.connector.paint(this._jsPlumb.paintStyleInUse,null,g);for(let i in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(i)){let b=this._jsPlumb.overlays[i];b.isVisible()&&b.paint(this._jsPlumb.overlayPlacements[i],g)}}this._jsPlumb.lastPaintedAt=E}},repaint:function(r){let E=jsPlumb.extend(r||{},{});E.elId=this.sourceId,this.paint(E)},prepareEndpoint:function(r,E,a,e,p,P,w,S,L){let s;if(e)a.endpoints[p]=e,e.addConnection(a);else{P.endpoints||(P.endpoints=[null,null]);let l=L||P.endpoints[p]||P.endpoint||r.Defaults.Endpoints[p]||c.Defaults.Endpoints[p]||r.Defaults.Endpoint||c.Defaults.Endpoint;P.endpointStyles||(P.endpointStyles=[null,null]),P.endpointHoverStyles||(P.endpointHoverStyles=[null,null]);let R=P.endpointStyles[p]||P.endpointStyle||r.Defaults.EndpointStyles[p]||c.Defaults.EndpointStyles[p]||r.Defaults.EndpointStyle||c.Defaults.EndpointStyle;R.fill==null&&P.paintStyle!=null&&(R.fill=P.paintStyle.stroke),R.outlineStroke==null&&P.paintStyle!=null&&(R.outlineStroke=P.paintStyle.outlineStroke),R.outlineWidth==null&&P.paintStyle!=null&&(R.outlineWidth=P.paintStyle.outlineWidth);let N=P.endpointHoverStyles[p]||P.endpointHoverStyle||r.Defaults.EndpointHoverStyles[p]||c.Defaults.EndpointHoverStyles[p]||r.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle;P.hoverPaintStyle!=null&&(N==null&&(N={}),N.fill==null&&(N.fill=P.hoverPaintStyle.stroke));let H=P.anchors?P.anchors[p]:P.anchor?P.anchor:Y(r.Defaults.Anchors[p],S,r)||Y(c.Defaults.Anchors[p],S,r)||Y(r.Defaults.Anchor,S,r)||Y(c.Defaults.Anchor,S,r),O=P.uuids?P.uuids[p]:null;s=E({paintStyle:R,hoverPaintStyle:N,endpoint:l,connections:[a],uuid:O,anchor:H,source:w,scope:P.scope,reattach:P.reattach||r.Defaults.ReattachConnections,detachable:P.detachable||r.Defaults.ConnectionsDetachable}),e==null&&s.setDeleteOnEmpty(!0),a.endpoints[p]=s,P.drawEndpoints===!1&&s.setVisible(!1,!0,!0)}return s},replaceEndpoint:function(r,E){let a=this.endpoints[r],e=a.elementId,p=this._jsPlumb.instance.getEndpoints(e),P=p.indexOf(a),w=this.makeEndpoint(r===0,a.element,e,null,E);this.endpoints[r]=w,p.splice(P,1,w),this._jsPlumb.instance.deleteObject({endpoint:a,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:a,current:w}),this._jsPlumb.instance.anchorManager.updateOtherEndpoint(this.endpoints[0].elementId,this.endpoints[1].elementId,this.endpoints[1].elementId,this)}})}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumbUtil,U=W.jsPlumb;U.AnchorManager=function(r){let E={},a={},e={},p={},P=this,w={},S=r.jsPlumbInstance,L={},s=function(h,D,I,f,_,v,M){let m=[],u=D[_?0:1]/(f.length+1);for(let y=0;y<f.length;y++){let A=(y+1)*u,F=v*D[_?1:0];M&&(A=D[_?0:1]-A);let n=_?A:F,t=I[0]+n,d=n/D[0],x=_?F:A,j=I[1]+x,B=x/D[1];m.push([t,j,d,B,f[y][1],f[y][2]])}return m},l=function(h){return function(D,I){let f=!0;return h?f=D[0][0]<I[0][0]:f=D[0][0]>I[0][0],f===!1?-1:1}},R=function(h,D){let I=h[0][0]<0?-Math.PI-h[0][0]:Math.PI-h[0][0],f=D[0][0]<0?-Math.PI-D[0][0]:Math.PI-D[0][0];return I>f?1:-1},N={top:function(h,D){return h[0]>D[0]?1:-1},right:l(!0),bottom:l(!0),left:R},H=function(h,D){return h.sort(D)},O=function(h,D){let I=S.getCachedData(h),f=I.s,_=I.o,v=function(M,m,u,y,A,F,n){if(y.length>0){let t=H(y,N[M]),d=M==="right"||M==="top",x=s(M,m,u,t,A,F,d),j=function(B,z){a[B.id]=[z[0],z[1],z[2],z[3]],e[B.id]=n};for(let B=0;B<x.length;B++){let z=x[B][4],X=z.endpoints[0].elementId===h,V=z.endpoints[1].elementId===h;X&&j(z.endpoints[0],x[B]),V&&j(z.endpoints[1],x[B])}}};v("bottom",f,[_.left,_.top],D.bottom,!0,1,[0,1]),v("top",f,[_.left,_.top],D.top,!0,0,[0,-1]),v("left",f,[_.left,_.top],D.left,!1,0,[-1,0]),v("right",f,[_.left,_.top],D.right,!1,1,[1,0])};this.reset=function(){E={},p={},w={}},this.addFloatingConnection=function(h,D){L[h]=D},this.removeFloatingConnection=function(h){delete L[h]},this.newConnection=function(h){let D=h.sourceId,I=h.targetId,f=h.endpoints,_=!0,v=function(M,m,u,y,A){D===I&&u.isContinuous&&(h._jsPlumb.instance.removeElement(f[1].canvas),_=!1),c.addToList(p,y,[A,m,u.constructor===U.DynamicAnchor])};v(0,f[0],f[0].anchor,I,h),_&&v(1,f[1],f[1].anchor,D,h)};let g=function(h){(function(D,I){if(D){let f=function(_){return _[4]===I};c.removeWithFunction(D.top,f),c.removeWithFunction(D.left,f),c.removeWithFunction(D.bottom,f),c.removeWithFunction(D.right,f)}})(w[h.elementId],h.id)};this.connectionDetached=function(h,D){let I=h.connection||h,f=h.sourceId,_=h.targetId,v=I.endpoints,M=function(m,u,y,A,F){c.removeWithFunction(p[A],function(n){return n[0].id===F.id})};M(1,v[1],v[1].anchor,f,I),M(0,v[0],v[0].anchor,_,I),I.floatingId&&(M(I.floatingIndex,I.floatingEndpoint,I.floatingEndpoint.anchor,I.floatingId,I),g(I.floatingEndpoint)),g(I.endpoints[0]),g(I.endpoints[1]),D||(P.redraw(I.sourceId),I.targetId!==I.sourceId&&P.redraw(I.targetId))},this.add=function(h,D){c.addToList(E,D,h)},this.changeId=function(h,D){p[D]=p[h],E[D]=E[h],delete p[h],delete E[h]},this.getConnectionsFor=function(h){return p[h]||[]},this.getEndpointsFor=function(h){return E[h]||[]},this.deleteEndpoint=function(h){c.removeWithFunction(E[h.elementId],function(D){return D.id===h.id}),g(h)},this.clearFor=function(h){delete E[h],E[h]=[]};let i=function(h,D,I,f,_,v,M,m,u,y,A,F){let n=-1,t=f.endpoints[M],d=t.id,x=[1,0][M],j=[[D,I],f,_,v,d],B=h[u],z=t._continuousAnchorEdge?h[t._continuousAnchorEdge]:null,X,V;if(z){let ot=c.findWithFunction(z,function(ct){return ct[4]===d});if(ot!==-1)for(z.splice(ot,1),X=0;X<z.length;X++)V=z[X][1],c.addWithFunction(A,V,function(ct){return ct.id===V.id}),c.addWithFunction(F,z[X][1].endpoints[M],function(ct){return ct.id===V.endpoints[M].id}),c.addWithFunction(F,z[X][1].endpoints[x],function(ct){return ct.id===V.endpoints[x].id})}for(X=0;X<B.length;X++)V=B[X][1],r.idx===1&&B[X][3]===v&&n===-1&&(n=X),c.addWithFunction(A,V,function(ot){return ot.id===V.id}),c.addWithFunction(F,B[X][1].endpoints[M],function(ot){return ot.id===V.endpoints[M].id}),c.addWithFunction(F,B[X][1].endpoints[x],function(ot){return ot.id===V.endpoints[x].id});{let ot=m?n!==-1?n:0:B.length;B.splice(ot,0,j)}t._continuousAnchorEdge=u};this.updateOtherEndpoint=function(h,D,I,f){let _=c.findWithFunction(p[h],function(M){return M[0].id===f.id}),v=c.findWithFunction(p[D],function(M){return M[0].id===f.id});_!==-1&&(p[h][_][0]=f,p[h][_][1]=f.endpoints[1],p[h][_][2]=f.endpoints[1].anchor.constructor===U.DynamicAnchor),v>-1&&(p[D].splice(v,1),c.addToList(p,I,[f,f.endpoints[0],f.endpoints[0].anchor.constructor===U.DynamicAnchor])),f.updateConnectedClass()},this.sourceChanged=function(h,D,I,f){if(h!==D){I.sourceId=D,I.source=f,c.removeWithFunction(p[h],function(v){return v[0].id===I.id});let _=c.findWithFunction(p[I.targetId],function(v){return v[0].id===I.id});_>-1&&(p[I.targetId][_][0]=I,p[I.targetId][_][1]=I.endpoints[0],p[I.targetId][_][2]=I.endpoints[0].anchor.constructor===U.DynamicAnchor),c.addToList(p,D,[I,I.endpoints[1],I.endpoints[1].anchor.constructor===U.DynamicAnchor]),I.endpoints[1].anchor.isContinuous&&(I.source===I.target?I._jsPlumb.instance.removeElement(I.endpoints[1].canvas):I.endpoints[1].canvas.parentNode==null&&I._jsPlumb.instance.appendElement(I.endpoints[1].canvas)),I.updateConnectedClass()}},this.rehomeEndpoint=function(h,D,I){let f=E[D]||[],_=S.getId(I);if(_!==D){let v=f.indexOf(h);if(v>-1){let M=f.splice(v,1)[0];P.add(M,_)}}for(let v=0;v<h.connections.length;v++)h.connections[v].sourceId===D?P.sourceChanged(D,h.elementId,h.connections[v],h.element):h.connections[v].targetId===D&&(h.connections[v].targetId=h.elementId,h.connections[v].target=h.element,P.updateOtherEndpoint(h.connections[v].sourceId,D,h.elementId,h.connections[v]))},this.redraw=function(h,D,I,f,_,v){if(!S.isSuspendDrawing()){let B=E[h]||[],z=p[h]||[],X=[],V=[],ot=[];I=I||S.timestamp(),f=f||{left:0,top:0},D&&(D={left:D.left+f.left,top:D.top+f.top});let ct=S.updateOffset({elId:h,offset:D,recalc:!1,timestamp:I}),pt={};for(var M=0;M<z.length;M++){var m=z[M][0],u=m.sourceId,y=m.targetId,A=m.endpoints[0].anchor.isContinuous,F=m.endpoints[1].anchor.isContinuous;if(A||F){var n=u+"_"+y,t=pt[n],d=m.sourceId===h?1:0;A&&!w[u]&&(w[u]={top:[],right:[],bottom:[],left:[]}),F&&!w[y]&&(w[y]={top:[],right:[],bottom:[],left:[]}),h!==y&&S.updateOffset({elId:y,timestamp:I}),h!==u&&S.updateOffset({elId:u,timestamp:I});let rt=S.getCachedData(y),ft=S.getCachedData(u);y===u&&(A||F)?(i(w[u],-Math.PI/2,0,m,!1,y,0,!1,"top",u,X,V),i(w[y],-Math.PI/2,0,m,!1,u,1,!1,"top",y,X,V)):(t||(t=this.calculateOrientation(u,y,ft.o,rt.o,m.endpoints[0].anchor,m.endpoints[1].anchor,m),pt[n]=t),A&&i(w[u],t.theta,0,m,!1,y,0,!1,t.a[0],u,X,V),F&&i(w[y],t.theta2,-1,m,!0,u,1,!0,t.a[1],y,X,V)),A&&c.addWithFunction(ot,u,function(ut){return ut===u}),F&&c.addWithFunction(ot,y,function(ut){return ut===y}),c.addWithFunction(X,m,function(ut){return ut.id===m.id}),(A&&d===0||F&&d===1)&&c.addWithFunction(V,m.endpoints[d],function(ut){return ut.id===m.endpoints[d].id})}}for(M=0;M<B.length;M++)B[M].connections.length===0&&B[M].anchor.isContinuous&&(w[h]||(w[h]={top:[],right:[],bottom:[],left:[]}),i(w[h],-Math.PI/2,0,{endpoints:[B[M],B[M]],paint:function(){}},!1,h,0,!1,B[M].anchor.getDefaultFace(),h,X,V),c.addWithFunction(ot,h,function(rt){return rt===h}));for(M=0;M<ot.length;M++)O(ot[M],w[ot[M]]);for(M=0;M<B.length;M++)B[M].paint({timestamp:I,offset:ct,dimensions:ct.s,recalc:v!==!0});for(M=0;M<V.length;M++){let rt=S.getCachedData(V[M].elementId);V[M].paint({timestamp:null,offset:rt,dimensions:rt.s})}for(M=0;M<z.length;M++){var x=z[M][1];if(x.anchor.constructor===U.DynamicAnchor){x.paint({elementWithPrecedence:h,timestamp:I}),c.addWithFunction(X,z[M][0],function(rt){return rt.id===z[M][0].id});for(var j=0;j<x.connections.length;j++)x.connections[j]!==z[M][0]&&c.addWithFunction(X,x.connections[j],function(rt){return rt.id===x.connections[j].id})}else c.addWithFunction(X,z[M][0],function(rt){return rt.id===z[M][0].id})}let $=L[h];for($&&$.paint({timestamp:I,recalc:!1,elId:h}),M=0;M<X.length;M++)X[M].paint({elId:h,timestamp:null,recalc:!1,clearEdits:_})}};let b=function(h){c.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;let D=h.faces||["top","right","bottom","left"],I=h.clockwise!==!1,f={},_={top:"bottom",right:"left",left:"right",bottom:"top"},v={top:"right",right:"bottom",left:"top",bottom:"left"},M={top:"left",right:"top",left:"bottom",bottom:"right"},m=I?v:M,u=I?M:v,y=h.cssClass||"",A=null,F=null,n=["left","right"],t=["top","bottom"],d=null;for(let x=0;x<D.length;x++)f[D[x]]=!0;this.getDefaultFace=function(){return D.length===0?"top":D[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(x){return f[x]?x:f[_[x]]?_[x]:f[m[x]]?m[x]:f[u[x]]?u[x]:x},this.isEdgeSupported=function(x){return d==null?F==null?f[x]===!0:F===x:d.indexOf(x)!==-1},this.setCurrentFace=function(x,j){A=x,j&&F!=null&&(F=A)},this.getCurrentFace=function(){return A},this.getSupportedFaces=function(){let x=[];for(let j in f)f[j]&&x.push(j);return x},this.lock=function(){F=A},this.unlock=function(){F=null},this.isLocked=function(){return F!=null},this.lockCurrentAxis=function(){A!=null&&(d=A==="left"||A==="right"?n:t)},this.unlockCurrentAxis=function(){d=null},this.compute=function(x){return a[x.element.id]||[0,0]},this.getCurrentLocation=function(x){return a[x.element.id]||[0,0]},this.getOrientation=function(x){return e[x.id]||[0,0]},this.getCssClass=function(){return y}};S.continuousAnchorFactory={get:function(h){return new b(h)},clear:function(h){delete a[h]}}},U.AnchorManager.prototype.calculateOrientation=function(r,E,a,e,p,P){let w={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},S=["left","top","right","bottom"];if(r===E)return{orientation:w.IDENTITY,a:["top","top"]};let L=Math.atan2(e.centery-a.centery,e.centerx-a.centerx),s=Math.atan2(a.centery-e.centery,a.centerx-e.centerx),l=[],R={};(function(O,g){for(let i=0;i<O.length;i++)R[O[i]]={left:[g[i].left,g[i].centery],right:[g[i].right,g[i].centery],top:[g[i].centerx,g[i].top],bottom:[g[i].centerx,g[i].bottom]}})(["source","target"],[a,e]);for(let O=0;O<S.length;O++)for(let g=0;g<S.length;g++)l.push({source:S[O],target:S[g],dist:Biltong.lineLength(R.source[S[O]],R.target[S[g]])});l.sort(function(O,g){return O.dist<g.dist?-1:O.dist>g.dist?1:0});let N=l[0].source,H=l[0].target;for(let O=0;O<l.length&&(!p.isContinuous||p.isEdgeSupported(l[O].source)?N=l[O].source:N=null,!P.isContinuous||P.isEdgeSupported(l[O].target)?H=l[O].target:H=null,!(N!=null&&H!=null));O++);return p.isContinuous&&p.setCurrentFace(N),P.isContinuous&&P.setCurrentFace(H),{a:[N,H],theta:L,theta2:s}},U.Anchor=function(r){this.x=r.x||0,this.y=r.y||0,this.elementId=r.elementId,this.cssClass=r.cssClass||"",this.userDefinedLocation=null,this.orientation=r.orientation||[0,0],this.lastReturnValue=null,this.offsets=r.offsets||[0,0],this.timestamp=null;let E=r.relocatable!==!1;this.isRelocatable=function(){return E},this.setRelocatable=function(p){E=p};let a=r.snapOnRelocate!==!1;this.isSnapOnRelocate=function(){return a};let e=!1;this.lock=function(){e=!0},this.unlock=function(){e=!1},this.isLocked=function(){return e},c.EventGenerator.apply(this),this.compute=function(p){let P=p.xy,w=p.wh,S=p.timestamp;return p.clearUserDefinedLocation&&(this.userDefinedLocation=null),S&&S===this.timestamp?this.lastReturnValue:(this.userDefinedLocation!=null?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[P[0]+this.x*w[0]+this.offsets[0],P[1]+this.y*w[1]+this.offsets[1],this.x,this.y],this.timestamp=S,this.lastReturnValue)},this.getCurrentLocation=function(p){return p=p||{},this.lastReturnValue==null||p.timestamp!=null&&this.timestamp!==p.timestamp?this.compute(p):this.lastReturnValue},this.setPosition=function(p,P,w,S,L){(!e||L)&&(this.x=p,this.y=P,this.orientation=[w,S],this.lastReturnValue=null)}},c.extend(U.Anchor,c.EventGenerator,{equals:function(r){if(!r)return!1;let E=r.getOrientation(),a=this.getOrientation();return this.x===r.x&&this.y===r.y&&this.offsets[0]===r.offsets[0]&&this.offsets[1]===r.offsets[1]&&a[0]===E[0]&&a[1]===E[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(r){this.userDefinedLocation=r},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),U.FloatingAnchor=function(r){U.Anchor.apply(this,arguments);let E=r.reference,a=r.referenceCanvas,e=U.getSize(a),p=0,P=0,w=null,S=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(L){let s=L.xy,l=[s[0]+e[0]/2,s[1]+e[1]/2];return S=l,l},this.getOrientation=function(L){if(w)return w;{let s=E.getOrientation(L);return[Math.abs(s[0])*p*-1,Math.abs(s[1])*P*-1]}},this.over=function(L,s){w=L.getOrientation(s)},this.out=function(){w=null},this.getCurrentLocation=function(L){return S==null?this.compute(L):S}},c.extend(U.FloatingAnchor,U.Anchor);let et=function(r,E,a){return r.constructor===U.Anchor?r:E.makeAnchor(r,a,E)};U.DynamicAnchor=function(r){U.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=r.elementId,this.jsPlumbInstance=r.jsPlumbInstance;for(let w=0;w<r.anchors.length;w++)this.anchors[w]=et(r.anchors[w],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};let E=this.anchors.length>0?this.anchors[0]:null,a=E,e=this,p=function(w,S,L,s,l){let R=s[0]+w.x*l[0],N=s[1]+w.y*l[1],H=s[0]+l[0]/2,O=s[1]+l[1]/2;return Math.sqrt(Math.pow(S-R,2)+Math.pow(L-N,2))+Math.sqrt(Math.pow(H-R,2)+Math.pow(O-N,2))},P=r.selector||function(w,S,L,s,l){let R=L[0]+s[0]/2,N=L[1]+s[1]/2,H=-1,O=1/0;for(let g=0;g<l.length;g++){let i=p(l[g],R,N,w,S);i<O&&(H=g+0,O=i)}return l[H]};this.compute=function(w){let S=w.xy,L=w.wh,s=w.txy,l=w.twh;this.timestamp=w.timestamp;let R=e.getUserDefinedLocation();return R!=null?R:(this.isLocked()||s==null||l==null||(w.timestamp=null,E=P(S,L,s,l,this.anchors),this.x=E.x,this.y=E.y,E!==a&&this.fire("anchorChanged",E),a=E),E.compute(w))},this.getCurrentLocation=function(w){return this.getUserDefinedLocation()||(E!=null?E.getCurrentLocation(w):null)},this.getOrientation=function(w){return E!=null?E.getOrientation(w):[0,0]},this.over=function(w,S){E!=null&&E.over(w,S)},this.out=function(){E!=null&&E.out()},this.setAnchor=function(w){E=w},this.getCssClass=function(){return E&&E.getCssClass()||""},this.setAnchorCoordinates=function(w){let S=jsPlumbUtil.findWithFunction(this.anchors,function(L){return L.x===w[0]&&L.y===w[1]});return S!==-1?(this.setAnchor(this.anchors[S]),!0):!1}},c.extend(U.DynamicAnchor,U.Anchor);let Y=function(r,E,a,e,p,P){U.Anchors[p]=function(w){let S=w.jsPlumbInstance.makeAnchor([r,E,a,e,0,0],w.elementId,w.jsPlumbInstance);return S.type=p,P&&P(S,w),S}};Y(.5,0,0,-1,"TopCenter"),Y(.5,1,0,1,"BottomCenter"),Y(0,.5,-1,0,"LeftMiddle"),Y(1,.5,1,0,"RightMiddle"),Y(.5,0,0,-1,"Top"),Y(.5,1,0,1,"Bottom"),Y(0,.5,-1,0,"Left"),Y(1,.5,1,0,"Right"),Y(.5,.5,0,0,"Center"),Y(1,0,0,-1,"TopRight"),Y(1,1,0,1,"BottomRight"),Y(0,0,0,-1,"TopLeft"),Y(0,1,0,1,"BottomLeft"),U.Defaults.DynamicAnchors=function(r){return r.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],r.elementId,r.jsPlumbInstance)},U.Anchors.AutoDefault=function(r){let E=r.jsPlumbInstance.makeDynamicAnchor(U.Defaults.DynamicAnchors(r));return E.type="AutoDefault",E};let K=function(r,E){U.Anchors[r]=function(a){let e=a.jsPlumbInstance.makeAnchor(["Continuous",{faces:E}],a.elementId,a.jsPlumbInstance);return e.type=r,e}};U.Anchors.Continuous=function(r){return r.jsPlumbInstance.continuousAnchorFactory.get(r)},K("ContinuousLeft",["left"]),K("ContinuousTop",["top"]),K("ContinuousBottom",["bottom"]),K("ContinuousRight",["right"]),Y(0,0,0,0,"Assign",function(r,E){let a=E.position||"Fixed";r.positionFinder=a.constructor===String?E.jsPlumbInstance.AnchorPositionFinders[a]:a,r.constructorParams=E}),W.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(r,E,a){return[(r.left-E.left)/a[0],(r.top-E.top)/a[1]]},Grid:function(r,E,a,e){let p=r.left-E.left,P=r.top-E.top,w=a[0]/e.grid[0],S=a[1]/e.grid[1],L=Math.floor(p/w),s=Math.floor(P/S);return[(L*w+w/2)/a[0],(s*S+S/2)/a[1]]}},U.Anchors.Perimeter=function(r){r=r||{};let E=r.anchorCount||60,a=r.shape;if(!a)throw new Error("no shape supplied to Perimeter Anchor type");let e=function(){let R=.5,N=Math.PI*2/E,H=0,O=[];for(let g=0;g<E;g++){let i=R+R*Math.sin(H),b=R+R*Math.cos(H);O.push([i,b,0,0]),H+=N}return O},p=function(R){let N=E/R.length,H=[],O=function(g,i,b,h,D,I,f){N=E*D;let _=(b-g)/N,v=(h-i)/N;for(let M=0;M<N;M++)H.push([g+_*M,i+v*M,I==null?0:I,f==null?0:f])};for(let g=0;g<R.length;g++)O.apply(null,R[g]);return H},P=function(R){let N=[];for(let H=0;H<R.length;H++)N.push([R[H][0],R[H][1],R[H][2],R[H][3],1/R.length,R[H][4],R[H][5]]);return p(N)},w=function(){return P([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},S={Circle:e,Ellipse:e,Diamond:function(){return P([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:w,Square:w,Triangle:function(){return P([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(R){let N=R.points,H=[],O=0;for(let g=0;g<N.length-1;g++){let i=Math.sqrt(Math.pow(N[g][2]-N[g][0])+Math.pow(N[g][3]-N[g][1]));O+=i,H.push([N[g][0],N[g][1],N[g+1][0],N[g+1][1],i])}for(let g=0;g<H.length;g++)H[g][4]=H[g][4]/O;return p(H)}},L=function(R,N){let H=[],O=N/180*Math.PI;for(let g=0;g<R.length;g++){let i=R[g][0]-.5,b=R[g][1]-.5;H.push([.5+(i*Math.cos(O)-b*Math.sin(O)),.5+(i*Math.sin(O)+b*Math.cos(O)),R[g][2],R[g][3]])}return H};if(!S[a])throw new Error("Shape ["+a+"] is unknown by Perimeter Anchor type");let s=S[a](r);r.rotation&&(s=L(s,r.rotation));let l=r.jsPlumbInstance.makeDynamicAnchor(s);return l.type="Perimeter",l}}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et=W.Biltong;c.Segments={AbstractSegment:function(e){this.params=e,this.findClosestPointOnPath=function(p,P){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(e.x1,e.x2),minY:Math.min(e.y1,e.y2),maxX:Math.max(e.x1,e.x2),maxY:Math.max(e.y1,e.y2)}},this.lineIntersection=function(p,P,w,S){return[]},this.boxIntersection=function(p,P,w,S){let L=[];return L.push.apply(L,this.lineIntersection(p,P,p+w,P)),L.push.apply(L,this.lineIntersection(p+w,P,p+w,P+S)),L.push.apply(L,this.lineIntersection(p+w,P+S,p,P+S)),L.push.apply(L,this.lineIntersection(p,P+S,p,P)),L},this.boundingBoxIntersection=function(p){return this.boxIntersection(p.x,p.y,p.w,p.y)}},Straight:function(e){c.Segments.AbstractSegment.apply(this,arguments);let p,P,w,S,L,s,l,R=function(){p=Math.sqrt(Math.pow(L-S,2)+Math.pow(l-s,2)),P=et.gradient({x:S,y:s},{x:L,y:l}),w=-1/P};this.type="Straight",this.getLength=function(){return p},this.getGradient=function(){return P},this.getCoordinates=function(){return{x1:S,y1:s,x2:L,y2:l}},this.setCoordinates=function(i){S=i.x1,s=i.y1,L=i.x2,l=i.y2,R()},this.setCoordinates({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),this.getBounds=function(){return{minX:Math.min(S,L),minY:Math.min(s,l),maxX:Math.max(S,L),maxY:Math.max(s,l)}},this.pointOnPath=function(i,b){if(i===0&&!b)return{x:S,y:s};if(i===1&&!b)return{x:L,y:l};{let h=b?i>0?i:p+i:i*p;return et.pointOnLine({x:S,y:s},{x:L,y:l},h)}},this.gradientAtPoint=function(i){return P},this.pointAlongPathFrom=function(i,b,h){let D=this.pointOnPath(i,h),I=b<=0?{x:S,y:s}:{x:L,y:l};return b<=0&&Math.abs(b)>1&&(b*=-1),et.pointOnLine(D,I,b)};let N=function(i,b,h){return h>=Math.min(i,b)&&h<=Math.max(i,b)},H=function(i,b,h){return Math.abs(h-i)<Math.abs(h-b)?i:b};this.findClosestPointOnPath=function(i,b){let h={d:1/0,x:null,y:null,l:null,x1:S,x2:L,y1:s,y2:l};if(P===0)h.y=s,h.x=N(S,L,i)?i:H(S,L,i);else if(P===1/0||P===-1/0)h.x=S,h.y=N(s,l,b)?b:H(s,l,b);else{let I=s-P*S,f=b-w*i,_=(f-I)/(P-w),v=P*_+I;h.x=N(S,L,_)?_:H(S,L,_),h.y=N(s,l,v)?v:H(s,l,v)}let D=et.lineLength([h.x,h.y],[S,s]);return h.d=et.lineLength([i,b],[h.x,h.y]),h.l=D/p,h};let O=function(i,b,h){return h>b?b<=i&&i<=h:b>=i&&i>=h},g=O;this.lineIntersection=function(i,b,h,D){let I=Math.abs(et.gradient({x:i,y:b},{x:h,y:D})),f=Math.abs(P),_=f===1/0?S:s-f*S,v=[],M=I===1/0?i:b-I*i;if(I!==f)if(I===1/0&&f===0)g(i,S,L)&&g(s,b,D)&&(v=[i,s]);else if(I===0&&f===1/0)g(b,s,l)&&g(S,i,h)&&(v=[S,b]);else{let m,u;I===1/0?(m=i,g(m,S,L)&&(u=f*i+_,g(u,b,D)&&(v=[m,u]))):I===0?(u=b,g(u,s,l)&&(m=(b-_)/f,g(m,i,h)&&(v=[m,u]))):(m=(M-_)/(f-I),u=f*m+_,g(m,S,L)&&g(u,s,l)&&(v=[m,u]))}return v},this.boxIntersection=function(i,b,h,D){let I=[];return I.push.apply(I,this.lineIntersection(i,b,i+h,b)),I.push.apply(I,this.lineIntersection(i+h,b,i+h,b+D)),I.push.apply(I,this.lineIntersection(i+h,b+D,i,b+D)),I.push.apply(I,this.lineIntersection(i,b+D,i,b)),I},this.boundingBoxIntersection=function(i){return this.boxIntersection(i.x,i.y,i.w,i.h)}},Arc:function(e){c.Segments.AbstractSegment.apply(this,arguments);var p=function(H,O){return et.theta([e.cx,e.cy],[H,O])},P=function(H,O){if(H.anticlockwise){let g=H.startAngle<H.endAngle?H.startAngle+w:H.startAngle,i=Math.abs(g-H.endAngle);return g-i*O}else{let g=H.endAngle<H.startAngle?H.endAngle+w:H.endAngle,i=Math.abs(g-H.startAngle);return H.startAngle+i*O}},w=2*Math.PI;this.radius=e.r,this.anticlockwise=e.ac,this.type="Arc",e.startAngle&&e.endAngle?(this.startAngle=e.startAngle,this.endAngle=e.endAngle,this.x1=e.cx+this.radius*Math.cos(e.startAngle),this.y1=e.cy+this.radius*Math.sin(e.startAngle),this.x2=e.cx+this.radius*Math.cos(e.endAngle),this.y2=e.cy+this.radius*Math.sin(e.endAngle)):(this.startAngle=p(e.x1,e.y1),this.endAngle=p(e.x2,e.y2),this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2),this.endAngle<0&&(this.endAngle+=w),this.startAngle<0&&(this.startAngle+=w);let S=this.endAngle<this.startAngle?this.endAngle+w:this.endAngle;this.sweep=Math.abs(S-this.startAngle),this.anticlockwise&&(this.sweep=w-this.sweep);let L=2*Math.PI*this.radius,s=this.sweep/w,l=L*s;this.getLength=function(){return l},this.getBounds=function(){return{minX:e.cx-e.r,maxX:e.cx+e.r,minY:e.cy-e.r,maxY:e.cy+e.r}};let R=1e-10,N=function(H){let O=Math.floor(H),g=Math.ceil(H);return H-O<R?O:g-H<R?g:H};this.pointOnPath=function(H,O){if(H===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(H===1)return{x:this.x2,y:this.y2,theta:this.endAngle};O&&(H=H/l);let g=P(this,H),i=e.cx+e.r*Math.cos(g),b=e.cy+e.r*Math.sin(g);return{x:N(i),y:N(b),theta:g}},this.gradientAtPoint=function(H,O){let g=this.pointOnPath(H,O),i=et.normal([e.cx,e.cy],[g.x,g.y]);return!this.anticlockwise&&(i===1/0||i===-1/0)&&(i*=-1),i},this.pointAlongPathFrom=function(H,O,g){let i=this.pointOnPath(H,g),b=O/L*2*Math.PI,h=this.anticlockwise?-1:1,D=i.theta+h*b,I=e.cx+this.radius*Math.cos(D),f=e.cy+this.radius*Math.sin(D);return{x:I,y:f}}},Bezier:function(e){this.curve=[{x:e.x1,y:e.y1},{x:e.cp1x,y:e.cp1y},{x:e.cp2x,y:e.cp2y},{x:e.x2,y:e.y2}],c.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(e.x1,e.x2,e.cp1x,e.cp2x),minY:Math.min(e.y1,e.y2,e.cp1y,e.cp2y),maxX:Math.max(e.x1,e.x2,e.cp1x,e.cp2x),maxY:Math.max(e.y1,e.y2,e.cp1y,e.cp2y)},this.type="Bezier";let p=function(P,w,S){return S&&(w=W.jsBezier.locationAlongCurveFrom(P,w>0?0:1,w)),w};this.pointOnPath=function(P,w){return P=p(this.curve,P,w),W.jsBezier.pointOnCurve(this.curve,P)},this.gradientAtPoint=function(P,w){return P=p(this.curve,P,w),W.jsBezier.gradientAtPoint(this.curve,P)},this.pointAlongPathFrom=function(P,w,S){return P=p(this.curve,P,S),W.jsBezier.pointAlongCurveFrom(this.curve,P,w)},this.getLength=function(){return W.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(P,w){let S=W.jsBezier.nearestPointOnCurve({x:P,y:w},this.curve);return{d:Math.sqrt(Math.pow(S.point.x-P,2)+Math.pow(S.point.y-w,2)),x:S.point.x,y:S.point.y,l:1-S.location,s:this}},this.lineIntersection=function(P,w,S,L){return W.jsBezier.lineIntersection(P,w,S,L,this.curve)}}},c.SegmentRenderer={getPath:function(e,p){return{Straight:function(P){let w=e.getCoordinates();return(P?"M "+w.x1+" "+w.y1+" ":"")+"L "+w.x2+" "+w.y2},Bezier:function(P){let w=e.params;return(P?"M "+w.x2+" "+w.y2+" ":"")+"C "+w.cp2x+" "+w.cp2y+" "+w.cp1x+" "+w.cp1y+" "+w.x1+" "+w.y1},Arc:function(P){let w=e.params,S=e.sweep>Math.PI?1:0,L=e.anticlockwise?0:1;return(P?"M"+e.x1+" "+e.y1+" ":"")+"A "+e.radius+" "+w.r+" 0 "+S+","+L+" "+e.x2+" "+e.y2}}[e.type](p)}};let Y=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};c.Connectors.AbstractConnector=function(e){Y.apply(this,arguments);let p=[],P=0,w=[],S=[],L=e.stub||0,s=U.isArray(L)?L[0]:L,l=U.isArray(L)?L[1]:L,R=e.gap||0,N=U.isArray(R)?R[0]:R,H=U.isArray(R)?R[1]:R,O=null,g=null;this.getPathData=function(){let f="";for(let _=0;_<p.length;_++)f+=c.SegmentRenderer.getPath(p[_],_===0),f+=" ";return f},this.findSegmentForPoint=function(f,_){let v={d:1/0,s:null,x:null,y:null,l:null};for(let M=0;M<p.length;M++){let m=p[M].findClosestPointOnPath(f,_);m.d<v.d&&(v.d=m.d,v.l=m.l,v.x=m.x,v.y=m.y,v.s=p[M],v.x1=m.x1,v.x2=m.x2,v.y1=m.y1,v.y2=m.y2,v.index=M,v.connectorLocation=w[M][0]+m.l*(w[M][1]-w[M][0]))}return v},this.lineIntersection=function(f,_,v,M){let m=[];for(let u=0;u<p.length;u++)m.push.apply(m,p[u].lineIntersection(f,_,v,M));return m},this.boxIntersection=function(f,_,v,M){let m=[];for(let u=0;u<p.length;u++)m.push.apply(m,p[u].boxIntersection(f,_,v,M));return m},this.boundingBoxIntersection=function(f){let _=[];for(let v=0;v<p.length;v++)_.push.apply(_,p[v].boundingBoxIntersection(f));return _};let i=function(){let f=0;for(let _=0;_<p.length;_++){let v=p[_].getLength();S[_]=v/P,w[_]=[f,f+=v/P]}},b=function(f,_){_&&(f=f>0?f/P:(P+f)/P);let v=w.length-1,M=1;for(let m=0;m<w.length;m++)if(w[m][1]>=f){v=m,M=f===1?1:f===0?0:(f-w[m][0])/S[m];break}return{segment:p[v],proportion:M,index:v}},h=function(f,_,v){if(v.x1===v.x2&&v.y1===v.y2)return;let M=new c.Segments[_](v);p.push(M),P+=M.getLength(),f.updateBounds(M)},D=function(){P=p.length=w.length=S.length=0};this.setSegments=function(f){O=[],P=0;for(let _=0;_<f.length;_++)O.push(f[_]),P+=f[_].getLength()},this.getLength=function(){return P};let I=function(f){this.strokeWidth=f.strokeWidth;let _=et.quadrant(f.sourcePos,f.targetPos),v=f.targetPos[0]<f.sourcePos[0],M=f.targetPos[1]<f.sourcePos[1],m=f.strokeWidth||1,u=f.sourceEndpoint.anchor.getOrientation(f.sourceEndpoint),y=f.targetEndpoint.anchor.getOrientation(f.targetEndpoint),A=v?f.targetPos[0]:f.sourcePos[0],F=M?f.targetPos[1]:f.sourcePos[1],n=Math.abs(f.targetPos[0]-f.sourcePos[0]),t=Math.abs(f.targetPos[1]-f.sourcePos[1]);if(u[0]===0&&u[1]===0||y[0]===0&&y[1]===0){let V=n>t?0:1,ot=[1,0][V];u=[],y=[],u[V]=f.sourcePos[V]>f.targetPos[V]?-1:1,y[V]=f.sourcePos[V]>f.targetPos[V]?1:-1,u[ot]=0,y[ot]=0}let d=v?n+N*u[0]:N*u[0],x=M?t+N*u[1]:N*u[1],j=v?H*y[0]:n+H*y[0],B=M?H*y[1]:t+H*y[1],z=u[0]*y[0]+u[1]*y[1],X={sx:d,sy:x,tx:j,ty:B,lw:m,xSpan:Math.abs(j-d),ySpan:Math.abs(B-x),mx:(d+j)/2,my:(x+B)/2,so:u,to:y,x:A,y:F,w:n,h:t,segment:_,startStubX:d+u[0]*s,startStubY:x+u[1]*s,endStubX:j+y[0]*l,endStubY:B+y[1]*l,isXGreaterThanStubTimes2:Math.abs(d-j)>s+l,isYGreaterThanStubTimes2:Math.abs(x-B)>s+l,opposite:z===-1,perpendicular:z===0,orthogonal:z===1,sourceAxis:u[0]===0?"y":"x",points:[A,F,n,t,d,x,j,B],stubs:[s,l]};return X.anchorOrientation=X.opposite?"opposite":X.orthogonal?"orthogonal":"perpendicular",X};return this.getSegments=function(){return p},this.updateBounds=function(f){let _=f.getBounds();this.bounds.minX=Math.min(this.bounds.minX,_.minX),this.bounds.maxX=Math.max(this.bounds.maxX,_.maxX),this.bounds.minY=Math.min(this.bounds.minY,_.minY),this.bounds.maxY=Math.max(this.bounds.maxY,_.maxY)},this.pointOnPath=function(f,_){let v=b(f,_);return v.segment&&v.segment.pointOnPath(v.proportion,!1)||[0,0]},this.gradientAtPoint=function(f,_){let v=b(f,_);return v.segment&&v.segment.gradientAtPoint(v.proportion,!1)||0},this.pointAlongPathFrom=function(f,_,v){let M=b(f,v);return M.segment&&M.segment.pointAlongPathFrom(M.proportion,_,!1)||[0,0]},this.compute=function(f){g=I.call(this,f),D(),this._compute(g,f),this.x=g.points[0],this.y=g.points[1],this.w=g.points[2],this.h=g.points[3],this.segment=g.segment,i()},{addSegment:h,prepareCompute:I,sourceStub:s,targetStub:l,maxStub:Math.max(s,l),sourceGap:N,targetGap:H,maxGap:Math.max(N,H)}},U.extend(c.Connectors.AbstractConnector,Y),c.Endpoints.AbstractEndpoint=function(e){return Y.apply(this,arguments),{compute:this.compute=function(P,w,S,L){let s=this._compute.apply(this,arguments);return this.x=s[0],this.y=s[1],this.w=s[2],this.h=s[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,s},cssClass:e.cssClass}},U.extend(c.Endpoints.AbstractEndpoint,Y),c.Endpoints.Dot=function(e){this.type="Dot",c.Endpoints.AbstractEndpoint.apply(this,arguments),e=e||{},this.radius=e.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(p,P,w,S){this.radius=w.radius||this.radius;let L=p[0]-this.radius,s=p[1]-this.radius,l=this.radius*2,R=this.radius*2;if(w.stroke){let N=w.strokeWidth||1;L-=N,s-=N,l+=N*2,R+=N*2}return[L,s,l,R,this.radius]}},U.extend(c.Endpoints.Dot,c.Endpoints.AbstractEndpoint),c.Endpoints.Rectangle=function(e){this.type="Rectangle",c.Endpoints.AbstractEndpoint.apply(this,arguments),e=e||{},this.width=e.width||20,this.height=e.height||20,this._compute=function(p,P,w,S){let L=w.width||this.width,s=w.height||this.height,l=p[0]-L/2,R=p[1]-s/2;return[l,R,L,s]}},U.extend(c.Endpoints.Rectangle,c.Endpoints.AbstractEndpoint);let K=function(e){c.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};U.extend(K,c.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(e){this._jsPlumb.displayElements.push(e)}}),c.Endpoints.Image=function(e){this.type="Image",K.apply(this,arguments),c.Endpoints.AbstractEndpoint.apply(this,arguments);let p=e.onload,P=e.src||e.url,w=e.cssClass?" "+e.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=e.width,this._jsPlumb.heightToUse=e.height,this._jsPlumb.endpoint=e.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,p&&p(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(S,L){let s=S.constructor===String?S:S.src;p=L,this._jsPlumb.img.src=s,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(P,p),this._compute=function(S,L,s,l){return this.anchorPoint=S,this._jsPlumb.ready?[S[0]-this._jsPlumb.widthToUse/2,S[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=c.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+w),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(S,L,s){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);let l=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,R=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;U.sizeElement(this.canvas,l,R,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(S,L){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(S,L):W.setTimeout(function(){this.paint(S,L)}.bind(this),200))}},U.extend(c.Endpoints.Image,[K,c.Endpoints.AbstractEndpoint],{cleanup:function(e){e&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),c.Endpoints.Blank=function(e){c.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",K.apply(this,arguments),this._compute=function(P,w,S,L){return[P[0],P[1],10,0]};let p=e.cssClass?" "+e.cssClass:"";this.canvas=c.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+p),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(P,w){U.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},U.extend(c.Endpoints.Blank,[c.Endpoints.AbstractEndpoint,K],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),c.Endpoints.Triangle=function(e){this.type="Triangle",c.Endpoints.AbstractEndpoint.apply(this,arguments);let p=this;e=e||{},e.width=e.width||55,e.height=e.height||55,this.width=e.width,this.height=e.height,this._compute=function(P,w,S,L){let s=S.width||p.width,l=S.height||p.height,R=P[0]-s/2,N=P[1]-l/2;return[R,N,s,l]}};let r=c.Overlays.AbstractOverlay=function(e){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=e.component,this.loc=e.location==null?.5:e.location,this.endpointLoc=e.endpointLocation==null?[.5,.5]:e.endpointLocation,this.visible=e.visible!==!1};r.prototype={cleanup:function(e){e&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(e,p){},setVisible:function(e){this.visible=e,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(e){this.loc+=e,this.component.repaint()},setLocation:function(e){this.loc=e,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},c.Overlays.Arrow=function(e){this.type="Arrow",r.apply(this,arguments),this.isAppendedAtTopLevel=!1,e=e||{};let p=this;this.length=e.length||20,this.width=e.width||20,this.id=e.id,this.direction=(e.direction||1)<0?-1:1;let P=e.paintStyle||{"stroke-width":1},w=e.foldback||.623;this.computeMaxSize=function(){return p.width*1.5},this.elementCreated=function(S,L){if(this.path=S,e.events)for(let s in e.events)c.on(S,s,e.events[s])},this.draw=function(S,L){let s,l,R,N,H;if(S.pointAlongPathFrom){if(U.isString(this.loc)||this.loc>1||this.loc<0){let h=parseInt(this.loc,10),D=this.loc<0?1:0;s=S.pointAlongPathFrom(D,h,!1),l=S.pointAlongPathFrom(D,h-this.direction*this.length/2,!1),R=et.pointOnLine(s,l,this.length)}else if(this.loc===1){if(s=S.pointOnPath(this.loc),l=S.pointAlongPathFrom(this.loc,-this.length),R=et.pointOnLine(s,l,this.length),this.direction===-1){let h=R;R=s,s=h}}else if(this.loc===0){if(R=S.pointOnPath(this.loc),l=S.pointAlongPathFrom(this.loc,this.length),s=et.pointOnLine(R,l,this.length),this.direction===-1){let h=R;R=s,s=h}}else s=S.pointAlongPathFrom(this.loc,this.direction*this.length/2),l=S.pointOnPath(this.loc),R=et.pointOnLine(s,l,this.length);N=et.perpendicularLineTo(s,R,this.width),H=et.pointOnLine(s,R,w*this.length);let O={hxy:s,tail:N,cxy:H},g=P.stroke||L.stroke,i=P.fill||L.stroke,b=P.strokeWidth||L.strokeWidth;return{component:S,d:O,"stroke-width":b,stroke:g,fill:i,minX:Math.min(s.x,N[0].x,N[1].x),maxX:Math.max(s.x,N[0].x,N[1].x),minY:Math.min(s.y,N[0].y,N[1].y),maxY:Math.max(s.y,N[0].y,N[1].y)}}else return{component:S,minX:0,maxX:0,minY:0,maxY:0}}},U.extend(c.Overlays.Arrow,r,{updateFrom:function(e){this.length=e.length||this.length,this.width=e.width||this.width,this.direction=e.direction!=null?e.direction:this.direction,this.foldback=e.foldback||this.foldback},cleanup:function(){this.path&&this.canvas&&this.canvas.removeChild(this.path)}}),c.Overlays.PlainArrow=function(e){e=e||{};let p=c.extend(e,{foldback:1});c.Overlays.Arrow.call(this,p),this.type="PlainArrow"},U.extend(c.Overlays.PlainArrow,c.Overlays.Arrow),c.Overlays.Diamond=function(e){e=e||{};let p=e.length||40,P=c.extend(e,{length:p/2,foldback:2});c.Overlays.Arrow.call(this,P),this.type="Diamond"},U.extend(c.Overlays.Diamond,c.Overlays.Arrow);let E=function(e,p){return(e._jsPlumb.cachedDimensions==null||p)&&(e._jsPlumb.cachedDimensions=e.getDimensions()),e._jsPlumb.cachedDimensions},a=function(e){c.jsPlumbUIComponent.apply(this,arguments),r.apply(this,arguments);let p=this.fire;this.fire=function(){p.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=e.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=e.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=e.create,this._jsPlumb.initiallyInvisible=e.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){let P=this._jsPlumb.div=c.getElement(this._jsPlumb.create(this._jsPlumb.component));P.style.position="absolute",jsPlumb.addClass(P,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:e.cssClass?e.cssClass:"")),this._jsPlumb.instance.appendElement(P),this._jsPlumb.instance.getId(P),this.canvas=P;let w="translate(-50%, -50%)";P.style.webkitTransform=w,P.style.mozTransform=w,P.style.msTransform=w,P.style.oTransform=w,P.style.transform=w,P._jsPlumb=this,e.visible===!1&&(P.style.display="none")}return this._jsPlumb.div},this.draw=function(P,w,S){let L=E(this);if(L!=null&&L.length===2){let s={x:0,y:0};if(S)s={x:S[0],y:S[1]};else if(P.pointOnPath){let N=this.loc,H=!1;(U.isString(this.loc)||this.loc<0||this.loc>1)&&(N=parseInt(this.loc,10),H=!0),s=P.pointOnPath(N,H)}else{let N=this.loc.constructor===Array?this.loc:this.endpointLoc;s={x:N[0]*P.w,y:N[1]*P.h}}let l=s.x-L[0]/2,R=s.y-L[1]/2;return{component:P,d:{minx:l,miny:R,td:L,cxy:s},minX:l,maxX:l+L[0],minY:R,maxY:R+L[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};U.extend(a,[c.jsPlumbUIComponent,r],{getDimensions:function(){return[1,1]},setVisible:function(e){this._jsPlumb.div&&(this._jsPlumb.div.style.display=e?"block":"none",e&&this._jsPlumb.initiallyInvisible&&(E(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(e){e?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(e,p){this._jsPlumb.div!=null&&e.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){let e=E(this);return Math.max(e[0],e[1])},paint:function(e,p){this._jsPlumb.initialised||(this.getElement(),e.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=e.component.x+e.d.minx+"px",this._jsPlumb.div.style.top=e.component.y+e.d.miny+"px"}}),c.Overlays.Custom=function(e){this.type="Custom",a.apply(this,arguments)},U.extend(c.Overlays.Custom,a),c.Overlays.GuideLines=function(){let e=this;e.length=50,e.strokeWidth=5,this.type="GuideLines",r.apply(this,arguments),c.jsPlumbUIComponent.apply(this,arguments),this.draw=function(p,P){let w=p.pointAlongPathFrom(e.loc,e.length/2),S=p.pointOnPath(e.loc),L=et.pointOnLine(w,S,e.length),s=et.perpendicularLineTo(w,L,40),l=et.perpendicularLineTo(L,w,20);return{connector:p,head:w,tail:L,headLine:l,tailLine:s,minX:Math.min(w.x,L.x,l[0].x,l[1].x),minY:Math.min(w.y,L.y,l[0].y,l[1].y),maxX:Math.max(w.x,L.x,l[0].x,l[1].x),maxY:Math.max(w.y,L.y,l[0].y,l[1].y)}}},c.Overlays.Label=function(e){this.labelStyle=e.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;let p=c.extend({create:function(){return c.createElement("div")}},e);if(c.Overlays.Custom.call(this,p),this.type="Label",this.label=e.label||"",this.labelText=null,this.labelStyle){let P=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",P.style.font=this.labelStyle.font,P.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(P.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){let w=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";P.style.border=this.labelStyle.borderWidth+"px solid "+w}this.labelStyle.padding&&(P.style.padding=this.labelStyle.padding)}},U.extend(c.Overlays.Label,c.Overlays.Custom,{cleanup:function(e){e&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(e){this.label=e,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),a.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){let e=this.label(this);this.getElement().innerHTML=e.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(e){e.label!=null&&this.setLabel(e.label)}})}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumbUtil,U=W.jsPlumbInstance,et="jtk-group-collapsed",Y="jtk-group-expanded",K="[jtk-group-content]",r="elementDraggable",E="stop",a="revert",e="_groupManager",p="_jsPlumbGroup",P="_jsPlumbGroupDrag",w="group:addMember",S="group:removeMember",L="group:add",s="group:remove",l="group:expand",R="group:collapse",N="groupDragStop",H="connectionMoved",O="internal.connectionDetached",g="removeAll",i="orphanAll",b="show",h="hide",D=function(f){let _={},v={},M={},m=this;f.bind("connection",function(t){t.source[p]!=null&&t.target[p]!=null&&t.source[p]===t.target[p]?(v[t.connection.id]=t.source[p],M[t.connection.id]=t.source[p]):(t.source[p]!=null&&(c.suggest(t.source[p].connections.source,t.connection),v[t.connection.id]=t.source[p]),t.target[p]!=null&&(c.suggest(t.target[p].connections.target,t.connection),M[t.connection.id]=t.target[p]))});function u(t){delete t.proxies;let d=v[t.id],x;d!=null&&(x=function(j){return j.id===t.id},c.removeWithFunction(d.connections.source,x),c.removeWithFunction(d.connections.target,x),delete v[t.id]),d=M[t.id],d!=null&&(x=function(j){return j.id===t.id},c.removeWithFunction(d.connections.source,x),c.removeWithFunction(d.connections.target,x),delete M[t.id])}f.bind(O,function(t){u(t.connection)}),f.bind(H,function(t){let x=(t.index===0?v:M)[t.connection.id];if(x){let j=x.connections[t.index===0?"source":"target"],B=j.indexOf(t.connection);B!==-1&&j.splice(B,1)}}),this.addGroup=function(t){f.addClass(t.getEl(),Y),_[t.id]=t,t.manager=this,n(t),f.fire(L,{group:t})},this.addToGroup=function(t,d,x){if(t=this.getGroup(t),t){let j=t.getEl();if(d._isJsPlumbGroup)return;let B=d._jsPlumbGroup;if(B!==t){let z=f.getOffset(d,!0),X=t.collapsed?f.getOffset(j,!0):f.getOffset(t.getDragArea(),!0);B!=null&&(B.remove(d,!1,x,!1,t),m.updateConnectionsForGroup(B)),t.add(d,x);let V=function(pt,$){let rt=$===0?1:0;pt.each(function(ft){ft.setVisible(!1),ft.endpoints[rt].element._jsPlumbGroup===t?(ft.endpoints[rt].setVisible(!1),F(ft,rt,t)):(ft.endpoints[$].setVisible(!1),A(ft,$,t))})};t.collapsed&&(V(f.select({source:d}),0),V(f.select({target:d}),1));let ot=f.getId(d);f.dragManager.setParent(d,ot,j,f.getId(j),z);let ct={left:z.left-X.left,top:z.top-X.top};if(f.setPosition(d,ct),f.dragManager.revalidateParent(d,ot,z),m.updateConnectionsForGroup(t),f.revalidate(ot),!x){let pt={group:t,el:d,pos:ct};B&&(pt.sourceGroup=B),f.fire(w,pt)}}}},this.removeFromGroup=function(t,d,x){t=this.getGroup(t),t&&t.remove(d,null,x)},this.getGroup=function(t){let d=t;if(c.isString(t)&&(d=_[t],d==null))throw new TypeError("No such group ["+t+"]");return d},this.getGroups=function(){let t=[];for(let d in _)t.push(_[d]);return t},this.removeGroup=function(t,d,x,j){t=this.getGroup(t),this.expandGroup(t,!0);let B=t[d?g:i](x,j);return f.remove(t.getEl()),delete _[t.id],delete f._groups[t.id],f.fire(s,{group:t}),B},this.removeAllGroups=function(t,d,x){for(let j in _)this.removeGroup(_[j],t,d,x)};function y(t,d){let x=t.getMembers();for(let j=0;j<x.length;j++)f[d?b:h](x[j],!0)}var A=function(t,d,x){let j=t.endpoints[d===0?1:0].element;if(j[p]&&!j[p].shouldProxy()&&j[p].collapsed)return;let B=x.getEl(),z=f.getId(B);f.proxyConnection(t,d,B,z,function(X,V){return x.getEndpoint(X,V)},function(X,V){return x.getAnchor(X,V)})};this.collapseGroup=function(t){if(t=this.getGroup(t),t==null||t.collapsed)return;let d=t.getEl();if(y(t,!1),t.shouldProxy()){let x=function(j,B){for(let z=0;z<j.length;z++){let X=j[z];A(X,B,t)}};x(t.connections.source,0),x(t.connections.target,1)}t.collapsed=!0,f.removeClass(d,Y),f.addClass(d,et),f.revalidate(d),f.fire(R,{group:t})};var F=function(t,d,x){f.unproxyConnection(t,d,f.getId(x.getEl()))};this.expandGroup=function(t,d){if(t=this.getGroup(t),t==null||!t.collapsed)return;let x=t.getEl();if(y(t,!0),t.shouldProxy()){let j=function(B,z){for(let X=0;X<B.length;X++){let V=B[X];F(V,z,t)}};j(t.connections.source,0),j(t.connections.target,1)}t.collapsed=!1,f.addClass(x,Y),f.removeClass(x,et),f.revalidate(x),this.repaintGroup(t),d||f.fire(l,{group:t})},this.repaintGroup=function(t){t=this.getGroup(t);let d=t.getMembers();for(let x=0;x<d.length;x++)f.revalidate(d[x])};function n(t){let d=t.getMembers(),x=f.getConnections({source:d,scope:"*"},!0),j=f.getConnections({target:d,scope:"*"},!0),B={};t.connections.source.length=0,t.connections.target.length=0;let z=function(X){for(let V=0;V<X.length;V++)B[X[V].id]||(B[X[V].id]=!0,X[V].source._jsPlumbGroup===t?(X[V].target._jsPlumbGroup!==t&&t.connections.source.push(X[V]),v[X[V].id]=t):X[V].target._jsPlumbGroup===t&&(t.connections.target.push(X[V]),M[X[V].id]=t))};z(x),z(j)}this.updateConnectionsForGroup=n,this.refreshAllGroups=function(){for(let t in _)n(_[t]),f.dragManager.updateOffsets(f.getId(_[t].getEl()))}},I=function(f,_){let v=this,M=_.el;this.getEl=function(){return M},this.id=_.id||c.uuid(),M._isJsPlumbGroup=!0;let m=this.getDragArea=function(){let $=f.getSelector(M,K);return $&&$.length>0?$[0]:M},u=_.ghost===!0,y=u||_.constrain===!0,A=_.revert!==!1,F=_.orphan===!0,n=_.prune===!0,t=_.dropOverride===!0,d=_.proxied!==!1,x=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function($,rt){return _.anchor||"Continuous"},this.getEndpoint=function($,rt){return _.endpoint||["Dot",{radius:10}]},this.collapsed=!1,_.draggable!==!1){let $={stop:function(rt){f.fire(N,jsPlumb.extend(rt,{group:v}))},scope:P};_.dragOptions&&W.jsPlumb.extend($,_.dragOptions),f.draggable(_.el,$)}_.droppable!==!1&&f.droppable(_.el,{drop:function($){let rt=$.drag.el;if(rt._isJsPlumbGroup)return;let ft=rt._jsPlumbGroup;if(ft!==v){if(ft!=null&&ft.overrideDrop(rt,v))return;f.getGroupManager().addToGroup(v,rt,!1)}}});let j=function($,rt){let ft=$.nodeType==null?$:[$];for(let ut=0;ut<ft.length;ut++)rt(ft[ut])};this.overrideDrop=function($,rt){return t&&(A||n||F)},this.add=function($,rt){let ft=m();j($,function(ut){if(ut._jsPlumbGroup!=null){if(ut._jsPlumbGroup===v)return;ut._jsPlumbGroup.remove(ut,!0,rt,!1)}ut._jsPlumbGroup=v,x.push(ut),f.isAlreadyDraggable(ut)&&pt(ut),ut.parentNode!==ft&&ft.appendChild(ut)}),f.getGroupManager().updateConnectionsForGroup(v)},this.remove=function($,rt,ft,ut,ht){j($,function(Ct){if(Ct._jsPlumbGroup===v){if(delete Ct._jsPlumbGroup,c.removeWithFunction(x,function(mt){return mt===Ct}),rt)try{v.getDragArea().removeChild(Ct)}catch(mt){jsPlumbUtil.log("Could not remove element from Group "+mt)}if(ct(Ct),!ft){let mt={group:v,el:Ct};ht&&(mt.targetGroup=ht),f.fire(S,mt)}}}),ut||f.getGroupManager().updateConnectionsForGroup(v)},this.removeAll=function($,rt){for(let ft=0,ut=x.length;ft<ut;ft++){let ht=x[0];v.remove(ht,$,rt,!0),f.remove(ht,!0)}x.length=0,f.getGroupManager().updateConnectionsForGroup(v)},this.orphanAll=function(){let $={};for(let rt=0;rt<x.length;rt++){let ft=X(x[rt]);$[ft[0]]=ft[1]}return x.length=0,$},this.getMembers=function(){return x},M[p]=this,f.bind(r,function($){$.el._jsPlumbGroup===this&&pt($.el)}.bind(this));function B($){return $.offsetParent}function z($,rt){let ft=B($),ut=f.getSize(ft),ht=f.getSize($),Ct=rt[0],mt=Ct+ht[0],Z=rt[1],Q=Z+ht[1];return mt>0&&Ct<ut[0]&&Q>0&&Z<ut[1]}function X($){let rt=f.getId($),ft=f.getOffset($);return $.parentNode.removeChild($),f.getContainer().appendChild($),f.setPosition($,ft),ct($),f.dragManager.clearParent($,rt),[rt,ft]}function V($){let rt=[];function ft(ut,ht,Ct){let mt=null;if(!z(ut,[ht,Ct])){let Z=ut._jsPlumbGroup;n?f.remove(ut):mt=X(ut),Z.remove(ut)}return mt}for(let ut=0;ut<$.selection.length;ut++)rt.push(ft($.selection[ut][0],$.selection[ut][1].left,$.selection[ut][1].top));return rt.length===1?rt[0]:rt}function ot($){let rt=f.getId($);f.revalidate($),f.dragManager.revalidateParent($,rt)}function ct($){!$._katavorioDrag||((n||F)&&$._katavorioDrag.off(E,V),!n&&!F&&A&&($._katavorioDrag.off(a,ot),$._katavorioDrag.setRevert(null)))}function pt($){!$._katavorioDrag||((n||F)&&$._katavorioDrag.on(E,V),y&&$._katavorioDrag.setConstrain(!0),u&&$._katavorioDrag.setUseGhostProxy(!0),!n&&!F&&A&&($._katavorioDrag.on(a,ot),$._katavorioDrag.setRevert(function(rt,ft){return!z(rt,ft)})))}this.shouldProxy=function(){return d},f.getGroupManager().addGroup(this)};U.prototype.addGroup=function(f){let _=this;if(_._groups=_._groups||{},_._groups[f.id]!=null)throw new TypeError("cannot create Group ["+f.id+"]; a Group with that ID exists");if(f.el[p]!=null)throw new TypeError("cannot create Group ["+f.id+"]; the given element is already a Group");let v=new I(_,f);return _._groups[v.id]=v,f.collapsed&&this.collapseGroup(v),v},U.prototype.addToGroup=function(f,_,v){let M=function(m){let u=this.getId(m);this.manage(u,m),this.getGroupManager().addToGroup(f,m,v)}.bind(this);if(Array.isArray(_))for(let m=0;m<_.length;m++)M(_[m]);else M(_)},U.prototype.removeFromGroup=function(f,_,v){this.getGroupManager().removeFromGroup(f,_,v)},U.prototype.removeGroup=function(f,_,v,M){return this.getGroupManager().removeGroup(f,_,v,M)},U.prototype.removeAllGroups=function(f,_,v){this.getGroupManager().removeAllGroups(f,_,v)},U.prototype.getGroup=function(f){return this.getGroupManager().getGroup(f)},U.prototype.getGroups=function(){return this.getGroupManager().getGroups()},U.prototype.expandGroup=function(f){this.getGroupManager().expandGroup(f)},U.prototype.collapseGroup=function(f){this.getGroupManager().collapseGroup(f)},U.prototype.repaintGroup=function(f){this.getGroupManager().repaintGroup(f)},U.prototype.toggleGroup=function(f){f=this.getGroupManager().getGroup(f),f!=null&&this.getGroupManager()[f.collapsed?"expandGroup":"collapseGroup"](f)},U.prototype.getGroupManager=function(){let f=this[e];return f==null&&(f=this[e]=new D(this)),f},U.prototype.removeGroupManager=function(){delete this[e]},U.prototype.getGroupFor=function(f){if(f=this.getElement(f),f)return f[p]}}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et="Straight",Y="Arc",K=function(r){this.type="Flowchart",r=r||{},r.stub=r.stub==null?30:r.stub;let E,a=c.Connectors.AbstractConnector.apply(this,arguments),e=r.midpoint==null?.5:r.midpoint,p=r.alwaysRespectStubs===!0,P=null,w=null,S=r.cornerRadius!=null?r.cornerRadius:0;r.loopbackRadius;let L=function(O){return O<0?-1:O===0?0:1},s=function(O){return[L(O[2]-O[0]),L(O[3]-O[1])]},l=function(O,g,i,b){if(P===g&&w===i)return;let h=P==null?b.sx:P,D=w==null?b.sy:w,I=h===g?"v":"h";P=g,w=i,O.push([h,D,g,i,I])},R=function(O){return Math.sqrt(Math.pow(O[0]-O[2],2)+Math.pow(O[1]-O[3],2))},N=function(O){let g=[];return g.push.apply(g,O),g},H=function(O,g,i){let b=null,h,D,I;for(let f=0;f<g.length-1;f++){if(b=b||N(g[f]),h=N(g[f+1]),D=s(b),I=s(h),S>0&&b[4]!==h[4]){let _=Math.min(R(b),R(h)),v=Math.min(S,_/2);b[2]-=D[0]*v,b[3]-=D[1]*v,h[0]+=I[0]*v,h[1]+=I[1]*v;let M=D[1]===I[0]&&I[0]===1||D[1]===I[0]&&I[0]===0&&D[0]!==I[1]||D[1]===I[0]&&I[0]===-1,m=h[1]>b[3]?1:-1,u=h[0]>b[2]?1:-1,y=m===u,A=y&&M||!y&&!M?h[0]:b[2],F=y&&M||!y&&!M?b[3]:h[1];a.addSegment(O,et,{x1:b[0],y1:b[1],x2:b[2],y2:b[3]}),a.addSegment(O,Y,{r:v,x1:b[2],y1:b[3],x2:h[0],y2:h[1],cx:A,cy:F,ac:M})}else{let _=b[2]===b[0]?0:b[2]>b[0]?i.lw/2:-(i.lw/2),v=b[3]===b[1]?0:b[3]>b[1]?i.lw/2:-(i.lw/2);a.addSegment(O,et,{x1:b[0]-_,y1:b[1]-v,x2:b[2]+_,y2:b[3]+v})}b=h}h!=null&&a.addSegment(O,et,{x1:h[0],y1:h[1],x2:h[2],y2:h[3]})};this._compute=function(O,g){E=[],P=null,w=null;let i=function(){return[O.startStubX,O.startStubY,O.endStubX,O.endStubY]},h={perpendicular:i,orthogonal:i,opposite:function(n){let t=O,d=n==="x"?0:1;return!p&&{x:function(){return t.so[d]===1&&(t.startStubX>t.endStubX&&t.tx>t.startStubX||t.sx>t.endStubX&&t.tx>t.sx)||t.so[d]===-1&&(t.startStubX<t.endStubX&&t.tx<t.startStubX||t.sx<t.endStubX&&t.tx<t.sx)},y:function(){return t.so[d]===1&&(t.startStubY>t.endStubY&&t.ty>t.startStubY||t.sy>t.endStubY&&t.ty>t.sy)||t.so[d]===-1&&(t.startStubY<t.endStubY&&t.ty<t.startStubY||t.sy<t.endStubY&&t.ty<t.sy)}}[n]()?{x:[(O.sx+O.tx)/2,O.startStubY,(O.sx+O.tx)/2,O.endStubY],y:[O.startStubX,(O.sy+O.ty)/2,O.endStubX,(O.sy+O.ty)/2]}[n]:[O.startStubX,O.startStubY,O.endStubX,O.endStubY]}}[O.anchorOrientation](O.sourceAxis),D=O.sourceAxis==="x"?0:1,I=O.sourceAxis==="x"?1:0,f=h[D],_=h[I],v=h[D+2],M=h[I+2];l(E,h[0],h[1],O);let m=O.startStubX+(O.endStubX-O.startStubX)*e,u=O.startStubY+(O.endStubY-O.startStubY)*e,y={x:[0,1],y:[1,0]},F={perpendicular:function(n){let t=O,d={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},x={x:[[t.startStubX,t.endStubX],null,[t.endStubX,t.startStubX]],y:[[t.startStubY,t.endStubY],null,[t.endStubY,t.startStubY]]},j={x:[[m,t.startStubY],[m,t.endStubY]],y:[[t.startStubX,u],[t.endStubX,u]]},B={x:[[t.endStubX,t.startStubY]],y:[[t.startStubX,t.endStubY]]},z={x:[[t.startStubX,t.endStubY],[t.endStubX,t.endStubY]],y:[[t.endStubX,t.startStubY],[t.endStubX,t.endStubY]]},X={x:[[t.startStubX,u],[t.endStubX,u],[t.endStubX,t.endStubY]],y:[[m,t.startStubY],[m,t.endStubY],[t.endStubX,t.endStubY]]},V={x:[t.startStubY,t.endStubY],y:[t.startStubX,t.endStubX]},ot=y[n][0],ct=y[n][1],pt=t.so[ot]+1,$=t.to[ct]+1,rt=t.to[ct]===-1&&V[n][1]<V[n][0]||t.to[ct]===1&&V[n][1]>V[n][0],ft=x[n][pt][0],ut=x[n][pt][1],ht=d[n][pt][$];if(t.segment===ht[3]||t.segment===ht[2]&&rt)return j[n];if(t.segment===ht[2]&&ut<ft)return B[n];if(t.segment===ht[2]&&ut>=ft||t.segment===ht[1]&&!rt)return X[n];if(t.segment===ht[0]||t.segment===ht[1]&&rt)return z[n]},orthogonal:function(n,t,d,x,j){let B=O,z={x:B.so[0]===-1?Math.min(t,x):Math.max(t,x),y:B.so[1]===-1?Math.min(t,x):Math.max(t,x)}[n];return{x:[[z,d],[z,j],[x,j]],y:[[d,z],[j,z],[j,x]]}[n]},opposite:function(n,t,d,x){let j=O,B={x:"y",y:"x"}[n],z={x:"height",y:"width"}[n],X=j["is"+n.toUpperCase()+"GreaterThanStubTimes2"];if(g.sourceEndpoint.elementId===g.targetEndpoint.elementId){let V=d+(1-g.sourceEndpoint.anchor[B])*g.sourceInfo[z]+a.maxStub;return{x:[[t,V],[x,V]],y:[[V,t],[V,x]]}[n]}else{if(!X||j.so[D]===1&&t>x||j.so[D]===-1&&t<x)return{x:[[t,u],[x,u]],y:[[m,t],[m,x]]}[n];if(j.so[D]===1&&t<x||j.so[D]===-1&&t>x)return{x:[[m,j.sy],[m,j.ty]],y:[[j.sx,u],[j.tx,u]]}[n]}}}[O.anchorOrientation](O.sourceAxis,f,_,v,M);if(F)for(let n=0;n<F.length;n++)l(E,F[n][0],F[n][1],O);l(E,h[2],h[3],O),l(E,O.tx,O.ty,O),H(this,E,O)}};c.Connectors.Flowchart=K,U.extend(c.Connectors.Flowchart,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil;c.Connectors.AbstractBezierConnector=function(Y){Y=Y||{};let K=Y.showLoopback!==!1;Y.curviness;let r=Y.margin||5;Y.proximityLimit;let E=Y.orientation&&Y.orientation==="clockwise",a=Y.loopbackRadius||25,e;return this._compute=function(p,P){let w=P.sourcePos,S=P.targetPos,L=Math.abs(w[0]-S[0]),s=Math.abs(w[1]-S[1]);if(!K||P.sourceEndpoint.elementId!==P.targetEndpoint.elementId)this._computeBezier(p,P,w,S,L,s);else{let l=P.sourcePos[0],R=P.sourcePos[1]-r,N=l,H=R-a,O=N-a,g=H-a;L=2*a,s=2*a,p.points[0]=O,p.points[1]=g,p.points[2]=L,p.points[3]=s,e.addSegment(this,"Arc",{loopback:!0,x1:l-O+4,y1:R-g,startAngle:0,endAngle:2*Math.PI,r:a,ac:!E,x2:l-O-4,y2:R-g,cx:N-O,cy:H-g})}},e=c.Connectors.AbstractConnector.apply(this,arguments),e},U.extend(c.Connectors.AbstractBezierConnector,c.Connectors.AbstractConnector);let et=function(Y){Y=Y||{},this.type="Bezier";let K=c.Connectors.AbstractBezierConnector.apply(this,arguments),r=Y.curviness||150,E=10;this.getCurviness=function(){return r},this._findControlPoint=function(a,e,p,P,w,S,L){let s=S[0]!==L[0]||S[1]===L[1],l=[];return s?(L[0]===0?l.push(p[0]<e[0]?a[0]+E:a[0]-E):l.push(a[0]+r*L[0]),L[1]===0?l.push(p[1]<e[1]?a[1]+E:a[1]-E):l.push(a[1]+r*S[1])):(S[0]===0?l.push(e[0]<p[0]?a[0]+E:a[0]-E):l.push(a[0]-r*S[0]),S[1]===0?l.push(e[1]<p[1]?a[1]+E:a[1]-E):l.push(a[1]+r*L[1])),l},this._computeBezier=function(a,e,p,P,w,S){let L,s,l=p[0]<P[0]?w:0,R=p[1]<P[1]?S:0,N=p[0]<P[0]?0:w,H=p[1]<P[1]?0:S;L=this._findControlPoint([l,R],p,P,e.sourceEndpoint,e.targetEndpoint,a.so,a.to),s=this._findControlPoint([N,H],P,p,e.targetEndpoint,e.sourceEndpoint,a.to,a.so),K.addSegment(this,"Bezier",{x1:l,y1:R,x2:N,y2:H,cp1x:L[0],cp1y:L[1],cp2x:s[0],cp2y:s[1]})}};c.Connectors.Bezier=et,U.extend(et,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et=function(r,E,a,e){return r<=a&&e<=E?1:r<=a&&E<=e?2:a<=r&&e>=E?3:4},Y=function(r,E,a,e,p,P,w,S,L){if(S<=L)return[r,E];if(a===1)return e[3]<=0&&p[3]>=1?[r+(e[2]<.5?-1*P:P),E]:e[2]>=1&&p[2]<=0?[r,E+(e[3]<.5?-1*w:w)]:[r+-1*P,E+-1*w];if(a===2)return e[3]>=1&&p[3]<=0?[r+(e[2]<.5?-1*P:P),E]:e[2]>=1&&p[2]<=0?[r,E+(e[3]<.5?-1*w:w)]:[r+P,E+-1*w];if(a===3)return e[3]>=1&&p[3]<=0?[r+(e[2]<.5?-1*P:P),E]:e[2]<=0&&p[2]>=1?[r,E+(e[3]<.5?-1*w:w)]:[r+-1*P,E+-1*w];if(a===4)return e[3]<=0&&p[3]>=1?[r+(e[2]<.5?-1*P:P),E]:e[2]<=0&&p[2]>=1?[r,E+(e[3]<.5?-1*w:w)]:[r+P,E+-1*w]},K=function(r){r=r||{},this.type="StateMachine";let E=c.Connectors.AbstractBezierConnector.apply(this,arguments),a=r.curviness||10,e=r.margin||5,p=r.proximityLimit||80;r.orientation&&r.orientation;let P;this._computeBezier=function(w,S,L,s,l,R){let N=S.sourcePos[0]<S.targetPos[0]?0:l,H=S.sourcePos[1]<S.targetPos[1]?0:R,O=S.sourcePos[0]<S.targetPos[0]?l:0,g=S.sourcePos[1]<S.targetPos[1]?R:0;S.sourcePos[2]===0&&(N-=e),S.sourcePos[2]===1&&(N+=e),S.sourcePos[3]===0&&(H-=e),S.sourcePos[3]===1&&(H+=e),S.targetPos[2]===0&&(O-=e),S.targetPos[2]===1&&(O+=e),S.targetPos[3]===0&&(g-=e),S.targetPos[3]===1&&(g+=e);let i=(N+O)/2,b=(H+g)/2,h=et(N,H,O,g),D=Math.sqrt(Math.pow(O-N,2)+Math.pow(g-H,2)),I,f,_,v;P=Y(i,b,h,S.sourcePos,S.targetPos,a,a,D,p),I=P[0],f=P[0],_=P[1],v=P[1],E.addSegment(this,"Bezier",{x1:O,y1:g,x2:N,y2:H,cp1x:I,cp1y:_,cp2x:f,cp2y:v})}};c.Connectors.StateMachine=K,U.extend(K,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et="Straight",Y=function(K){this.type=et;let r=c.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(E,a){r.addSegment(this,et,{x1:E.sx,y1:E.sy,x2:E.startStubX,y2:E.startStubY}),r.addSegment(this,et,{x1:E.startStubX,y1:E.startStubY,x2:E.endStubX,y2:E.endStubY}),r.addSegment(this,et,{x1:E.endStubX,y1:E.endStubY,x2:E.tx,y2:E.ty})}};c.Connectors.Straight=Y,U.extend(Y,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},Y="stroke-dasharray",K="dashstyle",r="linearGradient",E="radialGradient",a="defs",e="fill",p="stop",P="stroke",w="stroke-width",S="style",L="none",s="jsplumb_gradient_",l="strokeWidth",R={svg:"http://www.w3.org/2000/svg"},N=function(_,v){for(let M in v)_.setAttribute(M,""+v[M])},H=function(_,v){return v=v||{},v.version="1.1",v.xmlns=R.svg,c.createElementNS(R.svg,_,null,null,v)},O=function(_){return"position:absolute;left:"+_[0]+"px;top:"+_[1]+"px"},g=function(_){let v=_.querySelectorAll(" defs,linearGradient,radialGradient");for(let M=0;M<v.length;M++)v[M].parentNode.removeChild(v[M])},i=function(_,v,M,m,u){let y=s+u._jsPlumb.instance.idstamp();g(_);let A;M.gradient.offset?A=H(E,{id:y}):A=H(r,{id:y,gradientUnits:"userSpaceOnUse"});let F=H(a);_.appendChild(F),F.appendChild(A);for(let t=0;t<M.gradient.stops.length;t++){let d=u.segment===1||u.segment===2?t:M.gradient.stops.length-1-t,x=M.gradient.stops[d][1],j=H(p,{offset:Math.floor(M.gradient.stops[t][0]*100)+"%","stop-color":x});A.appendChild(j)}let n=M.stroke?P:e;v.setAttribute(n,"url(#"+y+")")},b=function(_,v,M,m,u){if(v.setAttribute(e,M.fill?M.fill:L),v.setAttribute(P,M.stroke?M.stroke:L),M.gradient?i(_,v,M,m,u):(g(_),v.setAttribute(S,"")),M.strokeWidth&&v.setAttribute(w,M.strokeWidth),M[K]&&M[l]&&!M[Y]){let y=M[K].indexOf(",")===-1?" ":",",A=M[K].split(y),F="";A.forEach(function(n){F+=Math.floor(n*M.strokeWidth)+y}),v.setAttribute(Y,F)}else M[Y]&&v.setAttribute(Y,M[Y]);for(let y in et)M[y]&&v.setAttribute(et[y],M[y])},h=function(_,v,M){_.childNodes.length>M?_.insertBefore(v,_.childNodes[M]):_.appendChild(v)};U.svg={node:H,attr:N,pos:O};let D=function(_){let v=_.pointerEventsSpec||"all",M={};c.jsPlumbUIComponent.apply(this,_.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;let m=_.cssClass+" "+(_.originalArgs[0].cssClass||""),u={style:"",width:0,height:0,"pointer-events":v,position:"absolute"};this.svg=H("svg",u),_.useDivWrapper?(this.canvas=c.createElement("div",{position:"absolute"}),U.sizeElement(this.canvas,0,0,1,1),this.canvas.className=m):(N(this.svg,{class:m}),this.canvas=this.svg),_._jsPlumb.appendElement(this.canvas,_.originalArgs[0].parent),_.useDivWrapper&&this.canvas.appendChild(this.svg);let y=[this.canvas];return this.getDisplayElements=function(){return y},this.appendDisplayElement=function(A){y.push(A)},this.paint=function(A,F,n){if(A!=null){let t=[this.x,this.y],d=[this.w,this.h],x;n!=null&&(n.xmin<0&&(t[0]+=n.xmin),n.ymin<0&&(t[1]+=n.ymin),d[0]=n.xmax+(n.xmin<0?-n.xmin:0),d[1]=n.ymax+(n.ymin<0?-n.ymin:0)),_.useDivWrapper?(U.sizeElement(this.canvas,t[0],t[1],d[0],d[1]),t[0]=0,t[1]=0,x=O([0,0])):x=O([t[0],t[1]]),M.paint.apply(this,arguments),N(this.svg,{style:x,width:d[0]||0,height:d[1]||0})}},{renderer:M}};U.extend(D,c.jsPlumbUIComponent,{cleanup:function(_){_||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(_){let v=_.getContainer();this.canvas&&this.canvas.parentNode==null&&v.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&v.appendChild(this.bgCanvas)},setVisible:function(_){this.canvas&&(this.canvas.style.display=_?"block":"none")}}),c.ConnectorRenderers.svg=function(_){let v=this,M=D.apply(this,[{cssClass:_._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:_._jsPlumb}]);M.renderer.paint=function(m,u,y){let A=v.getSegments(),F="",n=[0,0];if(y.xmin<0&&(n[0]=-y.xmin),y.ymin<0&&(n[1]=-y.ymin),A.length>0){F=v.getPathData();let t={d:F,transform:"translate("+n[0]+","+n[1]+")","pointer-events":_["pointer-events"]||"visibleStroke"},d=null,x=[v.x,v.y,v.w,v.h];if(m.outlineStroke){let j=m.outlineWidth||1,B=m.strokeWidth+2*j;d=c.extend({},m),delete d.gradient,d.stroke=m.outlineStroke,d.strokeWidth=B,v.bgPath==null?(v.bgPath=H("path",t),c.addClass(v.bgPath,c.connectorOutlineClass),h(v.svg,v.bgPath,0)):N(v.bgPath,t),b(v.svg,v.bgPath,d,x,v)}v.path==null?(v.path=H("path",t),h(v.svg,v.path,m.outlineStroke?1:0)):N(v.path,t),b(v.svg,v.path,m,x,v)}}},U.extend(c.ConnectorRenderers.svg,D);let I=c.SvgEndpoint=function(_){let v=D.apply(this,[{cssClass:_._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:_._jsPlumb}]);v.renderer.paint=function(M){let m=c.extend({},M);m.outlineStroke&&(m.stroke=m.outlineStroke),this.node==null?(this.node=this.makeNode(m),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),b(this.svg,this.node,m,[this.x,this.y,this.w,this.h],this),O(this.node,[this.x,this.y])}.bind(this)};U.extend(I,D),c.Endpoints.svg.Dot=function(){c.Endpoints.Dot.apply(this,arguments),I.apply(this,arguments),this.makeNode=function(_){return H("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(_){N(_,{cx:this.w/2,cy:this.h/2,r:this.radius})}},U.extend(c.Endpoints.svg.Dot,[c.Endpoints.Dot,I]),c.Endpoints.svg.Rectangle=function(){c.Endpoints.Rectangle.apply(this,arguments),I.apply(this,arguments),this.makeNode=function(_){return H("rect",{width:this.w,height:this.h})},this.updateNode=function(_){N(_,{width:this.w,height:this.h})}},U.extend(c.Endpoints.svg.Rectangle,[c.Endpoints.Rectangle,I]),c.Endpoints.svg.Image=c.Endpoints.Image,c.Endpoints.svg.Blank=c.Endpoints.Blank,c.Overlays.svg.Label=c.Overlays.Label,c.Overlays.svg.Custom=c.Overlays.Custom;let f=function(_,v){_.apply(this,v),c.jsPlumbUIComponent.apply(this,v),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(m,u){if(m.component.svg&&u){this.path==null&&(this.path=H("path",{"pointer-events":"all"}),m.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,m.component),this.canvas=m.component.svg);let y=v&&v.length===1&&v[0].cssClass||"",A=[0,0];u.xmin<0&&(A[0]=-u.xmin),u.ymin<0&&(A[1]=-u.ymin),N(this.path,{d:M(m.d),class:y,stroke:m.stroke?m.stroke:null,fill:m.fill?m.fill:null,transform:"translate("+A[0]+","+A[1]+")"})}};var M=function(m){return isNaN(m.cxy.x)||isNaN(m.cxy.y)?"":"M"+m.hxy.x+","+m.hxy.y+" L"+m.tail[0].x+","+m.tail[0].y+" L"+m.cxy.x+","+m.cxy.y+" L"+m.tail[1].x+","+m.tail[1].y+" L"+m.hxy.x+","+m.hxy.y};this.transfer=function(m){m.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),m.canvas.appendChild(this.path))}};U.extend(f,[c.jsPlumbUIComponent,c.Overlays.AbstractOverlay],{cleanup:function(_){this.path!=null&&(_?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(_,v){this.path&&v.canvas&&v.canvas.appendChild(this.path)},setVisible:function(_){this.path!=null&&(this.path.style.display=_?"block":"none")}}),c.Overlays.svg.Arrow=function(){f.apply(this,[c.Overlays.Arrow,arguments])},U.extend(c.Overlays.svg.Arrow,[c.Overlays.Arrow,f]),c.Overlays.svg.PlainArrow=function(){f.apply(this,[c.Overlays.PlainArrow,arguments])},U.extend(c.Overlays.svg.PlainArrow,[c.Overlays.PlainArrow,f]),c.Overlays.svg.Diamond=function(){f.apply(this,[c.Overlays.Diamond,arguments])},U.extend(c.Overlays.svg.Diamond,[c.Overlays.Diamond,f]),c.Overlays.svg.GuideLines=function(){let _=null,v=this,M,m;c.Overlays.GuideLines.apply(this,arguments),this.paint=function(y,A){_==null&&(_=H("path"),y.connector.svg.appendChild(_),v.attachListeners(_,y.connector),v.attachListeners(_,v),M=H("path"),y.connector.svg.appendChild(M),v.attachListeners(M,y.connector),v.attachListeners(M,v),m=H("path"),y.connector.svg.appendChild(m),v.attachListeners(m,y.connector),v.attachListeners(m,v));let F=[0,0];A.xmin<0&&(F[0]=-A.xmin),A.ymin<0&&(F[1]=-A.ymin),N(_,{d:u(y.head,y.tail),stroke:"red",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),N(M,{d:u(y.tailLine[0],y.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),N(m,{d:u(y.headLine[0],y.headLine[1]),stroke:"green",fill:null,transform:"translate("+F[0]+","+F[1]+")"})};var u=function(y,A){return"M "+y.x+","+y.y+" L"+A.x+","+A.y}},U.extend(c.Overlays.svg.GuideLines,c.Overlays.GuideLines)}).call(typeof window<"u"?window:globalThis);(function(){let W=this,c=W.jsPlumb,U=W.jsPlumbUtil,et=W.Katavorio,Y=W.Biltong,K=function(i){let b=i._mottle;return b||(b=i._mottle=new W.Mottle),b},r=function(i,b){b=b||"main";let h="_katavorio_"+b,D=i[h],I=i.getEventManager();return D||(D=new et({bind:I.on,unbind:I.off,getSize:c.getSize,getConstrainingRectangle:function(f){return[f.parentNode.scrollWidth,f.parentNode.scrollHeight]},getPosition:function(f,_){let v=i.getOffset(f,_,f._katavorioDrag?f.offsetParent:null);return[v.left,v.top]},setPosition:function(f,_){f.style.left=_[0]+"px",f.style.top=_[1]+"px"},addClass:c.addClass,removeClass:c.removeClass,intersects:Y.intersects,indexOf:function(f,_){return f.indexOf(_)},scope:i.getDefaultScope(),css:{noSelect:i.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),D.setZoom(i.getZoom()),i[h]=D,i.bind("zoom",D.setZoom)),D},E=function(i){let b=i.el._jsPlumbDragOptions,h=!0;return b.canDrag&&(h=b.canDrag()),h&&(this.setHoverSuspended(!0),this.select({source:i.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:i.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),h},a=function(i){let b=this.getUIPosition(arguments,this.getZoom());if(b!=null){let h=i.el._jsPlumbDragOptions;this.draw(i.el,b,null,!0),h._dragging&&this.addClass(i.el,"jtk-dragged"),h._dragging=!0}},e=function(i){let b=i.selection,h,D=function(I){I[1]!=null&&(h=this.getUIPosition([{el:I[2].el,pos:[I[1].left,I[1].top]}]),this.draw(I[2].el,h)),I[0]._jsPlumbDragOptions!=null&&delete I[0]._jsPlumbDragOptions._dragging,this.removeClass(I[0],"jtk-dragged"),this.select({source:I[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:I[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.getDragManager().dragEnded(I[2].el)}.bind(this);for(let I=0;I<b.length;I++)D(b[I]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},p=function(i,b){let h=function(D){if(b[D]!=null)if(U.isString(b[D])){let I=b[D].match(/-=/)?-1:1,f=b[D].substring(2);return i[D]+I*f}else return b[D];else return i[D]};return[h("left"),h("top")]};var P=function(i,b){if(b==null)return[0,0];let h=l(b),D=s(h,0);return[D[i+"X"],D[i+"Y"]]},w=P.bind(this,"page"),S=P.bind(this,"screen"),L=P.bind(this,"client"),s=function(i,b){return i.item?i.item(b):i[b]},l=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]};let R=function(i){let b={},h=[],D={},I={},f={};this.register=function(_){let v=i.getId(_),M;b[v]||(b[v]=_,h.push(_),D[v]={});let m=function(u){if(u){for(let y=0;y<u.childNodes.length;y++)if(u.childNodes[y].nodeType!==3&&u.childNodes[y].nodeType!==8){let A=jsPlumb.getElement(u.childNodes[y]),F=i.getId(u.childNodes[y],null,!0);if(F&&I[F]&&I[F]>0){M||(M=i.getOffset(_));let n=i.getOffset(A);D[v][F]={id:F,offset:{left:n.left-M.left,top:n.top-M.top}},f[F]=v}m(u.childNodes[y])}}};m(_)},this.updateOffsets=function(_,v){if(_!=null){v=v||{};let M=jsPlumb.getElement(_),m=i.getId(M),u=D[m],y;if(u){for(let A in u)if(u.hasOwnProperty(A)){let F=jsPlumb.getElement(A),n=v[A]||i.getOffset(F);if(F.offsetParent==null&&D[m][A]!=null)continue;y||(y=i.getOffset(M)),D[m][A]={id:A,offset:{left:n.left-y.left,top:n.top-y.top}},f[A]=m}}}},this.endpointAdded=function(_,v){v=v||i.getId(_);let M=document.body,m=_.parentNode;for(I[v]=I[v]?I[v]+1:1;m!=null&&m!==M;){let u=i.getId(m,null,!0);if(u&&b[u]){let y=i.getOffset(m);if(D[u][v]==null){let A=i.getOffset(_);D[u][v]={id:v,offset:{left:A.left-y.left,top:A.top-y.top}},f[v]=u}break}m=m.parentNode}},this.endpointDeleted=function(_){if(I[_.elementId]&&(I[_.elementId]--,I[_.elementId]<=0))for(let v in D)D.hasOwnProperty(v)&&D[v]&&(delete D[v][_.elementId],delete f[_.elementId])},this.changeId=function(_,v){D[v]=D[_],D[_]={},f[v]=f[_],f[_]=null},this.getElementsForDraggable=function(_){return D[_]},this.elementRemoved=function(_){let v=f[_];v&&(delete D[v][_],delete f[_])},this.reset=function(){b={},h=[],D={},I={}},this.dragEnded=function(_){if(_.offsetParent!=null){let v=i.getId(_),M=f[v];M&&this.updateOffsets(M)}},this.setParent=function(_,v,M,m,u){let y=f[v];D[m]||(D[m]={});let A=i.getOffset(M),F=u||i.getOffset(_);y&&D[y]&&delete D[y][v],D[m][v]={id:v,offset:{left:F.left-A.left,top:F.top-A.top}},f[v]=m},this.clearParent=function(_,v){let M=f[v];M&&(delete D[M][v],delete f[v])},this.revalidateParent=function(_,v,M){let m=f[v];if(m){let u={};u[v]=M,this.updateOffsets(m,u),i.revalidate(m)}},this.getDragAncestor=function(_){let v=jsPlumb.getElement(_),M=i.getId(v),m=f[M];return m?jsPlumb.getElement(m):null}},N=function(i,b,h){b=U.fastTrim(b),typeof i.className.baseVal<"u"?i.className.baseVal=b:i.className=b;try{let D=i.classList;if(D!=null){for(;D.length>0;)D.remove(D.item(0));for(let I=0;I<h.length;I++)h[I]&&D.add(h[I])}}catch(D){U.log("JSPLUMB: cannot set class list",D)}},H=function(i){return typeof i.className.baseVal>"u"?i.className:i.className.baseVal},O=function(i,b,h){b=b==null?[]:U.isArray(b)?b:b.split(/\s+/),h=h==null?[]:U.isArray(h)?h:h.split(/\s+/);let D=H(i),I=D.split(/\s+/),f=function(_,v){for(let M=0;M<v.length;M++)if(_)I.indexOf(v[M])===-1&&I.push(v[M]);else{let m=I.indexOf(v[M]);m!==-1&&I.splice(m,1)}};f(!0,b),f(!1,h),N(i,I.join(" "),I)};W.jsPlumb.extend(W.jsPlumbInstance.prototype,{headless:!1,pageLocation:w,screenLocation:S,clientLocation:L,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new R(this)),this.dragManager},recalculateOffsets:function(i){this.getDragManager().updateOffsets(i)},createElement:function(i,b,h,D){return this.createElementNS(null,i,b,h,D)},createElementNS:function(i,b,h,D,I){let f=i==null?document.createElement(b):document.createElementNS(i,b),_;h=h||{};for(_ in h)f.style[_]=h[_];D&&(f.className=D),I=I||{};for(_ in I)f.setAttribute(_,""+I[_]);return f},getAttribute:function(i,b){return i.getAttribute!=null?i.getAttribute(b):null},setAttribute:function(i,b,h){i.setAttribute!=null&&i.setAttribute(b,h)},setAttributes:function(i,b){for(let h in b)b.hasOwnProperty(h)&&i.setAttribute(h,b[h])},appendToRoot:function(i){document.body.appendChild(i)},getRenderModes:function(){return["svg"]},getClass:H,addClass:function(i,b){jsPlumb.each(i,function(h){O(h,b)})},hasClass:function(i,b){return i=jsPlumb.getElement(i),i.classList?i.classList.contains(b):H(i).indexOf(b)!==-1},removeClass:function(i,b){jsPlumb.each(i,function(h){O(h,null,b)})},toggleClass:function(i,b){jsPlumb.hasClass(i,b)?jsPlumb.removeClass(i,b):jsPlumb.addClass(i,b)},updateClasses:function(i,b,h){jsPlumb.each(i,function(D){O(D,b,h)})},setClass:function(i,b){b!=null&&jsPlumb.each(i,function(h){N(h,b,b.split(/\s+/))})},setPosition:function(i,b){i.style.left=b.left+"px",i.style.top=b.top+"px"},getPosition:function(i){let b=function(h){let D=i.style[h];return D?D.substring(0,D.length-2):0};return{left:b("left"),top:b("top")}},getStyle:function(i,b){return typeof window.getComputedStyle<"u"?getComputedStyle(i,null).getPropertyValue(b):i.currentStyle[b]},getSelector:function(i,b){let h=null;return arguments.length===1?h=i.nodeType!=null?i:document.querySelectorAll(i):h=i.querySelectorAll(b),h},getOffset:function(i,b,h){i=jsPlumb.getElement(i),h=h||this.getContainer();let D={left:i.offsetLeft,top:i.offsetTop},I=b||h!=null&&i!==h&&i.offsetParent!==h?i.offsetParent:null,f=function(_){_!=null&&_!==document.body&&(_.scrollTop>0||_.scrollLeft>0)&&(D.left-=_.scrollLeft,D.top-=_.scrollTop)}.bind(this);for(;I!=null;)D.left+=I.offsetLeft,D.top+=I.offsetTop,f(I),I=b?I.offsetParent:I.offsetParent===h?null:I.offsetParent;if(h!=null&&!b&&(h.scrollTop>0||h.scrollLeft>0)){let _=i.offsetParent!=null?this.getStyle(i.offsetParent,"position"):"static",v=this.getStyle(i,"position");v!=="absolute"&&v!=="fixed"&&_!=="absolute"&&_!=="fixed"&&(D.left-=h.scrollLeft,D.top-=h.scrollTop)}return D},getPositionOnElement:function(i,b,h){let D=typeof b.getBoundingClientRect<"u"?b.getBoundingClientRect():{left:0,top:0,width:0,height:0},I=document.body,f=document.documentElement,_=window.pageYOffset||f.scrollTop||I.scrollTop,v=window.pageXOffset||f.scrollLeft||I.scrollLeft,M=f.clientTop||I.clientTop||0,m=f.clientLeft||I.clientLeft||0,u=0,y=0,A=D.top+_-M+u*h,F=D.left+v-m+y*h,n=jsPlumb.pageLocation(i),t=D.width||b.offsetWidth*h,d=D.height||b.offsetHeight*h,x=(n[0]-F)/t,j=(n[1]-A)/d;return[x,j]},getAbsolutePosition:function(i){let b=function(h){let D=i.style[h];if(D)return parseFloat(D.substring(0,D.length-2))};return[b("left"),b("top")]},setAbsolutePosition:function(i,b,h,D){h?this.animate(i,{left:"+="+(b[0]-h[0]),top:"+="+(b[1]-h[1])},D):(i.style.left=b[0]+"px",i.style.top=b[1]+"px")},getSize:function(i){return[i.offsetWidth,i.offsetHeight]},getWidth:function(i){return i.offsetWidth},getHeight:function(i){return i.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(i,b){let h;return i=U.isArray(i)||i.length!=null&&!U.isString(i)?i:[i],Array.prototype.slice.call(i).forEach(function(D){h=this.info(D),h.el&&this._initDraggableIfNecessary(h.el,!0,b,h.id,!0)}.bind(this)),this},snapToGrid:function(i,b,h){let D=[],I=function(f){let _=this.info(f);if(_.el!=null&&_.el._katavorioDrag){let v=_.el._katavorioDrag.snap(b,h);this.revalidate(_.el),D.push([_.el,v])}}.bind(this);if(arguments.length===1||arguments.length===3)I(i,b,h);else{let f=this.getManagedElements();for(let _ in f)I(_,arguments[0],arguments[1])}return D},initDraggable:function(i,b,h){r(this,h).draggable(i,b),i._jsPlumbDragOptions=b},destroyDraggable:function(i,b){r(this,b).destroyDraggable(i),delete i._jsPlumbDragOptions},unbindDraggable:function(i,b,h,D){r(this,D).destroyDraggable(i,b,h)},setDraggable:function(i,b){return jsPlumb.each(i,function(h){this.isDragSupported(h)&&(this._draggableStates[this.getAttribute(h,"id")]=b,this.setElementDraggable(h,b))}.bind(this))},_draggableStates:{},toggleDraggable:function(i){let b;return jsPlumb.each(i,function(h){let D=this.getAttribute(h,"id");return b=this._draggableStates[D]==null?!1:this._draggableStates[D],b=!b,this._draggableStates[D]=b,this.setDraggable(h,b),b}.bind(this)),b},_initDraggableIfNecessary:function(i,b,h,D,I){if(!jsPlumb.headless&&(b==null?!1:b)&&jsPlumb.isDragSupported(i,this)){let _=h||this.Defaults.DragOptions;if(_=jsPlumb.extend({},_),jsPlumb.isAlreadyDraggable(i,this))h.force&&this.initDraggable(i,_);else{let v=jsPlumb.dragEvents.drag,M=jsPlumb.dragEvents.stop,m=jsPlumb.dragEvents.start;this.manage(D,i),_[m]=U.wrap(_[m],E.bind(this)),_[v]=U.wrap(_[v],a.bind(this)),_[M]=U.wrap(_[M],e.bind(this));let u=this.getId(i);this._draggableStates[u]=!0;let y=this._draggableStates[u];_.disabled=y==null?!1:!y,this.initDraggable(i,_),this.getDragManager().register(i),I&&this.fire("elementDraggable",{el:i,options:_})}}},animationSupported:!0,getElement:function(i){return i==null?null:(i=typeof i=="string"?i:i.length!=null&&i.enctype==null?i[0]:i,typeof i=="string"?document.getElementById(i):i)},removeElement:function(i){r(this).elementRemoved(i),this.getEventManager().remove(i)},doAnimate:function(i,b,h){h=h||{};var D=this.getOffset(i),I=p(D,b),f=I[0]-D.left,_=I[1]-D.top,v=h.duration||250,M=15,m=v/M,u=M/v*f,y=M/v*_,A=0,F=setInterval(function(){c.setPosition(i,{left:D.left+u*(A+1),top:D.top+y*(A+1)}),h.step!=null&&h.step(A,Math.ceil(m)),A++,A>=m&&(window.clearInterval(F),h.complete!=null&&h.complete())},M)},destroyDroppable:function(i,b){r(this,b).destroyDroppable(i)},unbindDroppable:function(i,b,h,D){r(this,D).destroyDroppable(i,b,h)},droppable:function(i,b){i=U.isArray(i)||i.length!=null&&!U.isString(i)?i:[i];let h;return b=b||{},b.allowLoopback=!1,Array.prototype.slice.call(i).forEach(function(D){h=this.info(D),h.el&&this.initDroppable(h.el,b)}.bind(this)),this},initDroppable:function(i,b,h){r(this,h).droppable(i,b)},isAlreadyDraggable:function(i){return i._katavorioDrag!=null},isDragSupported:function(i,b){return!0},isDropSupported:function(i,b){return!0},isElementDraggable:function(i){return i=c.getElement(i),i._katavorioDrag&&i._katavorioDrag.isEnabled()},getDragObject:function(i){return i[0].drag.getDragElement()},getDragScope:function(i){return i._katavorioDrag&&i._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(i){return i[0].e},getUIPosition:function(i,b){let h=i[0].el;if(h.offsetParent==null)return null;let D=i[0].finalPos||i[0].pos,I={left:D[0],top:D[1]};if(h._katavorioDrag&&h.offsetParent!==this.getContainer()){let f=this.getOffset(h.offsetParent);I.left+=f.left,I.top+=f.top}return I},setDragFilter:function(i,b,h){i._katavorioDrag&&i._katavorioDrag.setFilter(b,h)},setElementDraggable:function(i,b){i=c.getElement(i),i._katavorioDrag&&i._katavorioDrag.setEnabled(b)},setDragScope:function(i,b){i._katavorioDrag&&i._katavorioDrag.k.setDragScope(i,b)},setDropScope:function(i,b){i._katavorioDrop&&i._katavorioDrop.length>0&&i._katavorioDrop[0].k.setDropScope(i,b)},addToPosse:function(i,b){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(i,function(I){I=[c.getElement(I)],I.push.apply(I,h),D.addToPosse.apply(D,I)})},setPosse:function(i,b){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(i,function(I){I=[c.getElement(I)],I.push.apply(I,h),D.setPosse.apply(D,I)})},removeFromPosse:function(i,b){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(i,function(I){I=[c.getElement(I)],I.push.apply(I,h),D.removeFromPosse.apply(D,I)})},removeFromAllPosses:function(i){let b=r(this);c.each(i,function(h){b.removeFromAllPosses(c.getElement(h))})},setPosseState:function(i,b,h){let D=r(this);c.each(i,function(I){D.setPosseState(c.getElement(I),b,h)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(i){i._katavorioDrag&&i._katavorioDrag.abort()},addToDragSelection:function(i){r(this).select(i)},removeFromDragSelection:function(i){r(this).deselect(i)},clearDragSelection:function(){r(this).deselectAll()},trigger:function(i,b,h,D){this.getEventManager().trigger(i,b,h,D)},doReset:function(){for(let i in this)i.indexOf("_katavorio_")===0&&this[i].reset()},getEventManager:function(){return K(this)},on:function(i,b,h){return this.getEventManager().on.apply(this,arguments),this},off:function(i,b,h){return this.getEventManager().off.apply(this,arguments),this}}),function(i){let b=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?i():setTimeout(b,9)};b()}(c.init)}).call(typeof window<"u"?window:globalThis);const ge={jsplumbSetting:{Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"efContainer",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.1,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},Scope:"jsPlumb_DefaultScope"},jsplumbConnectOptions:{isSource:!0,isTarget:!0,anchor:"Continuous",labelStyle:{cssClass:"flowLabel"},emptyLabelStyle:{cssClass:"emptyFlowLabel"}},jsplumbSourceOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!1,connectorStyle:{stroke:"#b1b1b1",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#999999",strokeWidth:1.5}},jsplumbSourceOptions2:{filter:".flow-node-drag",filterExclude:!1,allowLoopback:!0,connector:["Flowchart",{curviness:50}],connectorStyle:{stroke:"#1089ff",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#0d6ecc",strokeWidth:1.5}},jsplumbTargetOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}}};class Yn{constructor(c){this.loadEasyFlowFinish=!1,this.jsplumb=jsPlumb.getInstance(),this.init(c)}init(c){this.jsplumb.ready(()=>{this.jsplumb.importDefaults(ge.jsplumbSetting),this.jsplumb.setSuspendDrawing(!1,!0),this.loadEasyFlow(c),this.loadEasyFlowFinish=!0,this.jsplumb.setContainer(document.querySelector("#efContainer"))})}loadEasyFlow(c){const{nodeList:U,lineList:et}=c,Y=je(ce(ge.jsplumbSourceOptions),{}),K=je(ce(ge.jsplumbTargetOptions),{});for(let r=0;r<U.length;r++){let E=U[r];this.jsplumb.makeSource(E.id,Y),this.jsplumb.makeTarget(E.id,K),E.viewOnly||this.jsplumb.draggable(E.id,{containment:"parent"})}for(let r=0;r<et.length;r++){let E=et[r],a={source:E.from,target:E.to,label:E.label?E.label:"",connector:E.connector?E.connector:"",anchors:E.anchors?E.anchors:void 0,paintStyle:E.paintStyle?E.paintStyle:void 0};this.jsplumb.connect(a,ge.jsplumbConnectOptions)}}getConnections(c,U){return this.jsplumb.getConnections({source:c,target:U})[0]}deleteConnection(c,U){const et=this.getConnections(c,U);this.jsplumb.deleteConnection(et)}removeAllEndpoints(c){this.jsplumb.removeAllEndpoints(c)}addNode(c){const U=je(ce(ge.jsplumbSourceOptions),{}),et=je(ce(ge.jsplumbTargetOptions),{});this.jsplumb.makeSource(c,U),this.jsplumb.makeTarget(c,et),this.jsplumb.draggable(c,{containment:"parent"})}repaint(){this.jsplumb.repaint()}}let Xn={name:"\u6D41\u7A0BA",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BA-\u8282\u70B9A",type:"switch",left:"26px",top:"161px"},{id:"nodeB",name:"\u6D41\u7A0BA-\u8282\u70B9B",type:"common",left:"340px",top:"161px"},{id:"nodeC",name:"\u6D41\u7A0BA-\u8282\u70B9C",type:"common",left:"739px",top:"161px"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},Wn={name:"\u6D41\u7A0BB",nodeList:[{id:"nodeA",name:"\u8282\u70B9A-\u4E0D\u53EF\u62D6\u62FD",type:"common",left:"18px",top:"223px",ico:"user",state:"success",viewOnly:!0},{id:"nodeB",type:"common",name:"\u6D41\u7A0BB-\u8282\u70B9B",left:"351px",top:"96px",ico:"bug",state:"error"},{id:"nodeC",name:"\u6D41\u7A0BB-\u8282\u70B9C",type:"common",left:"354px",top:"351px",ico:"index",state:"warning"},{id:"nodeD",name:"\u6D41\u7A0BB-\u8282\u70B9D",type:"common",left:"723px",top:"215px",ico:"printer",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"\u6761\u4EF6A"},{from:"nodeA",to:"nodeC",label:"\u6761\u4EF6B"},{from:"nodeB",to:"nodeD"},{from:"nodeC",to:"nodeD"}]},zn={name:"\u6D41\u7A0BC",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BC-\u8282\u70B9A",type:"common",left:"400px",top:"15px",ico:"smile"},{id:"nodeB",name:"\u6D41\u7A0BC-\u8282\u70B9B",type:"common",left:"400px",top:"200px",ico:"smile"},{id:"nodeC",name:"\u6D41\u7A0BC-\u8282\u70B9C",type:"common",left:"400px",top:"378px",ico:"smile"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},qn={name:"\u6D41\u7A0BD",nodeList:[{id:"nodeA",name:"\u6D41\u7A0BD-\u8282\u70B9A",type:"common",left:"18px",top:"223px",ico:"smile",state:"success"},{id:"nodeB",type:"common",name:"\u6D41\u7A0BD-\u8282\u70B9B",left:"351px",top:"96px",ico:"smile",state:"error"},{id:"nodeC",name:"\u6D41\u7A0BD-\u8282\u70B9C",type:"common",left:"354px",top:"351px",ico:"smile",state:"warning"},{id:"nodeD",name:"\u6D41\u7A0BD-\u8282\u70B9D",type:"common",left:"723px",top:"215px",ico:"smile",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"\u76F4\u7EBF,\u81EA\u5B9A\u4E49\u7EBF\u6837\u5F0F,\u56FA\u5B9A\u951A\u70B9",connector:"Straight",anchors:["Top","Bottom"],paintStyle:{strokeWidth:2,stroke:"#1879FF"}},{from:"nodeA",to:"nodeC",label:"\u8D1D\u585E\u5C14\u66F2\u7EBF,\u56FA\u5B9A\u951A\u70B9",connector:"Bezier",anchors:["Bottom","Left"]},{from:"nodeB",to:"nodeD",label:"\u6D41\u7A0B\u56FE\u7EBF,\u52A8\u6001\u951A\u70B9",connector:["Flowchart",{curviness:50}]},{from:"nodeC",to:"nodeD",label:"\u72B6\u6001\u673A,\u52A8\u6001\u951A\u70B9",connector:["StateMachine",{margin:8,curviness:10,proximityLimit:80}]},{from:"nodeC",to:"nodeC",label:"\u81EA\u8FDE\u63A5"}]};function $n(W="dataB"){return ce({dataA:Xn,dataB:Wn,dataC:zn,dataD:qn}[W])}const Jn=W=>(Ae("data-v-c62e3712"),W=W(),ke(),W),Kn={class:"ef-toolbar"},Zn={style:{float:"right","margin-right":"5px"}},Qn={key:0,class:"easy-flow"},ti={class:"left-side"},ei=["onClick"],ni=Jn(()=>Et("div",{class:"move-grid",style:{position:"absolute",top:"2000px",left:"2000px"}},"\xA0",-1)),ii={class:"right-side"},si={name:"EasyFlow"},oi=Object.assign(si,{props:{height:{type:String,default:"100%"},repeat:{type:Boolean,default:!0}},setup(W){const c=W,U=Jt(!1),et=Jt(null),Y=Jt(null),K=Jt(!1),r=Jt(!1),E=Jt({nodeList:[],lineList:[]}),a=Jt({type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}),e=Be({show:!1,type:"",left:0,top:0});let p;Xe(()=>{S("dataA")});function P(u,y){const{lineList:A}=E.value;return A.findIndex(F=>F.from===u&&F.to===y)>-1}function w(u,y){return P(y,u)}async function S(u){const y=$n(u);a.value.type="node",a.value.nodeId="",U.value=!1,E.value={nodeList:[],lineList:[]},await we(),U.value=!0,E.value=ce(y),await we(),L()}function L(){p=new Yn(E.value),p.jsplumb.bind("click",h),p.jsplumb.bind("connection",I),p.jsplumb.bind("connectionDetached",f),p.jsplumb.bind("connectionMoved",_),p.jsplumb.bind("contextmenu",(u,y)=>{y.preventDefault(),i(u,y)}),p.jsplumb.bind("beforeDrop",D),console.log("----------new plumb----------",p)}function s(){}function l(u){a.value.type="node",a.value.nodeId=u,et.value.nodeInit(E.value,u)}function R(u){const{nodeList:y}=E.value;for(let A=0;A<y.length;A++){let F=y[A];F.id===u.nodeId&&(F.left=u.left,F.top=u.top)}}function N(u){const y=E.value.nodeList.findIndex(A=>A.id===u);E.value.nodeList.splice(y,1),we(()=>{p.removeAllEndpoints(u)})}function H(){const{type:u,nodeId:y,sourceId:A,targetId:F}=a.value;qe.confirm({type:"warning",title:"\u63D0\u793A",message:`\u786E\u5B9A\u5220\u9664\u5F53\u524D\u9009\u4E2D\u7684${u==="node"?"\u8282\u70B9":"\u8FDE\u63A5\u7EBF"}\u5417?`}).then(()=>{u==="node"?N(y):u==="line"&&p.deleteConnection(A,F)}).catch(()=>{})}function O(u){u.preventDefault();let y=u.dataTransfer.getData("node"),A={};try{A=JSON.parse(y)}catch{console.log("drag data is not right json!");return}const F=Y.value.getBoundingClientRect(),n=u.clientX,t=u.clientY,d=n-F.x+Y.value.scrollLeft-85,x=t-F.y+Y.value.scrollTop-16;let j=A.name,B=j,z=A.id;if(c.repeat){let V=1;for(;V<1e4;){let ot=!1;for(let ct=0;ct<E.value.nodeList.length;ct++)E.value.nodeList[ct].name===B&&(B=j+V,ot=!0);if(ot){V++;continue}break}z=ze()}const X={id:z,name:B,type:A.type,left:d+"px",top:x+"px",ico:A.ico};E.value.nodeList.push(X),we(()=>p.addNode(z))}function g(u,y){l(u),e.show=!0,e.type="node",e.left=y.clientX+"px",e.top=y.clientY+"px"}function i(u,y){h(u),e.show=!0,e.type="line",e.left=y.clientX+"px",e.top=y.clientY+"px"}function b(){e.show=!1}Ue(()=>e.show,u=>{u?document.body.addEventListener("click",b):document.body.removeEventListener("click",b)});function h(u){a.value.type="line",a.value.sourceId=u.sourceId,a.value.targetId=u.targetId,et.value.lineInit(E.value,{from:u.sourceId,to:u.targetId,label:u.getLabel()})}function D(u){const{sourceId:y,targetId:A}=u;return y===A?!1:P(y,A)?(Oe.error("\u8BE5\u5173\u7CFB\u5DF2\u5B58\u5728,\u4E0D\u5141\u8BB8\u91CD\u590D\u521B\u5EFA"),!1):w(y,A)?(Oe.error("\u4E0D\u652F\u6301\u4E24\u4E2A\u8282\u70B9\u4E4B\u95F4\u8FDE\u7EBF\u56DE\u73AF"),!1):(Oe.success("\u8FDE\u63A5\u6210\u529F"),!0)}function I(u){const{sourceId:y,targetId:A}=u;p.loadEasyFlowFinish&&E.value.lineList.push({from:y,to:A})}function f(u){const{sourceId:y,targetId:A}=u,F=E.value.lineList.findIndex(n=>n.from===y&&n.to===A);E.value.lineList.splice(F,1)}function _(u){const{originalSourceId:y,originalTargetId:A}=u,F=E.value.lineList.findIndex(n=>n.from===y&&n.to===A);E.value.lineList.splice(F,1)}function v({from:u,to:y,label:A}){let F=p.getConnections(u,y);!A||A===""?(F.removeClass("flowLabel"),F.addClass("emptyFlowLabel")):F.addClass("flowLabel"),F.setLabel({label:A}),E.value.lineList.forEach(n=>{n.from===u&&n.to===y&&(n.label=A)})}function M(){p.repaint()}function m(){a.value={type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}}return(u,y)=>{const A=Ot("b-button"),F=Ot("b-divider"),n=Ot("b-dropdown-item"),t=Ot("b-dropdown-menu"),d=Ot("b-dropdown"),x=We("flow-drag");return wt(),At("div",{class:"easy-flow-container",style:Te({height:W.height})},[Et("div",Kn,[bt(A,{type:"text"},{default:xt(()=>[Nt(oe(E.value.name),1)]),_:1}),bt(F,{type:"vertical"}),bt(A,{type:"text",icon:"delete",onClick:H,disabled:!a.value.type},null,8,["disabled"]),Et("div",Zn,[bt(A,{size:"small",type:"info",plain:"",icon:"filedone",onClick:y[0]||(y[0]=j=>K.value=!0)},{default:xt(()=>[Nt(" \u6D41\u7A0B\u4FE1\u606F ")]),_:1}),bt(d,{trigger:"click",style:{margin:"0 10px"},onCommand:S},{dropdown:xt(()=>[bt(t,null,{default:xt(()=>[bt(n,{name:"dataA"},{default:xt(()=>[Nt("dataA")]),_:1}),bt(n,{name:"dataB"},{default:xt(()=>[Nt("dataB")]),_:1}),bt(n,{name:"dataC"},{default:xt(()=>[Nt("dataC")]),_:1}),bt(n,{name:"dataD"},{default:xt(()=>[Nt("dataD")]),_:1})]),_:1})]),default:xt(()=>[bt(A,{size:"small",type:"info",plain:"",icon:"database"},{default:xt(()=>[Nt("\u6570\u636E\u6E90")]),_:1})]),_:1}),bt(A,{size:"small",type:"info",plain:"",icon:"book",onClick:y[1]||(y[1]=j=>r.value=!0)},{default:xt(()=>[Nt(" \u5E2E\u52A9 ")]),_:1})])]),U.value?(wt(),At("div",Qn,[Et("div",ti,[bt(Pn,{repeat:W.repeat,data:E.value},null,8,["repeat","data"])]),Gt((wt(),At("div",{class:"canvas-side",id:"efContainer",ref_key:"efContainer",ref:Y,onClick:Me(s,["self"]),onDragover:y[2]||(y[2]=Me(()=>{},["prevent"])),onDrop:O},[(wt(!0),At(ie,null,ye(E.value.nodeList,j=>(wt(),he(rn,{key:j.id,id:j.id,node:j,activeElement:a.value,onClickNode:l,onChangeNodeSite:R,onNodeRightMenu:g},null,8,["id","node","activeElement"]))),128)),ni],40,ei)),[[x]]),Et("div",ii,[bt(Mn,{ref_key:"nodeFormRef",ref:et,onSetLineLabel:v,onSaveNode:M,onCancelSelect:m},null,512)]),bt(Fn,{modelValue:K.value,"onUpdate:modelValue":y[3]||(y[3]=j=>K.value=j),data:E.value},null,8,["modelValue","data"]),bt(Ln,{data:e,onDelete:H},null,8,["data"])])):se("",!0),bt(Vn,{modelValue:r.value,"onUpdate:modelValue":y[4]||(y[4]=j=>r.value=j)},null,8,["modelValue"])],4)}}}),li=be(oi,[["__scopeId","data-v-c62e3712"]]);const ri={class:"p16 wrapper"},fi={__name:"index",setup(W){return(c,U)=>(wt(),At("div",ri,[bt(li)]))}};export{fi as default};
