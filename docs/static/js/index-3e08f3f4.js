var e=(e,t,a)=>new Promise(((l,n)=>{var o=e=>{try{r(a.next(e))}catch(t){n(t)}},s=e=>{try{r(a.throw(e))}catch(t){n(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,s);r((a=a.apply(e,t)).next())}));import{f as t,t as a}from"./index-f17bcc8b.js";import{f as l,x as n,cn as o,co as s,g as r,n as d,J as c,L as i,o as h,A as u,B as p,t as f,c as m,a as y,r as v,u as k,w as g,F as b,d as x,D as S,E as w,q as C}from"./vendor-1971077f.js";function A(o,s={},r,d="text"){const c=l(null),i=l([]),h=l(""),u=l(!1),p=l(!1),f=()=>e(this,null,(function*(){if(o){try{m(!0);const e=yield o(s);"object"===t(e)?i.value=[e]:i.value=e,r&&r.emit("init-success")}catch(e){a("useTree/getTreeData",e)}m(!1)}}));function m(e){u.value=e}return{treeRef:c,query:h,loading:u,treeData:i,hasChecked:p,getFlatState:()=>c.value.getFlatState(),getTreeData:f,reloadTree:(...t)=>e(this,[...t],(function*(e=[],t=[]){yield f(),yield n(),c.value.setSelected(e),c.value.setExpand(t)})),reloadTreeWithCheck:(...t)=>e(this,[...t],(function*(e=[]){yield f(),yield n(),c.value&&c.value.setChecked(e)})),handleFilter:e=>{c.value&&c.value.filter(e)},filterNode:(e,t)=>!e||-1!==t[d].indexOf(e),handleSelect:(e,t,a)=>{r&&r.emit("select-change",t,a)},handleChecked:(e,t,a)=>{p.value=e.length>0,r&&r.emit("check-change",e,t,a)}}}const T={name:"BaseTree",props:{width:{type:String,default:"320px"},minHeight:{type:String,default:"300px"},maxHeight:{type:String,default:"700px"},treeTitle:{type:String},filterPosition:{type:String,default:"top"},lock:Boolean,fetch:{type:[Function,Array]},params:{type:Object},render:Function,showCheckbox:{type:Boolean},checkStrictly:{type:Boolean},showFilter:{type:Boolean},titleKey:{type:String,default:"text"},defaultExpand:{type:Boolean},expandKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]}},emits:["select-change","check-change","command","init-success"],setup(a,o){const s=l(null),c=r((()=>a.showFilter&&"top"===a.filterPosition)),i=r((()=>a.showFilter&&"inner"===a.filterPosition)),{treeRef:h,loading:u,query:p,treeData:f,getTreeData:m,reloadTree:y,reloadTreeWithCheck:v,handleSelect:k,handleChecked:g,handleFilter:b,filterNode:x}=A(a.fetch,a.params,o,a.titleKey);function S(){h.value&&h.value.setExpand(a.expandKeys),h.value&&h.value.setSelected(a.selectedKeys)}return d((()=>a.fetch),(a=>e(this,null,(function*(){if("array"===t(a))return f.value=a,a.length>0&&(yield n(),S()),!0;yield m(),S()}))),{immediate:!0}),{treeEl:s,showTopSearch:c,showInnerSearch:i,treeRef:h,query:p,loading:u,treeData:f,getTreeData:m,reloadTree:y,reloadTreeWithCheck:v,handleSelect:k,handleChecked:g,handleAction:function(e){switch(e){case"expandAll":h.value&&h.value.expandAll();break;case"collapseAll":h.value&&h.value.collapseAll();break;case"checkAll":h.value&&h.value.checkAll();break;case"uncheckAll":h.value&&h.value.uncheckAll()}o.emit("command",e)},handleFilter:b,filterNode:x}}};o("data-v-53325db2");const F={class:"base-tree-header"},D={class:"base-title"},_={class:"base-ctrl"},q={class:"search"},B={class:"ctrl"},E=p("i",{class:"b-iconfont b-icon-ellipsis"},null,-1),K=C("展开全部"),$=C("收起全部"),H=C("选择全部"),V=C("取消全选"),P={key:0,class:"tree-inner"},j={key:1,class:"inner-search"},N={class:"mr-5"},R={key:0,class:"tree-bottom"};s(),T.render=function(e,t,a,l,n,o){const s=c("b-input"),r=c("b-dropdown-item"),d=c("b-dropdown-menu"),C=c("b-dropdown"),A=c("b-tree"),T=i("loading");return h(),u("div",{class:"base-tree",style:w({width:a.width}),ref:"treeEl"},[p("div",F,[p("span",D,f(a.treeTitle),1),p("div",_,[p("div",q,[l.showTopSearch?(h(),m(s,{key:0,size:"small",search:"",modelValue:l.query,"onUpdate:modelValue":t[0]||(t[0]=e=>l.query=e),placeholder:"搜索",onSearch:l.handleFilter},null,8,["modelValue","onSearch"])):y("",!0),v(e.$slots,"default",{},void 0,!0)]),p("div",B,[k(C,{"append-to-body":"",placement:"bottom-start",onCommand:l.handleAction},{dropdown:g((()=>[k(d,null,{default:g((()=>[k(r,{name:"expandAll"},{default:g((()=>[K])),_:1}),k(r,{name:"collapseAll"},{default:g((()=>[$])),_:1}),a.showCheckbox?(h(),u(b,{key:0},[k(r,{name:"checkAll",divided:""},{default:g((()=>[H])),_:1}),k(r,{name:"uncheckAll"},{default:g((()=>[V])),_:1})],64)):y("",!0),v(e.$slots,"ctrl",{},void 0,!0)])),_:3})])),default:g((()=>[E])),_:3},8,["onCommand"])])])]),x(p("div",{class:S(["tree-wrap",{"has-bottom":e.$slots.bottom}]),style:w({minHeight:a.minHeight,maxHeight:a.maxHeight})},[e.$slots.inner?(h(),u("div",P,[v(e.$slots,"inner",{},void 0,!0)])):y("",!0),l.showInnerSearch?(h(),u("div",j,[k(s,{size:"small",search:"",modelValue:l.query,"onUpdate:modelValue":t[1]||(t[1]=e=>l.query=e),placeholder:"搜索",onSearch:l.handleFilter},null,8,["modelValue","onSearch"])])):y("",!0),p("div",N,[k(A,{data:l.treeData,"title-key":a.titleKey,"show-checkbox":a.showCheckbox,"filter-node-method":l.filterNode,render:a.render,"lock-select":a.lock,"default-expand":a.defaultExpand,ref:"treeRef",onSelectChange:l.handleSelect,onCheckChange:l.handleChecked},null,8,["data","title-key","show-checkbox","filter-node-method","render","lock-select","default-expand","onSelectChange","onCheckChange"])])],6),[[T,l.loading]]),e.$slots.bottom?(h(),u("div",R,[v(e.$slots,"bottom",{},void 0,!0)])):y("",!0)],4)},T.__scopeId="data-v-53325db2";export{T as _,A as u};
