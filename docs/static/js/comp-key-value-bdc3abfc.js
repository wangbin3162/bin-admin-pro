import{_ as e}from"./page-wrapper-ba2a5162.js";import{d as n}from"./index-f17bcc8b.js";import{_ as l,u as a}from"./index-9bc9a2c2.js";import{cn as t,co as o,f as s,n as u,J as d,o as i,A as r,B as p,F as c,K as m,u as f,w as b,q as v,g,c as h}from"./vendor-1971077f.js";import"./chunk-bin-ui-next-ddd04845.js";import"./chunk-echarts-f72b51a5.js";import"./chunk-brace-7f859248.js";const y={name:"KeyValueMapping",components:{DragHandle:l},props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:l}){const t=s([]),{listRef:o}=a(t,d);function d(){l("update:modelValue",t.value)}return u((()=>e.modelValue),(e=>{t.value=n(e)}),{immediate:!0,deep:!0}),{listRef:o,list:t,inputChange:function(){d()},handleAdd:function(){t.value.push({key:"",value:""}),d()},handleRemove:function(e){t.value.splice(e,1),d()}}}};t("data-v-75a06e4a");const k={class:"key-value-wrapper"},I={class:"mapping-list",ref:"listRef"},V=["onClick"],x={class:"mt-8 mb-8"},w=v("新增");o(),y.render=function(e,n,l,a,t,o){const s=d("drag-handle"),u=d("b-input"),v=d("b-button");return i(),r("div",k,[p("ul",I,[(i(!0),r(c,null,m(a.list,((e,n)=>(i(),r("li",{key:n,class:"mapping-item"},[f(s),p("label",null,[f(u,{modelValue:a.list[n].key,"onUpdate:modelValue":e=>a.list[n].key=e,placeholder:"key",clearable:"",onInput:a.inputChange},null,8,["modelValue","onUpdate:modelValue","onInput"])]),p("label",null,[f(u,{modelValue:a.list[n].value,"onUpdate:modelValue":e=>a.list[n].value=e,placeholder:"value",clearable:"",onInput:a.inputChange},null,8,["modelValue","onUpdate:modelValue","onInput"])]),p("i",{class:"destroy b-iconfont b-icon-delete",onClick:e=>a.handleRemove(n)},null,8,V)])))),128))],512),p("div",x,[f(v,{icon:"plus-circle",type:"text",onClick:a.handleAdd},{default:b((()=>[w])),_:1},8,["onClick"])])])},y.__scopeId="data-v-75a06e4a";const R={name:"CompKeyValue",components:{KeyValueMapping:y,PageWrapper:e},setup(e){const n=s([{key:"1",value:"a"},{key:"2",value:"b"},{key:"3",value:"c"}]),l=g((()=>JSON.stringify(n.value,null,2)));return{mapping:n,mappingJson:l,STR:"import Sortable from 'sortablejs'\nimport { onBeforeUnmount, onMounted, ref } from 'vue'\n\n/**\n * sortable hooks，用于创建拖拽排序列表\n * @param list 列表list<ref>\n * @param endFun 拖拽结束事件函数\n * @param option 其他sortable配置项\n */\nexport default function useSortable(list, endFun, option = {}) {\n  const defaultOptions = {\n    animation: 150,\n    ghostClass: 'blue-background-class',\n    // ************* 拖动对象移动样式\n    dragClass: 'drag-item-class',\n    // ************* 禁用html5原生拖拽行为\n    forceFallback: true,\n    handle: '.drag'\n  }\n  const listRef = ref(null)\n  let sortInstance = null\n  onMounted(() => {\n    if (sortInstance) sortInstance.destroy()\n    const el = listRef.value\n    if (!el) return\n    sortInstance = Sortable.create(el, {\n      ...defaultOptions,\n      ...option,\n      onUpdate: ({ newIndex, oldIndex }) => {\n        const $li = el.children[newIndex]\n        const $oldLi = el.children[oldIndex]\n        // 先删除移动的节点\n        el.removeChild($li)\n        // 再插入移动的节点到原有节点，还原了移动的操作\n        if (newIndex > oldIndex) {\n          el.insertBefore($li, $oldLi)\n        } else {\n          el.insertBefore($li, $oldLi.nextSibling)\n        }\n        // 更新items数组\n        const targetRow = list.value.splice(oldIndex, 1)[0]\n        list.value.splice(newIndex, 0, targetRow)\n        // 下一个tick就会走patch更新\n      },\n      onEnd: (evt) => {\n        endFun && endFun()\n      }\n    })\n  })\n  onBeforeUnmount(() => {\n    if (sortInstance) {\n      sortInstance.destroy()\n      sortInstance = null\n    }\n  })\n  return {\n    listRef\n  }\n}\n"}}},_={class:"p16"},C=v("实际存储值");R.render=function(e,n,l,a,t,o){const s=d("key-value-mapping"),u=d("b-divider"),r=d("b-ace-editor"),c=d("b-collapse-wrap"),m=d("b-col"),v=d("b-row"),g=d("page-wrapper");return i(),h(g,{desc:"基础映射配置示例，可拖动排序，并封装了通用的hook钩子函数，可进行复用。"},{default:b((()=>[f(v,{gutter:16},{default:b((()=>[f(m,{span:"12"},{default:b((()=>[f(c,{title:"映射配置",shadow:"none"},{default:b((()=>[p("div",_,[f(s,{modelValue:a.mapping,"onUpdate:modelValue":n[0]||(n[0]=e=>a.mapping=e)},null,8,["modelValue"]),f(u,{align:"left"},{default:b((()=>[C])),_:1}),f(r,{"model-value":a.mappingJson,readonly:""},null,8,["model-value"])])])),_:1})])),_:1}),f(m,{span:"12"},{default:b((()=>[f(c,{title:"useSortable",shadow:"none"},{default:b((()=>[f(r,{"model-value":a.STR,lang:"typescript",readonly:"",theme:"sqlserver",height:"850px",snippets:!1},null,8,["model-value"])])),_:1})])),_:1})])),_:1})])),_:1})};export{R as default};
