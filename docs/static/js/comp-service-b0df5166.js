var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,i=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,d=(e,l)=>{for(var a in l||(l={}))n.call(l,a)&&i(e,a,l[a]);if(o)for(var a of o(l))t.call(l,a)&&i(e,a,l[a]);return e},u=(e,o)=>l(e,a(o));import{_ as s}from"./page-wrapper-ea777216.js";import{f as r,n as m,J as c,o as p,A as h,B as g,u as V,w as v,a as b,a7 as f,a8 as R,q as k,g as y,F as C,K as U,c as w,t as x,D as _}from"./vendor-b1b195f8.js";import"./index-c2ebc9d7.js";import{_ as D,u as E}from"./index-d826c2ba.js";import"./chunk-brace-7f859248.js";import"./chunk-bin-ui-next-f06badfa.js";const L={name:"styles-editor",props:{modelValue:{type:String,default:""},showAction:{type:Boolean,default:!0},height:{type:String,default:"100px"}},emits:["update:modelValue","change"],setup(e,{emit:l}){const a=r(""),o=r("25%");function n(){l("update:modelValue",a.value),l("change",a.value)}function t(){a.value="width: 25%;",n()}return m((()=>e.modelValue),(l=>{""!==l?(!function(){const l=e.modelValue;l.includes("width: 25%;")?o.value="25%":l.includes("width: 50%;")?o.value="50%":l.includes("width: 75%;")?o.value="75%":l.includes("width: 100%;")?o.value="100%":o.value=""}(),a.value=l):t()}),{immediate:!0}),m((()=>o.value),(e=>{a.value=`width: ${e};`,n()})),{width:o,styleValue:a,emitValue:n,resetStyle:t}}},$=e=>(f("data-v-5d5152a2"),e=e(),R(),e),q={class:"styles-editor-wrap"},M={flex:"main:justify"},F={class:"editor-box"},N={key:0,class:"action-box"},z={class:"mb-5",flex:"main:justify cross:center"},S=$((()=>g("div",null,"样式显示",-1))),P=$((()=>g("div",{class:"mb-5"},[g("div",null,"宽度设置")],-1))),j={class:"mb-5",flex:"cross:center"},B=k("1"),O=k("2"),I=k("3"),A=k("4"),T=$((()=>g("span",{class:"ml-5"},"/ 4",-1)));L.render=function(e,l,a,o,n,t){const i=c("b-ace-editor"),d=c("b-icon"),u=c("b-tooltip"),s=c("b-space"),r=c("b-radio"),m=c("b-radio-group");return p(),h("div",q,[g("div",M,[g("div",F,[V(i,{modelValue:o.styleValue,"onUpdate:modelValue":l[0]||(l[0]=e=>o.styleValue=e),lang:"stylus",height:a.height,"font-size":14,onBlur:o.emitValue},null,8,["modelValue","height","onBlur"])]),a.showAction?(p(),h("div",N,[g("div",z,[S,V(s,null,{default:v((()=>[V(u,{content:"输入样式表，默认控件宽度皆为25%"},{default:v((()=>[V(d,{name:"question-circle",size:18})])),_:1}),V(u,{content:"重置样式"},{default:v((()=>[V(d,{name:"sync",size:18,type:"button",onClick:o.resetStyle},null,8,["onClick"])])),_:1})])),_:1})]),P,g("div",j,[V(m,{modelValue:o.width,"onUpdate:modelValue":l[1]||(l[1]=e=>o.width=e),type:"button",size:"mini"},{default:v((()=>[V(r,{label:"25%"},{default:v((()=>[B])),_:1}),V(r,{label:"50%"},{default:v((()=>[O])),_:1}),V(r,{label:"75%"},{default:v((()=>[I])),_:1}),V(r,{label:"100%"},{default:v((()=>[A])),_:1})])),_:1},8,["modelValue"]),T])])):b("",!0)])])},L.__scopeId="data-v-5d5152a2";const J=["blur","change"],G=["string","number"],H={length:"$length",email:"$email",phone:"$phone",idCode:"$idCode",unifiedCode:"$unifiedCode",orgInstCode:"$orgInstCode",regNo:"$regNo"},K={regexp:"$regexp",conditionRequired:"$conditionRequired",conditionNotRequired:"$conditionNotRequired",conditionNotBe:"$conditionNotBe",notSame:"$notSame",timeBound:"$timeBound"},W=d(d({required:"$required"},H),K),Y={$required:"必填项",$length:"长度参数",$email:"邮箱参数",$phone:"手机号码",$regexp:"正则匹配",$idCode:"身份证",$unifiedCode:"统一社会信用代码",$orgInstCode:"组织机构代码",$regNo:"工商注册号",$conditionRequired:"条件必填",$conditionNotRequired:"条件必不填",$conditionNotBe:"条件不为某值",$notSame:"值不能相同",$timeBound:"日期区间"};const Q={name:"async-validator",components:{DragHandle:D},props:{modelValue:{type:String,default:""},dataLength:Number,originalRules:{type:String},showLog:Boolean},emits:["update:modelValue","change"],setup(e,{emit:l}){const a=r(!1),o=r([]),{listRef:n}=E(o,p),t=y((()=>!!i(W.required))),i=e=>o.value.find((l=>l.name===e));function s(l){if(l===W.required&&t.value)return;const a=e=>({name:e,type:G[0],trigger:J[0]});switch(l){case W.required:o.value.unshift(u(d({},a(l)),{message:"必填项"}));break;case W.length:o.value.push(u(d({},a(l)),{min:1,max:e.dataLength||1/0,message:"长度必须在指定的范围内"}));break;case W.email:o.value.push(u(d({},a(l)),{message:"邮箱格式不正确"}));break;case W.phone:o.value.push(u(d({},a(l)),{message:"手机号格式不正确"}));break;case W.idCode:o.value.push(u(d({},a(l)),{preField:"",message:"身份证格式不正确",ignoreCase:!0}));break;case W.unifiedCode:o.value.push(u(d({},a(l)),{preField:"",message:"统一社会信用代码格式不正确",ignoreCase:!0}));break;case W.orgInstCode:o.value.push(u(d({},a(l)),{preField:"",message:"组织机构代码格式不正确",ignoreCase:!0}));break;case W.regNo:o.value.push(u(d({},a(l)),{preField:"",message:"工商注册号格式不正确",ignoreCase:!0}));break;case W.regexp:o.value.push(u(d({},a(l)),{regexp:"",message:"正则表达式不匹配"}));break;case W.conditionRequired:o.value.push(u(d({},a(l)),{preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下必填"}));break;case W.conditionNotRequired:o.value.push(u(d({},a(l)),{preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下不可填写"}));break;case W.conditionNotBe:o.value.push(u(d({},a(l)),{preField:"",preFieldValue:"",notValue:"",message:"当前字段在前置字段条件达成下不能为某值"}));break;case W.notSame:o.value.push(u(d({},a(l)),{preField:"",message:"不能和前置字段值相同"}));break;case W.timeBound:o.value.push(u(d({},a(l)),{time:"$now",compareMode:"gt",message:"日期不符合区间设置"}))}p()}function c(){o.value=[],a.value=!1,p()}function p(){const e=o.value.length?JSON.stringify(o.value):"";l("update:modelValue",e),l("change",e)}return m((()=>e.modelValue),(e=>{if(""!==e)try{o.value=JSON.parse(e),a.value=t.value}catch(l){console.warn("async-validator: model-value is not a right json，rules is reset"),c()}else c()}),{immediate:!0}),{rulesRef:n,SIMPLE_RULE:H,MULTIPLE_RULE:K,RULE:W,RULE_NAME_MAP:Y,TRIGGER:J,TYPE:G,hasRequiredRule:t,isRequired:a,checkRules:o,rulesClass:function(e){return e===W.required?"is-required":K[e.slice(1)]?"is-multiple":"is-normal"},requiredChange:function(e){e?s(W.required):(o.value=o.value.filter((e=>e.name!==W.required)),p())},setRules:s,removeRules:function(e){o.value.splice(e,1),p()},hasSameRule:function(e){return!K[e]&&!!i(e)},emitValue:p,allowDrop:function(e){e.preventDefault()},onDrop:function(e,l){o.value[l].hasOwnProperty("preField")&&(o.value[l].preField=e.dataTransfer.getData("index")),o.value[l].hasOwnProperty("time")&&(o.value[l].time=e.dataTransfer.getData("index")),p(),e.preventDefault()},reload:function(){e.originalRules&&(l("update:modelValue",e.originalRules),l("change",e.originalRules))},refreshRules:c}}},X=e=>(f("data-v-135d0b0e"),e=e(),R(),e),Z={class:"validator-wrap"},ee={class:"mb-10",style:{padding:"0 4px"}},le={style:{width:"100%","line-height":"32px"},flex:"main:justify"},ae=k(" 必填项 "),oe={style:{cursor:"pointer",color:"#13c2c2"}},ne=k(" 静态规则 "),te={style:{cursor:"pointer",color:"#52c41a"}},ie=k(" 动态规则 "),de=X((()=>g("i",{class:"b-iconfont b-icon-reload"},null,-1))),ue=X((()=>g("i",{class:"b-iconfont b-icon-mr"},null,-1))),se={class:"check-rules-wrap",ref:"rulesRef"},re={class:"rules-params"},me={class:"title-box",title:"触发条件"},ce=X((()=>g("span",{title:"输入框为失焦事件，其余控件为改变事件"},"触发条件",-1))),pe={class:"title-box",title:"取值类型"},he=X((()=>g("span",{title:"非数字类型选择字符"},"取值类型",-1))),ge={class:"rules-cfg"},Ve={key:0,class:"title-box is-message",title:"正则规则"},ve=X((()=>g("span",null,"正则规则",-1))),be={class:"title-box",title:"最小值"},fe=X((()=>g("span",{style:{width:"60px"}},"最小值",-1))),Re={class:"title-box",title:"最大值"},ke=X((()=>g("span",{style:{width:"60px"}},"最大值",-1))),ye=["onDrop"],Ce=X((()=>g("span",null,"前置字段",-1))),Ue=k(" 忽略大小写 "),we=["onDrop"],xe=X((()=>g("span",null,"前置字段",-1))),_e={class:"title-box",title:"前置字段值"},De=X((()=>g("span",null,"前置字段值",-1))),Ee=["onDrop"],Le=X((()=>g("span",null,"前置字段",-1))),$e={class:"title-box",title:"前置字段值"},qe=X((()=>g("span",null,"前置字段值",-1))),Me={class:"title-box",title:"不是某值"},Fe=X((()=>g("span",null,"不是某值",-1))),Ne=["onDrop"],ze=X((()=>g("span",null,"前置字段",-1))),Se={class:"title-box",title:"比较模式"},Pe=X((()=>g("span",null,"比较模式",-1))),je=["onDrop"],Be=X((()=>g("span",{title:"比较值(yyyy-MM-dd)，可以是字段名，也可以填写$now取得当前时间"},"比较取值",-1))),Oe={class:"rules-message"},Ie={class:"title-box is-message",title:"错误提示"},Ae=X((()=>g("span",null,"错误提示",-1))),Te={class:"delete"},Je={key:0};Q.render=function(e,l,a,o,n,t){const i=c("b-checkbox"),d=c("b-divider"),u=c("b-icon"),s=c("b-dropdown-item"),r=c("b-dropdown-menu"),m=c("b-dropdown"),f=c("b-button"),R=c("b-tooltip"),y=c("b-option"),D=c("b-select"),E=c("b-space"),L=c("b-input"),$=c("b-input-number"),q=c("drag-handle"),M=c("b-ace-editor");return p(),h("div",Z,[g("div",ee,[g("div",le,[g("div",null,[V(i,{modelValue:o.isRequired,"onUpdate:modelValue":l[0]||(l[0]=e=>o.isRequired=e),onChange:o.requiredChange,style:{"margin-right":"0"}},{default:v((()=>[ae])),_:1},8,["modelValue","onChange"]),V(d,{type:"vertical"}),V(m,{onCommand:o.setRules},{dropdown:v((()=>[V(r,null,{default:v((()=>[(p(!0),h(C,null,U(o.SIMPLE_RULE,((e,l)=>(p(),w(s,{key:l,name:e,disabled:o.hasSameRule(e)},{default:v((()=>[k(x(o.RULE_NAME_MAP[e]),1)])),_:2},1032,["name","disabled"])))),128))])),_:1})])),default:v((()=>[g("span",oe,[ne,V(u,{name:"down"})])])),_:1},8,["onCommand"]),V(d,{type:"vertical"}),V(m,{onCommand:o.setRules},{dropdown:v((()=>[V(r,null,{default:v((()=>[(p(!0),h(C,null,U(o.MULTIPLE_RULE,((e,l)=>(p(),w(s,{key:l,name:e},{default:v((()=>[k(x(o.RULE_NAME_MAP[e]),1)])),_:2},1032,["name"])))),128))])),_:1})])),default:v((()=>[g("span",te,[ie,V(u,{name:"down"})])])),_:1},8,["onCommand"])]),g("div",null,[V(R,{content:"初始化校验"},{default:v((()=>[V(f,{background:"",size:"mini",onClick:o.refreshRules},{default:v((()=>[de])),_:1},8,["onClick"])])),_:1}),a.originalRules?(p(),w(R,{key:0,content:"恢复修改前校验"},{default:v((()=>[V(f,{background:"",size:"mini",onClick:o.reload},{default:v((()=>[ue])),_:1},8,["onClick"])])),_:1})):b("",!0)])])]),g("ul",se,[(p(!0),h(C,null,U(o.checkRules,((e,n)=>(p(),h("li",{key:n,class:"rules-list-item"},[g("div",re,[V(E,null,{default:v((()=>[g("div",{class:_(["role-name",o.rulesClass(e.name)])},x(o.RULE_NAME_MAP[e.name]),3),g("div",me,[ce,V(D,{modelValue:o.checkRules[n].trigger,"onUpdate:modelValue":e=>o.checkRules[n].trigger=e,size:"small","append-to-body":"",onChange:o.emitValue},{default:v((()=>[V(y,{label:"失焦",value:"blur"}),V(y,{label:"改变",value:"change"})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),g("div",pe,[he,V(D,{modelValue:o.checkRules[n].type,"onUpdate:modelValue":e=>o.checkRules[n].type=e,size:"small","append-to-body":"",onChange:o.emitValue},{default:v((()=>[V(y,{label:"字符",value:"string"}),V(y,{label:"数字",value:"number"})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])])),_:2},1024)]),g("div",ge,[e.name===o.RULE.regexp?(p(),h("div",Ve,[ve,V(L,{modelValue:o.checkRules[n].regexp,"onUpdate:modelValue":e=>o.checkRules[n].regexp=e,modelModifiers:{trim:!0},size:"small",placeholder:"需输入字符格式",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])):b("",!0),V(E,null,{default:v((()=>[e.name===o.RULE.length?(p(),h(C,{key:0},[g("div",be,[fe,V($,{modelValue:o.checkRules[n].min,"onUpdate:modelValue":e=>o.checkRules[n].min=e,min:1,max:a.dataLength,precision:0,size:"small",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])]),g("div",Re,[ke,V($,{modelValue:o.checkRules[n].max,"onUpdate:modelValue":e=>o.checkRules[n].max=e,min:1,max:a.dataLength,precision:0,size:"small",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])])],64)):b("",!0),[o.RULE.idCode,o.RULE.unifiedCode,o.RULE.orgInstCode,o.RULE.regNo].includes(e.name)?(p(),h(C,{key:1},[g("div",{class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[1]||(l[1]=e=>o.allowDrop(e))},[Ce,V(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,ye),V(i,{modelValue:o.checkRules[n].ignoreCase,"onUpdate:modelValue":e=>o.checkRules[n].ignoreCase=e,onChange:o.emitValue},{default:v((()=>[Ue])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])],64)):b("",!0),e.name===o.RULE.conditionRequired||e.name===o.RULE.conditionNotRequired?(p(),h(C,{key:2},[g("div",{class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[2]||(l[2]=e=>o.allowDrop(e))},[xe,V(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,we),g("div",_e,[De,V(L,{modelValue:o.checkRules[n].preFieldValue,"onUpdate:modelValue":e=>o.checkRules[n].preFieldValue=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):b("",!0),e.name===o.RULE.conditionNotBe?(p(),h(C,{key:3},[g("div",{class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[3]||(l[3]=e=>o.allowDrop(e))},[Le,V(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Ee),g("div",$e,[qe,V(L,{modelValue:o.checkRules[n].preFieldValue,"onUpdate:modelValue":e=>o.checkRules[n].preFieldValue=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])]),g("div",Me,[Fe,V(L,{modelValue:o.checkRules[n].notValue,"onUpdate:modelValue":e=>o.checkRules[n].notValue=e,modelModifiers:{trim:!0},size:"small",placeholder:"不是某值",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):b("",!0),e.name===o.RULE.notSame?(p(),h("div",{key:4,class:"title-box",title:"前置字段",onDrop:e=>o.onDrop(e,n),onDragover:l[4]||(l[4]=e=>o.allowDrop(e))},[ze,V(L,{modelValue:o.checkRules[n].preField,"onUpdate:modelValue":e=>o.checkRules[n].preField=e,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Ne)):b("",!0),e.name===o.RULE.timeBound?(p(),h(C,{key:5},[g("div",Se,[Pe,V(D,{modelValue:o.checkRules[n].compareMode,"onUpdate:modelValue":e=>o.checkRules[n].compareMode=e,"append-to-body":"",size:"small",onChange:o.emitValue},{default:v((()=>[V(y,{value:"gt",label:">"}),V(y,{value:"ge",label:"≥"}),V(y,{value:"lt",label:"<"}),V(y,{value:"le",label:"≤"})])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),g("div",{class:"title-box",onDrop:e=>o.onDrop(e,n),onDragover:l[5]||(l[5]=e=>o.allowDrop(e))},[Be,V(L,{modelValue:o.checkRules[n].time,"onUpdate:modelValue":e=>o.checkRules[n].time=e,modelModifiers:{trim:!0},size:"small",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,je)],64)):b("",!0)])),_:2},1024)]),g("div",Oe,[g("div",Ie,[Ae,V(L,{modelValue:o.checkRules[n].message,"onUpdate:modelValue":e=>o.checkRules[n].message=e,modelModifiers:{trim:!0},size:"small",placeholder:"错误提示",onChange:o.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),V(q,{icon:"drag-drop-line"}),g("div",Te,[V(u,{title:"移除",color:"#f5222d",name:"minus-circle",size:"20",type:"button",onClick:e=>o.removeRules(n)},null,8,["onClick"])])])))),128))],512),a.showLog?(p(),h("div",Je,[V(M,{"model-value":JSON.stringify(o.checkRules,null,2),readonly:""},null,8,["model-value"])])):b("",!0)])},Q.__scopeId="data-v-135d0b0e";const Ge={name:"CompService",components:{AsyncValidator:Q,StylesEditor:L,PageWrapper:s}},He={class:"p10",style:{"min-height":"200px"}};Ge.render=function(e,l,a,o,n,t){const i=c("async-validator"),d=c("b-collapse-wrap"),u=c("b-col"),s=c("styles-editor"),r=c("b-row"),m=c("page-wrapper");return p(),w(m,{desc:"业务相关的独立组件，包含通用校验配置，字段样式配置等，可参考进行扩展或实现新的业务组件。"},{default:v((()=>[V(r,{gutter:16},{default:v((()=>[V(u,{span:"12"},{default:v((()=>[V(d,{title:"表单校验",shadow:"none"},{default:v((()=>[g("div",He,[V(i)])])),_:1})])),_:1}),V(u,{span:"12"},{default:v((()=>[V(d,{title:"字段样式配置",shadow:"none"},{default:v((()=>[V(s)])),_:1})])),_:1})])),_:1})])),_:1})};export{Ge as default};
