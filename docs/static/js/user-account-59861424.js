var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,u=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&n(e,l,a[l]);if(t)for(var l of t(a))r.call(a,l)&&n(e,l,a[l]);return e},d=(e,t)=>a(e,l(t));import{u as i}from"./useTable-0a8072b7.js";import{g as s}from"./user.api-fa5f8796.js";import{_ as p}from"./index-18e52138.js";import{_ as m}from"./page-wrapper-17a7ae57.js";import{_ as c}from"./index-a6874ac7.js";import{_ as f,u as b}from"./index-8df926ea.js";import{g}from"./depart.api-62ff3b35.js";import{u as y}from"./useForm-aaa7189f.js";import{a as h}from"./chunk-bin-ui-next-e393e6f7.js";import{f as C,y as V,n as _,J as k,o as v,c as x,w,B as j,u as q,A as S,K as D,F as U,a as z,q as T,t as L}from"./vendor-4890bdfb.js";import"./index-22ae5226.js";import"./chunk-brace-7f859248.js";const N={name:"UserAccount",components:{BaseTree:f,ActionButton:c,BaseTable:p,PageWrapper:m},setup(){const e=C(null),a=C({}),l=V({page:1,size:10,name:"",roles:"",status:"",date:"",email:""}),t=C(!1),o=C([]),r=C({}),{treeData:n,getTreeData:p}=b(g);p().then((()=>console.log(n.value)));const{loading:m,list:c,total:f,getListData:k,pageChange:v,pageSizeChange:x}=i(s,l),{formRef:w,editStatus:j,pageStatus:q,editLoading:S,openCreate:D,openEdit:U,backNormal:z,submitForm:T,resetForm:L,setBtnLoading:N,modalVisible:O}=y();return _(c,(e=>{o.value=e.map((e=>d(u({},e),{expand:!1})))})),k(),{treeRef:e,currentTreeNode:a,handleSelect:function(e,l){e.selected&&(a.value=e)},getDepartTree:g,deptTree:n,expand:t,query:l,loading:m,roleMap:{admin:"管理员",user:"普通用户",op:"实施人员"},total:f,copyList:o,getListData:k,pageChange:v,pageSizeChange:x,columns:[{title:"姓名",key:"realName"},{title:"登录名",key:"username"},{title:"邮箱",key:"email"},{title:"角色",slot:"roles"},{title:"出生日期",key:"createDate"},{title:"操作",width:100,align:"center",slot:"action"}],user:r,formRef:w,editStatus:j,pageStatus:q,editLoading:S,openCreate:D,openEdit:U,backNormal:z,submitForm:T,resetForm:L,ruleValidate:{realName:[{required:!0,message:"真实名称必填",trigger:"blur"}],username:[{required:!0,message:"用户名必填",trigger:"blur"}]},modalVisible:O,handleCreate:function(){r.value={realName:"",username:"",email:"",roles:"",depart:""},D()},handleCancel:function(){r.value={},z()},handleEdit:function(e){r.value=d(u({},e),{depart:""}),U()},handleSubmit:function(){T((()=>{N(!0);const e=q.value;setTimeout((()=>{h.success((e.isCreate?"新增":"修改")+"成功！"),N(!1),z(),k()}),1e3)}))},handleDelete:function(){h.success("删除成功！"),k()}}}},O={flex:""},F={style:{width:"calc(100% - 280px)"},class:"pl-16"},P=T("重置"),R=T("查询"),B=T("新增"),E=T(" 更多操作 "),M=T("刷新"),A=T("删除"),I={key:0},J=T("取 消"),K=T("确 定");N.render=function(e,a,l,t,o,r){const n=k("base-tree"),u=k("b-input"),d=k("b-form-item"),i=k("b-option"),s=k("b-select"),p=k("b-date-picker"),m=k("b-button"),c=k("b-form"),f=k("b-icon"),b=k("b-dropdown-item"),g=k("b-dropdown-menu"),y=k("b-dropdown"),h=k("action-button"),C=k("b-divider"),V=k("b-table"),_=k("b-page"),N=k("base-table"),W=k("b-tree-select"),G=k("b-modal"),H=k("page-wrapper");return v(),x(H,{desc:"页面数据为Mock数据，操作时不会进行真实操作。仅为模拟实现。"},{default:w((()=>[j("div",O,[q(n,{ref:"treeRef","tree-title":"部门列表","show-filter":"",fetch:t.getDepartTree,onSelectChange:t.handleSelect},null,8,["fetch","onSelectChange"]),j("div",F,[q(N,null,{filter:w((()=>[q(c,{"label-width":"95px"},{default:w((()=>[q(d,{label:"用户名称"},{default:w((()=>[q(u,{modelValue:t.query.name,"onUpdate:modelValue":a[0]||(a[0]=e=>t.query.name=e),clearable:""},null,8,["modelValue"])])),_:1}),q(d,{label:"用户角色"},{default:w((()=>[q(s,{modelValue:t.query.roles,"onUpdate:modelValue":a[1]||(a[1]=e=>t.query.roles=e),clearable:""},{default:w((()=>[(v(!0),S(U,null,D(t.roleMap,((e,a)=>(v(),x(i,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),t.expand?(v(),S(U,{key:0},[q(d,{label:"状态"},{default:w((()=>[q(s,{modelValue:t.query.status,"onUpdate:modelValue":a[2]||(a[2]=e=>t.query.status=e),clearable:""},{default:w((()=>[q(i,{label:"启用",value:"1"}),q(i,{label:"禁用",value:"0"})])),_:1},8,["modelValue"])])),_:1}),q(d,{label:"邮箱"},{default:w((()=>[q(u,{modelValue:t.query.email,"onUpdate:modelValue":a[3]||(a[3]=e=>t.query.email=e),clearable:""},null,8,["modelValue"])])),_:1}),q(d,{label:"日期"},{default:w((()=>[q(p,{modelValue:t.query.date,"onUpdate:modelValue":a[4]||(a[4]=e=>t.query.date=e),clearable:""},null,8,["modelValue"])])),_:1})],64)):z("",!0),q(d,null,{default:w((()=>[q(m,null,{default:w((()=>[P])),_:1}),q(m,{type:"primary",loading:t.loading,onClick:t.getListData},{default:w((()=>[R])),_:1},8,["loading","onClick"]),q(m,{type:"text",icon:t.expand?"up":"down",onClick:a[5]||(a[5]=e=>t.expand=!t.expand)},{default:w((()=>[T(L(t.expand?"收起":"展开"),1)])),_:1},8,["icon"])])),_:1})])),_:1})])),action:w((()=>[q(m,{type:"primary",icon:"plus-circle",onClick:t.handleCreate},{default:w((()=>[B])),_:1},8,["onClick"])])),actionRight:w((()=>[q(y,{style:{"margin-left":"20px"}},{dropdown:w((()=>[q(g,null,{default:w((()=>[q(b,null,{default:w((()=>[M])),_:1}),q(b,null,{default:w((()=>[A])),_:1})])),_:1})])),default:w((()=>[q(m,null,{default:w((()=>[E,q(f,{name:"down"})])),_:1})])),_:1})])),page:w((()=>[q(_,{total:t.total,current:t.query.page,"page-size":t.query.size,"show-sizer":"","show-total":"",onChange:t.pageChange,onSizeChange:t.pageSizeChange},null,8,["total","current","page-size","onChange","onSizeChange"])])),default:w((()=>[q(V,{columns:t.columns,data:t.copyList,loading:t.loading,border:""},{roles:w((({row:e})=>[T(L(t.roleMap[e.roles]),1)])),action:w((({row:e})=>[q(h,{type:"text",icon:"edit-square","is-icon":"",tooltip:"编辑",onClick:a=>t.handleEdit(e)},null,8,["onClick"]),q(C,{type:"vertical"}),q(h,{type:"text",icon:"delete",color:"danger","is-icon":"",tooltip:"删除",confirm:"",onClick:a=>t.handleDelete(e)},null,8,["onClick"])])),_:1},8,["columns","data","loading"])])),_:1})])]),q(G,{"model-value":t.modalVisible,title:(t.pageStatus.isCreate?"新增":"修改")+"角色",onClosed:t.handleCancel},{footer:w((()=>[j("div",null,[q(m,{onClick:t.handleCancel},{default:w((()=>[J])),_:1},8,["onClick"]),q(m,{type:"primary",loading:t.editLoading,onClick:t.handleSubmit},{default:w((()=>[K])),_:1},8,["loading","onClick"])])])),default:w((()=>[t.modalVisible?(v(),S("div",I,[q(c,{ref:"formRef",model:t.user,rules:t.ruleValidate,"label-width":"100px","label-suffix":":"},{default:w((()=>[q(d,{label:"所属部门"},{default:w((()=>[q(W,{modelValue:t.user.depart,"onUpdate:modelValue":a[6]||(a[6]=e=>t.user.depart=e),data:t.deptTree,"title-key":"text"},null,8,["modelValue","data"])])),_:1}),q(d,{label:"姓名",prop:"realName"},{default:w((()=>[q(u,{modelValue:t.user.realName,"onUpdate:modelValue":a[7]||(a[7]=e=>t.user.realName=e),placeholder:"输入姓名",clearable:""},null,8,["modelValue"])])),_:1}),q(d,{label:"用户名",prop:"username"},{default:w((()=>[q(u,{modelValue:t.user.username,"onUpdate:modelValue":a[8]||(a[8]=e=>t.user.username=e),placeholder:"输入登录名",clearable:""},null,8,["modelValue"])])),_:1}),q(d,{label:"邮箱"},{default:w((()=>[q(u,{modelValue:t.user.email,"onUpdate:modelValue":a[9]||(a[9]=e=>t.user.email=e),placeholder:"输入邮箱",clearable:""},null,8,["modelValue"])])),_:1}),q(d,{label:"角色"},{default:w((()=>[q(s,{modelValue:t.user.roles,"onUpdate:modelValue":a[10]||(a[10]=e=>t.user.roles=e),placeholder:"选择角色",clearable:""},{default:w((()=>[(v(!0),S(U,null,D(t.roleMap,((e,a)=>(v(),x(i,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])):z("",!0)])),_:1},8,["model-value","title","onClosed"])])),_:1})};export{N as default};
