import{j as N,t as q}from"./index-80424e34.js";import{a as k,x as T,a5 as I,b as E,n as H,I as b,K as z,o as m,z as v,A as _,t as j,f as O,c as p,r as S,u as i,d as f,F as P,w as R,B as U,D as K,q as C,a9 as W,aa as L}from"./vendor-e04737d2.js";function G(t,s={},a,n="text"){const o=k(null),l=k([]),y=k(""),c=k(!1),h=k(!1),r=async()=>{if(!!t){try{d(!0);const e=await t(s);N(e)==="object"?l.value=[e]:l.value=e,a&&a.emit("init-success")}catch(e){q("useTree/getTreeData",e)}d(!1)}},g=async(e=[],u=[])=>{await r(),await T(),o.value.setSelected(e),o.value.setExpand(u)},w=async(e=[])=>{await r(),await T(),o.value&&o.value.setChecked(e)};function d(e){c.value=e}return{treeRef:o,query:y,loading:c,treeData:l,hasChecked:h,getFlatState:()=>o.value.getFlatState(),getTreeData:r,reloadTree:g,reloadTreeWithCheck:w,handleFilter:e=>{o.value&&o.value.filter(e)},filterNode:(e,u)=>e?u[n].indexOf(e)!==-1:!0,handleSelect:(e,u,A)=>{a&&a.emit("select-change",u,A)},handleChecked:(e,u,A)=>{h.value=e.length>0,a&&a.emit("check-change",e,u,A)}}}const J={name:"BaseTree",props:{width:{type:String,default:"280px"},minHeight:{type:String,default:"300px"},maxHeight:{type:String,default:"700px"},treeTitle:{type:String},filterPosition:{type:String,default:"top"},lock:Boolean,fetch:{type:[Function,Array]},params:{type:Object},render:Function,showCheckbox:{type:Boolean},checkStrictly:{type:Boolean},showFilter:{type:Boolean},titleKey:{type:String,default:"text"},defaultExpand:{type:Boolean},expandKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]}},emits:["select-change","check-change","command","init-success"],setup(t,s){const a=k(null),n=E(()=>t.showFilter&&t.filterPosition==="top"),o=E(()=>t.showFilter&&t.filterPosition==="inner"),{treeRef:l,loading:y,query:c,treeData:h,getTreeData:r,reloadTree:g,reloadTreeWithCheck:w,handleSelect:d,handleChecked:F,handleFilter:B,filterNode:D}=G(t.fetch,t.params,s,t.titleKey);function V(e){switch(e){case"expandAll":l.value&&l.value.expandAll();break;case"collapseAll":l.value&&l.value.collapseAll();break;case"checkAll":l.value&&l.value.checkAll();break;case"uncheckAll":l.value&&l.value.uncheckAll();break}s.emit("command",e)}function x(){l.value&&l.value.setExpand(t.expandKeys),l.value&&l.value.setSelected(t.selectedKeys)}return H(()=>t.fetch,async e=>{if(N(e)==="array")return h.value=e,e.length>0&&(await T(),x()),!0;await r(),x()},{immediate:!0}),{treeEl:a,showTopSearch:n,showInnerSearch:o,treeRef:l,query:c,loading:y,treeData:h,getTreeData:r,reloadTree:g,reloadTreeWithCheck:w,handleSelect:d,handleChecked:F,handleAction:V,handleFilter:B,filterNode:D}}},M=t=>(W("data-v-e83cf626"),t=t(),L(),t),Q={class:"base-tree-header"},X={class:"base-title"},Y={class:"base-ctrl"},Z={class:"search"},$={class:"ctrl"},ee=M(()=>_("i",{class:"b-iconfont b-icon-ellipsis"},null,-1)),te=C("\u5C55\u5F00\u5168\u90E8"),ae=C("\u6536\u8D77\u5168\u90E8"),ne=C("\u9009\u62E9\u5168\u90E8"),le=C("\u53D6\u6D88\u5168\u9009"),oe={key:0,class:"tree-inner"},se={key:1,class:"inner-search"},ce={class:"mr-5"},re={key:0,class:"tree-bottom"};function de(t,s,a,n,o,l){const y=b("b-input"),c=b("b-dropdown-item"),h=b("b-dropdown-menu"),r=b("b-dropdown"),g=b("b-tree"),w=z("loading");return m(),v("div",{class:"base-tree",style:K({width:a.width}),ref:"treeEl"},[_("div",Q,[_("span",X,j(a.treeTitle),1),_("div",Y,[_("div",Z,[n.showTopSearch?(m(),O(y,{key:0,size:"small",search:"",modelValue:n.query,"onUpdate:modelValue":s[0]||(s[0]=d=>n.query=d),placeholder:"\u641C\u7D22",onSearch:n.handleFilter},null,8,["modelValue","onSearch"])):p("",!0),S(t.$slots,"default",{},void 0,!0)]),_("div",$,[i(r,{"append-to-body":"",placement:"bottom-start",onCommand:n.handleAction},{dropdown:f(()=>[i(h,null,{default:f(()=>[i(c,{name:"expandAll"},{default:f(()=>[te]),_:1}),i(c,{name:"collapseAll"},{default:f(()=>[ae]),_:1}),a.showCheckbox?(m(),v(P,{key:0},[i(c,{name:"checkAll",divided:""},{default:f(()=>[ne]),_:1}),i(c,{name:"uncheckAll"},{default:f(()=>[le]),_:1})],64)):p("",!0),S(t.$slots,"ctrl",{},void 0,!0)]),_:3})]),default:f(()=>[ee]),_:3},8,["onCommand"])])])]),R((m(),v("div",{class:U(["tree-wrap",{"has-bottom":t.$slots.bottom}]),style:K({minHeight:a.minHeight,maxHeight:a.maxHeight})},[t.$slots.inner?(m(),v("div",oe,[S(t.$slots,"inner",{},void 0,!0)])):p("",!0),n.showInnerSearch?(m(),v("div",se,[i(y,{size:"small",search:"",modelValue:n.query,"onUpdate:modelValue":s[1]||(s[1]=d=>n.query=d),placeholder:"\u641C\u7D22",onSearch:n.handleFilter},null,8,["modelValue","onSearch"])])):p("",!0),_("div",ce,[i(g,{data:n.treeData,"title-key":a.titleKey,"show-checkbox":a.showCheckbox,"filter-node-method":n.filterNode,render:a.render,"lock-select":a.lock,"default-expand":a.defaultExpand,ref:"treeRef",onSelectChange:n.handleSelect,onCheckChange:n.handleChecked},null,8,["data","title-key","show-checkbox","filter-node-method","render","lock-select","default-expand","onSelectChange","onCheckChange"])])],6)),[[w,n.loading]]),t.$slots.bottom?(m(),v("div",re,[S(t.$slots,"bottom",{},void 0,!0)])):p("",!0)],4)}var ue=I(J,[["render",de],["__scopeId","data-v-e83cf626"]]);export{ue as B,G as u};
