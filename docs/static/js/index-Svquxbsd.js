import{a8 as be,r as Jt,l as Zt,o as wt,a as At,b as Et,H as me,F as ie,i as se,t as oe,g as Rt,v as Ut,I as Le,O as Me,a9 as Ae,aa as ke,Q as Ot,R as ye,j as he,m as Be,K as bt,w as xt,f as Nt,T as Ye,n as Ue,p as Xe,G as we,P as We}from"./vendor-B29aizbt.js";import{i as ce,n as je,r as ze}from"./index-dssKf-7O.js";import{n as Oe,c as qe}from"./chunk-bin-ui-design-CMJ2EfEK.js";import"./chunk-brace-BklEY0pF.js";import"./chunk-mockjs-CGXE1Baq.js";const Te="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20class='icon'%20width='200px'%20height='200.00px'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill='%23333333'%20d='M212.992%20526.336%20212.992%20526.336%20212.992%20526.336%20215.04%20526.336%20212.992%20526.336ZM927.744%20530.432%20567.296%20530.432c-10.24%200-20.48%2010.24-20.48%2020.48l0%20221.184c0%2012.288%2010.24%2020.48%2020.48%2020.48l360.448%200c10.24%200%2020.48-8.192%2020.48-20.48L948.224%20550.912C948.224%20538.624%20937.984%20530.432%20927.744%20530.432zM909.312%20729.088c0%2014.336-10.24%2024.576-24.576%2024.576L610.304%20753.664c-14.336%200-24.576-10.24-24.576-24.576L585.728%20593.92c0-14.336%2010.24-24.576%2024.576-24.576l272.384%200c14.336%200%2024.576%2010.24%2024.576%2024.576L907.264%20729.088zM663.552%20815.104l167.936%200%200%2024.576-167.936%200%200-24.576ZM454.656%20178.176%2096.256%20178.176c-12.288%200-20.48%2010.24-20.48%2020.48l0%20221.184c0%2012.288%208.192%2020.48%2020.48%2020.48l360.448%200c12.288%200%2020.48-8.192%2020.48-20.48L477.184%20198.656C475.136%20186.368%20466.944%20178.176%20454.656%20178.176zM436.224%20376.832c0%2014.336-10.24%2024.576-24.576%2024.576L139.264%20401.408c-14.336%200-24.576-10.24-24.576-24.576l0-135.168c0-14.336%2010.24-24.576%2024.576-24.576l272.384%200c14.336%200%2024.576%2010.24%2024.576%2024.576L436.224%20376.832zM192.512%20462.848l167.936%200%200%2024.576-167.936%200%200-24.576ZM727.04%20313.344l24.576%200%200%20223.232-24.576%200%200-223.232ZM751.616%20198.656c-36.864%200-65.536%2030.72-65.536%2065.536s30.72%2065.536%2065.536%2065.536c36.864%200%2065.536-30.72%2065.536-65.536S788.48%20198.656%20751.616%20198.656zM751.616%20303.104c-20.48%200-38.912-16.384-38.912-38.912s16.384-38.912%2038.912-38.912%2038.912%2016.384%2038.912%2038.912S774.144%20303.104%20751.616%20303.104zM323.584%20684.032l223.232%200%200%2024.576-223.232%200%200-24.576ZM475.136%20253.952l223.232%200%200%2024.576-223.232%200%200-24.576ZM270.336%20487.424l24.576%200%200%20169.984-24.576%200%200-169.984ZM270.336%20638.976c-36.864%200-65.536%2030.72-65.536%2065.536s30.72%2065.536%2065.536%2065.536%2065.536-30.72%2065.536-65.536S307.2%20638.976%20270.336%20638.976zM270.336%20743.424c-20.48%200-38.912-16.384-38.912-38.912s16.384-38.912%2038.912-38.912%2038.912%2016.384%2038.912%2038.912S290.816%20743.424%20270.336%20743.424z'%20/%3e%3c/svg%3e",Fe="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20class='icon'%20width='200px'%20height='200.00px'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill='%23333333'%20d='M874.496%20693.4528c-12.288-12.288-33.5872-3.6864-33.5872%2013.9264v59.392H684.032l-40.96-76.1856c16.384-11.0592%2028.2624-24.9856%2032.768-42.1888%201.2288-3.2768%202.048-7.3728%202.048-11.0592v-241.664-1.6384-2.4576c0-23.7568-13.5168-43.008-35.2256-57.344l40.96-76.1856h157.2864v53.6576c0%2017.6128%2021.2992%2026.2144%2033.5872%2013.9264l84.3776-84.3776c7.7824-7.7824%207.7824-20.0704%200-27.8528l-84.3776-84.3776c-12.288-12.288-33.5872-3.6864-33.5872%2013.9264V196.608h-175.3088c-11.4688%200-21.7088%206.144-27.0336%2015.9744L585.728%20310.0672c-22.9376-5.7344-48.7424-8.6016-73.728-8.6016s-50.7904%202.8672-73.728%208.6016L385.4336%20212.1728c-5.3248-9.8304-15.5648-15.9744-27.0336-15.9744H183.0912V142.5408c0-17.6128-21.2992-26.2144-33.5872-13.9264L65.1264%20212.992c-7.7824%207.7824-7.7824%2020.0704%200%2027.8528l84.3776%2084.3776c12.288%2012.288%2033.5872%203.6864%2033.5872-13.9264V257.6384H339.968l40.96%2076.1856c-21.7088%2014.336-35.2256%2033.5872-35.2256%2057.344v245.76c0%203.6864%200.8192%207.3728%202.048%2010.6496%204.5056%2017.2032%2016.384%2031.5392%2033.1776%2042.5984l-40.96%2076.1856H183.0912V712.704c0-17.6128-21.2992-26.2144-33.5872-13.9264l-84.3776%2084.3776c-7.7824%207.7824-7.7824%2020.0704%200%2027.8528l84.3776%2084.3776c12.288%2012.288%2033.5872%203.6864%2033.5872-13.9264v-53.6576h175.3088c11.4688%200%2021.7088-6.144%2027.0336-15.9744l52.8384-97.8944c23.7568%205.7344%2049.152%208.6016%2073.728%208.6016s50.3808-2.8672%2073.728-8.6016l52.8384%2097.8944c5.3248%209.8304%2015.5648%2015.9744%2027.0336%2015.9744h175.3088v47.5136c0%2017.6128%2021.2992%2026.2144%2033.5872%2013.9264l84.3776-84.3776c7.7824-7.7824%207.7824-20.0704%200-27.8528l-84.3776-83.5584z%20m-466.944-61.44V399.7696c0.4096-2.4576%200.4096-5.3248%200-8.192%204.9152-9.0112%2040.5504-29.0816%20104.448-29.0816s99.5328%2020.0704%20104.448%2029.0816c-0.4096%202.8672-0.4096%205.3248%200%207.7824v232.2432c-4.096%208.6016-39.7312%2029.4912-104.448%2029.4912s-100.352-20.48-104.448-29.0816z'%20/%3e%3c/svg%3e",$e=X=>(Ae("data-v-ac610543"),X=X(),ke(),X),Je=$e(()=>Et("div",{class:"ef-node-left"},null,-1)),Ze={key:0,src:Te,class:"node-ico"},Ke={key:1,src:Fe,class:"switch-ico"},Qe=["title"],tn={key:0,class:"ef-node-right-ico"},en={class:"b-iconfont b-icon-check-circle"},nn={class:"b-iconfont b-icon-error"},sn={class:"b-iconfont b-icon-warning-circle"},on={class:"b-iconfont b-icon-loading"},ln={__name:"flow-node",props:{node:{type:Object,default:()=>({})},showState:{type:Boolean,default:!0},activeElement:Object},emits:["clickNode","changeNodeSite","nodeRightMenu"],setup(X,{emit:c}){const H=c,Q=X,J=Jt(null),W=Zt(()=>({top:Q.node.top,left:Q.node.left})),r=Zt(()=>Q.activeElement.type==="node"&&Q.activeElement.nodeId===Q.node.id),E=Zt(()=>["ef-node-container",`el-node-${Q.node.type}`,{"ef-node-active":r.value},{"view-only":Q.node.viewOnly}]),a=Zt(()=>{const j={};return j[`b-iconfont b-icon-${Q.node.ico}`]=!0,j});function t(){H("clickNode",Q.node.id)}function p(){const{left:j,top:S}=Q.node,I=J.value.style;if(j===I.left&&S===I.top)return;const s={nodeId:Q.node.id,left:I.left,top:I.top};H("changeNodeSite",s)}function x(j){H("nodeRightMenu",Q.node.id,j)}return(j,S)=>(wt(),At("div",{ref_key:"nodeRef",ref:J,style:Le(W.value),class:me(E.value),onClick:t,onMouseup:p,onContextmenu:S[0]||(S[0]=Me(I=>x(I),["stop","prevent"]))},[Je,Et("div",{class:me(["ef-node-left-ico",{" flow-node-drag":!X.node.viewOnly}])},[X.node.ico?(wt(),At("i",{key:0,class:me(a.value)},null,2)):(wt(),At(ie,{key:1},[X.node.type==="common"?(wt(),At("img",Ze)):se("",!0),X.node.type==="switch"?(wt(),At("img",Ke)):se("",!0)],64))],2),Et("div",{class:"ef-node-text",title:X.node.name},oe(X.node.name),9,Qe),X.showState?(wt(),At("div",tn,[Rt(Et("i",en,null,512),[[Ut,X.node.state==="success"]]),Rt(Et("i",nn,null,512),[[Ut,X.node.state==="error"]]),Rt(Et("i",sn,null,512),[[Ut,X.node.state==="warning"]]),Rt(Et("i",on,null,512),[[Ut,X.node.state==="running"]])])):se("",!0)],38))}},rn=be(ln,[["__scopeId","data-v-ac610543"]]),He=X=>(Ae("data-v-ce640da8"),X=X(),ke(),X),an={class:"flow-menu",ref:"tool"},un={class:"type-box"},cn=He(()=>Et("img",{src:Te,alt:"node",style:{width:"24px",height:"24px"}},null,-1)),hn=[cn],dn=He(()=>Et("img",{src:Fe,alt:"switch",style:{width:"20px",height:"20px"}},null,-1)),fn=[dn],pn={class:"ef-node-menu-ul"},gn=["type","draggable","onDragstart"],mn={class:"ef-node-left-ico"},yn={key:0,src:Te,alt:"node",style:{width:"24px",height:"24px"}},bn={key:1,src:Fe,alt:"switch",style:{width:"20px",height:"20px"}},vn={class:"ef-node-text"},Ie="common",Re="switch",_n={__name:"flow-menu",props:{repeat:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},menuList:{type:Object,default:()=>({common:[{id:"11",type:"common",name:"数据接入",ico:"index",style:{}},{id:"12",type:"common",name:"接口调用",style:{}}],switch:[{id:"13",type:"switch",name:"流程结束",style:{}},{id:"14",type:"switch",name:"数据清理",ico:"clear",style:{}}]})}},setup(X){const c=X,H=Jt(Ie),Q=Zt(()=>c.menuList[H.value]);function J(r){return c.data.nodeList.findIndex(E=>E.id===r)>-1}function W(r,E){r.dataTransfer.setData("node",JSON.stringify(E))}return(r,E)=>{const a=Ot("b-icon");return wt(),At("div",an,[Et("div",un,[Et("div",{class:me(["type-item",{active:H.value===Ie}]),title:"通用节点",onClick:E[0]||(E[0]=t=>H.value=Ie)},hn,2),Et("div",{class:me(["type-item",{active:H.value===Re}]),title:"条件节点",onClick:E[1]||(E[1]=t=>H.value=Re)},fn,2)]),Et("ul",pn,[(wt(!0),At(ie,null,ye(Q.value,t=>(wt(),At("li",{class:me(["ef-node-menu-li",[t.type,{disabled:J(t.id)}]]),key:t.id,type:t.type,draggable:!J(t.id),onDragstart:p=>W(p,t)},[Et("div",mn,[t.ico?(wt(),he(a,{key:0,name:t.ico},null,8,["name"])):(wt(),At(ie,{key:1},[t.type==="common"?(wt(),At("img",yn)):se("",!0),t.type==="switch"?(wt(),At("img",bn)):se("",!0)],64))]),Et("span",vn,oe(t.name),1)],42,gn))),128))])],512)}}},Pn=be(_n,[["__scopeId","data-v-ce640da8"]]),Cn=X=>(Ae("data-v-a7ee15a9"),X=X(),ke(),X),xn={class:"ef-node-form"},En=Cn(()=>Et("div",{class:"ef-node-form-header"},"编辑",-1)),Sn={class:"ef-node-form-body"},Dn={class:"empty"},wn={class:"mr-8"},jn={class:"b-iconfont b-icon-check-circle"},An={class:"b-iconfont b-icon-error"},kn={class:"b-iconfont b-icon-warning-circle"},On={class:"b-iconfont b-icon-loading"},In={__name:"flow-form",props:{showIco:{type:Boolean,default:!0},showState:{type:Boolean,default:!0}},emits:["setLineLabel","saveNode","cancelSelect"],setup(X,{expose:c,emit:H}){const Q=H,J=[{state:"success",label:"成功"},{state:"warning",label:"警告"},{state:"error",label:"错误"},{state:"running",label:"运行中"}],W=Be({type:"node",node:{},line:{},data:{}}),r=Zt(()=>Object.keys(W.node).length===0&&Object.keys(W.line).length===0);function E(j,S){W.type="node",W.data=j,j.nodeList.forEach(I=>{I.id===S&&(W.node=ce(I))})}function a(j,S){W.type="line",W.data=j,W.line=S}function t(){Q("setLineLabel",W.line)}function p(){W.data.nodeList.forEach(j=>{j.id===W.node.id&&(j.name=W.node.name,j.left=W.node.left,j.top=W.node.top,j.ico=W.node.ico,j.state=W.node.state,Q("saveNode",j))})}function x(){W.type="node",W.node={},W.line={},W.data={},Q("cancelSelect")}return c({nodeInit:E,lineInit:a}),(j,S)=>{const I=Ot("b-input"),s=Ot("b-form-item"),l=Ot("b-icon-select"),N=Ot("b-option"),G=Ot("b-select"),U=Ot("b-button"),O=Ot("b-form"),b=Ot("b-ace-editor");return wt(),At("div",xn,[En,Et("div",Sn,[Rt(Et("div",Dn,"暂未选择元素",512),[[Ut,r.value]]),Rt(bt(O,{model:W.node,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(s,{label:"类型"},{default:xt(()=>[bt(I,{modelValue:W.node.type,"onUpdate:modelValue":S[0]||(S[0]=n=>W.node.type=n),disabled:!0},null,8,["modelValue"])]),_:1}),bt(s,{label:"名称"},{default:xt(()=>[bt(I,{modelValue:W.node.name,"onUpdate:modelValue":S[1]||(S[1]=n=>W.node.name=n),clearable:""},null,8,["modelValue"])]),_:1}),bt(s,{label:"left坐标"},{default:xt(()=>[bt(I,{modelValue:W.node.left,"onUpdate:modelValue":S[2]||(S[2]=n=>W.node.left=n),disabled:""},null,8,["modelValue"])]),_:1}),bt(s,{label:"top坐标"},{default:xt(()=>[bt(I,{modelValue:W.node.top,"onUpdate:modelValue":S[3]||(S[3]=n=>W.node.top=n),disabled:""},null,8,["modelValue"])]),_:1}),X.showIco?(wt(),he(s,{key:0,label:"ico图标"},{default:xt(()=>[bt(l,{modelValue:W.node.ico,"onUpdate:modelValue":S[4]||(S[4]=n=>W.node.ico=n)},null,8,["modelValue"])]),_:1})):se("",!0),X.showState?(wt(),he(s,{key:1,label:"状态"},{default:xt(()=>[bt(G,{modelValue:W.node.state,"onUpdate:modelValue":S[5]||(S[5]=n=>W.node.state=n),placeholder:"请选择",clearable:""},{default:xt(()=>[(wt(),At(ie,null,ye(J,n=>bt(N,{key:n.state,label:n.label,value:n.state},{default:xt(()=>[Et("span",wn,[Rt(Et("i",jn,null,512),[[Ut,n.state==="success"]]),Rt(Et("i",An,null,512),[[Ut,n.state==="error"]]),Rt(Et("i",kn,null,512),[[Ut,n.state==="warning"]]),Rt(Et("i",On,null,512),[[Ut,n.state==="running"]])]),Et("span",null,oe(n.label),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})):se("",!0),bt(s,null,{default:xt(()=>[bt(U,{icon:"close",onClick:x},{default:xt(()=>[Nt("取消")]),_:1}),bt(U,{type:"primary",icon:"check",onClick:p},{default:xt(()=>[Nt("保存")]),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,W.type==="node"&&W.node.type]]),Rt(bt(O,{model:W.line,ref:"dataForm","label-width":"80px"},{default:xt(()=>[bt(s,{label:"类型"},{default:xt(()=>[bt(I,{modelValue:W.type,"onUpdate:modelValue":S[6]||(S[6]=n=>W.type=n),disabled:!0},null,8,["modelValue"])]),_:1}),bt(s,{label:"条件"},{default:xt(()=>[bt(I,{modelValue:W.line.label,"onUpdate:modelValue":S[7]||(S[7]=n=>W.line.label=n),clearable:""},null,8,["modelValue"])]),_:1}),bt(s,null,{default:xt(()=>[bt(U,{icon:"close",onClick:x},{default:xt(()=>[Nt("取消")]),_:1}),bt(U,{type:"primary",icon:"check",onClick:t},{default:xt(()=>[Nt("保存")]),_:1})]),_:1})]),_:1},8,["model"]),[[Ut,W.type==="line"]]),bt(b,{"model-value":JSON.stringify(W,null,2),height:"200px"},null,8,["model-value"])])])}}},Mn=be(In,[["__scopeId","data-v-a7ee15a9"]]),Ln={__name:"context-menu",props:{data:{type:Object,default:()=>({})}},emits:["delete"],setup(X,{emit:c}){const H=c,Q=X,J=Zt(()=>Q.data.show),W=Zt(()=>({left:Q.data.left,top:Q.data.top}));function r(){H("delete")}return(E,a)=>{const t=Ot("b-icon");return wt(),he(Ye,{name:"zoom-in-top"},{default:xt(()=>[Rt(Et("ul",{class:"contextmenu",style:Le(W.value)},[Et("li",{onClick:r},[bt(t,{name:"delete"}),Nt(" 删除"+oe(X.data.type==="line"?"线":"节点"),1)])],4),[[Ut,J.value]])]),_:1})}}},Tn=be(Ln,[["__scopeId","data-v-9e4baa69"]]),Fn={__name:"flow-info",props:{data:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(X,{emit:c}){const H=c,Q=X,J=Zt({get:()=>Q.modelValue,set:W=>H("update:modelValue",W)});return(W,r)=>{const E=Ot("b-ace-editor"),a=Ot("b-modal");return wt(),he(a,{modelValue:J.value,"onUpdate:modelValue":r[0]||(r[0]=t=>J.value=t),title:"流程数据信息",width:"680px","destroy-on-close":""},{default:xt(()=>[bt(E,{"model-value":JSON.stringify(X.data,null,2),height:"500px"},null,8,["model-value"])]),_:1},8,["modelValue"])}}},Nn={style:{overflow:"hidden"},flex:""},Gn={style:{width:"30%","border-right":"1px solid #f0f0f0"}},Rn={class:"scroll-box"},Bn=["id"],Un={class:"title"},Hn={__name:"helper",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(X,{emit:c}){const H=c,Q=X,J=Jt("add"),W=[{id:"add",icon:"plus-circle",title:"如何新增",message:["按住鼠标拖拽左侧组件到中间画布中松开鼠标即可"]},{id:"delete",icon:"delete",title:"如何删除",message:["1、鼠标点中需要删除的节点或连线，点击左上角的删除图标","2、鼠标右键需要删除的节点或连线，选择删除节点或删除线"]},{id:"move",icon:"drag",title:"如何移动",message:["鼠标移动到节点中，当鼠标变为可拖拽的图标时按下鼠标移动到新的位置松开鼠标"]},{id:"line",icon:"index",title:"如何连线",message:["鼠标移动到节点中左侧的图标上，当鼠标变为 + 时按下鼠标移动到另一个节点中松开鼠标"]},{id:"condition",icon:"sisternode",title:"如何添加条件",message:["点击画布中的连线，在页面右侧会出现一个表单，输入新的条件，点击【保存】"]}],r=Zt({get:()=>Q.modelValue,set:E=>H("update:modelValue",E)});return Ue(()=>r.value,E=>{E&&(J.value="add")}),(E,a)=>{const t=Ot("b-icon"),p=Ot("b-menu-item"),x=Ot("b-menu"),j=Ot("b-divider"),S=Ot("b-modal");return wt(),he(S,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=I=>r.value=I),title:"帮助",width:"680px","body-styles":{padding:0}},{default:xt(()=>[Et("div",Nn,[Et("div",Gn,[bt(x,{"default-active":J.value,onSelect:a[0]||(a[0]=I=>J.value=I)},{default:xt(()=>[(wt(),At(ie,null,ye(W,I=>bt(p,{key:I.id,index:I.id},{title:xt(()=>[Nt(oe(I.title),1)]),default:xt(()=>[bt(t,{name:I.icon},null,8,["name"])]),_:2},1032,["index"])),64))]),_:1},8,["default-active"])]),Et("div",Rn,[(wt(),At(ie,null,ye(W,I=>Rt(Et("div",{key:I.id,class:"scroll-page",id:I.id},[Et("div",Un,[bt(j,{align:"left",style:{margin:"0"}},{default:xt(()=>[Nt(oe(I.title),1)]),_:2},1024)]),(wt(!0),At(ie,null,ye(I.message,(s,l)=>(wt(),At("p",{key:l},oe(s),1))),128))],8,Bn),[[Ut,I.id===J.value]])),64))])])]),_:1},8,["modelValue"])}}},Vn=be(Hn,[["__scopeId","data-v-2b6f178d"]]);(function(){typeof Math.sgn>"u"&&(Math.sgn=function(g){return g==0?0:g>0?1:-1});let X={subtract:function(g,u){return{x:g.x-u.x,y:g.y-u.y}},dotProduct:function(g,u){return g.x*u.x+g.y*u.y},square:function(g){return Math.sqrt(g.x*g.x+g.y*g.y)},scale:function(g,u){return{x:g.x*u,y:g.y*u}}},c=64,H=Math.pow(2,-c-1),Q=function(g,u){let m=[],A=W(g,u),F=u.length-1,i=2*F-1,e=r(A,i,m,0),d=X.subtract(g,u[0]),C=X.square(d),w=0;for(let z=0;z<e;z++){d=X.subtract(g,p(u,F,m[z],null,null));var B=X.square(d);B<C&&(C=B,w=m[z])}return d=X.subtract(g,u[F]),B=X.square(d),B<C&&(C=B,w=1),{location:w,distance:C}},J=function(g,u){let m=Q(g,u);return{point:p(u,u.length-1,m.location,null,null),location:m.location}};var W=function(g,u){let m=u.length-1,A=2*m-1,F=[],i=[],e=[],d=[],C=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];for(var w=0;w<=m;w++)F[w]=X.subtract(u[w],g);for(var w=0;w<=m-1;w++)i[w]=X.subtract(u[w+1],u[w]),i[w]=X.scale(i[w],3);for(let Y=0;Y<=m-1;Y++)for(let V=0;V<=m;V++)e[Y]||(e[Y]=[]),e[Y][V]=X.dotProduct(i[Y],F[V]);for(w=0;w<=A;w++)d[w]||(d[w]=[]),d[w].y=0,d[w].x=parseFloat(w)/A;let B=m,z=m-1;for(let Y=0;Y<=B+z;Y++){let V=Math.max(0,Y-z),ot=Math.min(Y,B);for(w=V;w<=ot;w++){let ct=Y-w;d[w+ct].y+=e[ct][w]*C[ct][w]}}return d},r=function(g,u,m,A){let F=[],i=[],e,d,C=[],w=[];switch(E(g,u)){case 0:return 0;case 1:{if(A>=c)return m[0]=(g[0].x+g[u].x)/2,1;if(a(g,u))return m[0]=t(g,u),1;break}}p(g,u,.5,F,i),e=r(F,u,C,A+1),d=r(i,u,w,A+1);for(var B=0;B<e;B++)m[B]=C[B];for(var B=0;B<d;B++)m[B+e]=w[B];return e+d},E=function(g,u){let m=0,A,F;A=F=Math.sgn(g[0].y);for(let i=1;i<=u;i++)A=Math.sgn(g[i].y),A!=F&&m++,F=A;return m},a=function(g,u){let m,A,F,i,e,d,C,w,B,z,Y,V,ot,ct,pt,$;d=g[0].y-g[u].y,C=g[u].x-g[0].x,w=g[0].x*g[u].y-g[u].x*g[0].y;let rt,ft;rt=ft=0;for(let ut=1;ut<u;ut++){let ht=d*g[ut].x+C*g[ut].y+w;ht>rt?rt=ht:ht<ft&&(ft=ht)}return Y=0,V=1,ot=0,ct=d,pt=C,$=w-rt,B=Y*pt-ct*V,z=1/B,A=(V*$-pt*ot)*z,ct=d,pt=C,$=w-ft,B=Y*pt-ct*V,z=1/B,F=(V*$-pt*ot)*z,i=Math.min(A,F),e=Math.max(A,F),m=e-i,m<H?1:0},t=function(g,u){let m=1,A=0,F=g[u].x-g[0].x,i=g[u].y-g[0].y,e=g[0].x-0,d=g[0].y-0,C=F*A-i*m,w=1/C,B=(F*d-i*e)*w;return 0+m*B},p=function(g,u,m,A,F){let i=[[]];for(var e=0;e<=u;e++)i[0][e]=g[e];for(let d=1;d<=u;d++)for(var e=0;e<=u-d;e++)i[d]||(i[d]=[]),i[d][e]||(i[d][e]={}),i[d][e].x=(1-m)*i[d-1][e].x+m*i[d-1][e+1].x,i[d][e].y=(1-m)*i[d-1][e].y+m*i[d-1][e+1].y;if(A!=null)for(e=0;e<=u;e++)A[e]=i[e][0];if(F!=null)for(e=0;e<=u;e++)F[e]=i[u-e][e];return i[u][0]};let x={},j=function(g){let u=x[g];if(!u){u=[];let A=function(){return function(w){return Math.pow(w,g)}},F=function(){return function(w){return Math.pow(1-w,g)}},i=function(w){return function(B){return w}},e=function(){return function(w){return w}},d=function(){return function(w){return 1-w}},C=function(w){return function(B){let z=1;for(let Y=0;Y<w.length;Y++)z=z*w[Y](B);return z}};u.push(new A);for(let w=1;w<g;w++){let B=[new i(g)];for(var m=0;m<g-w;m++)B.push(new e);for(var m=0;m<w;m++)B.push(new d);u.push(new C(B))}u.push(new F),x[g]=u}return u},S=function(g,u){let m=j(g.length-1),A=0,F=0;for(let i=0;i<g.length;i++)A=A+g[i].x*m[i](u),F=F+g[i].y*m[i](u);return{x:A,y:F}},I=function(g,u){return Math.sqrt(Math.pow(g.x-u.x,2)+Math.pow(g.y-u.y,2))},s=function(g){return g[0].x===g[1].x&&g[0].y===g[1].y},l=function(g,u,m){if(s(g))return{point:g[0],location:u};let A=S(g,u),F=0,i=u,e=m>0?1:-1,d=null;for(;F<Math.abs(m);)i+=.005*e,d=S(g,i),F+=I(d,A),A=d;return{point:d,location:i}},N=function(g){if(s(g))return 0;let u=S(g,0),m=0,A=0,F=1,i=null;for(;A<1;)A+=.005*F,i=S(g,A),m+=I(i,u),u=i;return m},G=function(g,u,m){return l(g,u,m).point},U=function(g,u,m){return l(g,u,m).location},O=function(g,u){let m=S(g,u),A=S(g.slice(0,g.length-1),u),F=A.y-m.y,i=A.x-m.x;return F===0?1/0:Math.atan(F/i)},b=function(g,u,m){let A=l(g,u,m);return A.location>1&&(A.location=1),A.location<0&&(A.location=0),O(g,A.location)},n=function(g,u,m,A){A=A??0;let F=l(g,u,A),i=O(g,F.location),e=Math.atan(-1/i),d=m/2*Math.sin(e),C=m/2*Math.cos(e);return[{x:F.point.x+C,y:F.point.y+d},{x:F.point.x-C,y:F.point.y-d}]},y=function(g,u,m,A,F){let i=A-u,e=g-m,d=g*(u-A)+u*(m-g),C=f(F),w=[i*C[0][0]+e*C[1][0],i*C[0][1]+e*C[1][1],i*C[0][2]+e*C[1][2],i*C[0][3]+e*C[1][3]+d],B=_.apply(null,w),z=[];if(B!=null)for(let V=0;V<3;V++){let ot=B[V],ct=Math.pow(ot,2),pt=Math.pow(ot,3),$=[C[0][0]*pt+C[0][1]*ct+C[0][2]*ot+C[0][3],C[1][0]*pt+C[1][1]*ct+C[1][2]*ot+C[1][3]];var Y;m-g!==0?Y=($[0]-g)/(m-g):Y=($[1]-u)/(A-u),ot>=0&&ot<=1&&Y>=0&&Y<=1&&z.push($)}return z},h=function(g,u,m,A,F){let i=[];return i.push.apply(i,y(g,u,g+m,u,F)),i.push.apply(i,y(g+m,u,g+m,u+A,F)),i.push.apply(i,y(g+m,u+A,g,u+A,F)),i.push.apply(i,y(g,u+A,g,u,F)),i},D=function(g,u){let m=[];return m.push.apply(m,y(g.x,g.y,g.x+g.w,g.y,u)),m.push.apply(m,y(g.x+g.w,g.y,g.x+g.w,g.y+g.h,u)),m.push.apply(m,y(g.x+g.w,g.y+g.h,g.x,g.y+g.h,u)),m.push.apply(m,y(g.x,g.y+g.h,g.x,g.y,u)),m};function M(g,u){return[-g[0][u]+3*g[1][u]+-3*g[2][u]+g[3][u],3*g[0][u]-6*g[1][u]+3*g[2][u],-3*g[0][u]+3*g[1][u],g[0][u]]}function f(g){return[M(g,"x"),M(g,"y")]}function v(g){return g<0?-1:g>0?1:0}function _(g,u,m,A){let F=u/g,i=m/g,e=A/g,d=(3*i-Math.pow(F,2))/9,C=(9*F*i-27*e-2*Math.pow(F,3))/54,w=Math.pow(d,3)+Math.pow(C,2),B,z,Y=[];if(w>=0)B=v(C+Math.sqrt(w))*Math.pow(Math.abs(C+Math.sqrt(w)),1/3),z=v(C-Math.sqrt(w))*Math.pow(Math.abs(C-Math.sqrt(w)),1/3),Y[0]=-F/3+(B+z),Y[1]=-F/3-(B+z)/2,Y[2]=-F/3-(B+z)/2,Math.abs(Math.sqrt(3)*(B-z)/2)!==0&&(Y[1]=-1,Y[2]=-1);else{let V=Math.acos(C/Math.sqrt(-Math.pow(d,3)));Y[0]=2*Math.sqrt(-d)*Math.cos(V/3)-F/3,Y[1]=2*Math.sqrt(-d)*Math.cos((V+2*Math.PI)/3)-F/3,Y[2]=2*Math.sqrt(-d)*Math.cos((V+4*Math.PI)/3)-F/3}for(let V=0;V<3;V++)(Y[V]<0||Y[V]>1)&&(Y[V]=-1);return Y}let L=this.jsBezier={distanceFromCurve:Q,gradientAtPoint:O,gradientAtPointAlongCurveFrom:b,nearestPointOnCurve:J,pointOnCurve:S,pointAlongCurveFrom:G,perpendicularToCurveAt:n,locationAlongCurveFrom:U,getLength:N,lineIntersection:y,boxIntersection:h,boundingBoxIntersection:D,version:"0.9.0"};typeof exports<"u"&&(exports.jsBezier=L)}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.Biltong={version:"0.4.0"};typeof exports<"u"&&(exports.Biltong=c);let H=function(a){return Object.prototype.toString.call(a)==="[object Array]"},Q=function(a,t,p){return a=H(a)?a:[a.x,a.y],t=H(t)?t:[t.x,t.y],p(a,t)},J=c.gradient=function(a,t){return Q(a,t,function(p,x){return x[0]==p[0]?x[1]>p[1]?1/0:-1/0:x[1]==p[1]?x[0]>p[0]?0:-0:(x[1]-p[1])/(x[0]-p[0])})};c.normal=function(a,t){return-1/J(a,t)},c.lineLength=function(a,t){return Q(a,t,function(p,x){return Math.sqrt(Math.pow(x[1]-p[1],2)+Math.pow(x[0]-p[0],2))})};let W=c.quadrant=function(a,t){return Q(a,t,function(p,x){return x[0]>p[0]||x[0]==p[0]?x[1]>p[1]?2:1:x[1]>p[1]?3:4})};c.theta=function(a,t){return Q(a,t,function(p,x){let j=J(p,x),S=Math.atan(j),I=W(p,x);return(I==4||I==3)&&(S+=Math.PI),S<0&&(S+=2*Math.PI),S})},c.intersects=function(a,t){let p=a.x,x=a.x+a.w,j=a.y,S=a.y+a.h,I=t.x,s=t.x+t.w,l=t.y,N=t.y+t.h;return p<=I&&I<=x&&j<=l&&l<=S||p<=s&&s<=x&&j<=l&&l<=S||p<=I&&I<=x&&j<=N&&N<=S||p<=s&&I<=x&&j<=N&&N<=S||I<=p&&p<=s&&l<=j&&j<=N||I<=x&&x<=s&&l<=j&&j<=N||I<=p&&p<=s&&l<=S&&S<=N||I<=x&&p<=s&&l<=S&&S<=N},c.encloses=function(a,t,p){let x=a.x,j=a.x+a.w,S=a.y,I=a.y+a.h,s=t.x,l=t.x+t.w,N=t.y,G=t.y+t.h,U=function(O,b,n,y){return p?O<=b&&n>=y:O<b&&n>y};return U(x,s,j,l)&&U(S,N,I,G)};let r=[null,[1,-1],[1,1],[-1,1],[-1,-1]],E=[null,[-1,-1],[-1,1],[1,1],[1,-1]];c.pointOnLine=function(a,t,p){let x=J(a,t),j=W(a,t),S=p>0?r[j]:E[j],I=Math.atan(x),s=Math.abs(p*Math.sin(I))*S[1],l=Math.abs(p*Math.cos(I))*S[0];return{x:a.x+l,y:a.y+s}},c.perpendicularLineTo=function(a,t,p){let x=J(a,t),j=Math.atan(-1/x),S=p/2*Math.sin(j),I=p/2*Math.cos(j);return[{x:t.x+I,y:t.y+S},{x:t.x-I,y:t.y-S}]}}).call(typeof window<"u"?window:void 0);(function(){function X(i,e,d,C,w,B,z,Y){return new Touch({target:e,identifier:F(),pageX:d,pageY:C,screenX:w,screenY:B,clientX:z||w,clientY:Y||B})}function c(){let i=[];return Array.prototype.push.apply(i,arguments),i.item=function(e){return this[e]},i}function H(i,e,d,C,w,B,z,Y){return c(X.apply(null,arguments))}var Q=this,J=function(i,e,d){d=d||i.parentNode;let C=d.querySelectorAll(e);for(let w=0;w<C.length;w++)if(C[w]===i)return!0;return!1},W=function(i){return typeof i=="string"||i.constructor===String?document.getElementById(i):i},r=function(i){return i.srcElement||i.target},E=function(i,e,d,C){if(C){if(typeof i.path<"u"&&i.path.indexOf)return{path:i.path,end:i.path.indexOf(d)};{let w={path:[],end:-1},B=function(z){w.path.push(z),z===d?w.end=w.path.length-1:z.parentNode!=null&&B(z.parentNode)};return B(e),w}}else return{path:[e],end:1}},a=function(i,e){for(var d=0,C=i.length;d<C&&i[d]!=e;d++);d<i.length&&i.splice(d,1)},t=1,p=function(i,e,d){let C=t++;return i.__ta=i.__ta||{},i.__ta[e]=i.__ta[e]||{},i.__ta[e][C]=d,d.__tauid=C,C},x=function(i,e,d){if(i.__ta&&i.__ta[e]&&delete i.__ta[e][d.__tauid],d.__taExtra){for(let C=0;C<d.__taExtra.length;C++)m(i,d.__taExtra[C][0],d.__taExtra[C][1]);d.__taExtra.length=0}d.__taUnstore&&d.__taUnstore()},j=function(i,e,d,C){if(i==null)return d;{let w=i.split(","),B=function(z){B.__tauid=d.__tauid;let Y=r(z),V=Y,ot=E(z,Y,e,i!=null);if(ot.end!=-1)for(let ct=0;ct<ot.end;ct++){V=ot.path[ct];for(let pt=0;pt<w.length;pt++)J(V,w[pt],e)&&d.apply(V,arguments)}};return S(d,C,B),B}},S=function(i,e,d){i.__taExtra=i.__taExtra||[],i.__taExtra.push([e,d])},I=function(i,e,d,C){if(O&&n[e]){let w=j(C,i,d,n[e]);u(i,n[e],w,d)}e==="focus"&&i.getAttribute("tabindex")==null&&i.setAttribute("tabindex","1"),u(i,e,j(C,i,d,e),d)},s=function(i,e,d,C){if(i.__taSmartClicks==null){let w=function(Y){i.__tad=M(Y)},B=function(Y){i.__tau=M(Y)},z=function(Y){if(i.__tad&&i.__tau&&i.__tad[0]===i.__tau[0]&&i.__tad[1]===i.__tau[1])for(let V=0;V<i.__taSmartClicks.length;V++)i.__taSmartClicks[V].apply(r(Y),[Y])};I(i,"mousedown",w,C),I(i,"mouseup",B,C),I(i,"click",z,C),i.__taSmartClicks=[]}i.__taSmartClicks.push(d),d.__taUnstore=function(){a(i.__taSmartClicks,d)}},l={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},N=function(i,e){return function(d,C,w,B){if(C=="contextmenu"&&b)I(d,C,w,B);else{if(d.__taTapHandler==null){let ct=d.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]};var z=function(pt){let $=r(pt),rt=E(pt,$,d,B!=null),ft=!1;for(let ut=0;ut<rt.end;ut++){if(ft)return;$=rt.path[ut];for(let ht=0;ht<ct.downSelectors.length;ht++)if(ct.downSelectors[ht]==null||J($,ct.downSelectors[ht],d)){ct.down=!0,setTimeout(V,i),setTimeout(ot,e),ft=!0;break}}},Y=function(pt){if(ct.down){let $=r(pt),rt,ft;ct.taps++;let ut=g(pt);for(let ht in l)if(l.hasOwnProperty(ht)){let Ct=l[ht];if(Ct.touches===ut&&(Ct.taps===1||Ct.taps===ct.taps))for(let mt=0;mt<ct[ht].length;mt++){ft=E(pt,$,d,ct[ht][mt][1]!=null);for(let K=0;K<ft.end;K++)if(rt=ft.path[K],ct[ht][mt][1]==null||J(rt,ct[ht][mt][1],d)){ct[ht][mt][0].apply(rt,[pt]);break}}}}},V=function(){ct.down=!1},ot=function(){ct.taps=0};I(d,"mousedown",z),I(d,"mouseup",Y)}d.__taTapHandler.downSelectors.push(B),d.__taTapHandler[C].push([w,B]),w.__taUnstore=function(){a(d.__taTapHandler[C],w)}}}},G=function(i,e,d,C){for(let w in d.__tamee[i])d.__tamee[i].hasOwnProperty(w)&&d.__tamee[i][w].apply(C,[e])},U=function(){let i=[];return function(e,d,C,w){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};let B=function(Y){let V=r(Y);(w==null&&V==e&&!e.__tamee.over||J(V,w,e)&&(V.__tamee==null||!V.__tamee.over))&&(G("mouseenter",Y,e,V),V.__tamee=V.__tamee||{},V.__tamee.over=!0,i.push(V))},z=function(Y){let V=r(Y);for(let ot=0;ot<i.length;ot++)V==i[ot]&&!J(Y.relatedTarget||Y.toElement,"*",V)&&(V.__tamee.over=!1,i.splice(ot,1),G("mouseexit",Y,e,V))};u(e,"mouseover",j(w,e,B,"mouseover"),B),u(e,"mouseout",j(w,e,z,"mouseout"),z)}C.__taUnstore=function(){delete e.__tamee[d][C.__tauid]},p(e,d,C),e.__tamee[d][C.__tauid]=C}},O="ontouchstart"in document.documentElement,b="onmousedown"in document.documentElement,n={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},y=function(){let i=-1;if(navigator.appName=="Microsoft Internet Explorer"){let e=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),h=y>-1&&y<9,D=function(i,e){if(i==null)return[0,0];let d=L(i),C=_(d,0);return[C[e+"X"],C[e+"Y"]]},M=function(i){return i==null?[0,0]:h?[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop]:D(i,"page")},f=function(i){return D(i,"screen")},v=function(i){return D(i,"client")},_=function(i,e){return i.item?i.item(e):i[e]},L=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},g=function(i){return L(i).length},u=function(i,e,d,C){if(p(i,e,d),C.__tauid=d.__tauid,i.addEventListener)i.addEventListener(e,d,!1);else if(i.attachEvent){let w=e+d.__tauid;i["e"+w]=d,i[w]=function(){i["e"+w]&&i["e"+w](window.event)},i.attachEvent("on"+e,i[w])}},m=function(i,e,d){d!=null&&A(i,function(){let C=W(this);if(x(C,e,d),d.__tauid!=null){if(C.removeEventListener)C.removeEventListener(e,d,!1),O&&n[e]&&C.removeEventListener(n[e],d,!1);else if(this.detachEvent){let w=e+d.__tauid;C[w]&&C.detachEvent("on"+e,C[w]),C[w]=null,C["e"+w]=null}}d.__taTouchProxy&&m(i,d.__taTouchProxy[1],d.__taTouchProxy[0])})},A=function(i,e){if(i!=null){i=typeof Window<"u"&&typeof i.top!="unknown"&&i==i.top?[i]:typeof i!="string"&&i.tagName==null&&i.length!=null?i:typeof i=="string"?document.querySelectorAll(i):[i];for(let d=0;d<i.length;d++)e.apply(i[d])}},F=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})};Q.Mottle=function(i){i=i||{};let e=i.clickThreshold||250,d=i.dblClickThreshold||450,C=new U,w=new N(e,d),B=i.smartClicks,z=function(Y,V,ot,ct){ot!=null&&A(Y,function(){let pt=W(this);B&&V==="click"?s(pt,V,ot,ct):V==="tap"||V==="dbltap"||V==="contextmenu"?w(pt,V,ot,ct):V==="mouseenter"||V=="mouseexit"?C(pt,V,ot,ct):I(pt,V,ot,ct)})};this.remove=function(Y){return A(Y,function(){let V=W(this);if(V.__ta){for(let ot in V.__ta)if(V.__ta.hasOwnProperty(ot))for(let ct in V.__ta[ot])V.__ta[ot].hasOwnProperty(ct)&&m(V,ot,V.__ta[ot][ct])}V.parentNode&&V.parentNode.removeChild(V)}),this},this.on=function(Y,V,ot,ct){let pt=arguments[0],$=arguments.length==4?arguments[2]:null,rt=arguments[1],ft=arguments[arguments.length-1];return z(pt,rt,ft,$),this},this.off=function(Y,V,ot){return m(Y,V,ot),this},this.trigger=function(Y,V,ot,ct){let pt=b&&(typeof MouseEvent>"u"||ot==null||ot.constructor===MouseEvent),$=O&&!b&&n[V]?n[V]:V,rt=!(O&&!b&&n[V]),ft=M(ot),ut=f(ot),ht=v(ot);return A(Y,function(){let Ct=W(this),mt;ot=ot||{screenX:ut[0],screenY:ut[1],clientX:ht[0],clientY:ht[1]};let K=function(et){ct&&(et.payload=ct)},tt={TouchEvent:function(et){let lt=H(window,Ct,0,ft[0],ft[1],ut[0],ut[1],ht[0],ht[1]);(et.initTouchEvent||et.initEvent)($,!0,!0,window,null,ut[0],ut[1],ht[0],ht[1],!1,!1,!1,!1,lt,lt,lt,1,0)},MouseEvents:function(et){et.initMouseEvent($,!0,!0,window,0,ut[0],ut[1],ht[0],ht[1],!1,!1,!1,!1,1,Ct)}};if(document.createEvent){let et=!rt&&!pt&&O&&n[V],lt=et?"TouchEvent":"MouseEvents";mt=document.createEvent(lt),tt[lt](mt),K(mt),Ct.dispatchEvent(mt)}else document.createEventObject&&(mt=document.createEventObject(),mt.eventType=mt.eventName=$,mt.screenX=ut[0],mt.screenY=ut[1],mt.clientX=ht[0],mt.clientY=ht[1],K(mt),Ct.fireEvent("on"+$,mt))}),this}},Q.Mottle.consume=function(i,e){i.stopPropagation?i.stopPropagation():i.returnValue=!1,!e&&i.preventDefault&&i.preventDefault()},Q.Mottle.pageLocation=M,Q.Mottle.setForceTouchEvents=function(i){O=i},Q.Mottle.setForceMouseEvents=function(i){b=i},Q.Mottle.version="0.8.0",typeof exports<"u"&&(exports.Mottle=Q.Mottle)}).call(typeof window>"u"?void 0:window);(function(){let X=this,c=function(i,e,d){return i.indexOf(e)===-1?(i.push(e),!0):!1},H=function(i,e){let d=i.indexOf(e);d!==-1&&i.splice(d,1)},Q=function(i,e){let d=[];for(let C=0;C<i.length;C++)e.indexOf(i[C])===-1&&d.push(i[C]);return d},J=function(i){return i==null?!1:typeof i=="string"||i.constructor===String},W=function(i){let e=i.getBoundingClientRect(),d=document.body,C=document.documentElement,w=window.pageYOffset||C.scrollTop||d.scrollTop,B=window.pageXOffset||C.scrollLeft||d.scrollLeft,z=C.clientTop||d.clientTop||0,Y=C.clientLeft||d.clientLeft||0,V=e.top+w-z,ot=e.left+B-Y;return{top:Math.round(V),left:Math.round(ot)}},r=function(i,e,d){d=d||i.parentNode;let C=d.querySelectorAll(e);for(let w=0;w<C.length;w++)if(C[w]===i)return!0;return!1},E=function(i,e,d){if(r(e,d,i))return e;{let C=e.parentNode;for(;C!=null&&C!==i;){if(r(C,d,i))return C;C=C.parentNode}}},a=function(i,e,d){let C=null,w=e.getAttribute("katavorio-draggable"),B=w!=null?"[katavorio-draggable='"+w+"'] ":"";for(let z=0;z<i.length;z++)if(C=E(e,d,B+i[z].selector),C!=null){if(i[z].filter){let Y=r(d,i[z].filter,C);if(i[z].filterExclude===!0&&!Y||Y)return null}return[i[z],C]}return null};var t=function(){let i=-1;if(navigator.appName==="Microsoft Internet Explorer"){let e=navigator.userAgent;new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)!=null&&(i=parseFloat(RegExp.$1))}return i}(),p=10,x=10,j=t>-1&&t<9,S=t===9,I=function(i){if(j)return[i.clientX+document.documentElement.scrollLeft,i.clientY+document.documentElement.scrollTop];{let e=l(i),d=s(e,0);return S?[d.pageX||d.clientX,d.pageY||d.clientY]:[d.pageX,d.pageY]}},s=function(i,e){return i.item?i.item(e):i[e]},l=function(i){return i.touches&&i.touches.length>0?i.touches:i.changedTouches&&i.changedTouches.length>0?i.changedTouches:i.targetTouches&&i.targetTouches.length>0?i.targetTouches:[i]},N={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},G="katavorio-drag-scope",U=["stop","start","drag","drop","over","out","beforeStart"],O=function(){},b=function(){return!0},n=function(i,e,d){for(let C=0;C<i.length;C++)i[C]!=d&&e(i[C])},y=function(i,e,d,C){n(i,function(w){w.setActive(e),e&&w.updatePosition(),d&&w.setHover(C,e)})},h=function(i,e){if(i!=null){i=!J(i)&&i.tagName==null&&i.length!=null?i:[i];for(let d=0;d<i.length;d++)e.apply(i[d],[i[d]])}},D=function(i){i.stopPropagation?(i.stopPropagation(),i.preventDefault()):i.returnValue=!1},M="input,textarea,select,button,option",f=function(i,e,d){let C=i.srcElement||i.target;return!r(C,d.getInputFilterSelector(),e)};let v=function(i,e,d,C){this.params=e||{},this.el=i,this.params.addClass(this.el,this._class),this.uuid=m();let w=!0;return this.setEnabled=function(B){w=B},this.isEnabled=function(){return w},this.toggleEnabled=function(){w=!w},this.setScope=function(B){this.scopes=B?B.split(/\s+/):[C]},this.addScope=function(B){let z={};h(this.scopes,function(Y){z[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){z[Y]=!0}),this.scopes=[];for(let Y in z)this.scopes.push(Y)},this.removeScope=function(B){let z={};h(this.scopes,function(Y){z[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){delete z[Y]}),this.scopes=[];for(let Y in z)this.scopes.push(Y)},this.toggleScope=function(B){let z={};h(this.scopes,function(Y){z[Y]=!0}),h(B?B.split(/\s+/):[],function(Y){z[Y]?delete z[Y]:z[Y]=!0}),this.scopes=[];for(let Y in z)this.scopes.push(Y)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},_=function(){return!0},L=function(){return!1},g=function(i,e,d,C){this._class=d.draggable;let w=v.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;let B=[0,0],z=null,Y=null,V=[0,0],ot=!1,ct=[0,0],pt=this.params.consumeStartEvent!==!1,$=this.el,rt=this.params.clone;this.params.scroll;let ft=e.multipleDrop!==!1,ut=!1,ht=e.ghostProxy===!0?_:e.ghostProxy&&typeof e.ghostProxy=="function"?e.ghostProxy:L,Ct=function(it){return it.cloneNode(!0)},mt=null,K=[],tt=null,et=e.ghostProxyParent,lt,yt,Dt,Mt;if(e.selector){let it=i.getAttribute("katavorio-draggable");it==null&&(it=""+new Date().getTime(),i.setAttribute("katavorio-draggable",it)),K.push(e)}let Bt=e.snapThreshold,le=function(it,vt,Pt,gt,St){let kt=Math.floor(it[0]/vt),Xt=vt*kt,$t=Xt+vt,o=Math.abs(it[0]-Xt)<=gt?Xt:Math.abs($t-it[0])<=gt?$t:it[0],k=Math.floor(it[1]/Pt),P=Pt*k,T=P+Pt,R=Math.abs(it[1]-P)<=St?P:Math.abs(T-it[1])<=St?T:it[1];return[o,R]};this.posses=[],this.posseRoles={},this.toGrid=function(it){if(this.params.grid==null)return it;{let vt=this.params.grid?this.params.grid[0]/2:Bt||p/2,Pt=this.params.grid?this.params.grid[1]/2:Bt||x/2;return le(it,this.params.grid[0],this.params.grid[1],vt,Pt)}},this.snap=function(it,vt){if($==null)return;it=it||(this.params.grid?this.params.grid[0]:p),vt=vt||(this.params.grid?this.params.grid[1]:x);let Pt=this.params.getPosition($),gt=this.params.grid?this.params.grid[0]/2:Bt,St=this.params.grid?this.params.grid[1]/2:Bt,kt=le(Pt,it,vt,gt,St);return this.params.setPosition($,kt),kt},this.setUseGhostProxy=function(it){ht=it?_:L};let zt,qt=function(it){return e.allowNegative===!1?[Math.max(0,it[0]),Math.max(0,it[1])]:it},Pe=(function(it){zt=typeof it=="function"?it:it?(function(vt,Pt,gt,St){return qt([Math.max(0,Math.min(gt.w-St[0],vt[0])),Math.max(0,Math.min(gt.h-St[1],vt[1]))])}).bind(this):function(vt){return qt(vt)}}).bind(this);Pe(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(it){Pe(it)};let de;this.setRevert=function(it){de=it},this.params.revert&&(de=this.params.revert);let Ce=function(it){return typeof it=="function"?(it._katavorioId=m(),it._katavorioId):it},Ht={},fe=function(it){for(let vt in Ht){let Pt=Ht[vt],gt=Pt[0](it);if(Pt[1]&&(gt=!gt),!gt)return!1}return!0},re=this.setFilter=function(it,vt){if(it){let Pt=Ce(it);Ht[Pt]=[function(gt){let St=gt.srcElement||gt.target,kt;return J(it)?kt=r(St,it,i):typeof it=="function"&&(kt=it(gt,i)),kt},vt!==!1]}};this.addFilter=re,this.removeFilter=function(it){let vt=typeof it=="function"?it._katavorioId:it;delete Ht[vt]},this.clearAllFilters=function(){Ht={}},this.canDrag=this.params.canDrag||b;let ae,Lt=[],Yt=[];this.addSelector=function(it){it.selector&&K.push(it)},this.downListener=(function(it){if(it.defaultPrevented)return;if((this.rightButtonCanDrag||it.which!==3&&it.button!==2)&&this.isEnabled()&&this.canDrag())if(fe(it)&&f(it,this.el,this.k)){if(tt=null,mt=null,K.length>0){let gt=a(K,this.el,it.target||it.srcElement);if(gt!=null&&(tt=gt[0],mt=gt[1]),mt==null)return}else mt=this.el;if(rt)if($=mt.cloneNode(!0),this.params.addClass($,N.clonedDrag),$.setAttribute("id",null),$.style.position="absolute",this.params.parent!=null){let gt=this.params.getPosition(this.el);$.style.left=gt[0]+"px",$.style.top=gt[1]+"px",this.params.parent.appendChild($)}else{let gt=W(mt);$.style.left=gt.left+"px",$.style.top=gt.top+"px",document.body.appendChild($)}else $=mt;pt&&D(it),B=I(it),$&&$.parentNode&&(ct=[$.parentNode.scrollLeft,$.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),w.markSelection(this),w.markPosses(this),this.params.addClass(document.body,d.noSelect),te("beforeStart",{el:this.el,pos:z,e:it,drag:this})}else this.params.consumeFilteredEvents&&D(it)}).bind(this),this.moveListener=(function(it){if(B){if(!ot)if(te("start",{el:this.el,pos:z,e:it,drag:this})!==!1){if(!B)return;this.mark(!0),ot=!0}else this.abort();if(B){Yt.length=0;let vt=I(it),Pt=vt[0]-B[0],gt=vt[1]-B[1],St=this.params.ignoreZoom?1:w.getZoom();$&&$.parentNode&&(Pt+=$.parentNode.scrollLeft-ct[0],gt+=$.parentNode.scrollTop-ct[1]),Pt/=St,gt/=St,this.moveBy(Pt,gt,it),w.updateSelection(Pt,gt,this),w.updatePosses(Pt,gt,this)}}}).bind(this),this.upListener=(function(it){B&&(B=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,d.noSelect),this.unmark(it),w.unmarkSelection(this,it),w.unmarkPosses(this,it),this.stop(it),w.notifyPosseDragStop(this,it),ot=!1,Yt.length=0,rt?($&&$.parentNode&&$.parentNode.removeChild($),$=null):de&&de($,this.params.getPosition($))===!0&&(this.params.setPosition($,z),te("revert",$)))}).bind(this),this.getFilters=function(){return Ht},this.abort=function(){B!=null&&this.upListener()},this.getDragElement=function(it){return it?mt||this.el:$||this.el};let It={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};e.events.start&&It.start.push(e.events.start),e.events.beforeStart&&It.beforeStart.push(e.events.beforeStart),e.events.stop&&It.stop.push(e.events.stop),e.events.drag&&It.drag.push(e.events.drag),e.events.revert&&It.revert.push(e.events.revert),this.on=function(it,vt){It[it]&&It[it].push(vt)},this.off=function(it,vt){if(It[it]){let Pt=[];for(let gt=0;gt<It[it].length;gt++)It[it][gt]!==vt&&Pt.push(It[it][gt]);It[it]=Pt}};var te=function(it,vt){let Pt=null;if(tt&&tt[it])Pt=tt[it](vt);else if(It[it])for(let gt=0;gt<It[it].length;gt++)try{let St=It[it][gt](vt);St!=null&&(Pt=St)}catch{}return Pt};this.notifyStart=function(it){te("start",{el:this.el,pos:this.params.getPosition($),e:it,drag:this})},this.stop=function(it,vt){if(vt||ot){let Pt=[],gt=w.getSelection(),St=this.params.getPosition($);if(gt.length>0)for(let kt=0;kt<gt.length;kt++){let Xt=this.params.getPosition(gt[kt].el);Pt.push([gt[kt].el,{left:Xt[0],top:Xt[1]},gt[kt]])}else Pt.push([$,{left:St[0],top:St[1]},this]);te("stop",{el:$,pos:ee||St,finalPos:St,e:it,drag:this,selection:Pt})}},this.mark=function(it){z=this.params.getPosition($),Y=this.params.getPosition($,!0),V=[Y[0]-z[0],Y[1]-z[1]],this.size=this.params.getSize($),Lt=w.getMatchingDroppables(this),y(Lt,!0,!1,this),this.params.addClass($,this.params.dragClass||d.drag);let vt;this.params.getConstrainingRectangle?vt=this.params.getConstrainingRectangle($):vt=this.params.getSize($.parentNode),ae={w:vt[0],h:vt[1]},Dt=0,Mt=0,it&&w.notifySelectionDragStart(this)};let ee;this.unmark=function(it,vt){if(y(Lt,!1,!0,this),ut&&ht(mt,$)?(ee=[$.offsetLeft-Dt,$.offsetTop-Mt],$.parentNode.removeChild($),$=mt):ee=null,this.params.removeClass($,this.params.dragClass||d.drag),Lt.length=0,ut=!1,!vt){Yt.length>0&&ee&&e.setPosition(mt,ee),Yt.sort(A);for(let Pt=0;Pt<Yt.length&&Yt[Pt].drop(this,it)!==!0;Pt++);}},this.moveBy=function(it,vt,Pt){Yt.length=0;let gt=this.toGrid([z[0]+it,z[1]+vt]),St=zt(gt,$,ae,this.size);if(ht(this.el,$))if(gt[0]!==St[0]||gt[1]!==St[1]){if(!ut){let o=Ct(mt);e.addClass(o,N.ghostProxy),et?(et.appendChild(o),lt=e.getPosition(mt.parentNode,!0),yt=e.getPosition(e.ghostProxyParent,!0),Dt=lt[0]-yt[0],Mt=lt[1]-yt[1]):mt.parentNode.appendChild(o),$=o,ut=!0}St=gt}else ut&&($.parentNode.removeChild($),$=mt,ut=!1,lt=null,yt=null,Dt=0,Mt=0);let kt={x:St[0],y:St[1],w:this.size[0],h:this.size[1]},Xt={x:kt.x+V[0],y:kt.y+V[1],w:kt.w,h:kt.h},$t=null;this.params.setPosition($,[St[0]+Dt,St[1]+Mt]);for(let o=0;o<Lt.length;o++){let k={x:Lt[o].pagePosition[0],y:Lt[o].pagePosition[1],w:Lt[o].size[0],h:Lt[o].size[1]};this.params.intersects(Xt,k)&&(ft||$t==null||$t===Lt[o].el)&&Lt[o].canDrop(this)?($t||($t=Lt[o].el),Yt.push(Lt[o]),Lt[o].setHover(this,!0,Pt)):Lt[o].isHover()&&Lt[o].setHover(this,!1,Pt)}te("drag",{el:this.el,pos:St,e:Pt,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?re(this.params.handle,!1):re(this.params.filter,this.params.filterExclude)},u=function(i,e,d,C){this._class=d.droppable,this.params=e||{},this.rank=e.rank||0,this._activeClass=this.params.activeClass||d.active,this._hoverClass=this.params.hoverClass||d.hover,v.apply(this,arguments);let w=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(B){this.params[B?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(B){return!0},this.isHover=function(){return w},this.setHover=function(B,z,Y){(z||this.el._katavorioDragHover==null||this.el._katavorioDragHover===B.el._katavorio)&&(this.params[z?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=z?B.el._katavorio:null,w!==z&&this.params.events[z?"over":"out"]({el:this.el,e:Y,drag:B,drop:this}),w=z)},this.drop=function(B,z){return this.params.events.drop({drag:B,e:z,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,w=null}};var m=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i==="x"?e:e&3|8).toString(16)})},A=function(i,e){return i.rank<e.rank?1:i.rank>e.rank?-1:0};let F=function(i){return i==null||(i=typeof i=="string"||i.constructor===String?document.getElementById(i):i,i==null)?null:(i._katavorio=i._katavorio||m(),i)};X.Katavorio=function(i){let e=[],d={};this._dragsByScope={},this._dropsByScope={};let C=1,w=function(K,tt){h(K,function(et){for(let lt=0;lt<et.scopes.length;lt++)tt[et.scopes[lt]]=tt[et.scopes[lt]]||[],tt[et.scopes[lt]].push(et)})},B=function(K,tt){let et=0;return h(K,function(lt){for(let yt=0;yt<lt.scopes.length;yt++)if(tt[lt.scopes[yt]]){let Dt=i.indexOf(tt[lt.scopes[yt]],lt);Dt!==-1&&(tt[lt.scopes[yt]].splice(Dt,1),et++)}}),et>0};this.getMatchingDroppables=function(K){let tt=[],et={};for(let lt=0;lt<K.scopes.length;lt++){let yt=this._dropsByScope[K.scopes[lt]];if(yt)for(let Dt=0;Dt<yt.length;Dt++)yt[Dt].canDrop(K)&&!et[yt[Dt].uuid]&&(yt[Dt].allowLoopback||yt[Dt].el!==K.el)&&(et[yt[Dt].uuid]=!0,tt.push(yt[Dt]))}return tt.sort(A),tt};let z=(function(K){K=K||{};let tt={events:{}},et;for(et in i)tt[et]=i[et];for(et in K)tt[et]=K[et];for(et=0;et<U.length;et++)tt.events[U[et]]=K[U[et]]||O;return tt.katavorio=this,tt}).bind(this),Y=(function(K,tt){for(let et=0;et<U.length;et++)tt[U[et]]&&K.on(U[et],tt[U[et]])}).bind(this),V={},ot=i.css||{},ct=i.scope||G;for(var pt in N)V[pt]=N[pt];for(var pt in ot)V[pt]=ot[pt];let $=i.inputFilterSelector||M;this.getInputFilterSelector=function(){return $},this.setInputFilterSelector=function(K){return $=K,this},this.draggable=function(K,tt){let et=[];return h(K,(function(lt){if(lt=F(lt),lt!=null)if(lt._katavorioDrag==null){let yt=z(tt);lt._katavorioDrag=new g(lt,yt,V,ct),w(lt._katavorioDrag,this._dragsByScope),et.push(lt._katavorioDrag),i.addClass(lt,yt.selector?V.delegatedDraggable:V.draggable)}else Y(lt._katavorioDrag,tt)}).bind(this)),et},this.droppable=function(K,tt){let et=[];return h(K,(function(lt){if(lt=F(lt),lt!=null){let yt=new u(lt,z(tt),V,ct);lt._katavorioDrop=lt._katavorioDrop||[],lt._katavorioDrop.push(yt),w(yt,this._dropsByScope),et.push(yt),i.addClass(lt,V.droppable)}}).bind(this)),et},this.select=function(K){return h(K,function(){let tt=F(this);tt&&tt._katavorioDrag&&(d[tt._katavorio]||(e.push(tt._katavorioDrag),d[tt._katavorio]=[tt,e.length-1],i.addClass(tt,V.selected)))}),this},this.deselect=function(K){return h(K,function(){let tt=F(this);if(tt&&tt._katavorio&&d[tt._katavorio]){let lt=[];for(let yt=0;yt<e.length;yt++)e[yt].el!==tt&&lt.push(e[yt]);e=lt,delete d[tt._katavorio],i.removeClass(tt,V.selected)}}),this},this.deselectAll=function(){for(let K in d){let tt=d[K];i.removeClass(tt[0],V.selected)}e.length=0,d={}},this.markSelection=function(K){n(e,function(tt){tt.mark()},K)},this.markPosses=function(K){K.posses&&h(K.posses,function(tt){K.posseRoles[tt]&&Ct[tt]&&n(Ct[tt].members,function(et){et.mark()},K)})},this.unmarkSelection=function(K,tt){n(e,function(et){et.unmark(tt)},K)},this.unmarkPosses=function(K,tt){K.posses&&h(K.posses,function(et){K.posseRoles[et]&&Ct[et]&&n(Ct[et].members,function(lt){lt.unmark(tt,!0)},K)})},this.getSelection=function(){return e.slice(0)},this.updateSelection=function(K,tt,et){n(e,function(lt){lt.moveBy(K,tt)},et)};let rt=function(K,tt){tt.posses&&h(tt.posses,function(et){tt.posseRoles[et]&&Ct[et]&&n(Ct[et].members,function(lt){K(lt)},tt)})};this.updatePosses=function(K,tt,et){rt(function(lt){lt.moveBy(K,tt)},et)},this.notifyPosseDragStop=function(K,tt){rt(function(et){et.stop(tt,!0)},K)},this.notifySelectionDragStop=function(K,tt){n(e,function(et){et.stop(tt,!0)},K)},this.notifySelectionDragStart=function(K,tt){n(e,function(et){et.notifyStart(tt)},K)},this.setZoom=function(K){C=K},this.getZoom=function(){return C};let ft=function(K,tt,et,lt){h(K,function(yt){B(yt,et),yt[lt](tt),w(yt,et)})};h(["set","add","remove","toggle"],(function(K){this[K+"Scope"]=(function(tt,et){ft(tt._katavorioDrag,et,this._dragsByScope,K+"Scope"),ft(tt._katavorioDrop,et,this._dropsByScope,K+"Scope")}).bind(this),this[K+"DragScope"]=(function(tt,et){ft(tt.constructor===g?tt:tt._katavorioDrag,et,this._dragsByScope,K+"Scope")}).bind(this),this[K+"DropScope"]=(function(tt,et){ft(tt.constructor===u?tt:tt._katavorioDrop,et,this._dropsByScope,K+"Scope")}).bind(this)}).bind(this)),this.snapToGrid=function(K,tt){for(let et in this._dragsByScope)n(this._dragsByScope[et],function(lt){lt.snap(K,tt)})},this.getDragsForScope=function(K){return this._dragsByScope[K]},this.getDropsForScope=function(K){return this._dropsByScope[K]};let ut=function(K,tt,et){if(K=F(K),K[tt]){let lt=e.indexOf(K[tt]);lt>=0&&e.splice(lt,1),B(K[tt],et)&&h(K[tt],function(yt){yt.destroy()}),delete K[tt]}},ht=function(K,tt,et,lt){K=F(K),K[tt]&&K[tt].off(et,lt)};this.elementRemoved=function(K){this.destroyDraggable(K),this.destroyDroppable(K)},this.destroyDraggable=function(K,tt,et){arguments.length===1?ut(K,"_katavorioDrag",this._dragsByScope):ht(K,"_katavorioDrag",tt,et)},this.destroyDroppable=function(K,tt,et){arguments.length===1?ut(K,"_katavorioDrop",this._dropsByScope):ht(K,"_katavorioDrop",tt,et)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},e=[],d={},Ct={}};var Ct={};let mt=function(K,tt,et){let lt=J(tt)?tt:tt.id,yt=J(tt)?!0:tt.active!==!1,Dt=Ct[lt]||function(){let Mt={name:lt,members:[]};return Ct[lt]=Mt,Mt}();return h(K,function(Mt){if(Mt._katavorioDrag){if(et&&Mt._katavorioDrag.posseRoles[Dt.name]!=null)return;c(Dt.members,Mt._katavorioDrag),c(Mt._katavorioDrag.posses,Dt.name),Mt._katavorioDrag.posseRoles[Dt.name]=yt}}),Dt};this.addToPosse=function(K,tt){let et=[];for(let lt=1;lt<arguments.length;lt++)et.push(mt(K,arguments[lt]));return et.length===1?et[0]:et},this.setPosse=function(K,tt){let et=[];for(let lt=1;lt<arguments.length;lt++)et.push(mt(K,arguments[lt],!0).name);return h(K,(function(lt){if(lt._katavorioDrag){let yt=Q(lt._katavorioDrag.posses,et),Dt=[];Array.prototype.push.apply(Dt,lt._katavorioDrag.posses);for(let Mt=0;Mt<yt.length;Mt++)this.removeFromPosse(lt,yt[Mt])}}).bind(this)),et.length===1?et[0]:et},this.removeFromPosse=function(K,tt){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(let et=1;et<arguments.length;et++)tt=arguments[et],h(K,function(lt){if(lt._katavorioDrag&&lt._katavorioDrag.posses){let yt=lt._katavorioDrag;h(tt,function(Dt){H(Ct[Dt].members,yt),H(yt.posses,Dt),delete yt.posseRoles[Dt]})}})},this.removeFromAllPosses=function(K){h(K,function(tt){if(tt._katavorioDrag&&tt._katavorioDrag.posses){let et=tt._katavorioDrag;h(et.posses,function(lt){H(Ct[lt].members,et)}),et.posses.length=0,et.posseRoles={}}})},this.setPosseState=function(K,tt,et){let lt=Ct[tt];lt&&h(K,function(yt){yt._katavorioDrag&&yt._katavorioDrag.posses&&(yt._katavorioDrag.posseRoles[lt.name]=et)})}},X.Katavorio.version="1.0.0",typeof exports<"u"&&(exports.Katavorio=X.Katavorio)}).call(typeof window<"u"?window:void 0);(function(){let X=this;X.jsPlumbUtil=X.jsPlumbUtil||{};let c=X.jsPlumbUtil;typeof exports<"u"&&(exports.jsPlumbUtil=c);function H(u){return Object.prototype.toString.call(u)==="[object Array]"}c.isArray=H;function Q(u){return Object.prototype.toString.call(u)==="[object Number]"}c.isNumber=Q;function J(u){return typeof u=="string"}c.isString=J;function W(u){return typeof u=="boolean"}c.isBoolean=W;function r(u){return u==null}c.isNull=r;function E(u){return u==null?!1:Object.prototype.toString.call(u)==="[object Object]"}c.isObject=E;function a(u){return Object.prototype.toString.call(u)==="[object Date]"}c.isDate=a;function t(u){return Object.prototype.toString.call(u)==="[object Function]"}c.isFunction=t;function p(u){return t(u)&&u.name!=null&&u.name.length>0}c.isNamedFunction=p;function x(u){for(let m in u)if(u.hasOwnProperty(m))return!1;return!0}c.isEmpty=x;function j(u){if(J(u))return""+u;if(W(u))return!!u;if(a(u))return new Date(u.getTime());if(t(u))return u;if(H(u)){let m=[];for(let A=0;A<u.length;A++)m.push(j(u[A]));return m}else if(E(u)){let m={};for(let A in u)m[A]=j(u[A]);return m}else return u}c.clone=j;function S(u,m,A,F){let i={},e,d,C={};for(A=A||[],F=F||[],d=0;d<A.length;d++)i[A[d]]=!0;for(d=0;d<F.length;d++)C[F[d]]=!0;let w=j(u);for(d in m)if(w[d]==null||C[d])w[d]=m[d];else if(J(m[d])||W(m[d]))i[d]?(e=[],e.push.apply(e,H(w[d])?w[d]:[w[d]]),e.push.apply(e,W(m[d])?m[d]:[m[d]]),w[d]=e):w[d]=m[d];else if(H(m[d]))e=[],H(w[d])&&e.push.apply(e,w[d]),e.push.apply(e,m[d]),w[d]=e;else if(E(m[d])){E(w[d])||(w[d]={});for(let B in m[d])w[d][B]=m[d][B]}return w}c.merge=S;function I(u,m,A){if(u==null)return;let F=u,i=F;return m.replace(/([^\.])+/g,function(e,d,C,w){let B=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),z=C+e.length>=w.length,Y=function(){return i[B[1]]||function(){return i[B[1]]=[],i[B[1]]}()};if(z)B?Y()[B[3]]=A:i[e]=A;else if(B){let V=Y();i=V[B[3]]||function(){return V[B[3]]={},V[B[3]]}()}else i=i[e]||function(){return i[e]={},i[e]}();return""}),u}c.replace=I;function s(u,m,A){for(let F=0;F<A.length;F++){let i=A[F][0][A[F][1]].apply(A[F][0],A[F][2]);if(i===m)return i}return u}c.functionChain=s;function l(u,m,A,F){let i=function(d){let C=d.match(/(\${.*?})/g);if(C!=null)for(let w=0;w<C.length;w++){let B=m[C[w].substring(2,C[w].length-1)]||"";B!=null&&(d=d.replace(C[w],B))}return d},e=function(d){if(d!=null){if(J(d))return i(d);if(t(d)&&!F&&(A==null||(d.name||"").indexOf(A)===0))return d(m);if(H(d)){let C=[];for(let w=0;w<d.length;w++)C.push(e(d[w]));return C}else if(E(d)){let C={};for(let w in d)C[w]=e(d[w]);return C}else return d}};return e(u)}c.populate=l;function N(u,m){if(u){for(let A=0;A<u.length;A++)if(m(u[A]))return A}return-1}c.findWithFunction=N;function G(u,m){let A=N(u,m);return A>-1&&u.splice(A,1),A!==-1}c.removeWithFunction=G;function U(u,m){let A=u.indexOf(m);return A>-1&&u.splice(A,1),A!==-1}c.remove=U;function O(u,m,A){N(u,A)===-1&&u.push(m)}c.addWithFunction=O;function b(u,m,A,F){let i=u[m];return i==null&&(i=[],u[m]=i),i[F?"unshift":"push"](A),i}c.addToList=b;function n(u,m,A){return u.indexOf(m)===-1?(A?u.unshift(m):u.push(m),!0):!1}c.suggest=n;function y(u,m,A){let F;m=H(m)?m:[m];let i=function(C){let w=C.__proto__;for(;w!=null;)if(w.prototype!=null){for(let B in w.prototype)w.prototype.hasOwnProperty(B)&&!u.prototype.hasOwnProperty(B)&&(u.prototype[B]=w.prototype[B]);w=w.prototype.__proto__}else w=null};for(F=0;F<m.length;F++){for(let C in m[F].prototype)m[F].prototype.hasOwnProperty(C)&&!u.prototype.hasOwnProperty(C)&&(u.prototype[C]=m[F].prototype[C]);i(m[F])}let e=function(C,w){return function(){for(F=0;F<m.length;F++)m[F].prototype[C]&&m[F].prototype[C].apply(this,arguments);return w.apply(this,arguments)}},d=function(C){for(let w in C)u.prototype[w]=e(w,C[w])};if(arguments.length>2)for(F=2;F<arguments.length;F++)d(arguments[F]);return u}c.extend=y;function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){let m=Math.random()*16|0;return(u==="x"?m:m&3|8).toString(16)})}c.uuid=h;function D(u){if(u==null)return null;let m=u.replace(/^\s\s*/,""),A=/\s/,F=m.length;for(;A.test(m.charAt(--F)););return m.slice(0,F+1)}c.fastTrim=D;function M(u,m){u=u.length==null||typeof u=="string"?[u]:u;for(let A=0;A<u.length;A++)m(u[A])}c.each=M;function f(u,m){let A=[];for(let F=0;F<u.length;F++)A.push(m(u[F]));return A}c.map=f;function v(u,m,A){A=A||"parent";let F=function(w){return w?m[w]:null},i=function(w){return w?F(w[A]):null},e=function(w,B){if(w==null)return B;{let z=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];B.mergeStrategy==="override"&&Array.prototype.push.apply(z,["events","overlays"]);let Y=S(w,B,[],z);return e(i(w),Y)}},d=function(w){if(w==null)return{};if(typeof w=="string")return F(w);if(w.length){let B=!1,z=0,Y;for(;!B&&z<w.length;)Y=d(w[z]),Y?B=!0:z++;return Y}},C=d(u);return C?e(i(C),C):{}}c.mergeWithParents=v,c.logEnabled=!0;function _(){if(c.logEnabled&&typeof console<"u")try{let u=arguments[arguments.length-1];console.log(u)}catch{}}c.log=_;function L(u,m,A){return function(){let F=null;try{m!=null&&(F=m.apply(this,arguments))}catch(i){_("jsPlumb function failed : "+i)}if(u!=null&&(A==null||F!==A))try{F=u.apply(this,arguments)}catch(i){_("wrapped function failed : "+i)}return F}}c.wrap=L;let g=function(){function u(){let m=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(A,F,i){let e=function(d){b(m._listeners,d,F,i),F.__jsPlumb=F.__jsPlumb||{},F.__jsPlumb[h()]=d};if(typeof A=="string")e(A);else if(A.length!=null)for(let d=0;d<A.length;d++)e(A[d]);return m},this.fire=function(A,F,i){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[A]){let e=this._listeners[A].length,d=0,C=!1,w=null;if(!this.shouldFireEvent||this.shouldFireEvent(A,F,i))for(;!C&&d<e&&w!==!1;){if(this.eventsToDieOn[A])this._listeners[A][d].apply(this,[F,i]);else try{w=this._listeners[A][d].apply(this,[F,i])}catch(B){_("jsPlumb: fire failed for event "+A+" : "+B)}d++,(this._listeners==null||this._listeners[A]==null)&&(C=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){let A=m.queue.pop();A&&m.fire.apply(m,A)},this.unbind=function(A,F){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof A=="string")delete this._listeners[A];else if(A.__jsPlumb){let i;for(let e in A.__jsPlumb)i=A.__jsPlumb[e],U(this._listeners[i]||[],A)}}else arguments.length===2&&U(this._listeners[A]||[],F);return this},this.getListener=function(A){return m._listeners[A]},this.setSuspendEvents=function(A){m.eventsSuspended=A},this.isSuspendEvents=function(){return m.eventsSuspended},this.silently=function(A){m.setSuspendEvents(!0);try{A()}catch(F){_("Cannot execute silent function "+F)}m.setSuspendEvents(!1)},this.cleanupListeners=function(){for(let A in m._listeners)m._listeners[A]=null}}return u}();c.EventGenerator=g}).call(typeof window<"u"?window:void 0);(function(){let X=this;X.jsPlumbUtil.matchesSelector=function(c,H,Q){Q=Q||c.parentNode;let J=Q.querySelectorAll(H);for(let W=0;W<J.length;W++)if(J[W]===c)return!0;return!1},X.jsPlumbUtil.consume=function(c,H){c.stopPropagation?c.stopPropagation():c.returnValue=!1,!H&&c.preventDefault&&c.preventDefault()},X.jsPlumbUtil.sizeElement=function(c,H,Q,J,W){c&&(c.style.height=W+"px",c.height=W,c.style.width=J+"px",c.width=J,c.style.left=H+"px",c.style.top=Q+"px")}}).call(typeof window<"u"?window:void 0);(function(){let X={deriveAnchor:function(J,W,r,E){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[J][W]}},c=this,H=function(J){this.count=0,this.instance=J,this.lists={},this.instance.addList=function(W,r){return this.listManager.addList(W,r)},this.instance.removeList=function(W){this.listManager.removeList(W)},this.instance.bind("manageElement",(function(W){let r=this.instance.getSelector(W.el,"[jtk-scrollable-list]");for(let E=0;E<r.length;E++)this.addList(r[E])}).bind(this)),this.instance.bind("unmanageElement",function(W){this.removeList(W.el)}),this.instance.bind("connection",(function(W,r){r==null&&(this._maybeUpdateParentList(W.source),this._maybeUpdateParentList(W.target))}).bind(this))};c.jsPlumbListManager=H,H.prototype={addList:function(J,W){let r=this.instance.extend({},X);W=this.instance.extend(r,W||{});let E=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[E]=new Q(this.instance,J,W,E)},removeList:function(J){let W=this.lists[J._jsPlumbList];W&&(W.destroy(),delete this.lists[J._jsPlumbList])},_maybeUpdateParentList:function(J){let W=J.parentNode,r=this.instance.getContainer();for(;W!=null&&W!==r;){if(W._jsPlumbList!=null&&this.lists[W._jsPlumbList]!=null){W._jsPlumbScrollHandler();return}W=W.parentNode}}};var Q=function(J,W,r,E){W._jsPlumbList=E;function a(j,S,I,s){return r.anchor?r.anchor:r.deriveAnchor(j,S,I,s)}function t(j,S,I,s){return r.deriveEndpoint?r.deriveEndpoint(j,S,I,s):r.endpoint?r.endpoint:I.type}function p(j){let S=j.parentNode,I=J.getContainer();for(;S!=null&&S!==I;){if(J.hasClass(S,"jtk-managed")){J.recalculateOffsets(S);return}S=S.parentNode}}let x=function(j){let S=J.getSelector(W,".jtk-managed"),I=J.getId(W);for(var s=0;s<S.length;s++){if(S[s].offsetTop<W.scrollTop)S[s]._jsPlumbProxies||(S[s]._jsPlumbProxies=S[s]._jsPlumbProxies||[],J.select({source:S[s]}).each(function(l){J.proxyConnection(l,0,W,I,function(){return t("top",0,l.endpoints[0],l)},function(){return a("top",0,l.endpoints[0],l)}),S[s]._jsPlumbProxies.push([l,0])}),J.select({target:S[s]}).each(function(l){J.proxyConnection(l,1,W,I,function(){return t("top",1,l.endpoints[1],l)},function(){return a("top",1,l.endpoints[1],l)}),S[s]._jsPlumbProxies.push([l,1])}));else if(S[s].offsetTop>W.scrollTop+W.offsetHeight)S[s]._jsPlumbProxies||(S[s]._jsPlumbProxies=S[s]._jsPlumbProxies||[],J.select({source:S[s]}).each(function(l){J.proxyConnection(l,0,W,I,function(){return t("bottom",0,l.endpoints[0],l)},function(){return a("bottom",0,l.endpoints[0],l)}),S[s]._jsPlumbProxies.push([l,0])}),J.select({target:S[s]}).each(function(l){J.proxyConnection(l,1,W,I,function(){return t("bottom",1,l.endpoints[1],l)},function(){return a("bottom",1,l.endpoints[1],l)}),S[s]._jsPlumbProxies.push([l,1])}));else if(S[s]._jsPlumbProxies){for(let l=0;l<S[s]._jsPlumbProxies.length;l++)J.unproxyConnection(S[s]._jsPlumbProxies[l][0],S[s]._jsPlumbProxies[l][1],I);delete S[s]._jsPlumbProxies}J.revalidate(S[s])}p(W)};J.setAttribute(W,"jtk-scrollable-list","true"),W._jsPlumbScrollHandler=x,J.on(W,"scroll",x),x(),this.destroy=function(){J.off(W,"scroll",x),delete W._jsPlumbScrollHandler;let j=J.getSelector(W,".jtk-managed"),S=J.getId(W);for(let I=0;I<j.length;I++)if(j[I]._jsPlumbProxies){for(let s=0;s<j[I]._jsPlumbProxies.length;s++)J.unproxyConnection(j[I]._jsPlumbProxies[s][0],j[I]._jsPlumbProxies[s][1],S);delete j[I]._jsPlumbProxies}}}}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumbUtil,H=function(){return""+new Date().getTime()},Q=function(s){if(s._jsPlumb.paintStyle&&s._jsPlumb.hoverPaintStyle){let l={};I.extend(l,s._jsPlumb.paintStyle),I.extend(l,s._jsPlumb.hoverPaintStyle),delete s._jsPlumb.hoverPaintStyle,l.gradient&&s._jsPlumb.paintStyle.fill&&delete l.gradient,s._jsPlumb.hoverPaintStyle=l}},J=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],W=function(s,l,N,G){let U=s.getAttachedElements();if(U)for(let O=0,b=U.length;O<b;O++)(!G||G!==U[O])&&U[O].setHover(l,!0,N)},r=function(s){return s==null?null:s.split(" ")},E=function(s,l,N){for(let G in l)s[G]=N},a=function(s,l,N){if(s.getDefaultType){let G=s.getTypeDescriptor(),U={},O=s.getDefaultType(),b=c.merge({},O);E(U,O,"__default");for(let n=0,y=s._jsPlumb.types.length;n<y;n++){let h=s._jsPlumb.types[n];if(h!=="__default"){let D=s._jsPlumb.instance.getType(h,G);if(D!=null){let M=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],f=[];D.mergeStrategy==="override"?Array.prototype.push.apply(M,["events","overlays","cssClass"]):f.push("cssClass"),b=c.merge(b,D,f,M),E(U,D,h)}}}l&&(b=c.populate(b,l,"_")),s.applyType(b,N,U),N||s.repaint()}},t=X.jsPlumbUIComponent=function(s){c.EventGenerator.apply(this,arguments);let l=this,N=arguments,G=l.idPrefix,U=G+new Date().getTime();this._jsPlumb={instance:s._jsPlumb,parameters:s.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:s.beforeDetach,beforeDrop:s.beforeDrop,overlayPlacements:[],hoverClass:s.hoverClass||s._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(D,M,f){this._jsPlumb.typeCache[f]=this._jsPlumb.typeCache[f]||{},this._jsPlumb.typeCache[f][D]=M},this.getCachedTypeItem=function(D,M){return this._jsPlumb.typeCache[M]?this._jsPlumb.typeCache[M][D]:null},this.getId=function(){return U};let O=s.overlays||[],b={};if(this.defaultOverlayKeys){for(var n=0;n<this.defaultOverlayKeys.length;n++)Array.prototype.push.apply(O,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[n]]||[]);for(n=0;n<O.length;n++){let D=I.convertToFullOverlaySpec(O[n]);b[D[1].id]=D}}let y={overlays:b,parameters:s.parameters||{},scope:s.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return y},this.appendToDefaultType=function(D){for(let M in D)y[M]=D[M]},s.events)for(let D in s.events)l.bind(D,s.events[D]);this.clone=(function(){let D=Object.create(this.constructor.prototype);return this.constructor.apply(D,N),D}).bind(this),this.isDetachAllowed=function(D){let M=!0;if(this._jsPlumb.beforeDetach)try{M=this._jsPlumb.beforeDetach(D)}catch(f){c.log("jsPlumb: beforeDetach callback failed",f)}return M},this.isDropAllowed=function(D,M,f,v,_,L,g){let u=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:D,targetId:M,scope:f,connection:v,dropEndpoint:_,source:L,target:g});if(this._jsPlumb.beforeDrop)try{u=this._jsPlumb.beforeDrop({sourceId:D,targetId:M,scope:f,connection:v,dropEndpoint:_,source:L,target:g})}catch(m){c.log("jsPlumb: beforeDrop callback failed",m)}return u};let h=[];this.setListenerComponent=function(D){for(let M=0;M<h.length;M++)h[M][3]=D}},p=function(s,l){let N=s._jsPlumb.types[l],G=s._jsPlumb.instance.getType(N,s.getTypeDescriptor());G!=null&&G.cssClass&&s.canvas&&s._jsPlumb.instance.removeClass(s.canvas,G.cssClass)};c.extend(X.jsPlumbUIComponent,c.EventGenerator,{getParameter:function(s){return this._jsPlumb.parameters[s]},setParameter:function(s,l){this._jsPlumb.parameters[s]=l},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(s){this._jsPlumb.parameters=s},getClass:function(){return I.getClass(this.canvas)},hasClass:function(s){return I.hasClass(this.canvas,s)},addClass:function(s){I.addClass(this.canvas,s)},removeClass:function(s){I.removeClass(this.canvas,s)},updateClasses:function(s,l){I.updateClasses(this.canvas,s,l)},setType:function(s,l,N){this.clearTypes(),this._jsPlumb.types=r(s)||[],a(this,l,N)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(s,l){a(this,s,l)},hasType:function(s){return this._jsPlumb.types.indexOf(s)!==-1},addType:function(s,l,N){let G=r(s),U=!1;if(G!=null){for(let O=0,b=G.length;O<b;O++)this.hasType(G[O])||(this._jsPlumb.types.push(G[O]),U=!0);U&&a(this,l,N)}},removeType:function(s,l,N){let G=r(s),U=!1,O=(function(b){let n=this._jsPlumb.types.indexOf(b);return n!==-1?(p(this,n),this._jsPlumb.types.splice(n,1),!0):!1}).bind(this);if(G!=null){for(let b=0,n=G.length;b<n;b++)U=O(G[b])||U;U&&a(this,l,N)}},clearTypes:function(s,l){let N=this._jsPlumb.types.length;for(let G=0;G<N;G++)p(this,0),this._jsPlumb.types.splice(0,1);a(this,s,l)},toggleType:function(s,l,N){let G=r(s);if(G!=null){for(let U=0,O=G.length;U<O;U++){let b=this._jsPlumb.types.indexOf(G[U]);b!==-1?(p(this,b),this._jsPlumb.types.splice(b,1)):this._jsPlumb.types.push(G[U])}a(this,l,N)}},applyType:function(s,l){if(this.setPaintStyle(s.paintStyle,l),this.setHoverPaintStyle(s.hoverPaintStyle,l),s.parameters)for(let N in s.parameters)this.setParameter(N,s.parameters[N]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(s,l){this._jsPlumb.paintStyle=s,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,Q(this),l||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(s,l){this._jsPlumb.hoverPaintStyle=s,Q(this),l||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(s){(s||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(s,l,N){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=s;let G=s?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[G](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[G](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=s?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(N=N||H(),this.repaint({timestamp:N,recalc:!1}))),this.getAttachedElements&&!l&&W(this,s,H(),this)}}});let x=0,j=function(){let s=x+1;return x++,s},S=X.jsPlumbInstance=function(s){this.version="2.12.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},s&&I.extend(this.Defaults,s),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},c.EventGenerator.apply(this);let l=this,N=j(),G=l.bind,U={},O=1,b=function(o){if(o==null)return null;if(o.nodeType===3||o.nodeType===8)return{el:o,text:!0};{let k=l.getElement(o);return{el:k,id:c.isString(o)&&k==null?o:ht(k)}}};this.getInstanceIndex=function(){return N},this.setZoom=function(o,k){return O=o,l.fire("zoom",O),k&&l.repaintEverything(),!0},this.getZoom=function(){return O};for(let o in this.Defaults)U[o]=this.Defaults[o];let n,y=[];this.unbindContainer=function(){if(n!=null&&y.length>0)for(let o=0;o<y.length;o++)l.off(n,y[o][0],y[o][1])},this.setContainer=function(o){this.unbindContainer(),o=this.getElement(o),this.select().each(function(Z){Z.moveParent(o)}),this.selectEndpoints().each(function(Z){Z.moveParent(o)});let k=n;n=o,y.length=0;let P={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},T=function(Z,st,nt){let dt=st.srcElement||st.target,at=(dt&&dt.parentNode?dt.parentNode._jsPlumb:null)||(dt?dt._jsPlumb:null)||(dt&&dt.parentNode&&dt.parentNode.parentNode?dt.parentNode.parentNode._jsPlumb:null);if(at){at.fire(Z,at,st);let _t=nt&&P[nt+Z]||Z;l.fire(_t,at.component||at,st)}},R=function(Z,st,nt){y.push([Z,nt]),l.on(n,Z,st,nt)},q=function(Z){R(Z,".jtk-connector",function(st){T(Z,st)}),R(Z,".jtk-endpoint",function(st){T(Z,st,"endpoint")}),R(Z,".jtk-overlay",function(st){T(Z,st)})};for(let Z=0;Z<J.length;Z++)q(J[Z]);for(let Z in _){let st=_[Z].el;st.parentNode===k&&(k.removeChild(st),n.appendChild(st))}},this.getContainer=function(){return n},this.bind=function(o,k){o==="ready"&&D?k():G.apply(l,[o,k])},l.importDefaults=function(o){for(let k in o)l.Defaults[k]=o[k];return o.Container&&l.setContainer(o.Container),l},l.restoreDefaults=function(){return l.Defaults=I.extend({},U),l};var h=null,D=!1,M=[],f={},v={},_={},L={},g={},u=!1,m=[],A=!1,F=null,i=this.Defaults.Scope,e=1,d=function(){return""+e++},C=(function(o,k){n?n.appendChild(o):k?this.getElement(k).appendChild(o):this.appendToRoot(o)}).bind(this),w=function(o,k,P,T){if(!A){let R=ht(o),q,Z=l.getDragManager();Z&&(q=Z.getElementsForDraggable(R)),P==null&&(P=H());let st=It({elId:R,offset:k,recalc:!1,timestamp:P});if(q&&st&&st.o)for(let nt in q)It({elId:q[nt].id,offset:{left:st.o.left+q[nt].offset.left,top:st.o.top+q[nt].offset.top},recalc:!1,timestamp:P});if(l.anchorManager.redraw(R,k,P,null,T),q)for(let nt in q)l.anchorManager.redraw(q[nt].id,k,P,q[nt].offset,T,!0)}},B=function(o){return v[o]},z=function(o,k){let P=o.scope.split(/\s/),T=k.scope.split(/\s/);for(let R=0;R<P.length;R++)for(let q=0;q<T.length;q++)if(T[q]===P[R])return!0;return!1},Y=function(o,k){let P=I.extend({},o);for(let T in k)k[T]&&(P[T]=k[T]);return P},V=(function(o,k){let P=I.extend({},o);if(k&&I.extend(P,k),P.source&&(P.source.endpoint?P.sourceEndpoint=P.source:P.source=l.getElement(P.source)),P.target&&(P.target.endpoint?P.targetEndpoint=P.target:P.target=l.getElement(P.target)),o.uuids&&(P.sourceEndpoint=B(o.uuids[0]),P.targetEndpoint=B(o.uuids[1])),P.sourceEndpoint&&P.sourceEndpoint.isFull()){c.log(l,"could not add connection; source endpoint is full");return}if(P.targetEndpoint&&P.targetEndpoint.isFull()){c.log(l,"could not add connection; target endpoint is full");return}if(!P.type&&P.sourceEndpoint&&(P.type=P.sourceEndpoint.connectionType),P.sourceEndpoint&&P.sourceEndpoint.connectorOverlays){P.overlays=P.overlays||[];for(let q=0,Z=P.sourceEndpoint.connectorOverlays.length;q<Z;q++)P.overlays.push(P.sourceEndpoint.connectorOverlays[q])}P.sourceEndpoint&&P.sourceEndpoint.scope&&(P.scope=P.sourceEndpoint.scope),!P["pointer-events"]&&P.sourceEndpoint&&P.sourceEndpoint.connectorPointerEvents&&(P["pointer-events"]=P.sourceEndpoint.connectorPointerEvents);let T=function(q,Z,st){let nt=Y(Z,{anchor:P.anchors?P.anchors[st]:P.anchor,endpoint:P.endpoints?P.endpoints[st]:P.endpoint,paintStyle:P.endpointStyles?P.endpointStyles[st]:P.endpointStyle,hoverPaintStyle:P.endpointHoverStyles?P.endpointHoverStyles[st]:P.endpointHoverStyle});return l.addEndpoint(q,nt)},R=function(q,Z,st,nt){if(P[q]&&!P[q].endpoint&&!P[q+"Endpoint"]&&!P.newConnection){let dt=ht(P[q]),at=st[dt];if(at=at?at[nt]:null,at){if(!at.enabled)return!1;let _t=I.extend({},at.def);delete _t.label;let jt=at.endpoint!=null&&at.endpoint._jsPlumb?at.endpoint:T(P[q],_t,Z);if(jt.isFull())return!1;P[q+"Endpoint"]=jt,!P.scope&&_t.scope&&(P.scope=_t.scope),at.uniqueEndpoint?at.endpoint?jt.finalEndpoint=at.endpoint:(at.endpoint=jt,jt.setDeleteOnEmpty(!1)):jt.setDeleteOnEmpty(!0),Z===0&&at.def.connectorOverlays&&(P.overlays=P.overlays||[],Array.prototype.push.apply(P.overlays,at.def.connectorOverlays))}}};if(R("source",0,this.sourceEndpointDefinitions,P.type||"default")!==!1&&R("target",1,this.targetEndpointDefinitions,P.type||"default")!==!1)return P.sourceEndpoint&&P.targetEndpoint&&(z(P.sourceEndpoint,P.targetEndpoint)||(P=null)),P}).bind(l),ot=function(o){let k=l.Defaults.ConnectionType||l.getDefaultConnectionType();o._jsPlumb=l,o.newConnection=ot,o.newEndpoint=pt,o.endpointsByUUID=v,o.endpointsByElement=f,o.finaliseConnection=ct,o.id="con_"+d();let P=new k(o);return P.isDetachable()&&(P.endpoints[0].initDraggable("_jsPlumbSource"),P.endpoints[1].initDraggable("_jsPlumbTarget")),P},ct=l.finaliseConnection=function(o,k,P,T){if(k=k||{},o.suspendedEndpoint||M.push(o),o.pending=null,o.endpoints[0].isTemporarySource=!1,T!==!1&&l.anchorManager.newConnection(o),w(o.source),!k.doNotFireConnectionEvent&&k.fireEvent!==!1){let R={connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]};l.fire("connection",R,P)}},pt=function(o,k){let P=l.Defaults.EndpointType||I.Endpoint,T=I.extend({},o);T._jsPlumb=l,T.newConnection=ot,T.newEndpoint=pt,T.endpointsByUUID=v,T.endpointsByElement=f,T.fireDetachEvent=K,T.elementId=k||ht(T.source);let R=new P(T);return R.id="ep_"+d(),Yt(T.elementId,T.source),I.headless||l.getDragManager().endpointAdded(T.source,k),R},$=function(o,k,P){let T=f[o];if(T&&T.length)for(let R=0,q=T.length;R<q;R++){for(let Z=0,st=T[R].connections.length;Z<st;Z++)if(k(T[R].connections[Z]))return;P&&P(T[R])}},rt=function(o,k,P){k=k==="block";let T=null;P&&(T=function(q){q.setVisible(k,!0,!0)});let R=b(o);$(R.id,function(q){if(k&&P){let Z=q.sourceId===R.id?1:0;q.endpoints[Z].isVisible()&&q.setVisible(!0)}else q.setVisible(k)},T)},ft=function(o,k){let P=null;k&&(P=function(T){let R=T.isVisible();T.setVisible(!R)}),$(o,function(T){let R=T.isVisible();T.setVisible(!R)},P)},ut=function(o){let k=L[o];return k?{o:k,s:m[o]}:It({elId:o})},ht=function(o,k,P){if(c.isString(o))return o;if(o==null)return null;let T=l.getAttribute(o,"id");return(!T||T==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?T=k:(arguments.length===1||arguments.length===3&&!arguments[2])&&(T="jsPlumb_"+N+"_"+d()),P||l.setAttribute(o,"id",T)),T};this.setConnectionBeingDragged=function(o){u=o},this.isConnectionBeingDragged=function(){return u},this.getManagedElements=function(){return _},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(o,k,P){P=P||{};let T=I.extend({},P);I.extend(T,k),T.endpoint=T.endpoint||l.Defaults.Endpoint,T.paintStyle=T.paintStyle||l.Defaults.EndpointStyle;let R=[],q=c.isArray(o)||o.length!=null&&!c.isString(o)?o:[o];for(let Z=0,st=q.length;Z<st;Z++){T.source=l.getElement(q[Z]),ae(T.source);let nt=ht(T.source),dt=pt(T,nt),at=Yt(nt,T.source).info.o;c.addToList(f,nt,dt),A||dt.paint({anchorLoc:dt.anchor.compute({xy:[at.left,at.top],wh:m[nt],element:dt,timestamp:F}),timestamp:F}),R.push(dt)}return R.length===1?R[0]:R},this.addEndpoints=function(o,k,P){let T=[];for(let R=0,q=k.length;R<q;R++){let Z=l.addEndpoint(o,k[R],P);c.isArray(Z)?Array.prototype.push.apply(T,Z):T.push(Z)}return T},this.animate=function(o,k,P){if(!this.animationSupported)return!1;P=P||{};let T=l.getElement(o),R=ht(T),q=I.animEvents.step,Z=I.animEvents.complete;P[q]=c.wrap(P[q],function(){l.revalidate(R)}),P[Z]=c.wrap(P[Z],function(){l.revalidate(R)}),l.doAnimate(T,k,P)},this.checkCondition=function(o,k){let P=l.getListener(o),T=!0;if(P&&P.length>0){let R=Array.prototype.slice.call(arguments,1);try{for(let q=0,Z=P.length;q<Z;q++)T=T&&P[q].apply(P[q],R)}catch(q){c.log(l,"cannot check condition ["+o+"]"+q)}}return T},this.connect=function(o,k){let P=V(o,k),T;if(P){if(P.source==null&&P.sourceEndpoint==null){c.log("Cannot establish connection - source does not exist");return}if(P.target==null&&P.targetEndpoint==null){c.log("Cannot establish connection - target does not exist");return}ae(P.source),T=ot(P),ct(T,P)}return T};let Ct=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],mt=(function(o,k,P,T){let R,q=Ct[P],Z=o[q.elId];o[q.el];let st,nt,dt=o.endpoints[P],at={index:P,originalSourceId:P===0?Z:o.sourceId,newSourceId:o.sourceId,originalTargetId:P===1?Z:o.targetId,newTargetId:o.targetId,connection:o};if(k.constructor===I.Endpoint)R=k,R.addConnection(o),k=R.element;else if(st=ht(k),nt=this[q.epDefs][st],st===o[q.elId])R=null;else if(nt)for(let _t in nt){if(!nt[_t].enabled)return;R=nt[_t].endpoint!=null&&nt[_t].endpoint._jsPlumb?nt[_t].endpoint:this.addEndpoint(k,nt[_t].def),nt[_t].uniqueEndpoint&&(nt[_t].endpoint=R),R.addConnection(o)}else R=o.makeEndpoint(P===0,k,st);return R!=null&&(dt.detachFromConnection(o),o.endpoints[P]=R,o[q.el]=R.element,o[q.elId]=R.elementId,at[P===0?"newSourceId":"newTargetId"]=R.elementId,tt(at),T||o.repaint()),at.element=k,at}).bind(this);this.setSource=function(o,k,P){let T=mt(o,k,0,P);this.anchorManager.sourceChanged(T.originalSourceId,T.newSourceId,o,T.el)},this.setTarget=function(o,k,P){let T=mt(o,k,1,P);this.anchorManager.updateOtherEndpoint(T.originalSourceId,T.originalTargetId,T.newTargetId,o)},this.deleteEndpoint=function(o,k,P){let T=typeof o=="string"?v[o]:o;return T&&l.deleteObject({endpoint:T,dontUpdateHover:k,deleteAttachedObjects:P}),l},this.deleteEveryEndpoint=function(){let o=l.setSuspendDrawing(!0);for(let P in f){let T=f[P];if(T&&T.length)for(let R=0,q=T.length;R<q;R++)l.deleteEndpoint(T[R],!0)}f={},_={},v={},L={},g={},l.anchorManager.reset();let k=l.getDragManager();return k&&k.reset(),o||l.setSuspendDrawing(!1),l};var K=function(o,k,P){let T=l.Defaults.ConnectionType||l.getDefaultConnectionType(),R=o.constructor===T,q=R?{connection:o,source:o.source,target:o.target,sourceId:o.sourceId,targetId:o.targetId,sourceEndpoint:o.endpoints[0],targetEndpoint:o.endpoints[1]}:o;k&&l.fire("connectionDetached",q,P),l.fire("internal.connectionDetached",q,P),l.anchorManager.connectionDetached(q)},tt=l.fireMoveEvent=function(o,k){l.fire("connectionMoved",o,k)};this.unregisterEndpoint=function(o){o._jsPlumb.uuid&&(v[o._jsPlumb.uuid]=null),l.anchorManager.deleteEndpoint(o);for(let k in f){let P=f[k];if(P){let T=[];for(let R=0,q=P.length;R<q;R++)P[R]!==o&&T.push(P[R]);f[k]=T}f[k].length<1&&delete f[k]}};let et="isDetachAllowed",lt="beforeDetach",yt="checkCondition";this.deleteConnection=function(o,k){return o!=null&&(k=k||{},k.force||c.functionChain(!0,!1,[[o.endpoints[0],et,[o]],[o.endpoints[1],et,[o]],[o,et,[o]],[l,yt,[lt,o]]]))?(o.setHover(!1),K(o,!o.pending&&k.fireEvent!==!1,k.originalEvent),o.endpoints[0].detachFromConnection(o),o.endpoints[1].detachFromConnection(o),c.removeWithFunction(M,function(P){return o.id===P.id}),o.cleanup(),o.destroy(),!0):!1},this.deleteEveryConnection=function(o){o=o||{};let k=M.length,P=0;return l.batch(function(){for(let T=0;T<k;T++)P+=l.deleteConnection(M[0],o)?1:0}),P},this.deleteConnectionsForElement=function(o,k){k=k||{},o=l.getElement(o);let P=ht(o),T=f[P];if(T&&T.length)for(let R=0,q=T.length;R<q;R++)T[R].deleteEveryConnection(k);return l},this.deleteObject=function(o){let k={endpoints:{},connections:{},endpointCount:0,connectionCount:0},P=o.deleteAttachedObjects!==!1,T=function(Z){Z!=null&&k.connections[Z.id]==null&&(!o.dontUpdateHover&&Z._jsPlumb!=null&&Z.setHover(!1),k.connections[Z.id]=Z,k.connectionCount++)},R=function(Z){if(Z!=null&&k.endpoints[Z.id]==null&&(!o.dontUpdateHover&&Z._jsPlumb!=null&&Z.setHover(!1),k.endpoints[Z.id]=Z,k.endpointCount++,P))for(let st=0;st<Z.connections.length;st++){let nt=Z.connections[st];T(nt)}};o.connection?T(o.connection):R(o.endpoint);for(let Z in k.connections){var q=k.connections[Z];if(q._jsPlumb){c.removeWithFunction(M,function(nt){return q.id===nt.id}),K(q,o.fireEvent===!1?!1:!q.pending,o.originalEvent);let st=o.deleteAttachedObjects==null?null:!o.deleteAttachedObjects;q.endpoints[0].detachFromConnection(q,null,st),q.endpoints[1].detachFromConnection(q,null,st),q.cleanup(!0),q.destroy(!0)}}for(let Z in k.endpoints){let st=k.endpoints[Z];st._jsPlumb&&(l.unregisterEndpoint(st),st.cleanup(!0),st.destroy(!0))}return k};let Dt=function(o,k,P,T){for(let R=0,q=o.length;R<q;R++)o[R][k].apply(o[R],P);return T(o)},Mt=function(o,k,P){let T=[];for(let R=0,q=o.length;R<q;R++)T.push([o[R][k].apply(o[R],P),o[R]]);return T},Bt=function(o,k,P){return function(){return Dt(o,k,arguments,P)}},le=function(o,k){return function(){return Mt(o,k,arguments)}},zt=function(o,k){let P=[];if(o)if(typeof o=="string"){if(o==="*")return o;P.push(o)}else if(k)P=o;else if(o.length)for(let T=0,R=o.length;T<R;T++)P.push(b(o[T]).id);else P.push(b(o).id);return P},qt=function(o,k,P){return o==="*"?!0:o.length>0?o.indexOf(k)!==-1:!P};this.getConnections=function(o,k){o?o.constructor===String&&(o={scope:o}):o={};let P=o.scope||l.getDefaultScope(),T=zt(P,!0),R=zt(o.source),q=zt(o.target),Z=!k&&T.length>1?{}:[],st=function(nt,dt){if(!k&&T.length>1){let at=Z[nt];at==null&&(at=Z[nt]=[]),at.push(dt)}else Z.push(dt)};for(let nt=0,dt=M.length;nt<dt;nt++){let at=M[nt],_t=at.proxies&&at.proxies[0]?at.proxies[0].originalEp.elementId:at.sourceId,jt=at.proxies&&at.proxies[1]?at.proxies[1].originalEp.elementId:at.targetId;qt(T,at.scope)&&qt(R,_t)&&qt(q,jt)&&st(at.scope,at)}return Z};let Pe=function(o,k){return function(P){for(let T=0,R=o.length;T<R;T++)P(o[T]);return k(o)}},de=function(o){return function(k){return o[k]}},Ce=function(o,k){let P={length:o.length,each:Pe(o,k),get:de(o)},T=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],R=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],q,Z;for(q=0,Z=T.length;q<Z;q++)P[T[q]]=Bt(o,T[q],k);for(q=0,Z=R.length;q<Z;q++)P[R[q]]=le(o,R[q]);return P},Ht=function(o){let k=Ce(o,Ht);return I.extend(k,{setDetachable:Bt(o,"setDetachable",Ht),setReattach:Bt(o,"setReattach",Ht),setConnector:Bt(o,"setConnector",Ht),delete:function(){for(let P=0,T=o.length;P<T;P++)l.deleteConnection(o[P])},isDetachable:le(o,"isDetachable"),isReattach:le(o,"isReattach")})},fe=function(o){let k=Ce(o,fe);return I.extend(k,{setEnabled:Bt(o,"setEnabled",fe),setAnchor:Bt(o,"setAnchor",fe),isEnabled:le(o,"isEnabled"),deleteEveryConnection:function(){for(let P=0,T=o.length;P<T;P++)o[P].deleteEveryConnection()},delete:function(){for(let P=0,T=o.length;P<T;P++)l.deleteEndpoint(o[P])}})};this.select=function(o){return o=o||{},o.scope=o.scope||"*",Ht(o.connections||l.getConnections(o,!0))},this.selectEndpoints=function(o){o=o||{},o.scope=o.scope||"*";let k=!o.element&&!o.source&&!o.target,P=k?"*":zt(o.element),T=k?"*":zt(o.source),R=k?"*":zt(o.target),q=zt(o.scope,!0),Z=[];for(let st in f){let nt=qt(P,st,!0),dt=qt(T,st,!0),at=T!=="*",_t=qt(R,st,!0),jt=R!=="*";if(nt||dt||_t)t:for(let Gt=0,xe=f[st].length;Gt<xe;Gt++){let ue=f[st][Gt];if(qt(q,ue.scope,!0)){let Wt=at&&T.length>0&&!ue.isSource,Ee=jt&&R.length>0&&!ue.isTarget;if(Wt||Ee)continue t;Z.push(ue)}}}return fe(Z)},this.getAllConnections=function(){return M},this.getDefaultScope=function(){return i},this.getEndpoint=B,this.getEndpoints=function(o){return f[b(o).id]||[]},this.getDefaultEndpointType=function(){return I.Endpoint},this.getDefaultConnectionType=function(){return I.Connection},this.getId=ht,this.draw=w,this.info=b,this.appendElement=C;let re=!1;this.isHoverSuspended=function(){return re},this.setHoverSuspended=function(o){re=o},this.hide=function(o,k){return rt(o,"none",k),l},this.idstamp=d;var ae=function(o){if(!n&&o){let k=l.getElement(o);k.offsetParent&&l.setContainer(k.offsetParent)}};let Lt=function(){l.Defaults.Container&&l.setContainer(l.Defaults.Container)};var Yt=l.manage=function(o,k,P){return _[o]||(_[o]={el:k,endpoints:[],connections:[]},_[o].info=It({elId:o,timestamp:F}),l.addClass(k,"jtk-managed"),P||l.fire("manageElement",{id:o,info:_[o].info,el:k})),_[o]};l.unmanage=function(o){if(_[o]){let k=_[o].el;l.removeClass(k,"jtk-managed"),delete _[o],l.fire("unmanageElement",{id:o,el:k})}};var It=function(o){let k=o.timestamp,P=o.recalc,T=o.offset,R=o.elId,q;return A&&!k&&(k=F),!P&&k&&k===g[R]?{o:o.offset||L[R],s:m[R]}:(P||!T&&L[R]==null?(q=_[R]?_[R].el:null,q!=null&&(m[R]=l.getSize(q),L[R]=l.getOffset(q),g[R]=k)):(L[R]=T||L[R],m[R]==null&&(q=_[R].el,q!=null&&(m[R]=l.getSize(q))),g[R]=k),L[R]&&!L[R].right&&(L[R].right=L[R].left+m[R][0],L[R].bottom=L[R].top+m[R][1],L[R].width=m[R][0],L[R].height=m[R][1],L[R].centerx=L[R].left+L[R].width/2,L[R].centery=L[R].top+L[R].height/2),{o:L[R],s:m[R]})};this.updateOffset=It,this.init=(function(){D||(Lt(),l.anchorManager=new X.jsPlumb.AnchorManager({jsPlumbInstance:l}),D=!0,l.fire("ready",l))}).bind(this),this.log=h,this.jsPlumbUIComponent=t,this.makeAnchor=function(){let o,k=function(q,Z){if(X.jsPlumb.Anchors[q])return new X.jsPlumb.Anchors[q](Z);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+q+"'"}};if(arguments.length===0)return null;let P=arguments[0],T=arguments[1],R=null;if(P.compute&&P.getOrientation)return P;if(typeof P=="string")R=k(arguments[0],{elementId:T,jsPlumbInstance:l});else if(c.isArray(P))if(c.isArray(P[0])||c.isString(P[0]))P.length===2&&c.isObject(P[1])?c.isString(P[0])?(o=X.jsPlumb.extend({elementId:T,jsPlumbInstance:l},P[1]),R=k(P[0],o)):(o=X.jsPlumb.extend({elementId:T,jsPlumbInstance:l,anchors:P[0]},P[1]),R=new X.jsPlumb.DynamicAnchor(o)):R=new I.DynamicAnchor({anchors:P,selector:null,elementId:T,jsPlumbInstance:l});else{let q={x:P[0],y:P[1],orientation:P.length>=4?[P[2],P[3]]:[0,0],offsets:P.length>=6?[P[4],P[5]]:[0,0],elementId:T,jsPlumbInstance:l,cssClass:P.length===7?P[6]:null};R=new X.jsPlumb.Anchor(q),R.clone=function(){return new X.jsPlumb.Anchor(q)}}return R.id||(R.id="anchor_"+d()),R},this.makeAnchors=function(o,k,P){let T=[];for(let R=0,q=o.length;R<q;R++)typeof o[R]=="string"?T.push(X.jsPlumb.Anchors[o[R]]({elementId:k,jsPlumbInstance:P})):c.isArray(o[R])&&T.push(l.makeAnchor(o[R],k,P));return T},this.makeDynamicAnchor=function(o,k){return new X.jsPlumb.DynamicAnchor({anchors:o,selector:k,elementId:null,jsPlumbInstance:l})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};let te=function(o,k,P,T,R){let q=o.target||o.srcElement,Z=!1,st=T.getSelector(k,P);for(let nt=0;nt<st.length;nt++)if(st[nt]===q){Z=!0;break}return R?!Z:Z},ee=function(o,k,P,T,R){let q=new t(k),Z=k._jsPlumb.EndpointDropHandler({jsPlumb:l,enabled:function(){return o.def.enabled},isFull:function(){let nt=l.select({target:o.id}).length;return o.def.maxConnections>0&&nt>=o.def.maxConnections},element:o.el,elementId:o.id,isSource:T,isTarget:R,addClass:function(nt){l.addClass(o.el,nt)},removeClass:function(nt){l.removeClass(o.el,nt)},onDrop:function(nt){nt.endpoints[0].anchor.unlock()},isDropAllowed:function(){return q.isDropAllowed.apply(q,arguments)},isRedrop:function(nt){return nt.suspendedElement!=null&&nt.suspendedEndpoint!=null&&nt.suspendedEndpoint.element===o.el},getEndpoint:function(nt){let dt=o.def.endpoint;if(dt==null||dt._jsPlumb==null){let at=l.deriveEndpointAndAnchorSpec(nt.getType().join(" "),!0),_t=at.endpoints?X.jsPlumb.extend(k,{endpoint:o.def.def.endpoint||at.endpoints[1]}):k;at.anchors&&(_t=X.jsPlumb.extend(_t,{anchor:o.def.def.anchor||at.anchors[1]})),dt=l.addEndpoint(o.el,_t),dt._mtNew=!0}if(k.uniqueEndpoint&&(o.def.endpoint=dt),dt.setDeleteOnEmpty(!0),nt.isDetachable()&&dt.initDraggable(),dt.anchor.positionFinder!=null){let at=l.getUIPosition(arguments,l.getZoom()),_t=l.getOffset(o.el),jt=l.getSize(o.el),Gt=at==null?[0,0]:dt.anchor.positionFinder(at,_t,jt,dt.anchor.constructorParams);dt.anchor.x=Gt[0],dt.anchor.y=Gt[1]}return dt},maybeCleanup:function(nt){nt._mtNew&&nt.connections.length===0?l.deleteObject({endpoint:nt}):delete nt._mtNew}}),st=X.jsPlumb.dragEvents.drop;return P.scope=P.scope||k.scope||l.Defaults.Scope,P[st]=c.wrap(P[st],Z,!0),P.rank=k.rank||0,R&&(P[X.jsPlumb.dragEvents.over]=function(){return!0}),k.allowLoopback===!1&&(P.canDrop=function(nt){return nt.getDragElement()._jsPlumbRelatedElement!==o.el}),l.initDroppable(o.el,P,"internal"),Z};this.makeTarget=function(o,k,P){let T=X.jsPlumb.extend({_jsPlumb:this},P);X.jsPlumb.extend(T,k);let R=T.maxConnections||-1,q=(function(st){let nt=b(st),dt=nt.id,at=X.jsPlumb.extend({},T.dropOptions||{}),_t=T.connectionType||"default";this.targetEndpointDefinitions[dt]=this.targetEndpointDefinitions[dt]||{},ae(dt),nt.el._isJsPlumbGroup&&at.rank==null&&(at.rank=-1);let jt={def:X.jsPlumb.extend({},T),uniqueEndpoint:T.uniqueEndpoint,maxConnections:R,enabled:!0};T.createEndpoint&&(jt.uniqueEndpoint=!0,jt.endpoint=l.addEndpoint(st,jt.def),jt.endpoint.setDeleteOnEmpty(!1)),nt.def=jt,this.targetEndpointDefinitions[dt][_t]=jt,ee(nt,T,at,T.isSource===!0,!0),nt.el._katavorioDrop[nt.el._katavorioDrop.length-1].targetDef=jt}).bind(this),Z=o.length&&o.constructor!==String?o:[o];for(let st=0,nt=Z.length;st<nt;st++)q(Z[st]);return this},this.unmakeTarget=function(o,k){let P=b(o);return l.destroyDroppable(P.el,"internal"),k||delete this.targetEndpointDefinitions[P.id],this},this.makeSource=function(o,k,P){let T=X.jsPlumb.extend({_jsPlumb:this},P);X.jsPlumb.extend(T,k);let R=T.connectionType||"default",q=l.deriveEndpointAndAnchorSpec(R);T.endpoint=T.endpoint||q.endpoints[0],T.anchor=T.anchor||q.anchors[0];let Z=T.maxConnections||-1,st=T.onMaxConnections,nt=(function(at){let _t=at.id,jt=this.getElement(at.el);this.sourceEndpointDefinitions[_t]=this.sourceEndpointDefinitions[_t]||{},ae(_t);let Gt={def:X.jsPlumb.extend({},T),uniqueEndpoint:T.uniqueEndpoint,maxConnections:Z,enabled:!0};T.createEndpoint&&(Gt.uniqueEndpoint=!0,Gt.endpoint=l.addEndpoint(o,Gt.def),Gt.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[_t][R]=Gt,at.def=Gt;let xe=X.jsPlumb.dragEvents.stop,ue=X.jsPlumb.dragEvents.drag,Wt=X.jsPlumb.extend({},T.dragOptions||{}),Ee=Wt.drag,Ne=Wt.stop,Tt=null,Se=!1;Wt.scope=Wt.scope||T.scope,Wt[ue]=c.wrap(Wt[ue],function(){Ee&&Ee.apply(this,arguments),Se=!1}),Wt[xe]=c.wrap(Wt[xe],(function(){if(Ne&&Ne.apply(this,arguments),this.currentlyDragging=!1,Tt._jsPlumb!=null){let Vt=T.anchor||this.Defaults.Anchor,Ft=Tt.anchor,De=Tt.connections[0],Kt=this.makeAnchor(Vt,_t,this),Qt=Tt.element;if(Kt.positionFinder!=null){let ne=l.getOffset(Qt),pe=this.getSize(Qt),ve={left:ne.left+Ft.x*pe[0],top:ne.top+Ft.y*pe[1]},_e=Kt.positionFinder(ve,ne,pe,Kt.constructorParams);Kt.x=_e[0],Kt.y=_e[1]}Tt.setAnchor(Kt,!0),Tt.repaint(),this.repaint(Tt.elementId),De!=null&&this.repaint(De.targetId)}}).bind(this));let Ge=(function(Vt){if(Vt.which===3||Vt.button===2)return;let Ft=this.sourceEndpointDefinitions[_t][R];if(!Ft.enabled||(_t=this.getId(this.getElement(at.el)),T.filter&&(c.isString(T.filter)?te(Vt,at.el,T.filter,this,T.filterExclude):T.filter(Vt,at.el))===!1))return;let De=this.select({source:_t}).length;if(Ft.maxConnections>=0&&De>=Ft.maxConnections)return st&&st({element:at.el,maxConnections:Z},Vt),!1;let Kt=X.jsPlumb.getPositionOnElement(Vt,jt,O),Qt={};X.jsPlumb.extend(Qt,Ft.def),Qt.isTemporarySource=!0,Qt.anchor=[Kt[0],Kt[1],0,0],Qt.dragOptions=Wt,Ft.def.scope&&(Qt.scope=Ft.def.scope),Tt=this.addEndpoint(_t,Qt),Se=!0,Tt.setDeleteOnEmpty(!0),Ft.uniqueEndpoint&&(Ft.endpoint?Tt.finalEndpoint=Ft.endpoint:(Ft.endpoint=Tt,Tt.setDeleteOnEmpty(!1)));let ne=function(){l.off(Tt.canvas,"mouseup",ne),l.off(at.el,"mouseup",ne),Se&&(Se=!1,l.deleteEndpoint(Tt))};l.on(Tt.canvas,"mouseup",ne),l.on(at.el,"mouseup",ne);let pe={};if(Ft.def.extract)for(let ve in Ft.def.extract){let _e=(Vt.srcElement||Vt.target).getAttribute(ve);_e&&(pe[Ft.def.extract[ve]]=_e)}l.trigger(Tt.canvas,"mousedown",Vt,pe),c.consume(Vt)}).bind(this);this.on(at.el,"mousedown",Ge),Gt.trigger=Ge,T.filter&&(c.isString(T.filter)||c.isFunction(T.filter))&&l.setDragFilter(at.el,T.filter);let Ve=X.jsPlumb.extend({},T.dropOptions||{});ee(at,T,Ve,!0,T.isTarget===!0)}).bind(this),dt=o.length&&o.constructor!==String?o:[o];for(let at=0,_t=dt.length;at<_t;at++)nt(b(dt[at]));return this},this.unmakeSource=function(o,k,P){let T=b(o);l.destroyDroppable(T.el,"internal");let R=this.sourceEndpointDefinitions[T.id];if(R){for(let q in R)if(k==null||k===q){let Z=R[q].trigger;Z&&l.off(T.el,"mousedown",Z),P||delete this.sourceEndpointDefinitions[T.id][q]}}return this},this.unmakeEverySource=function(){for(let o in this.sourceEndpointDefinitions)l.unmakeSource(o,null,!0);return this.sourceEndpointDefinitions={},this};let it=(function(o,k,P){k=c.isArray(k)?k:[k];let T=ht(o);P=P||"default";for(let R=0;R<k.length;R++){let q=this[k[R]][T];if(q&&q[P])return q[P].def.scope||this.Defaults.Scope}}).bind(this),vt=(function(o,k,P,T){P=c.isArray(P)?P:[P];let R=ht(o);T=T||"default";for(let q=0;q<P.length;q++){let Z=this[P[q]][R];Z&&Z[T]&&(Z[T].def.scope=k)}}).bind(this);this.getScope=function(o,k){return it(o,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(o){return it(o,"sourceEndpointDefinitions")},this.getTargetScope=function(o){return it(o,"targetEndpointDefinitions")},this.setScope=function(o,k,P){this.setSourceScope(o,k,P),this.setTargetScope(o,k,P)},this.setSourceScope=function(o,k,P){vt(o,k,"sourceEndpointDefinitions",P),this.setDragScope(o,k)},this.setTargetScope=function(o,k,P){vt(o,k,"targetEndpointDefinitions",P),this.setDropScope(o,k)},this.unmakeEveryTarget=function(){for(let o in this.targetEndpointDefinitions)l.unmakeTarget(o,!0);return this.targetEndpointDefinitions={},this};let Pt=(function(o,k,P,T,R){let q=o==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,Z,st,nt;if(R=R||"default",k.length&&!c.isString(k)){Z=[];for(let dt=0,at=k.length;dt<at;dt++)st=b(k[dt]),q[st.id]&&q[st.id][R]&&(Z[dt]=q[st.id][R].enabled,nt=T?!Z[dt]:P,q[st.id][R].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}else{st=b(k);let dt=st.id;q[dt]&&q[dt][R]&&(Z=q[dt][R].enabled,nt=T?!Z:P,q[dt][R].enabled=nt,l[nt?"removeClass":"addClass"](st.el,"jtk-"+o+"-disabled"))}return Z}).bind(this),gt=(function(o,k){if(c.isString(o)||!o.length)return k.apply(this,[o]);if(o.length)return k.apply(this,[o[0]])}).bind(this);this.toggleSourceEnabled=function(o,k){return Pt("source",o,null,!0,k),this.isSourceEnabled(o,k)},this.setSourceEnabled=function(o,k,P){return Pt("source",o,k,null,P)},this.isSource=function(o,k){return k=k||"default",gt(o,(function(P){let T=this.sourceEndpointDefinitions[b(P).id];return T!=null&&T[k]!=null}).bind(this))},this.isSourceEnabled=function(o,k){return k=k||"default",gt(o,(function(P){let T=this.sourceEndpointDefinitions[b(P).id];return T&&T[k]&&T[k].enabled===!0}).bind(this))},this.toggleTargetEnabled=function(o,k){return Pt("target",o,null,!0,k),this.isTargetEnabled(o,k)},this.isTarget=function(o,k){return k=k||"default",gt(o,(function(P){let T=this.targetEndpointDefinitions[b(P).id];return T!=null&&T[k]!=null}).bind(this))},this.isTargetEnabled=function(o,k){return k=k||"default",gt(o,(function(P){let T=this.targetEndpointDefinitions[b(P).id];return T&&T[k]&&T[k].enabled===!0}).bind(this))},this.setTargetEnabled=function(o,k,P){return Pt("target",o,k,null,P)},this.ready=function(o){l.bind("ready",o)};let St=function(o,k){if(typeof o=="object"&&o.length)for(let P=0,T=o.length;P<T;P++)k(o[P]);else k(o);return l};this.repaint=function(o,k,P){return St(o,function(T){w(T,k,P)})},this.revalidate=function(o,k,P){return St(o,function(T){let R=P?T:l.getId(T);l.updateOffset({elId:R,recalc:!0,timestamp:k});let q=l.getDragManager();q&&q.updateOffsets(R),l.repaint(T)})},this.repaintEverything=function(){let o=H(),k;for(k in f)l.updateOffset({elId:k,recalc:!0,timestamp:o});for(k in f)w(k,null,o);return this},this.removeAllEndpoints=function(o,k,P){P=P||[];let T=function(R){let q=b(R),Z=f[q.id],st,nt;if(Z)for(P.push(q),st=0,nt=Z.length;st<nt;st++)l.deleteEndpoint(Z[st],!1);if(delete f[q.id],k&&q.el&&q.el.nodeType!==3&&q.el.nodeType!==8)for(st=0,nt=q.el.childNodes.length;st<nt;st++)T(q.el.childNodes[st])};return T(o),this};let kt=function(o,k){l.removeAllEndpoints(o.id,!0,k);let P=l.getDragManager(),T=function(R){P&&P.elementRemoved(R.id),l.anchorManager.clearFor(R.id),l.anchorManager.removeFloatingConnection(R.id),l.isSource(R.el)&&l.unmakeSource(R.el),l.isTarget(R.el)&&l.unmakeTarget(R.el),l.destroyDraggable(R.el),l.destroyDroppable(R.el),delete l.floatingConnections[R.id],delete _[R.id],delete L[R.id],R.el&&(l.removeElement(R.el),R.el._jsPlumb=null)};for(let R=1;R<k.length;R++)T(k[R]);T(o)};this.remove=function(o,k){let P=b(o),T=[];return P.text&&P.el.parentNode?P.el.parentNode.removeChild(P.el):P.id&&l.batch(function(){kt(P,T)},k===!0),l},this.empty=function(o,k){let P=[],T=function(R,q){let Z=b(R);if(Z.text)Z.el.parentNode.removeChild(Z.el);else if(Z.el){for(;Z.el.childNodes.length>0;)T(Z.el.childNodes[0]);q||kt(Z,P)}};return l.batch(function(){T(o,!0)},k===!1),l},this.reset=function(o){l.silently((function(){re=!1,l.removeAllGroups(),l.removeGroupManager(),l.deleteEveryEndpoint(),o||l.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},M.length=0,this.doReset&&this.doReset()}).bind(this))};let Xt=function(o){o.canvas&&o.canvas.parentNode&&o.canvas.parentNode.removeChild(o.canvas),o.cleanup(),o.destroy()};this.clear=function(){l.select().each(Xt),l.selectEndpoints().each(Xt),f={},v={}},this.setDefaultScope=function(o){return i=o,l},this.deriveEndpointAndAnchorSpec=function(o,k){let P=((k?"":"default ")+o).split(/[\s]/),T=null,R=null,q=null,Z=null;for(let st=0;st<P.length;st++){let nt=l.getType(P[st],"connection");nt&&(nt.endpoints&&(T=nt.endpoints),nt.endpoint&&(R=nt.endpoint),nt.anchors&&(Z=nt.anchors),nt.anchor&&(q=nt.anchor))}return{endpoints:T||[R,R],anchors:Z||[q,q]}},this.setId=function(o,k,P){let T;c.isString(o)?T=o:(o=this.getElement(o),T=this.getId(o));let R=this.getConnections({source:T,scope:"*"},!0),q=this.getConnections({target:T,scope:"*"},!0);k=""+k,P?o=this.getElement(k):(o=this.getElement(T),this.setAttribute(o,"id",k)),f[k]=f[T]||[];for(let nt=0,dt=f[k].length;nt<dt;nt++)f[k][nt].setElementId(k),f[k][nt].setReferenceElement(o);delete f[T],this.sourceEndpointDefinitions[k]=this.sourceEndpointDefinitions[T],delete this.sourceEndpointDefinitions[T],this.targetEndpointDefinitions[k]=this.targetEndpointDefinitions[T],delete this.targetEndpointDefinitions[T],this.anchorManager.changeId(T,k);let Z=this.getDragManager();Z&&Z.changeId(T,k),_[k]=_[T],delete _[T];let st=function(nt,dt,at){for(let _t=0,jt=nt.length;_t<jt;_t++)nt[_t].endpoints[dt].setElementId(k),nt[_t].endpoints[dt].setReferenceElement(o),nt[_t][at+"Id"]=k,nt[_t][at]=o};st(R,0,"source"),st(q,1,"target"),this.repaint(k)},this.setDebugLog=function(o){h=o},this.setSuspendDrawing=function(o,k){let P=A;return A=o,o?F=new Date().getTime():F=null,k&&this.repaintEverything(),P},this.isSuspendDrawing=function(){return A},this.getSuspendedAt=function(){return F},this.batch=function(o,k){let P=this.isSuspendDrawing();P||this.setSuspendDrawing(!0);try{o()}catch(T){c.log("Function run while suspended failed",T)}P||this.setSuspendDrawing(!1,!k)},this.doWhileSuspended=this.batch,this.getCachedData=ut,this.timestamp=H,this.show=function(o,k){return rt(o,"block",k),l},this.toggleVisible=ft,this.addListener=this.bind;let $t=[];this.registerFloatingConnection=function(o,k,P){$t[o.id]=k,c.addToList(f,o.id,P)},this.getFloatingConnectionFor=function(o){return $t[o]},this.listManager=new X.jsPlumbListManager(this)};c.extend(X.jsPlumbInstance,c.EventGenerator,{setAttribute:function(s,l,N){this.setAttribute(s,l,N)},getAttribute:function(s,l){return this.getAttribute(X.jsPlumb.getElement(s),l)},convertToFullOverlaySpec:function(s){return c.isString(s)&&(s=[s,{}]),s[1].id=s[1].id||c.uuid(),s},registerConnectionType:function(s,l){if(this._connectionTypes[s]=X.jsPlumb.extend({},l),l.overlays){let N={};for(let G=0;G<l.overlays.length;G++){let U=this.convertToFullOverlaySpec(l.overlays[G]);N[U[1].id]=U}this._connectionTypes[s].overlays=N}},registerConnectionTypes:function(s){for(let l in s)this.registerConnectionType(l,s[l])},registerEndpointType:function(s,l){if(this._endpointTypes[s]=X.jsPlumb.extend({},l),l.overlays){let N={};for(let G=0;G<l.overlays.length;G++){let U=this.convertToFullOverlaySpec(l.overlays[G]);N[U[1].id]=U}this._endpointTypes[s].overlays=N}},registerEndpointTypes:function(s){for(let l in s)this.registerEndpointType(l,s[l])},getType:function(s,l){return l==="connection"?this._connectionTypes[s]:this._endpointTypes[s]},setIdChanged:function(s,l){this.setId(s,l,!0)},setParent:function(s,l){let N=this.getElement(s),G=this.getId(N),U=this.getElement(l),O=this.getId(U),b=this.getDragManager();N.parentNode.removeChild(N),U.appendChild(N),b&&b.setParent(N,G,U,O)},extend:function(s,l,N){let G;if(N)for(G=0;G<N.length;G++)s[N[G]]=l[N[G]];else for(G in l)s[G]=l[G];return s},floatingConnections:{},getFloatingAnchorIndex:function(s){return s.endpoints[0].isFloating()?0:s.endpoints[1].isFloating()?1:-1},proxyConnection:function(s,l,N,G,U,O){let b,n=s.endpoints[l].elementId,y=s.endpoints[l];s.proxies=s.proxies||[],s.proxies[l]?b=s.proxies[l].ep:b=this.addEndpoint(N,{endpoint:U(s,l),anchor:O(s,l),parameters:{isProxyEndpoint:!0}}),b.setDeleteOnEmpty(!0),s.proxies[l]={ep:b,originalEp:y},l===0?this.anchorManager.sourceChanged(n,G,s,N):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,n,G,s),s.target=N,s.targetId=G),y.detachFromConnection(s,null,!0),b.connections=[s],s.endpoints[l]=b,y.setVisible(!1),s.setVisible(!0),this.revalidate(N)},unproxyConnection:function(s,l,N){if(s._jsPlumb==null||s.proxies==null||s.proxies[l]==null)return;let G=s.proxies[l].originalEp.element,U=s.proxies[l].originalEp.elementId;s.endpoints[l]=s.proxies[l].originalEp,l===0?this.anchorManager.sourceChanged(N,U,s,G):(this.anchorManager.updateOtherEndpoint(s.endpoints[0].elementId,N,U,s),s.target=G,s.targetId=U),s.proxies[l].ep.detachFromConnection(s,null),s.proxies[l].originalEp.addConnection(s),s.isVisible()&&s.proxies[l].originalEp.setVisible(!0),delete s.proxies[l]}});var I=new S;X.jsPlumb=I,I.getInstance=function(s,l){let N=new S(s);if(l)for(let G in l)N[G]=l[G];return N.init(),N},I.each=function(s,l){if(s!=null)if(typeof s=="string")l(I.getElement(s));else if(s.length!=null)for(let N=0;N<s.length;N++)l(I.getElement(s[N]));else l(s)},typeof exports<"u"&&(exports.jsPlumb=I)}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q="__label",J=function(r,E){let a={cssClass:E.cssClass,labelStyle:r.labelStyle,id:Q,component:r,_jsPlumb:r._jsPlumb.instance},t=c.extend(a,E);return new c.Overlays[r._jsPlumb.instance.getRenderMode()].Label(t)},W=function(r,E){let a=null;if(H.isArray(E)){let t=E[0],p=c.extend({component:r,_jsPlumb:r._jsPlumb.instance},E[1]);E.length===3&&c.extend(p,E[2]),a=new c.Overlays[r._jsPlumb.instance.getRenderMode()][t](p)}else E.constructor===String?a=new c.Overlays[r._jsPlumb.instance.getRenderMode()][E]({component:r,_jsPlumb:r._jsPlumb.instance}):a=E;return a.id=a.id||H.uuid(),r.cacheTypeItem("overlay",a,a.id),r._jsPlumb.overlays[a.id]=a,a};c.OverlayCapableJsPlumbUIComponent=function(r){X.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},r.label?this.getDefaultType().overlays[Q]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:Q}]:r.id&&(this.getDefaultType().overlays[Q]=["Label",{label:r.label,location:r.labelLocation||this.defaultLabelLocation||.5,labelStyle:r.emptyLabelStyle||this._jsPlumb.instance.Defaults.emptyLabelStyle,id:Q}]),this.setListenerComponent=function(E){if(this._jsPlumb)for(let a in this._jsPlumb.overlays)this._jsPlumb.overlays[a].setListenerComponent(E)}},c.OverlayCapableJsPlumbUIComponent.applyType=function(r,E){if(E.overlays){let a={},t;for(t in E.overlays){let p=r._jsPlumb.overlays[E.overlays[t][1].id];if(p)p.updateFrom(E.overlays[t][1]),a[E.overlays[t][1].id]=!0;else{let x=r.getCachedTypeItem("overlay",E.overlays[t][1].id);x!=null?(x.reattach(r._jsPlumb.instance,r),x.setVisible(!0),x.updateFrom(E.overlays[t][1]),r._jsPlumb.overlays[x.id]=x):x=r.addOverlay(E.overlays[t],!0),a[x.id]=!0}}for(t in r._jsPlumb.overlays)a[r._jsPlumb.overlays[t].id]==null&&r.removeOverlay(r._jsPlumb.overlays[t].id,!0)}},H.extend(c.OverlayCapableJsPlumbUIComponent,X.jsPlumbUIComponent,{setHover:function(r,E){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(let a in this._jsPlumb.overlays)this._jsPlumb.overlays[a][r?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(r,E){let a=W(this,r);if(this.getData&&a.type==="Label"&&H.isArray(r)){let t=this.getData(),p=r[1];if(t){let x=p.labelLocationAttribute||"labelLocation",j=t?t[x]:null;j&&(a.loc=j)}}return E||this.repaint(),a},getOverlay:function(r){return this._jsPlumb.overlays[r]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(r){let E=this.getOverlay(r);E&&E.hide()},hideOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].hide()},showOverlay:function(r){let E=this.getOverlay(r);E&&E.show()},showOverlays:function(){for(let r in this._jsPlumb.overlays)this._jsPlumb.overlays[r].show()},removeAllOverlays:function(r){for(let E in this._jsPlumb.overlays)this._jsPlumb.overlays[E].cleanup&&this._jsPlumb.overlays[E].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},r||this.repaint()},removeOverlay:function(r,E){let a=this._jsPlumb.overlays[r];a&&(a.setVisible(!1),!E&&a.cleanup&&a.cleanup(),delete this._jsPlumb.overlays[r],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[r],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[r])},removeOverlays:function(){for(let r=0,E=arguments.length;r<E;r++)this.removeOverlay(arguments[r])},moveParent:function(r){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),r.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),r.appendChild(this.canvas);for(let E in this._jsPlumb.overlays)if(this._jsPlumb.overlays[E].isAppendedAtTopLevel){let a=this._jsPlumb.overlays[E].getElement();a.parentNode.removeChild(a),r.appendChild(a)}}},getLabel:function(){let r=this.getOverlay(Q);return r!=null?r.getLabel():null},getLabelOverlay:function(){return this.getOverlay(Q)},setLabel:function(r){let E=this.getOverlay(Q);if(E)r.constructor===String||r.constructor===Function?E.setLabel(r):(r.label||(r.label=""),E.setLabel(r.label),r.location&&E.setLocation(r.location));else{let a=r.constructor===String||r.constructor===Function?{label:r}:r;E=J(this,a),this._jsPlumb.overlays[Q]=E}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(r){for(let E in this._jsPlumb.overlays)this._jsPlumb.overlays[E].cleanup(r),this._jsPlumb.overlays[E].destroy(r);r&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(r){this[r?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(r,E){this._jsPlumb.overlayPositions[r.id]=E},getAbsoluteOverlayPosition:function(r){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[r.id]:null},_clazzManip:function(r,E,a){if(!a)for(let t in this._jsPlumb.overlays)this._jsPlumb.overlays[t][r+"Class"](E)},addClass:function(r,E){this._clazzManip("add",r,E)},removeClass:function(r,E){this._clazzManip("remove",r,E)}})}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=function(a,t,p){let x=!1;return{drag:function(){if(x)return x=!1,!0;if(t.element){let j=p.getUIPosition(arguments,p.getZoom());j!=null&&p.setPosition(t.element,j),p.repaint(t.element,j),a.paint({anchorPoint:a.anchor.getCurrentLocation({element:a})})}},stopDrag:function(){x=!0}}},J=function(a,t,p,x){let j=t.createElement("div",{position:"absolute"});t.appendElement(j);let S=t.getId(j);t.setPosition(j,p),j.style.width=x[0]+"px",j.style.height=x[1]+"px",t.manage(S,j,!0),a.id=S,a.element=j},W=function(a,t,p,x,j,S,I,s){let l=new c.FloatingAnchor({reference:t,referenceCanvas:x,jsPlumbInstance:S});return I({paintStyle:a,endpoint:p,anchor:l,source:j,scope:s})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],E=function(a,t){let p=0;if(t!=null){for(let x=0;x<a.connections.length;x++)if(a.connections[x].sourceId===t||a.connections[x].targetId===t){p=x;break}}return a.connections[p]};c.Endpoint=function(a){let t=a._jsPlumb,p=a.newConnection,x=a.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:a.connectionType,maxConnections:a.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:a.maxConnections,paintStyle:a.endpointStyle||a.paintStyle||a.style||this._jsPlumb.instance.Defaults.EndpointStyle||c.Defaults.EndpointStyle,hoverPaintStyle:a.endpointHoverStyle||a.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle,connectorStyle:a.connectorStyle,connectorHoverStyle:a.connectorHoverStyle,connectorClass:a.connectorClass,connectorHoverClass:a.connectorHoverClass,connectorOverlays:a.connectorOverlays,connector:a.connector,connectorTooltip:a.connectorTooltip}),this._jsPlumb.enabled=a.enabled!==!1,this._jsPlumb.visible=!0,this.element=c.getElement(a.source),this._jsPlumb.uuid=a.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(a.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=a.elementId,this.dragProxy=a.dragProxy,this._jsPlumb.connectionCost=a.connectionCost,this._jsPlumb.connectionsDirected=a.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};let j=a.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(O){j=O};let S=(function(){let O=t.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();let b=t.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(O),this.addClass(b),c.updateClasses(this.element,b,O)}).bind(this);this.prepareAnchor=function(O){let b=this._jsPlumb.instance.makeAnchor(O,this.elementId,t);return b.bind("anchorChanged",(function(n){this.fire("anchorChanged",{endpoint:this,anchor:n}),S()}).bind(this)),b},this.setPreparedAnchor=function(O,b){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=O,S(),b||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(O,b){let n=this.prepareAnchor(O);return this.setPreparedAnchor(n,b),this};let I=(function(O){if(this.connections.length>0)for(let b=0;b<this.connections.length;b++)this.connections[b].setHover(O,!1);else this.setHover(O)}).bind(this);this.bind("mouseover",function(){I(!0)}),this.bind("mouseout",function(){I(!1)}),a._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(O,b){let n=function(D,M){let f=t.getRenderMode();if(c.Endpoints[f][D])return new c.Endpoints[f][D](M);if(!t.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+D+"'"}},y={_jsPlumb:this._jsPlumb.instance,cssClass:a.cssClass,container:a.container,tooltip:a.tooltip,connectorTooltip:a.connectorTooltip,endpoint:this},h;return H.isString(O)?h=n(O,y):H.isArray(O)?(y=H.merge(O[1],y),h=n(O[0],y)):h=O.clone(),h.clone=(function(){if(H.isString(O))return n(O,y);if(H.isArray(O))return y=H.merge(O[1],y),n(O[0],y)}).bind(this),h.typeId=b,h},this.setEndpoint=function(O,b){let n=this.prepareEndpoint(O);this.setPreparedEndpoint(n,!0)},this.setPreparedEndpoint=function(O,b){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=O,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},c.extend(this,a,r),this.isSource=a.isSource||!1,this.isTemporarySource=a.isTemporarySource||!1,this.isTarget=a.isTarget||!1,this.connections=a.connections||[],this.connectorPointerEvents=a["connector-pointer-events"],this.scope=a.scope||t.getDefaultScope(),this.timestamp=null,this.reattachConnections=a.reattach||t.Defaults.ReattachConnections,this.connectionsDetachable=t.Defaults.ConnectionsDetachable,(a.connectionsDetachable===!1||a.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=a.dragAllowedWhenFull!==!1,a.onMaxConnections&&this.bind("maxConnections",a.onMaxConnections),this.addConnection=function(O){this.connections.push(O),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)},this.detachFromConnection=function(O,b,n){b=b??this.connections.indexOf(O),b>=0&&(this.connections.splice(b,1),this[(this.connections.length>0?"add":"remove")+"Class"](t.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](t.endpointFullClass)),!n&&j&&this.connections.length===0&&t.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:n!==!0})},this.deleteEveryConnection=function(O){let b=this.connections.length;for(let n=0;n<b;n++)t.deleteConnection(this.connections[0],O)},this.detachFrom=function(O,b,n){let y=[];for(let h=0;h<this.connections.length;h++)(this.connections[h].endpoints[1]===O||this.connections[h].endpoints[0]===O)&&y.push(this.connections[h]);for(let h=0,D=y.length;h<D;h++)t.deleteConnection(y[0]);return this},this.getElement=function(){return this.element},this.setElement=function(O){let b=this._jsPlumb.instance.getId(O),n=this.elementId;return H.removeWithFunction(a.endpointsByElement[this.elementId],(function(y){return y.id===this.id}).bind(this)),this.element=c.getElement(O),this.elementId=t.getId(this.element),t.anchorManager.rehomeEndpoint(this,n,this.element),t.dragManager.endpointAdded(this.element),H.addToList(a.endpointsByElement,b,this),this},this.makeInPlaceCopy=function(){let O=this.anchor.getCurrentLocation({element:this}),b=this.anchor.getOrientation(this),n=this.anchor.getCssClass(),y={bind:function(){},compute:function(){return[O[0],O[1]]},getCurrentLocation:function(){return[O[0],O[1]]},getOrientation:function(){return b},getCssClass:function(){return n}};return x({dropOptions:a.dropOptions,anchor:y,source:this.element,paintStyle:this.getPaintStyle(),endpoint:a.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(O){O=O||{};let b=O.timestamp,n=O.recalc!==!1;if(!b||this.timestamp!==b){let y=t.updateOffset({elId:this.elementId,timestamp:b}),h=O.offset?O.offset.o:y.o;if(h!=null){let D=O.anchorPoint,M=O.connectorPaintStyle;if(D==null){let f=O.dimensions||y.s,v={xy:[h.left,h.top],wh:f,element:this,timestamp:b};if(n&&this.anchor.isDynamic&&this.connections.length>0){let _=E(this,O.elementWithPrecedence),L=_.endpoints[0]===this?1:0,g=L===0?_.sourceId:_.targetId,u=t.getCachedData(g),m=u.o,A=u.s;v.index=L===0?1:0,v.connection=_,v.txy=[m.left,m.top],v.twh=A,v.tElement=_.endpoints[L]}else this.connections.length>0&&(v.connection=this.connections[0]);D=this.anchor.compute(v)}this.endpoint.compute(D,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,M||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=b;for(let f in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(f)){let v=this._jsPlumb.overlays[f];v.isVisible()&&(this._jsPlumb.overlayPlacements[f]=v.draw(this.endpoint,this._jsPlumb.paintStyleInUse),v.paint(this._jsPlumb.overlayPlacements[f]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;let s=!1;this.initDraggable=function(){if(!s&&c.isDragSupported(this.element)){let O={id:null,element:null},b=null,n=!1,y=null,h=Q(this,O,t),D=a.dragOptions||{},M={},f=c.dragEvents.start,v=c.dragEvents.stop,_=c.dragEvents.drag,L=c.dragEvents.beforeStart,g,u=function(F){g=F.e.payload||{}},m=(function(F){b=this.connectorSelector();let i=!0;this.isEnabled()||(i=!1),b==null&&!this.isSource&&!this.isTemporarySource&&(i=!1),this.isSource&&this.isFull()&&!(b!=null&&this.dragAllowedWhenFull)&&(i=!1),b!=null&&!b.isDetachable(this)&&(this.isFull()?i=!1:b=null);let e=t.checkCondition(b==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:b});if(e===!1?i=!1:typeof e=="object"?c.extend(e,g||{}):e=g||{},i===!1)return t.stopDrag&&t.stopDrag(this.canvas),h.stopDrag(),!1;for(let V=0;V<this.connections.length;V++)this.connections[V].setHover(!1);this.addClass("endpointDrag"),t.setConnectionBeingDragged(!0),b&&!this.isFull()&&this.isSource&&(b=null),t.updateOffset({elId:this.elementId});let d=this._jsPlumb.instance.getOffset(this.canvas),C=this.canvas,w=this._jsPlumb.instance.getSize(this.canvas);J(O,t,d,w),t.setAttributes(this.canvas,{dragId:O.id,elId:this.elementId});let B=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){let V=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);V.endpoints[1]&&(B=V.endpoints[1])}let z=this._jsPlumb.instance.makeAnchor("Center");z.isFloating=!0,this._jsPlumb.floatingEndpoint=W(this.getPaintStyle(),z,B,this.canvas,O.element,t,x,this.scope);let Y=this._jsPlumb.floatingEndpoint.anchor;if(b==null)this.setHover(!1,!1),b=p({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:O.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:a.connectorStyle,hoverPaintStyle:a.connectorHoverStyle,connector:a.connector,overlays:a.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:a.scope,data:e}),b.pending=!0,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.anchor=Y,t.fire("connectionDrag",b),t.anchorManager.newConnection(b);else{n=!0,b.setHover(!1);let V=b.endpoints[0].id===this.id?0:1;this.detachFromConnection(b,null,!0);let ot=t.getDragScope(C);t.setAttribute(this.canvas,"originalScope",ot),t.fire("connectionDrag",b),V===0?(y=[b.source,b.sourceId,C,ot],t.anchorManager.sourceChanged(b.endpoints[V].elementId,O.id,b,O.element)):(y=[b.target,b.targetId,C,ot],b.target=O.element,b.targetId=O.id,t.anchorManager.updateOtherEndpoint(b.sourceId,b.endpoints[V].elementId,b.targetId,b)),b.suspendedEndpoint=b.endpoints[V],b.suspendedElement=b.endpoints[V].getElement(),b.suspendedElementId=b.endpoints[V].elementId,b.suspendedElementType=V===0?"source":"target",b.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=b.suspendedEndpoint,b.endpoints[V]=this._jsPlumb.floatingEndpoint,b.addClass(t.draggingClass),this._jsPlumb.floatingEndpoint.addClass(t.draggingClass)}t.registerFloatingConnection(O,b,this._jsPlumb.floatingEndpoint),t.currentlyDragging=!0}).bind(this),A=(function(){if(t.setConnectionBeingDragged(!1),b&&b.endpoints!=null){let F=t.getDropEvent(arguments),i=t.getFloatingAnchorIndex(b);if(b.endpoints[i===0?1:0].anchor.unlock(),b.removeClass(t.draggingClass),this._jsPlumb&&(b.deleteConnectionNow||b.endpoints[i]===this._jsPlumb.floatingEndpoint)&&n&&b.suspendedEndpoint){i===0?(b.floatingElement=b.source,b.floatingId=b.sourceId,b.floatingEndpoint=b.endpoints[0],b.floatingIndex=0,b.source=y[0],b.sourceId=y[1]):(b.floatingElement=b.target,b.floatingId=b.targetId,b.floatingEndpoint=b.endpoints[1],b.floatingIndex=1,b.target=y[0],b.targetId=y[1]);let e=this._jsPlumb.floatingEndpoint;t.setDragScope(y[2],y[3]),b.endpoints[i]=b.suspendedEndpoint,b.isReattach()||b._forceReattach||b._forceDetach||!t.deleteConnection(b,{originalEvent:F})?(b.setHover(!1),b._forceDetach=null,b._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(b),b.suspendedEndpoint.addConnection(b),i===1?t.anchorManager.updateOtherEndpoint(b.sourceId,b.floatingId,b.targetId,b):t.anchorManager.sourceChanged(b.floatingId,b.sourceId,b,b.source),t.repaint(y[1])):t.deleteObject({endpoint:e})}this.deleteAfterDragStop?t.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),t.fire("connectionDragStop",b,F),b.pending&&t.fire("connectionAborted",b,F),t.currentlyDragging=!1,b.suspendedElement=null,b.suspendedEndpoint=null,b=null}O&&O.element&&t.remove(O.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.unlock(),this._jsPlumb.floatingEndpoint=null)}).bind(this);D=c.extend(M,D),D.scope=this.scope||D.scope,D[L]=H.wrap(D[L],u,!1),D[f]=H.wrap(D[f],m,!1),D[_]=H.wrap(D[_],h.drag),D[v]=H.wrap(D[v],A),D.multipleDrop=!1,D.canDrag=(function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}).bind(this),t.initDraggable(this.canvas,D,"internal"),this.canvas._jsPlumbRelatedElement=this.element,s=!0}};let l=a.endpoint||this._jsPlumb.instance.Defaults.Endpoint||c.Defaults.Endpoint;this.setEndpoint(l,!0);let N=a.anchor?a.anchor:a.anchors?a.anchors:t.Defaults.Anchor||"Top";this.setAnchor(N,!0);let G=["default",a.type||""].join(" ");this.addType(G,a.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();let U=(function(O,b,n,y){if(c.isDropSupported(this.element)){let h=a.dropOptions||t.Defaults.DropOptions||c.Defaults.DropOptions;h=c.extend({},h),h.scope=h.scope||this.scope;let D=c.dragEvents.drop,M=c.dragEvents.over,f=c.dragEvents.out,v=this,_=t.EndpointDropHandler({getEndpoint:function(){return v},jsPlumb:t,enabled:function(){return n!=null?n.isEnabled():!0},isFull:function(){return n.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(L){v.addClass(L)},removeClass:function(L){v.removeClass(L)},isDropAllowed:function(){return v.isDropAllowed.apply(v,arguments)},reference:y,isRedrop:function(L,g){return L.suspendedEndpoint&&g.reference&&L.suspendedEndpoint.id===g.reference.id}});h[D]=H.wrap(h[D],_,!0),h[M]=H.wrap(h[M],(function(){let L=c.getDragObject(arguments),g=t.getAttribute(c.getElement(L),"dragId"),u=t.getFloatingConnectionFor(g);if(u!=null){let m=t.getFloatingAnchorIndex(u);if(this.isTarget&&m!==0||u.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===u.suspendedEndpoint.id){let F=t.checkCondition("checkDropAllowed",{sourceEndpoint:u.endpoints[m],targetEndpoint:this,connection:u});this[(F?"add":"remove")+"Class"](t.endpointDropAllowedClass),this[(F?"remove":"add")+"Class"](t.endpointDropForbiddenClass),u.endpoints[m].anchor.over(this.anchor,this)}}}).bind(this)),h[f]=H.wrap(h[f],(function(){let L=c.getDragObject(arguments),g=L==null?null:t.getAttribute(c.getElement(L),"dragId"),u=g?t.getFloatingConnectionFor(g):null;if(u!=null){let m=t.getFloatingAnchorIndex(u);(this.isTarget&&m!==0||u.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===u.suspendedEndpoint.id)&&(this.removeClass(t.endpointDropAllowedClass),this.removeClass(t.endpointDropForbiddenClass),u.endpoints[m].anchor.out())}}).bind(this)),t.initDroppable(O,h,"internal",b)}}).bind(this);return this.anchor.isFloating||U(this.canvas,!(a._transient||this.anchor.isFloating),this,a.reference),this},H.extend(c.Endpoint,c.OverlayCapableJsPlumbUIComponent,{setVisible:function(a,t,p){if(this._jsPlumb.visible=a,this.canvas&&(this.canvas.style.display=a?"block":"none"),this[a?"showOverlays":"hideOverlays"](),!t){for(let x=0;x<this.connections.length;x++)if(this.connections[x].setVisible(a),!p){let j=this===this.connections[x].endpoints[0]?1:0;this.connections[x].endpoints[j].connections.length===1&&this.connections[x].endpoints[j].setVisible(a,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(a,t){this.setPaintStyle(a.endpointStyle||a.paintStyle,t),this.setHoverPaintStyle(a.endpointHoverStyle||a.hoverPaintStyle,t),a.maxConnections!=null&&(this._jsPlumb.maxConnections=a.maxConnections),a.scope&&(this.scope=a.scope),c.extend(this,a,r),a.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,a.cssClass),c.OverlayCapableJsPlumbUIComponent.applyType(this,a)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(a){this._jsPlumb.enabled=a},cleanup:function(){let a=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");c.removeClass(this.element,a),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(a){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(a)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(a){let t=!1;if(a){for(let p=0;p<this.connections.length;p++)if(this.connections[p].endpoints[1]===a||this.connections[p].endpoints[0]===a){t=!0;break}}return t},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(a){this._jsPlumb.connectionCost=a},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(a){this._jsPlumb.connectionsDirected=a},setElementId:function(a){this.elementId=a,this.anchor.elementId=a},setReferenceElement:function(a){this.element=c.getElement(a)},setDragAllowedWhenFull:function(a){this.dragAllowedWhenFull=a},equals:function(a){return this.anchor.equals(a.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(a){return this.anchor.compute(a)}}),X.jsPlumbInstance.prototype.EndpointDropHandler=function(a){return function(t){let p=a.jsPlumb;a.removeClass(p.endpointDropAllowedClass),a.removeClass(p.endpointDropForbiddenClass);let x=p.getDropEvent(arguments),j=p.getDragObject(arguments),S=p.getAttribute(j,"dragId");p.getAttribute(j,"elId");let I=p.getAttribute(j,"originalScope"),s=p.getFloatingConnectionFor(S);if(s==null)return;let l=s.suspendedEndpoint!=null;if(l&&s.suspendedEndpoint._jsPlumb==null)return;let N=a.getEndpoint(s);if(N==null)return;if(a.isRedrop(s,a)){s._forceReattach=!0,s.setHover(!1),a.maybeCleanup&&a.maybeCleanup(N);return}let G=p.getFloatingAnchorIndex(s);if(G===0&&!a.isSource||G===1&&!a.isTarget){a.maybeCleanup&&a.maybeCleanup(N);return}a.onDrop&&a.onDrop(s),I&&p.setDragScope(j,I);let U=a.isFull(t);if(U&&N.fire("maxConnections",{endpoint:this,connection:s,maxConnections:N._jsPlumb.maxConnections},x),!U&&a.enabled()){let O=!0;G===0?(s.floatingElement=s.source,s.floatingId=s.sourceId,s.floatingEndpoint=s.endpoints[0],s.floatingIndex=0,s.source=a.element,s.sourceId=a.elementId):(s.floatingElement=s.target,s.floatingId=s.targetId,s.floatingEndpoint=s.endpoints[1],s.floatingIndex=1,s.target=a.element,s.targetId=a.elementId),l&&s.suspendedEndpoint.id!==N.id&&(!s.isDetachAllowed(s)||!s.endpoints[G].isDetachAllowed(s)||!s.suspendedEndpoint.isDetachAllowed(s)||!p.checkCondition("beforeDetach",s))&&(O=!1);let b=(function(y){s.endpoints[G].detachFromConnection(s),s.suspendedEndpoint&&s.suspendedEndpoint.detachFromConnection(s),s.endpoints[G]=N,N.addConnection(s);let h=N.getParameters();for(let D in h)s.setParameter(D,h[D]);if(!l)h.draggable&&p.initDraggable(this.element,a.dragOptions,"internal",p);else{let D=s.suspendedEndpoint.elementId;p.fireMoveEvent({index:G,originalSourceId:G===0?D:s.sourceId,newSourceId:G===0?N.elementId:s.sourceId,originalTargetId:G===1?D:s.targetId,newTargetId:G===1?N.elementId:s.targetId,originalSourceEndpoint:G===0?s.suspendedEndpoint:s.endpoints[0],newSourceEndpoint:G===0?N:s.endpoints[0],originalTargetEndpoint:G===1?s.suspendedEndpoint:s.endpoints[1],newTargetEndpoint:G===1?N:s.endpoints[1],connection:s},x)}G===1?p.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):p.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),s.endpoints[0].finalEndpoint&&(s.endpoints[0].detachFromConnection(s),s.endpoints[0]=s.endpoints[0].finalEndpoint,s.endpoints[0].addConnection(s)),H.isObject(y)&&s.mergeData(y),p.finaliseConnection(s,null,x,!1),s.setHover(!1),p.revalidate(s.endpoints[0].element)}).bind(this),n=function(){s.suspendedEndpoint&&(s.endpoints[G]=s.suspendedEndpoint,s.setHover(!1),s._forceDetach=!0,G===0?(s.source=s.suspendedEndpoint.element,s.sourceId=s.suspendedEndpoint.elementId):(s.target=s.suspendedEndpoint.element,s.targetId=s.suspendedEndpoint.elementId),s.suspendedEndpoint.addConnection(s),G===1?p.anchorManager.updateOtherEndpoint(s.sourceId,s.floatingId,s.targetId,s):p.anchorManager.sourceChanged(s.floatingId,s.sourceId,s,s.source),p.repaint(s.sourceId),s._forceDetach=!1)};if(O=O&&a.isDropAllowed(s.sourceId,s.targetId,s.scope,s,N),O)return b(O),!0;n()}a.maybeCleanup&&a.maybeCleanup(N),p.currentlyDragging=!1}}}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=function(r,E,a,t,p){if(c.Connectors[E]=c.Connectors[E]||{},c.Connectors[E][a]==null){if(c.Connectors[a]==null){if(r.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+a+"'")}c.Connectors[E][a]=function(){c.Connectors[a].apply(this,arguments),c.ConnectorRenderers[E].apply(this,arguments)},H.extend(c.Connectors[E][a],[c.Connectors[a],c.ConnectorRenderers[E]])}return new c.Connectors[E][a](t,p)},J=function(r,E,a){return r?a.makeAnchor(r,E,a):null},W=function(r,E,a,t){E!=null&&(E._jsPlumbConnections=E._jsPlumbConnections||{},t?delete E._jsPlumbConnections[r.id]:E._jsPlumbConnections[r.id]=!0,H.isEmpty(E._jsPlumbConnections)?a.removeClass(E,a.connectedClass):a.addClass(E,a.connectedClass))};c.Connection=function(r){let E=r.newEndpoint;this.id=r.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=r.previousConnection,this.source=c.getElement(r.source),this.target=c.getElement(r.target),c.OverlayCapableJsPlumbUIComponent.apply(this,arguments),r.sourceEndpoint?(this.source=r.sourceEndpoint.getElement(),this.sourceId=r.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),r.targetEndpoint?(this.target=r.targetEndpoint.getElement(),this.targetId=r.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=r.scope,this.endpoints=[],this.endpointStyles=[];let a=this._jsPlumb.instance;a.manage(this.sourceId,this.source),a.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:r.cssClass,container:r.container,"pointer-events":r["pointer-events"],editorParams:r.editorParams,overlays:r.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",(function(){this.setHover(!0)}).bind(this)),this.bind("mouseout",(function(){this.setHover(!1)}).bind(this)),this.makeEndpoint=function(N,G,U,O,b){return U=U||this._jsPlumb.instance.getId(G),this.prepareEndpoint(a,E,this,O,N?0:1,r,G,U,b)},r.type&&(r.endpoints=r.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(r.type).endpoints);let t=this.makeEndpoint(!0,this.source,this.sourceId,r.sourceEndpoint),p=this.makeEndpoint(!1,this.target,this.targetId,r.targetEndpoint);t&&H.addToList(r.endpointsByElement,this.sourceId,t),p&&H.addToList(r.endpointsByElement,this.targetId,p),this.scope||(this.scope=this.endpoints[0].scope),r.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(r.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(r.deleteEndpointsOnEmpty));let x=a.Defaults.ConnectionsDetachable;r.detachable===!1&&(x=!1),this.endpoints[0].connectionsDetachable===!1&&(x=!1),this.endpoints[1].connectionsDetachable===!1&&(x=!1);let j=r.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||a.Defaults.ReattachConnections;this.appendToDefaultType({detachable:x,reattach:j,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||r.paintStyle||a.Defaults.PaintStyle||c.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||r.hoverPaintStyle||a.Defaults.HoverPaintStyle||c.Defaults.HoverPaintStyle});let S=a.getSuspendedAt();if(!a.isSuspendDrawing()){let N=a.getCachedData(this.sourceId),G=N.o,U=N.s,O=a.getCachedData(this.targetId),b=O.o,n=O.s,y=S||a.timestamp(),h=this.endpoints[0].anchor.compute({xy:[G.left,G.top],wh:U,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[b.left,b.top],twh:n,tElement:this.endpoints[1],timestamp:y});this.endpoints[0].paint({anchorLoc:h,timestamp:y}),h=this.endpoints[1].anchor.compute({xy:[b.left,b.top],wh:n,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[G.left,G.top],twh:U,tElement:this.endpoints[0],timestamp:y}),this.endpoints[1].paint({anchorLoc:h,timestamp:y})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(N){return this._jsPlumb.detachable===!1?!1:N!=null?N.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(N){this._jsPlumb.detachable=N===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(N){this._jsPlumb.reattach=N===!0},this._jsPlumb.cost=r.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=r.directed,r.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());let I=c.extend({},this.endpoints[1].getParameters());c.extend(I,this.endpoints[0].getParameters()),c.extend(I,this.getParameters()),this.setParameters(I),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||r.connector||a.Defaults.Connector||c.Defaults.Connector,!0);let s=r.data==null||!H.isObject(r.data)?{}:r.data;this.getData=function(){return s},this.setData=function(N){s=N||{}},this.mergeData=function(N){s=c.extend(s,N)};let l=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,r.type].join(" ");/[^\s]/.test(l)&&this.addType(l,r.data,!0),this.updateConnectedClass()},H.extend(c.Connection,c.OverlayCapableJsPlumbUIComponent,{applyType:function(r,E,a){let t=null;r.connector!=null&&(t=this.getCachedTypeItem("connector",a.connector),t==null&&(t=this.prepareConnector(r.connector,a.connector),this.cacheTypeItem("connector",t,a.connector)),this.setPreparedConnector(t)),r.detachable!=null&&this.setDetachable(r.detachable),r.reattach!=null&&this.setReattach(r.reattach),r.scope&&(this.scope=r.scope),r.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,r.cssClass);let p=null;r.anchor?(p=this.getCachedTypeItem("anchors",a.anchor),p==null&&(p=[this._jsPlumb.instance.makeAnchor(r.anchor),this._jsPlumb.instance.makeAnchor(r.anchor)],this.cacheTypeItem("anchors",p,a.anchor))):r.anchors&&(p=this.getCachedTypeItem("anchors",a.anchors),p==null&&(p=[this._jsPlumb.instance.makeAnchor(r.anchors[0]),this._jsPlumb.instance.makeAnchor(r.anchors[1])],this.cacheTypeItem("anchors",p,a.anchors))),p!=null&&(this.endpoints[0].anchor=p[0],this.endpoints[1].anchor=p[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),c.OverlayCapableJsPlumbUIComponent.applyType(this,r)},addClass:function(r,E){E&&(this.endpoints[0].addClass(r),this.endpoints[1].addClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(r)),this.connector&&this.connector.addClass(r)},removeClass:function(r,E){E&&(this.endpoints[0].removeClass(r),this.endpoints[1].removeClass(r),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(r)),this.connector&&this.connector.removeClass(r)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(r){this._jsPlumb.visible=r,this.connector&&this.connector.setVisible(r),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(r){this._jsPlumb&&(W(this,this.source,this._jsPlumb.instance,r),W(this,this.target,this._jsPlumb.instance,r))},setHover:function(r){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(r),X.jsPlumb[r?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),X.jsPlumb[r?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(r){this._jsPlumb.cost=r},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(r,E){let a={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},t=this._jsPlumb.instance.getRenderMode(),p;return H.isString(r)?p=Q(this._jsPlumb.instance,t,r,a,this):H.isArray(r)&&(r.length===1?p=Q(this._jsPlumb.instance,t,r[0],a,this):p=Q(this._jsPlumb.instance,t,r[0],H.merge(r[1],a),this)),E!=null&&(p.typeId=E),p},setPreparedConnector:function(r,E,a,t){if(this.connector!==r){let p,x="";if(this.connector!=null&&(p=this.connector,x=p.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=r,t&&this.cacheTypeItem("connector",r,t),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(x),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),p!=null){let j=this.getOverlays();for(let S=0;S<j.length;S++)j[S].transfer&&j[S].transfer(this.connector)}a||this.setListenerComponent(this.connector),E||this.repaint()}},setConnector:function(r,E,a,t){let p=this.prepareConnector(r,t);this.setPreparedConnector(p,E,a,t)},paint:function(r){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){r=r||{};let E=r.timestamp,a=this.targetId,t=this.sourceId,p=1,x=0;if(E==null||E!==this._jsPlumb.lastPaintedAt){let j=this._jsPlumb.instance.updateOffset({elId:t}).o,S=this._jsPlumb.instance.updateOffset({elId:a}).o,I=this.endpoints[x],s=this.endpoints[p],l=I.anchor.getCurrentLocation({xy:[j.left,j.top],wh:[j.width,j.height],element:I,timestamp:E}),N=s.anchor.getCurrentLocation({xy:[S.left,S.top],wh:[S.width,S.height],element:s,timestamp:E});this.connector.resetBounds(),this.connector.compute({sourcePos:l,targetPos:N,sourceOrientation:I.anchor.getOrientation(I),targetOrientation:s.anchor.getOrientation(s),sourceEndpoint:this.endpoints[x],targetEndpoint:this.endpoints[p],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:j,targetInfo:S});let G={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(let n in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(n)){let y=this._jsPlumb.overlays[n];y.isVisible()&&(this._jsPlumb.overlayPlacements[n]=y.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(y)),G.minX=Math.min(G.minX,this._jsPlumb.overlayPlacements[n].minX),G.maxX=Math.max(G.maxX,this._jsPlumb.overlayPlacements[n].maxX),G.minY=Math.min(G.minY,this._jsPlumb.overlayPlacements[n].minY),G.maxY=Math.max(G.maxY,this._jsPlumb.overlayPlacements[n].maxY))}let U=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,O=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),b={xmin:Math.min(this.connector.bounds.minX-(U+O),G.minX),ymin:Math.min(this.connector.bounds.minY-(U+O),G.minY),xmax:Math.max(this.connector.bounds.maxX+(U+O),G.maxX),ymax:Math.max(this.connector.bounds.maxY+(U+O),G.maxY)};this.connector.paintExtents=b,this.connector.paint(this._jsPlumb.paintStyleInUse,null,b);for(let n in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(n)){let y=this._jsPlumb.overlays[n];y.isVisible()&&y.paint(this._jsPlumb.overlayPlacements[n],b)}}this._jsPlumb.lastPaintedAt=E}},repaint:function(r){let E=jsPlumb.extend(r||{},{});E.elId=this.sourceId,this.paint(E)},prepareEndpoint:function(r,E,a,t,p,x,j,S,I){let s;if(t)a.endpoints[p]=t,t.addConnection(a);else{x.endpoints||(x.endpoints=[null,null]);let l=I||x.endpoints[p]||x.endpoint||r.Defaults.Endpoints[p]||c.Defaults.Endpoints[p]||r.Defaults.Endpoint||c.Defaults.Endpoint;x.endpointStyles||(x.endpointStyles=[null,null]),x.endpointHoverStyles||(x.endpointHoverStyles=[null,null]);let N=x.endpointStyles[p]||x.endpointStyle||r.Defaults.EndpointStyles[p]||c.Defaults.EndpointStyles[p]||r.Defaults.EndpointStyle||c.Defaults.EndpointStyle;N.fill==null&&x.paintStyle!=null&&(N.fill=x.paintStyle.stroke),N.outlineStroke==null&&x.paintStyle!=null&&(N.outlineStroke=x.paintStyle.outlineStroke),N.outlineWidth==null&&x.paintStyle!=null&&(N.outlineWidth=x.paintStyle.outlineWidth);let G=x.endpointHoverStyles[p]||x.endpointHoverStyle||r.Defaults.EndpointHoverStyles[p]||c.Defaults.EndpointHoverStyles[p]||r.Defaults.EndpointHoverStyle||c.Defaults.EndpointHoverStyle;x.hoverPaintStyle!=null&&(G==null&&(G={}),G.fill==null&&(G.fill=x.hoverPaintStyle.stroke));let U=x.anchors?x.anchors[p]:x.anchor?x.anchor:J(r.Defaults.Anchors[p],S,r)||J(c.Defaults.Anchors[p],S,r)||J(r.Defaults.Anchor,S,r)||J(c.Defaults.Anchor,S,r),O=x.uuids?x.uuids[p]:null;s=E({paintStyle:N,hoverPaintStyle:G,endpoint:l,connections:[a],uuid:O,anchor:U,source:j,scope:x.scope,reattach:x.reattach||r.Defaults.ReattachConnections,detachable:x.detachable||r.Defaults.ConnectionsDetachable}),t==null&&s.setDeleteOnEmpty(!0),a.endpoints[p]=s,x.drawEndpoints===!1&&s.setVisible(!1,!0,!0)}return s},replaceEndpoint:function(r,E){let a=this.endpoints[r],t=a.elementId,p=this._jsPlumb.instance.getEndpoints(t),x=p.indexOf(a),j=this.makeEndpoint(r===0,a.element,t,null,E);this.endpoints[r]=j,p.splice(x,1,j),this._jsPlumb.instance.deleteObject({endpoint:a,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:a,current:j}),this._jsPlumb.instance.anchorManager.updateOtherEndpoint(this.endpoints[0].elementId,this.endpoints[1].elementId,this.endpoints[1].elementId,this)}})}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumbUtil,H=X.jsPlumb;H.AnchorManager=function(r){let E={},a={},t={},p={},x=this,j={},S=r.jsPlumbInstance,I={},s=function(h,D,M,f,v,_,L){let g=[],u=D[v?0:1]/(f.length+1);for(let m=0;m<f.length;m++){let A=(m+1)*u,F=_*D[v?1:0];L&&(A=D[v?0:1]-A);let i=v?A:F,e=M[0]+i,d=i/D[0],C=v?F:A,w=M[1]+C,B=C/D[1];g.push([e,w,d,B,f[m][1],f[m][2]])}return g},l=function(h){return function(D,M){let f=!0;return f=D[0][0]<M[0][0],f===!1?-1:1}},N=function(h,D){let M=h[0][0]<0?-Math.PI-h[0][0]:Math.PI-h[0][0],f=D[0][0]<0?-Math.PI-D[0][0]:Math.PI-D[0][0];return M>f?1:-1},G={top:function(h,D){return h[0]>D[0]?1:-1},right:l(),bottom:l(),left:N},U=function(h,D){return h.sort(D)},O=function(h,D){let M=S.getCachedData(h),f=M.s,v=M.o,_=function(L,g,u,m,A,F,i){if(m.length>0){let e=U(m,G[L]),d=L==="right"||L==="top",C=s(L,g,u,e,A,F,d),w=function(B,z){a[B.id]=[z[0],z[1],z[2],z[3]],t[B.id]=i};for(let B=0;B<C.length;B++){let z=C[B][4],Y=z.endpoints[0].elementId===h,V=z.endpoints[1].elementId===h;Y&&w(z.endpoints[0],C[B]),V&&w(z.endpoints[1],C[B])}}};_("bottom",f,[v.left,v.top],D.bottom,!0,1,[0,1]),_("top",f,[v.left,v.top],D.top,!0,0,[0,-1]),_("left",f,[v.left,v.top],D.left,!1,0,[-1,0]),_("right",f,[v.left,v.top],D.right,!1,1,[1,0])};this.reset=function(){E={},p={},j={}},this.addFloatingConnection=function(h,D){I[h]=D},this.removeFloatingConnection=function(h){delete I[h]},this.newConnection=function(h){let D=h.sourceId,M=h.targetId,f=h.endpoints,v=!0,_=function(L,g,u,m,A){D===M&&u.isContinuous&&(h._jsPlumb.instance.removeElement(f[1].canvas),v=!1),c.addToList(p,m,[A,g,u.constructor===H.DynamicAnchor])};_(0,f[0],f[0].anchor,M,h),v&&_(1,f[1],f[1].anchor,D,h)};let b=function(h){(function(D,M){if(D){let f=function(v){return v[4]===M};c.removeWithFunction(D.top,f),c.removeWithFunction(D.left,f),c.removeWithFunction(D.bottom,f),c.removeWithFunction(D.right,f)}})(j[h.elementId],h.id)};this.connectionDetached=function(h,D){let M=h.connection||h,f=h.sourceId,v=h.targetId,_=M.endpoints,L=function(g,u,m,A,F){c.removeWithFunction(p[A],function(i){return i[0].id===F.id})};L(1,_[1],_[1].anchor,f,M),L(0,_[0],_[0].anchor,v,M),M.floatingId&&(L(M.floatingIndex,M.floatingEndpoint,M.floatingEndpoint.anchor,M.floatingId,M),b(M.floatingEndpoint)),b(M.endpoints[0]),b(M.endpoints[1]),D||(x.redraw(M.sourceId),M.targetId!==M.sourceId&&x.redraw(M.targetId))},this.add=function(h,D){c.addToList(E,D,h)},this.changeId=function(h,D){p[D]=p[h],E[D]=E[h],delete p[h],delete E[h]},this.getConnectionsFor=function(h){return p[h]||[]},this.getEndpointsFor=function(h){return E[h]||[]},this.deleteEndpoint=function(h){c.removeWithFunction(E[h.elementId],function(D){return D.id===h.id}),b(h)},this.clearFor=function(h){delete E[h],E[h]=[]};let n=function(h,D,M,f,v,_,L,g,u,m,A,F){let i=-1,e=f.endpoints[L],d=e.id,C=[1,0][L],w=[[D,M],f,v,_,d],B=h[u],z=e._continuousAnchorEdge?h[e._continuousAnchorEdge]:null,Y,V;if(z){let ot=c.findWithFunction(z,function(ct){return ct[4]===d});if(ot!==-1)for(z.splice(ot,1),Y=0;Y<z.length;Y++)V=z[Y][1],c.addWithFunction(A,V,function(ct){return ct.id===V.id}),c.addWithFunction(F,z[Y][1].endpoints[L],function(ct){return ct.id===V.endpoints[L].id}),c.addWithFunction(F,z[Y][1].endpoints[C],function(ct){return ct.id===V.endpoints[C].id})}for(Y=0;Y<B.length;Y++)V=B[Y][1],r.idx===1&&B[Y][3]===_&&i===-1&&(i=Y),c.addWithFunction(A,V,function(ot){return ot.id===V.id}),c.addWithFunction(F,B[Y][1].endpoints[L],function(ot){return ot.id===V.endpoints[L].id}),c.addWithFunction(F,B[Y][1].endpoints[C],function(ot){return ot.id===V.endpoints[C].id});{let ot=g?i!==-1?i:0:B.length;B.splice(ot,0,w)}e._continuousAnchorEdge=u};this.updateOtherEndpoint=function(h,D,M,f){let v=c.findWithFunction(p[h],function(L){return L[0].id===f.id}),_=c.findWithFunction(p[D],function(L){return L[0].id===f.id});v!==-1&&(p[h][v][0]=f,p[h][v][1]=f.endpoints[1],p[h][v][2]=f.endpoints[1].anchor.constructor===H.DynamicAnchor),_>-1&&(p[D].splice(_,1),c.addToList(p,M,[f,f.endpoints[0],f.endpoints[0].anchor.constructor===H.DynamicAnchor])),f.updateConnectedClass()},this.sourceChanged=function(h,D,M,f){if(h!==D){M.sourceId=D,M.source=f,c.removeWithFunction(p[h],function(_){return _[0].id===M.id});let v=c.findWithFunction(p[M.targetId],function(_){return _[0].id===M.id});v>-1&&(p[M.targetId][v][0]=M,p[M.targetId][v][1]=M.endpoints[0],p[M.targetId][v][2]=M.endpoints[0].anchor.constructor===H.DynamicAnchor),c.addToList(p,D,[M,M.endpoints[1],M.endpoints[1].anchor.constructor===H.DynamicAnchor]),M.endpoints[1].anchor.isContinuous&&(M.source===M.target?M._jsPlumb.instance.removeElement(M.endpoints[1].canvas):M.endpoints[1].canvas.parentNode==null&&M._jsPlumb.instance.appendElement(M.endpoints[1].canvas)),M.updateConnectedClass()}},this.rehomeEndpoint=function(h,D,M){let f=E[D]||[],v=S.getId(M);if(v!==D){let _=f.indexOf(h);if(_>-1){let L=f.splice(_,1)[0];x.add(L,v)}}for(let _=0;_<h.connections.length;_++)h.connections[_].sourceId===D?x.sourceChanged(D,h.elementId,h.connections[_],h.element):h.connections[_].targetId===D&&(h.connections[_].targetId=h.elementId,h.connections[_].target=h.element,x.updateOtherEndpoint(h.connections[_].sourceId,D,h.elementId,h.connections[_]))},this.redraw=function(h,D,M,f,v,_){if(!S.isSuspendDrawing()){let B=E[h]||[],z=p[h]||[],Y=[],V=[],ot=[];M=M||S.timestamp(),f=f||{left:0,top:0},D&&(D={left:D.left+f.left,top:D.top+f.top});let ct=S.updateOffset({elId:h,offset:D,recalc:!1,timestamp:M}),pt={};for(var L=0;L<z.length;L++){var g=z[L][0],u=g.sourceId,m=g.targetId,A=g.endpoints[0].anchor.isContinuous,F=g.endpoints[1].anchor.isContinuous;if(A||F){var i=u+"_"+m,e=pt[i],d=g.sourceId===h?1:0;A&&!j[u]&&(j[u]={top:[],right:[],bottom:[],left:[]}),F&&!j[m]&&(j[m]={top:[],right:[],bottom:[],left:[]}),h!==m&&S.updateOffset({elId:m,timestamp:M}),h!==u&&S.updateOffset({elId:u,timestamp:M});let rt=S.getCachedData(m),ft=S.getCachedData(u);m===u&&(A||F)?(n(j[u],-Math.PI/2,0,g,!1,m,0,!1,"top",u,Y,V),n(j[m],-Math.PI/2,0,g,!1,u,1,!1,"top",m,Y,V)):(e||(e=this.calculateOrientation(u,m,ft.o,rt.o,g.endpoints[0].anchor,g.endpoints[1].anchor,g),pt[i]=e),A&&n(j[u],e.theta,0,g,!1,m,0,!1,e.a[0],u,Y,V),F&&n(j[m],e.theta2,-1,g,!0,u,1,!0,e.a[1],m,Y,V)),A&&c.addWithFunction(ot,u,function(ut){return ut===u}),F&&c.addWithFunction(ot,m,function(ut){return ut===m}),c.addWithFunction(Y,g,function(ut){return ut.id===g.id}),(A&&d===0||F&&d===1)&&c.addWithFunction(V,g.endpoints[d],function(ut){return ut.id===g.endpoints[d].id})}}for(L=0;L<B.length;L++)B[L].connections.length===0&&B[L].anchor.isContinuous&&(j[h]||(j[h]={top:[],right:[],bottom:[],left:[]}),n(j[h],-Math.PI/2,0,{endpoints:[B[L],B[L]],paint:function(){}},!1,h,0,!1,B[L].anchor.getDefaultFace(),h,Y,V),c.addWithFunction(ot,h,function(rt){return rt===h}));for(L=0;L<ot.length;L++)O(ot[L],j[ot[L]]);for(L=0;L<B.length;L++)B[L].paint({timestamp:M,offset:ct,dimensions:ct.s,recalc:_!==!0});for(L=0;L<V.length;L++){let rt=S.getCachedData(V[L].elementId);V[L].paint({timestamp:null,offset:rt,dimensions:rt.s})}for(L=0;L<z.length;L++){var C=z[L][1];if(C.anchor.constructor===H.DynamicAnchor){C.paint({elementWithPrecedence:h,timestamp:M}),c.addWithFunction(Y,z[L][0],function(rt){return rt.id===z[L][0].id});for(var w=0;w<C.connections.length;w++)C.connections[w]!==z[L][0]&&c.addWithFunction(Y,C.connections[w],function(rt){return rt.id===C.connections[w].id})}else c.addWithFunction(Y,z[L][0],function(rt){return rt.id===z[L][0].id})}let $=I[h];for($&&$.paint({timestamp:M,recalc:!1,elId:h}),L=0;L<Y.length;L++)Y[L].paint({elId:h,timestamp:null,recalc:!1,clearEdits:v})}};let y=function(h){c.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;let D=h.faces||["top","right","bottom","left"],M=h.clockwise!==!1,f={},v={top:"bottom",right:"left",left:"right",bottom:"top"},_={top:"right",right:"bottom",left:"top",bottom:"left"},L={top:"left",right:"top",left:"bottom",bottom:"right"},g=M?_:L,u=M?L:_,m=h.cssClass||"",A=null,F=null,i=["left","right"],e=["top","bottom"],d=null;for(let C=0;C<D.length;C++)f[D[C]]=!0;this.getDefaultFace=function(){return D.length===0?"top":D[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(C){return f[C]?C:f[v[C]]?v[C]:f[g[C]]?g[C]:f[u[C]]?u[C]:C},this.isEdgeSupported=function(C){return d==null?F==null?f[C]===!0:F===C:d.indexOf(C)!==-1},this.setCurrentFace=function(C,w){A=C,w&&F!=null&&(F=A)},this.getCurrentFace=function(){return A},this.getSupportedFaces=function(){let C=[];for(let w in f)f[w]&&C.push(w);return C},this.lock=function(){F=A},this.unlock=function(){F=null},this.isLocked=function(){return F!=null},this.lockCurrentAxis=function(){A!=null&&(d=A==="left"||A==="right"?i:e)},this.unlockCurrentAxis=function(){d=null},this.compute=function(C){return a[C.element.id]||[0,0]},this.getCurrentLocation=function(C){return a[C.element.id]||[0,0]},this.getOrientation=function(C){return t[C.id]||[0,0]},this.getCssClass=function(){return m}};S.continuousAnchorFactory={get:function(h){return new y(h)},clear:function(h){delete a[h]}}},H.AnchorManager.prototype.calculateOrientation=function(r,E,a,t,p,x){let j={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},S=["left","top","right","bottom"];if(r===E)return{orientation:j.IDENTITY,a:["top","top"]};let I=Math.atan2(t.centery-a.centery,t.centerx-a.centerx),s=Math.atan2(a.centery-t.centery,a.centerx-t.centerx),l=[],N={};(function(O,b){for(let n=0;n<O.length;n++)N[O[n]]={left:[b[n].left,b[n].centery],right:[b[n].right,b[n].centery],top:[b[n].centerx,b[n].top],bottom:[b[n].centerx,b[n].bottom]}})(["source","target"],[a,t]);for(let O=0;O<S.length;O++)for(let b=0;b<S.length;b++)l.push({source:S[O],target:S[b],dist:Biltong.lineLength(N.source[S[O]],N.target[S[b]])});l.sort(function(O,b){return O.dist<b.dist?-1:O.dist>b.dist?1:0});let G=l[0].source,U=l[0].target;for(let O=0;O<l.length&&(!p.isContinuous||p.isEdgeSupported(l[O].source)?G=l[O].source:G=null,!x.isContinuous||x.isEdgeSupported(l[O].target)?U=l[O].target:U=null,!(G!=null&&U!=null));O++);return p.isContinuous&&p.setCurrentFace(G),x.isContinuous&&x.setCurrentFace(U),{a:[G,U],theta:I,theta2:s}},H.Anchor=function(r){this.x=r.x||0,this.y=r.y||0,this.elementId=r.elementId,this.cssClass=r.cssClass||"",this.userDefinedLocation=null,this.orientation=r.orientation||[0,0],this.lastReturnValue=null,this.offsets=r.offsets||[0,0],this.timestamp=null;let E=r.relocatable!==!1;this.isRelocatable=function(){return E},this.setRelocatable=function(p){E=p};let a=r.snapOnRelocate!==!1;this.isSnapOnRelocate=function(){return a};let t=!1;this.lock=function(){t=!0},this.unlock=function(){t=!1},this.isLocked=function(){return t},c.EventGenerator.apply(this),this.compute=function(p){let x=p.xy,j=p.wh,S=p.timestamp;return p.clearUserDefinedLocation&&(this.userDefinedLocation=null),S&&S===this.timestamp?this.lastReturnValue:(this.userDefinedLocation!=null?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[x[0]+this.x*j[0]+this.offsets[0],x[1]+this.y*j[1]+this.offsets[1],this.x,this.y],this.timestamp=S,this.lastReturnValue)},this.getCurrentLocation=function(p){return p=p||{},this.lastReturnValue==null||p.timestamp!=null&&this.timestamp!==p.timestamp?this.compute(p):this.lastReturnValue},this.setPosition=function(p,x,j,S,I){(!t||I)&&(this.x=p,this.y=x,this.orientation=[j,S],this.lastReturnValue=null)}},c.extend(H.Anchor,c.EventGenerator,{equals:function(r){if(!r)return!1;let E=r.getOrientation(),a=this.getOrientation();return this.x===r.x&&this.y===r.y&&this.offsets[0]===r.offsets[0]&&this.offsets[1]===r.offsets[1]&&a[0]===E[0]&&a[1]===E[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(r){this.userDefinedLocation=r},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),H.FloatingAnchor=function(r){H.Anchor.apply(this,arguments);let E=r.reference,a=r.referenceCanvas,t=H.getSize(a),p=0,x=0,j=null,S=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(I){let s=I.xy,l=[s[0]+t[0]/2,s[1]+t[1]/2];return S=l,l},this.getOrientation=function(I){if(j)return j;{let s=E.getOrientation(I);return[Math.abs(s[0])*p*-1,Math.abs(s[1])*x*-1]}},this.over=function(I,s){j=I.getOrientation(s)},this.out=function(){j=null},this.getCurrentLocation=function(I){return S??this.compute(I)}},c.extend(H.FloatingAnchor,H.Anchor);let Q=function(r,E,a){return r.constructor===H.Anchor?r:E.makeAnchor(r,a,E)};H.DynamicAnchor=function(r){H.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=r.elementId,this.jsPlumbInstance=r.jsPlumbInstance;for(let j=0;j<r.anchors.length;j++)this.anchors[j]=Q(r.anchors[j],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};let E=this.anchors.length>0?this.anchors[0]:null,a=E,t=this,p=function(j,S,I,s,l){let N=s[0]+j.x*l[0],G=s[1]+j.y*l[1],U=s[0]+l[0]/2,O=s[1]+l[1]/2;return Math.sqrt(Math.pow(S-N,2)+Math.pow(I-G,2))+Math.sqrt(Math.pow(U-N,2)+Math.pow(O-G,2))},x=r.selector||function(j,S,I,s,l){let N=I[0]+s[0]/2,G=I[1]+s[1]/2,U=-1,O=1/0;for(let b=0;b<l.length;b++){let n=p(l[b],N,G,j,S);n<O&&(U=b+0,O=n)}return l[U]};this.compute=function(j){let S=j.xy,I=j.wh,s=j.txy,l=j.twh;this.timestamp=j.timestamp;let N=t.getUserDefinedLocation();return N??(this.isLocked()||s==null||l==null||(j.timestamp=null,E=x(S,I,s,l,this.anchors),this.x=E.x,this.y=E.y,E!==a&&this.fire("anchorChanged",E),a=E),E.compute(j))},this.getCurrentLocation=function(j){return this.getUserDefinedLocation()||(E!=null?E.getCurrentLocation(j):null)},this.getOrientation=function(j){return E!=null?E.getOrientation(j):[0,0]},this.over=function(j,S){E!=null&&E.over(j,S)},this.out=function(){E!=null&&E.out()},this.setAnchor=function(j){E=j},this.getCssClass=function(){return E&&E.getCssClass()||""},this.setAnchorCoordinates=function(j){let S=jsPlumbUtil.findWithFunction(this.anchors,function(I){return I.x===j[0]&&I.y===j[1]});return S!==-1?(this.setAnchor(this.anchors[S]),!0):!1}},c.extend(H.DynamicAnchor,H.Anchor);let J=function(r,E,a,t,p,x){H.Anchors[p]=function(j){let S=j.jsPlumbInstance.makeAnchor([r,E,a,t,0,0],j.elementId,j.jsPlumbInstance);return S.type=p,x&&x(S,j),S}};J(.5,0,0,-1,"TopCenter"),J(.5,1,0,1,"BottomCenter"),J(0,.5,-1,0,"LeftMiddle"),J(1,.5,1,0,"RightMiddle"),J(.5,0,0,-1,"Top"),J(.5,1,0,1,"Bottom"),J(0,.5,-1,0,"Left"),J(1,.5,1,0,"Right"),J(.5,.5,0,0,"Center"),J(1,0,0,-1,"TopRight"),J(1,1,0,1,"BottomRight"),J(0,0,0,-1,"TopLeft"),J(0,1,0,1,"BottomLeft"),H.Defaults.DynamicAnchors=function(r){return r.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],r.elementId,r.jsPlumbInstance)},H.Anchors.AutoDefault=function(r){let E=r.jsPlumbInstance.makeDynamicAnchor(H.Defaults.DynamicAnchors(r));return E.type="AutoDefault",E};let W=function(r,E){H.Anchors[r]=function(a){let t=a.jsPlumbInstance.makeAnchor(["Continuous",{faces:E}],a.elementId,a.jsPlumbInstance);return t.type=r,t}};H.Anchors.Continuous=function(r){return r.jsPlumbInstance.continuousAnchorFactory.get(r)},W("ContinuousLeft",["left"]),W("ContinuousTop",["top"]),W("ContinuousBottom",["bottom"]),W("ContinuousRight",["right"]),J(0,0,0,0,"Assign",function(r,E){let a=E.position||"Fixed";r.positionFinder=a.constructor===String?E.jsPlumbInstance.AnchorPositionFinders[a]:a,r.constructorParams=E}),X.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(r,E,a){return[(r.left-E.left)/a[0],(r.top-E.top)/a[1]]},Grid:function(r,E,a,t){let p=r.left-E.left,x=r.top-E.top,j=a[0]/t.grid[0],S=a[1]/t.grid[1],I=Math.floor(p/j),s=Math.floor(x/S);return[(I*j+j/2)/a[0],(s*S+S/2)/a[1]]}},H.Anchors.Perimeter=function(r){r=r||{};let E=r.anchorCount||60,a=r.shape;if(!a)throw new Error("no shape supplied to Perimeter Anchor type");let t=function(){let N=.5,G=Math.PI*2/E,U=0,O=[];for(let b=0;b<E;b++){let n=N+N*Math.sin(U),y=N+N*Math.cos(U);O.push([n,y,0,0]),U+=G}return O},p=function(N){let G=E/N.length,U=[],O=function(b,n,y,h,D,M,f){G=E*D;let v=(y-b)/G,_=(h-n)/G;for(let L=0;L<G;L++)U.push([b+v*L,n+_*L,M??0,f??0])};for(let b=0;b<N.length;b++)O.apply(null,N[b]);return U},x=function(N){let G=[];for(let U=0;U<N.length;U++)G.push([N[U][0],N[U][1],N[U][2],N[U][3],1/N.length,N[U][4],N[U][5]]);return p(G)},j=function(){return x([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},S={Circle:t,Ellipse:t,Diamond:function(){return x([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:j,Square:j,Triangle:function(){return x([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(N){let G=N.points,U=[],O=0;for(let b=0;b<G.length-1;b++){let n=Math.sqrt(Math.pow(G[b][2]-G[b][0])+Math.pow(G[b][3]-G[b][1]));O+=n,U.push([G[b][0],G[b][1],G[b+1][0],G[b+1][1],n])}for(let b=0;b<U.length;b++)U[b][4]=U[b][4]/O;return p(U)}},I=function(N,G){let U=[],O=G/180*Math.PI;for(let b=0;b<N.length;b++){let n=N[b][0]-.5,y=N[b][1]-.5;U.push([.5+(n*Math.cos(O)-y*Math.sin(O)),.5+(n*Math.sin(O)+y*Math.cos(O)),N[b][2],N[b][3]])}return U};if(!S[a])throw new Error("Shape ["+a+"] is unknown by Perimeter Anchor type");let s=S[a](r);r.rotation&&(s=I(s,r.rotation));let l=r.jsPlumbInstance.makeDynamicAnchor(s);return l.type="Perimeter",l}}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=X.Biltong;c.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(p,x){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}},this.lineIntersection=function(p,x,j,S){return[]},this.boxIntersection=function(p,x,j,S){let I=[];return I.push.apply(I,this.lineIntersection(p,x,p+j,x)),I.push.apply(I,this.lineIntersection(p+j,x,p+j,x+S)),I.push.apply(I,this.lineIntersection(p+j,x+S,p,x+S)),I.push.apply(I,this.lineIntersection(p,x+S,p,x)),I},this.boundingBoxIntersection=function(p){return this.boxIntersection(p.x,p.y,p.w,p.y)}},Straight:function(t){c.Segments.AbstractSegment.apply(this,arguments);let p,x,j,S,I,s,l,N=function(){p=Math.sqrt(Math.pow(I-S,2)+Math.pow(l-s,2)),x=Q.gradient({x:S,y:s},{x:I,y:l}),j=-1/x};this.type="Straight",this.getLength=function(){return p},this.getGradient=function(){return x},this.getCoordinates=function(){return{x1:S,y1:s,x2:I,y2:l}},this.setCoordinates=function(n){S=n.x1,s=n.y1,I=n.x2,l=n.y2,N()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(S,I),minY:Math.min(s,l),maxX:Math.max(S,I),maxY:Math.max(s,l)}},this.pointOnPath=function(n,y){if(n===0&&!y)return{x:S,y:s};if(n===1&&!y)return{x:I,y:l};{let h=y?n>0?n:p+n:n*p;return Q.pointOnLine({x:S,y:s},{x:I,y:l},h)}},this.gradientAtPoint=function(n){return x},this.pointAlongPathFrom=function(n,y,h){let D=this.pointOnPath(n,h),M=y<=0?{x:S,y:s}:{x:I,y:l};return y<=0&&Math.abs(y)>1&&(y*=-1),Q.pointOnLine(D,M,y)};let G=function(n,y,h){return h>=Math.min(n,y)&&h<=Math.max(n,y)},U=function(n,y,h){return Math.abs(h-n)<Math.abs(h-y)?n:y};this.findClosestPointOnPath=function(n,y){let h={d:1/0,x:null,y:null,l:null,x1:S,x2:I,y1:s,y2:l};if(x===0)h.y=s,h.x=G(S,I,n)?n:U(S,I,n);else if(x===1/0||x===-1/0)h.x=S,h.y=G(s,l,y)?y:U(s,l,y);else{let M=s-x*S,f=y-j*n,v=(f-M)/(x-j),_=x*v+M;h.x=G(S,I,v)?v:U(S,I,v),h.y=G(s,l,_)?_:U(s,l,_)}let D=Q.lineLength([h.x,h.y],[S,s]);return h.d=Q.lineLength([n,y],[h.x,h.y]),h.l=D/p,h};let O=function(n,y,h){return h>y?y<=n&&n<=h:y>=n&&n>=h},b=O;this.lineIntersection=function(n,y,h,D){let M=Math.abs(Q.gradient({x:n,y},{x:h,y:D})),f=Math.abs(x),v=f===1/0?S:s-f*S,_=[],L=M===1/0?n:y-M*n;if(M!==f)if(M===1/0&&f===0)b(n,S,I)&&b(s,y,D)&&(_=[n,s]);else if(M===0&&f===1/0)b(y,s,l)&&b(S,n,h)&&(_=[S,y]);else{let g,u;M===1/0?(g=n,b(g,S,I)&&(u=f*n+v,b(u,y,D)&&(_=[g,u]))):M===0?(u=y,b(u,s,l)&&(g=(y-v)/f,b(g,n,h)&&(_=[g,u]))):(g=(L-v)/(f-M),u=f*g+v,b(g,S,I)&&b(u,s,l)&&(_=[g,u]))}return _},this.boxIntersection=function(n,y,h,D){let M=[];return M.push.apply(M,this.lineIntersection(n,y,n+h,y)),M.push.apply(M,this.lineIntersection(n+h,y,n+h,y+D)),M.push.apply(M,this.lineIntersection(n+h,y+D,n,y+D)),M.push.apply(M,this.lineIntersection(n,y+D,n,y)),M},this.boundingBoxIntersection=function(n){return this.boxIntersection(n.x,n.y,n.w,n.h)}},Arc:function(t){c.Segments.AbstractSegment.apply(this,arguments);var p=function(U,O){return Q.theta([t.cx,t.cy],[U,O])},x=function(U,O){if(U.anticlockwise){let b=U.startAngle<U.endAngle?U.startAngle+j:U.startAngle,n=Math.abs(b-U.endAngle);return b-n*O}else{let b=U.endAngle<U.startAngle?U.endAngle+j:U.endAngle,n=Math.abs(b-U.startAngle);return U.startAngle+n*O}},j=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=p(t.x1,t.y1),this.endAngle=p(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=j),this.startAngle<0&&(this.startAngle+=j);let S=this.endAngle<this.startAngle?this.endAngle+j:this.endAngle;this.sweep=Math.abs(S-this.startAngle),this.anticlockwise&&(this.sweep=j-this.sweep);let I=2*Math.PI*this.radius,s=this.sweep/j,l=I*s;this.getLength=function(){return l},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};let N=1e-10,G=function(U){let O=Math.floor(U),b=Math.ceil(U);return U-O<N?O:b-U<N?b:U};this.pointOnPath=function(U,O){if(U===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(U===1)return{x:this.x2,y:this.y2,theta:this.endAngle};O&&(U=U/l);let b=x(this,U),n=t.cx+t.r*Math.cos(b),y=t.cy+t.r*Math.sin(b);return{x:G(n),y:G(y),theta:b}},this.gradientAtPoint=function(U,O){let b=this.pointOnPath(U,O),n=Q.normal([t.cx,t.cy],[b.x,b.y]);return!this.anticlockwise&&(n===1/0||n===-1/0)&&(n*=-1),n},this.pointAlongPathFrom=function(U,O,b){let n=this.pointOnPath(U,b),y=O/I*2*Math.PI,h=this.anticlockwise?-1:1,D=n.theta+h*y,M=t.cx+this.radius*Math.cos(D),f=t.cy+this.radius*Math.sin(D);return{x:M,y:f}}},Bezier:function(t){this.curve=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}],c.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)},this.type="Bezier";let p=function(x,j,S){return S&&(j=X.jsBezier.locationAlongCurveFrom(x,j>0?0:1,j)),j};this.pointOnPath=function(x,j){return x=p(this.curve,x,j),X.jsBezier.pointOnCurve(this.curve,x)},this.gradientAtPoint=function(x,j){return x=p(this.curve,x,j),X.jsBezier.gradientAtPoint(this.curve,x)},this.pointAlongPathFrom=function(x,j,S){return x=p(this.curve,x,S),X.jsBezier.pointAlongCurveFrom(this.curve,x,j)},this.getLength=function(){return X.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(x,j){let S=X.jsBezier.nearestPointOnCurve({x,y:j},this.curve);return{d:Math.sqrt(Math.pow(S.point.x-x,2)+Math.pow(S.point.y-j,2)),x:S.point.x,y:S.point.y,l:1-S.location,s:this}},this.lineIntersection=function(x,j,S,I){return X.jsBezier.lineIntersection(x,j,S,I,this.curve)}}},c.SegmentRenderer={getPath:function(t,p){return{Straight:function(x){let j=t.getCoordinates();return(x?"M "+j.x1+" "+j.y1+" ":"")+"L "+j.x2+" "+j.y2},Bezier:function(x){let j=t.params;return(x?"M "+j.x2+" "+j.y2+" ":"")+"C "+j.cp2x+" "+j.cp2y+" "+j.cp1x+" "+j.cp1y+" "+j.x1+" "+j.y1},Arc:function(x){let j=t.params,S=t.sweep>Math.PI?1:0,I=t.anticlockwise?0:1;return(x?"M"+t.x1+" "+t.y1+" ":"")+"A "+t.radius+" "+j.r+" 0 "+S+","+I+" "+t.x2+" "+t.y2}}[t.type](p)}};let J=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};c.Connectors.AbstractConnector=function(t){J.apply(this,arguments);let p=[],x=0,j=[],S=[],I=t.stub||0,s=H.isArray(I)?I[0]:I,l=H.isArray(I)?I[1]:I,N=t.gap||0,G=H.isArray(N)?N[0]:N,U=H.isArray(N)?N[1]:N,O=null,b=null;this.getPathData=function(){let f="";for(let v=0;v<p.length;v++)f+=c.SegmentRenderer.getPath(p[v],v===0),f+=" ";return f},this.findSegmentForPoint=function(f,v){let _={d:1/0,s:null,x:null,y:null,l:null};for(let L=0;L<p.length;L++){let g=p[L].findClosestPointOnPath(f,v);g.d<_.d&&(_.d=g.d,_.l=g.l,_.x=g.x,_.y=g.y,_.s=p[L],_.x1=g.x1,_.x2=g.x2,_.y1=g.y1,_.y2=g.y2,_.index=L,_.connectorLocation=j[L][0]+g.l*(j[L][1]-j[L][0]))}return _},this.lineIntersection=function(f,v,_,L){let g=[];for(let u=0;u<p.length;u++)g.push.apply(g,p[u].lineIntersection(f,v,_,L));return g},this.boxIntersection=function(f,v,_,L){let g=[];for(let u=0;u<p.length;u++)g.push.apply(g,p[u].boxIntersection(f,v,_,L));return g},this.boundingBoxIntersection=function(f){let v=[];for(let _=0;_<p.length;_++)v.push.apply(v,p[_].boundingBoxIntersection(f));return v};let n=function(){let f=0;for(let v=0;v<p.length;v++){let _=p[v].getLength();S[v]=_/x,j[v]=[f,f+=_/x]}},y=function(f,v){v&&(f=f>0?f/x:(x+f)/x);let _=j.length-1,L=1;for(let g=0;g<j.length;g++)if(j[g][1]>=f){_=g,L=f===1?1:f===0?0:(f-j[g][0])/S[g];break}return{segment:p[_],proportion:L,index:_}},h=function(f,v,_){if(_.x1===_.x2&&_.y1===_.y2)return;let L=new c.Segments[v](_);p.push(L),x+=L.getLength(),f.updateBounds(L)},D=function(){x=p.length=j.length=S.length=0};this.setSegments=function(f){O=[],x=0;for(let v=0;v<f.length;v++)O.push(f[v]),x+=f[v].getLength()},this.getLength=function(){return x};let M=function(f){this.strokeWidth=f.strokeWidth;let v=Q.quadrant(f.sourcePos,f.targetPos),_=f.targetPos[0]<f.sourcePos[0],L=f.targetPos[1]<f.sourcePos[1],g=f.strokeWidth||1,u=f.sourceEndpoint.anchor.getOrientation(f.sourceEndpoint),m=f.targetEndpoint.anchor.getOrientation(f.targetEndpoint),A=_?f.targetPos[0]:f.sourcePos[0],F=L?f.targetPos[1]:f.sourcePos[1],i=Math.abs(f.targetPos[0]-f.sourcePos[0]),e=Math.abs(f.targetPos[1]-f.sourcePos[1]);if(u[0]===0&&u[1]===0||m[0]===0&&m[1]===0){let V=i>e?0:1,ot=[1,0][V];u=[],m=[],u[V]=f.sourcePos[V]>f.targetPos[V]?-1:1,m[V]=f.sourcePos[V]>f.targetPos[V]?1:-1,u[ot]=0,m[ot]=0}let d=_?i+G*u[0]:G*u[0],C=L?e+G*u[1]:G*u[1],w=_?U*m[0]:i+U*m[0],B=L?U*m[1]:e+U*m[1],z=u[0]*m[0]+u[1]*m[1],Y={sx:d,sy:C,tx:w,ty:B,lw:g,xSpan:Math.abs(w-d),ySpan:Math.abs(B-C),mx:(d+w)/2,my:(C+B)/2,so:u,to:m,x:A,y:F,w:i,h:e,segment:v,startStubX:d+u[0]*s,startStubY:C+u[1]*s,endStubX:w+m[0]*l,endStubY:B+m[1]*l,isXGreaterThanStubTimes2:Math.abs(d-w)>s+l,isYGreaterThanStubTimes2:Math.abs(C-B)>s+l,opposite:z===-1,perpendicular:z===0,orthogonal:z===1,sourceAxis:u[0]===0?"y":"x",points:[A,F,i,e,d,C,w,B],stubs:[s,l]};return Y.anchorOrientation=Y.opposite?"opposite":Y.orthogonal?"orthogonal":"perpendicular",Y};return this.getSegments=function(){return p},this.updateBounds=function(f){let v=f.getBounds();this.bounds.minX=Math.min(this.bounds.minX,v.minX),this.bounds.maxX=Math.max(this.bounds.maxX,v.maxX),this.bounds.minY=Math.min(this.bounds.minY,v.minY),this.bounds.maxY=Math.max(this.bounds.maxY,v.maxY)},this.pointOnPath=function(f,v){let _=y(f,v);return _.segment&&_.segment.pointOnPath(_.proportion,!1)||[0,0]},this.gradientAtPoint=function(f,v){let _=y(f,v);return _.segment&&_.segment.gradientAtPoint(_.proportion,!1)||0},this.pointAlongPathFrom=function(f,v,_){let L=y(f,_);return L.segment&&L.segment.pointAlongPathFrom(L.proportion,v,!1)||[0,0]},this.compute=function(f){b=M.call(this,f),D(),this._compute(b,f),this.x=b.points[0],this.y=b.points[1],this.w=b.points[2],this.h=b.points[3],this.segment=b.segment,n()},{addSegment:h,prepareCompute:M,sourceStub:s,targetStub:l,maxStub:Math.max(s,l),sourceGap:G,targetGap:U,maxGap:Math.max(G,U)}},H.extend(c.Connectors.AbstractConnector,J),c.Endpoints.AbstractEndpoint=function(t){return J.apply(this,arguments),{compute:this.compute=function(x,j,S,I){let s=this._compute.apply(this,arguments);return this.x=s[0],this.y=s[1],this.w=s[2],this.h=s[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,s},cssClass:t.cssClass}},H.extend(c.Endpoints.AbstractEndpoint,J),c.Endpoints.Dot=function(t){this.type="Dot",c.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(p,x,j,S){this.radius=j.radius||this.radius;let I=p[0]-this.radius,s=p[1]-this.radius,l=this.radius*2,N=this.radius*2;if(j.stroke){let G=j.strokeWidth||1;I-=G,s-=G,l+=G*2,N+=G*2}return[I,s,l,N,this.radius]}},H.extend(c.Endpoints.Dot,c.Endpoints.AbstractEndpoint),c.Endpoints.Rectangle=function(t){this.type="Rectangle",c.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(p,x,j,S){let I=j.width||this.width,s=j.height||this.height,l=p[0]-I/2,N=p[1]-s/2;return[l,N,I,s]}},H.extend(c.Endpoints.Rectangle,c.Endpoints.AbstractEndpoint);let W=function(t){c.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};H.extend(W,c.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),c.Endpoints.Image=function(t){this.type="Image",W.apply(this,arguments),c.Endpoints.AbstractEndpoint.apply(this,arguments);let p=t.onload,x=t.src||t.url,j=t.cssClass?" "+t.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=t.width,this._jsPlumb.heightToUse=t.height,this._jsPlumb.endpoint=t.endpoint,this._jsPlumb.img.onload=(function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,p&&p(this))}).bind(this),this._jsPlumb.endpoint.setImage=(function(S,I){let s=S.constructor===String?S:S.src;p=I,this._jsPlumb.img.src=s,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}).bind(this),this._jsPlumb.endpoint.setImage(x,p),this._compute=function(S,I,s,l){return this.anchorPoint=S,this._jsPlumb.ready?[S[0]-this._jsPlumb.widthToUse/2,S[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=c.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+j),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(S,I,s){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);let l=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,N=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;H.sizeElement(this.canvas,l,N,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(S,I){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(S,I):X.setTimeout((function(){this.paint(S,I)}).bind(this),200))}},H.extend(c.Endpoints.Image,[W,c.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),c.Endpoints.Blank=function(t){c.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",W.apply(this,arguments),this._compute=function(x,j,S,I){return[x[0],x[1],10,0]};let p=t.cssClass?" "+t.cssClass:"";this.canvas=c.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+p),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(x,j){H.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},H.extend(c.Endpoints.Blank,[c.Endpoints.AbstractEndpoint,W],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),c.Endpoints.Triangle=function(t){this.type="Triangle",c.Endpoints.AbstractEndpoint.apply(this,arguments);let p=this;t=t||{},t.width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(x,j,S,I){let s=S.width||p.width,l=S.height||p.height,N=x[0]-s/2,G=x[1]-l/2;return[N,G,s,l]}};let r=c.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=t.location==null?.5:t.location,this.endpointLoc=t.endpointLocation==null?[.5,.5]:t.endpointLocation,this.visible=t.visible!==!1};r.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t,p){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},c.Overlays.Arrow=function(t){this.type="Arrow",r.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};let p=this;this.length=t.length||20,this.width=t.width||20,this.id=t.id,this.direction=(t.direction||1)<0?-1:1;let x=t.paintStyle||{"stroke-width":1},j=t.foldback||.623;this.computeMaxSize=function(){return p.width*1.5},this.elementCreated=function(S,I){if(this.path=S,t.events)for(let s in t.events)c.on(S,s,t.events[s])},this.draw=function(S,I){let s,l,N,G,U;if(S.pointAlongPathFrom){if(H.isString(this.loc)||this.loc>1||this.loc<0){let h=parseInt(this.loc,10),D=this.loc<0?1:0;s=S.pointAlongPathFrom(D,h,!1),l=S.pointAlongPathFrom(D,h-this.direction*this.length/2,!1),N=Q.pointOnLine(s,l,this.length)}else if(this.loc===1){if(s=S.pointOnPath(this.loc),l=S.pointAlongPathFrom(this.loc,-this.length),N=Q.pointOnLine(s,l,this.length),this.direction===-1){let h=N;N=s,s=h}}else if(this.loc===0){if(N=S.pointOnPath(this.loc),l=S.pointAlongPathFrom(this.loc,this.length),s=Q.pointOnLine(N,l,this.length),this.direction===-1){let h=N;N=s,s=h}}else s=S.pointAlongPathFrom(this.loc,this.direction*this.length/2),l=S.pointOnPath(this.loc),N=Q.pointOnLine(s,l,this.length);G=Q.perpendicularLineTo(s,N,this.width),U=Q.pointOnLine(s,N,j*this.length);let O={hxy:s,tail:G,cxy:U},b=x.stroke||I.stroke,n=x.fill||I.stroke,y=x.strokeWidth||I.strokeWidth;return{component:S,d:O,"stroke-width":y,stroke:b,fill:n,minX:Math.min(s.x,G[0].x,G[1].x),maxX:Math.max(s.x,G[0].x,G[1].x),minY:Math.min(s.y,G[0].y,G[1].y),maxY:Math.max(s.y,G[0].y,G[1].y)}}else return{component:S,minX:0,maxX:0,minY:0,maxY:0}}},H.extend(c.Overlays.Arrow,r,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=t.direction!=null?t.direction:this.direction,this.foldback=t.foldback||this.foldback},cleanup:function(){this.path&&this.canvas&&this.canvas.removeChild(this.path)}}),c.Overlays.PlainArrow=function(t){t=t||{};let p=c.extend(t,{foldback:1});c.Overlays.Arrow.call(this,p),this.type="PlainArrow"},H.extend(c.Overlays.PlainArrow,c.Overlays.Arrow),c.Overlays.Diamond=function(t){t=t||{};let p=t.length||40,x=c.extend(t,{length:p/2,foldback:2});c.Overlays.Arrow.call(this,x),this.type="Diamond"},H.extend(c.Overlays.Diamond,c.Overlays.Arrow);let E=function(t,p){return(t._jsPlumb.cachedDimensions==null||p)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},a=function(t){c.jsPlumbUIComponent.apply(this,arguments),r.apply(this,arguments);let p=this.fire;this.fire=function(){p.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=t.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){let x=this._jsPlumb.div=c.getElement(this._jsPlumb.create(this._jsPlumb.component));x.style.position="absolute",jsPlumb.addClass(x,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"")),this._jsPlumb.instance.appendElement(x),this._jsPlumb.instance.getId(x),this.canvas=x;let j="translate(-50%, -50%)";x.style.webkitTransform=j,x.style.mozTransform=j,x.style.msTransform=j,x.style.oTransform=j,x.style.transform=j,x._jsPlumb=this,t.visible===!1&&(x.style.display="none")}return this._jsPlumb.div},this.draw=function(x,j,S){let I=E(this);if(I!=null&&I.length===2){let s={x:0,y:0};if(S)s={x:S[0],y:S[1]};else if(x.pointOnPath){let G=this.loc,U=!1;(H.isString(this.loc)||this.loc<0||this.loc>1)&&(G=parseInt(this.loc,10),U=!0),s=x.pointOnPath(G,U)}else{let G=this.loc.constructor===Array?this.loc:this.endpointLoc;s={x:G[0]*x.w,y:G[1]*x.h}}let l=s.x-I[0]/2,N=s.y-I[1]/2;return{component:x,d:{minx:l,miny:N,td:I,cxy:s},minX:l,maxX:l+I[0],minY:N,maxY:N+I[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};H.extend(a,[c.jsPlumbUIComponent,r],{getDimensions:function(){return[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(E(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t,p){this._jsPlumb.div!=null&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){let t=E(this);return Math.max(t[0],t[1])},paint:function(t,p){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),c.Overlays.Custom=function(t){this.type="Custom",a.apply(this,arguments)},H.extend(c.Overlays.Custom,a),c.Overlays.GuideLines=function(){let t=this;t.length=50,t.strokeWidth=5,this.type="GuideLines",r.apply(this,arguments),c.jsPlumbUIComponent.apply(this,arguments),this.draw=function(p,x){let j=p.pointAlongPathFrom(t.loc,t.length/2),S=p.pointOnPath(t.loc),I=Q.pointOnLine(j,S,t.length),s=Q.perpendicularLineTo(j,I,40),l=Q.perpendicularLineTo(I,j,20);return{connector:p,head:j,tail:I,headLine:l,tailLine:s,minX:Math.min(j.x,I.x,l[0].x,l[1].x),minY:Math.min(j.y,I.y,l[0].y,l[1].y),maxX:Math.max(j.x,I.x,l[0].x,l[1].x),maxY:Math.max(j.y,I.y,l[0].y,l[1].y)}}},c.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;let p=c.extend({create:function(){return c.createElement("div")}},t);if(c.Overlays.Custom.call(this,p),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){let x=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",x.style.font=this.labelStyle.font,x.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(x.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){let j=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";x.style.border=this.labelStyle.borderWidth+"px solid "+j}this.labelStyle.padding&&(x.style.padding=this.labelStyle.padding)}},H.extend(c.Overlays.Label,c.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),a.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){let t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){t.label!=null&&this.setLabel(t.label)}})}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumbUtil,H=X.jsPlumbInstance,Q="jtk-group-collapsed",J="jtk-group-expanded",W="[jtk-group-content]",r="elementDraggable",E="stop",a="revert",t="_groupManager",p="_jsPlumbGroup",x="_jsPlumbGroupDrag",j="group:addMember",S="group:removeMember",I="group:add",s="group:remove",l="group:expand",N="group:collapse",G="groupDragStop",U="connectionMoved",O="internal.connectionDetached",b="removeAll",n="orphanAll",y="show",h="hide",D=function(f){let v={},_={},L={},g=this;f.bind("connection",function(e){e.source[p]!=null&&e.target[p]!=null&&e.source[p]===e.target[p]?(_[e.connection.id]=e.source[p],L[e.connection.id]=e.source[p]):(e.source[p]!=null&&(c.suggest(e.source[p].connections.source,e.connection),_[e.connection.id]=e.source[p]),e.target[p]!=null&&(c.suggest(e.target[p].connections.target,e.connection),L[e.connection.id]=e.target[p]))});function u(e){delete e.proxies;let d=_[e.id],C;d!=null&&(C=function(w){return w.id===e.id},c.removeWithFunction(d.connections.source,C),c.removeWithFunction(d.connections.target,C),delete _[e.id]),d=L[e.id],d!=null&&(C=function(w){return w.id===e.id},c.removeWithFunction(d.connections.source,C),c.removeWithFunction(d.connections.target,C),delete L[e.id])}f.bind(O,function(e){u(e.connection)}),f.bind(U,function(e){let C=(e.index===0?_:L)[e.connection.id];if(C){let w=C.connections[e.index===0?"source":"target"],B=w.indexOf(e.connection);B!==-1&&w.splice(B,1)}}),this.addGroup=function(e){f.addClass(e.getEl(),J),v[e.id]=e,e.manager=this,i(e),f.fire(I,{group:e})},this.addToGroup=function(e,d,C){if(e=this.getGroup(e),e){let w=e.getEl();if(d._isJsPlumbGroup)return;let B=d._jsPlumbGroup;if(B!==e){let z=f.getOffset(d,!0),Y=e.collapsed?f.getOffset(w,!0):f.getOffset(e.getDragArea(),!0);B!=null&&(B.remove(d,!1,C,!1,e),g.updateConnectionsForGroup(B)),e.add(d,C);let V=function(pt,$){let rt=$===0?1:0;pt.each(function(ft){ft.setVisible(!1),ft.endpoints[rt].element._jsPlumbGroup===e?(ft.endpoints[rt].setVisible(!1),F(ft,rt,e)):(ft.endpoints[$].setVisible(!1),A(ft,$,e))})};e.collapsed&&(V(f.select({source:d}),0),V(f.select({target:d}),1));let ot=f.getId(d);f.dragManager.setParent(d,ot,w,f.getId(w),z);let ct={left:z.left-Y.left,top:z.top-Y.top};if(f.setPosition(d,ct),f.dragManager.revalidateParent(d,ot,z),g.updateConnectionsForGroup(e),f.revalidate(ot),!C){let pt={group:e,el:d,pos:ct};B&&(pt.sourceGroup=B),f.fire(j,pt)}}}},this.removeFromGroup=function(e,d,C){e=this.getGroup(e),e&&e.remove(d,null,C)},this.getGroup=function(e){let d=e;if(c.isString(e)&&(d=v[e],d==null))throw new TypeError("No such group ["+e+"]");return d},this.getGroups=function(){let e=[];for(let d in v)e.push(v[d]);return e},this.removeGroup=function(e,d,C,w){e=this.getGroup(e),this.expandGroup(e,!0);let B=e[d?b:n](C,w);return f.remove(e.getEl()),delete v[e.id],delete f._groups[e.id],f.fire(s,{group:e}),B},this.removeAllGroups=function(e,d,C){for(let w in v)this.removeGroup(v[w],e,d,C)};function m(e,d){let C=e.getMembers();for(let w=0;w<C.length;w++)f[d?y:h](C[w],!0)}var A=function(e,d,C){let w=e.endpoints[d===0?1:0].element;if(w[p]&&!w[p].shouldProxy()&&w[p].collapsed)return;let B=C.getEl(),z=f.getId(B);f.proxyConnection(e,d,B,z,function(Y,V){return C.getEndpoint(Y,V)},function(Y,V){return C.getAnchor(Y,V)})};this.collapseGroup=function(e){if(e=this.getGroup(e),e==null||e.collapsed)return;let d=e.getEl();if(m(e,!1),e.shouldProxy()){let C=function(w,B){for(let z=0;z<w.length;z++){let Y=w[z];A(Y,B,e)}};C(e.connections.source,0),C(e.connections.target,1)}e.collapsed=!0,f.removeClass(d,J),f.addClass(d,Q),f.revalidate(d),f.fire(N,{group:e})};var F=function(e,d,C){f.unproxyConnection(e,d,f.getId(C.getEl()))};this.expandGroup=function(e,d){if(e=this.getGroup(e),e==null||!e.collapsed)return;let C=e.getEl();if(m(e,!0),e.shouldProxy()){let w=function(B,z){for(let Y=0;Y<B.length;Y++){let V=B[Y];F(V,z,e)}};w(e.connections.source,0),w(e.connections.target,1)}e.collapsed=!1,f.addClass(C,J),f.removeClass(C,Q),f.revalidate(C),this.repaintGroup(e),d||f.fire(l,{group:e})},this.repaintGroup=function(e){e=this.getGroup(e);let d=e.getMembers();for(let C=0;C<d.length;C++)f.revalidate(d[C])};function i(e){let d=e.getMembers(),C=f.getConnections({source:d,scope:"*"},!0),w=f.getConnections({target:d,scope:"*"},!0),B={};e.connections.source.length=0,e.connections.target.length=0;let z=function(Y){for(let V=0;V<Y.length;V++)B[Y[V].id]||(B[Y[V].id]=!0,Y[V].source._jsPlumbGroup===e?(Y[V].target._jsPlumbGroup!==e&&e.connections.source.push(Y[V]),_[Y[V].id]=e):Y[V].target._jsPlumbGroup===e&&(e.connections.target.push(Y[V]),L[Y[V].id]=e))};z(C),z(w)}this.updateConnectionsForGroup=i,this.refreshAllGroups=function(){for(let e in v)i(v[e]),f.dragManager.updateOffsets(f.getId(v[e].getEl()))}},M=function(f,v){let _=this,L=v.el;this.getEl=function(){return L},this.id=v.id||c.uuid(),L._isJsPlumbGroup=!0;let g=this.getDragArea=function(){let $=f.getSelector(L,W);return $&&$.length>0?$[0]:L},u=v.ghost===!0,m=u||v.constrain===!0,A=v.revert!==!1,F=v.orphan===!0,i=v.prune===!0,e=v.dropOverride===!0,d=v.proxied!==!1,C=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function($,rt){return v.anchor||"Continuous"},this.getEndpoint=function($,rt){return v.endpoint||["Dot",{radius:10}]},this.collapsed=!1,v.draggable!==!1){let $={stop:function(rt){f.fire(G,jsPlumb.extend(rt,{group:_}))},scope:x};v.dragOptions&&X.jsPlumb.extend($,v.dragOptions),f.draggable(v.el,$)}v.droppable!==!1&&f.droppable(v.el,{drop:function($){let rt=$.drag.el;if(rt._isJsPlumbGroup)return;let ft=rt._jsPlumbGroup;if(ft!==_){if(ft!=null&&ft.overrideDrop(rt,_))return;f.getGroupManager().addToGroup(_,rt,!1)}}});let w=function($,rt){let ft=$.nodeType==null?$:[$];for(let ut=0;ut<ft.length;ut++)rt(ft[ut])};this.overrideDrop=function($,rt){return e&&(A||i||F)},this.add=function($,rt){let ft=g();w($,function(ut){if(ut._jsPlumbGroup!=null){if(ut._jsPlumbGroup===_)return;ut._jsPlumbGroup.remove(ut,!0,rt,!1)}ut._jsPlumbGroup=_,C.push(ut),f.isAlreadyDraggable(ut)&&pt(ut),ut.parentNode!==ft&&ft.appendChild(ut)}),f.getGroupManager().updateConnectionsForGroup(_)},this.remove=function($,rt,ft,ut,ht){w($,function(Ct){if(Ct._jsPlumbGroup===_){if(delete Ct._jsPlumbGroup,c.removeWithFunction(C,function(mt){return mt===Ct}),rt)try{_.getDragArea().removeChild(Ct)}catch(mt){jsPlumbUtil.log("Could not remove element from Group "+mt)}if(ct(Ct),!ft){let mt={group:_,el:Ct};ht&&(mt.targetGroup=ht),f.fire(S,mt)}}}),ut||f.getGroupManager().updateConnectionsForGroup(_)},this.removeAll=function($,rt){for(let ft=0,ut=C.length;ft<ut;ft++){let ht=C[0];_.remove(ht,$,rt,!0),f.remove(ht,!0)}C.length=0,f.getGroupManager().updateConnectionsForGroup(_)},this.orphanAll=function(){let $={};for(let rt=0;rt<C.length;rt++){let ft=Y(C[rt]);$[ft[0]]=ft[1]}return C.length=0,$},this.getMembers=function(){return C},L[p]=this,f.bind(r,(function($){$.el._jsPlumbGroup===this&&pt($.el)}).bind(this));function B($){return $.offsetParent}function z($,rt){let ft=B($),ut=f.getSize(ft),ht=f.getSize($),Ct=rt[0],mt=Ct+ht[0],K=rt[1],tt=K+ht[1];return mt>0&&Ct<ut[0]&&tt>0&&K<ut[1]}function Y($){let rt=f.getId($),ft=f.getOffset($);return $.parentNode.removeChild($),f.getContainer().appendChild($),f.setPosition($,ft),ct($),f.dragManager.clearParent($,rt),[rt,ft]}function V($){let rt=[];function ft(ut,ht,Ct){let mt=null;if(!z(ut,[ht,Ct])){let K=ut._jsPlumbGroup;i?f.remove(ut):mt=Y(ut),K.remove(ut)}return mt}for(let ut=0;ut<$.selection.length;ut++)rt.push(ft($.selection[ut][0],$.selection[ut][1].left,$.selection[ut][1].top));return rt.length===1?rt[0]:rt}function ot($){let rt=f.getId($);f.revalidate($),f.dragManager.revalidateParent($,rt)}function ct($){$._katavorioDrag&&((i||F)&&$._katavorioDrag.off(E,V),!i&&!F&&A&&($._katavorioDrag.off(a,ot),$._katavorioDrag.setRevert(null)))}function pt($){$._katavorioDrag&&((i||F)&&$._katavorioDrag.on(E,V),m&&$._katavorioDrag.setConstrain(!0),u&&$._katavorioDrag.setUseGhostProxy(!0),!i&&!F&&A&&($._katavorioDrag.on(a,ot),$._katavorioDrag.setRevert(function(rt,ft){return!z(rt,ft)})))}this.shouldProxy=function(){return d},f.getGroupManager().addGroup(this)};H.prototype.addGroup=function(f){let v=this;if(v._groups=v._groups||{},v._groups[f.id]!=null)throw new TypeError("cannot create Group ["+f.id+"]; a Group with that ID exists");if(f.el[p]!=null)throw new TypeError("cannot create Group ["+f.id+"]; the given element is already a Group");let _=new M(v,f);return v._groups[_.id]=_,f.collapsed&&this.collapseGroup(_),_},H.prototype.addToGroup=function(f,v,_){let L=(function(g){let u=this.getId(g);this.manage(u,g),this.getGroupManager().addToGroup(f,g,_)}).bind(this);if(Array.isArray(v))for(let g=0;g<v.length;g++)L(v[g]);else L(v)},H.prototype.removeFromGroup=function(f,v,_){this.getGroupManager().removeFromGroup(f,v,_)},H.prototype.removeGroup=function(f,v,_,L){return this.getGroupManager().removeGroup(f,v,_,L)},H.prototype.removeAllGroups=function(f,v,_){this.getGroupManager().removeAllGroups(f,v,_)},H.prototype.getGroup=function(f){return this.getGroupManager().getGroup(f)},H.prototype.getGroups=function(){return this.getGroupManager().getGroups()},H.prototype.expandGroup=function(f){this.getGroupManager().expandGroup(f)},H.prototype.collapseGroup=function(f){this.getGroupManager().collapseGroup(f)},H.prototype.repaintGroup=function(f){this.getGroupManager().repaintGroup(f)},H.prototype.toggleGroup=function(f){f=this.getGroupManager().getGroup(f),f!=null&&this.getGroupManager()[f.collapsed?"expandGroup":"collapseGroup"](f)},H.prototype.getGroupManager=function(){let f=this[t];return f==null&&(f=this[t]=new D(this)),f},H.prototype.removeGroupManager=function(){delete this[t]},H.prototype.getGroupFor=function(f){if(f=this.getElement(f),f)return f[p]}}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q="Straight",J="Arc",W=function(r){this.type="Flowchart",r=r||{},r.stub=r.stub==null?30:r.stub;let E,a=c.Connectors.AbstractConnector.apply(this,arguments),t=r.midpoint==null?.5:r.midpoint,p=r.alwaysRespectStubs===!0,x=null,j=null,S=r.cornerRadius!=null?r.cornerRadius:0;r.loopbackRadius;let I=function(O){return O<0?-1:O===0?0:1},s=function(O){return[I(O[2]-O[0]),I(O[3]-O[1])]},l=function(O,b,n,y){if(x===b&&j===n)return;let h=x??y.sx,D=j??y.sy,M=h===b?"v":"h";x=b,j=n,O.push([h,D,b,n,M])},N=function(O){return Math.sqrt(Math.pow(O[0]-O[2],2)+Math.pow(O[1]-O[3],2))},G=function(O){let b=[];return b.push.apply(b,O),b},U=function(O,b,n){let y=null,h,D,M;for(let f=0;f<b.length-1;f++){if(y=y||G(b[f]),h=G(b[f+1]),D=s(y),M=s(h),S>0&&y[4]!==h[4]){let v=Math.min(N(y),N(h)),_=Math.min(S,v/2);y[2]-=D[0]*_,y[3]-=D[1]*_,h[0]+=M[0]*_,h[1]+=M[1]*_;let L=D[1]===M[0]&&M[0]===1||D[1]===M[0]&&M[0]===0&&D[0]!==M[1]||D[1]===M[0]&&M[0]===-1,g=h[1]>y[3]?1:-1,u=h[0]>y[2]?1:-1,m=g===u,A=m&&L||!m&&!L?h[0]:y[2],F=m&&L||!m&&!L?y[3]:h[1];a.addSegment(O,Q,{x1:y[0],y1:y[1],x2:y[2],y2:y[3]}),a.addSegment(O,J,{r:_,x1:y[2],y1:y[3],x2:h[0],y2:h[1],cx:A,cy:F,ac:L})}else{let v=y[2]===y[0]?0:y[2]>y[0]?n.lw/2:-(n.lw/2),_=y[3]===y[1]?0:y[3]>y[1]?n.lw/2:-(n.lw/2);a.addSegment(O,Q,{x1:y[0]-v,y1:y[1]-_,x2:y[2]+v,y2:y[3]+_})}y=h}h!=null&&a.addSegment(O,Q,{x1:h[0],y1:h[1],x2:h[2],y2:h[3]})};this._compute=function(O,b){E=[],x=null,j=null;let n=function(){return[O.startStubX,O.startStubY,O.endStubX,O.endStubY]},h={perpendicular:n,orthogonal:n,opposite:function(i){let e=O,d=i==="x"?0:1;return!p&&{x:function(){return e.so[d]===1&&(e.startStubX>e.endStubX&&e.tx>e.startStubX||e.sx>e.endStubX&&e.tx>e.sx)||e.so[d]===-1&&(e.startStubX<e.endStubX&&e.tx<e.startStubX||e.sx<e.endStubX&&e.tx<e.sx)},y:function(){return e.so[d]===1&&(e.startStubY>e.endStubY&&e.ty>e.startStubY||e.sy>e.endStubY&&e.ty>e.sy)||e.so[d]===-1&&(e.startStubY<e.endStubY&&e.ty<e.startStubY||e.sy<e.endStubY&&e.ty<e.sy)}}[i]()?{x:[(O.sx+O.tx)/2,O.startStubY,(O.sx+O.tx)/2,O.endStubY],y:[O.startStubX,(O.sy+O.ty)/2,O.endStubX,(O.sy+O.ty)/2]}[i]:[O.startStubX,O.startStubY,O.endStubX,O.endStubY]}}[O.anchorOrientation](O.sourceAxis),D=O.sourceAxis==="x"?0:1,M=O.sourceAxis==="x"?1:0,f=h[D],v=h[M],_=h[D+2],L=h[M+2];l(E,h[0],h[1],O);let g=O.startStubX+(O.endStubX-O.startStubX)*t,u=O.startStubY+(O.endStubY-O.startStubY)*t,m={x:[0,1],y:[1,0]},F={perpendicular:function(i){let e=O,d={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},C={x:[[e.startStubX,e.endStubX],null,[e.endStubX,e.startStubX]],y:[[e.startStubY,e.endStubY],null,[e.endStubY,e.startStubY]]},w={x:[[g,e.startStubY],[g,e.endStubY]],y:[[e.startStubX,u],[e.endStubX,u]]},B={x:[[e.endStubX,e.startStubY]],y:[[e.startStubX,e.endStubY]]},z={x:[[e.startStubX,e.endStubY],[e.endStubX,e.endStubY]],y:[[e.endStubX,e.startStubY],[e.endStubX,e.endStubY]]},Y={x:[[e.startStubX,u],[e.endStubX,u],[e.endStubX,e.endStubY]],y:[[g,e.startStubY],[g,e.endStubY],[e.endStubX,e.endStubY]]},V={x:[e.startStubY,e.endStubY],y:[e.startStubX,e.endStubX]},ot=m[i][0],ct=m[i][1],pt=e.so[ot]+1,$=e.to[ct]+1,rt=e.to[ct]===-1&&V[i][1]<V[i][0]||e.to[ct]===1&&V[i][1]>V[i][0],ft=C[i][pt][0],ut=C[i][pt][1],ht=d[i][pt][$];if(e.segment===ht[3]||e.segment===ht[2]&&rt)return w[i];if(e.segment===ht[2]&&ut<ft)return B[i];if(e.segment===ht[2]&&ut>=ft||e.segment===ht[1]&&!rt)return Y[i];if(e.segment===ht[0]||e.segment===ht[1]&&rt)return z[i]},orthogonal:function(i,e,d,C,w){let B=O,z={x:B.so[0]===-1?Math.min(e,C):Math.max(e,C),y:B.so[1]===-1?Math.min(e,C):Math.max(e,C)}[i];return{x:[[z,d],[z,w],[C,w]],y:[[d,z],[w,z],[w,C]]}[i]},opposite:function(i,e,d,C){let w=O,B={x:"y",y:"x"}[i],z={x:"height",y:"width"}[i],Y=w["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(b.sourceEndpoint.elementId===b.targetEndpoint.elementId){let V=d+(1-b.sourceEndpoint.anchor[B])*b.sourceInfo[z]+a.maxStub;return{x:[[e,V],[C,V]],y:[[V,e],[V,C]]}[i]}else{if(!Y||w.so[D]===1&&e>C||w.so[D]===-1&&e<C)return{x:[[e,u],[C,u]],y:[[g,e],[g,C]]}[i];if(w.so[D]===1&&e<C||w.so[D]===-1&&e>C)return{x:[[g,w.sy],[g,w.ty]],y:[[w.sx,u],[w.tx,u]]}[i]}}}[O.anchorOrientation](O.sourceAxis,f,v,_,L);if(F)for(let i=0;i<F.length;i++)l(E,F[i][0],F[i][1],O);l(E,h[2],h[3],O),l(E,O.tx,O.ty,O),U(this,E,O)}};c.Connectors.Flowchart=W,H.extend(c.Connectors.Flowchart,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil;c.Connectors.AbstractBezierConnector=function(J){J=J||{};let W=J.showLoopback!==!1;J.curviness;let r=J.margin||5;J.proximityLimit;let E=J.orientation&&J.orientation==="clockwise",a=J.loopbackRadius||25,t;return this._compute=function(p,x){let j=x.sourcePos,S=x.targetPos,I=Math.abs(j[0]-S[0]),s=Math.abs(j[1]-S[1]);if(!W||x.sourceEndpoint.elementId!==x.targetEndpoint.elementId)this._computeBezier(p,x,j,S,I,s);else{let l=x.sourcePos[0],N=x.sourcePos[1]-r,G=l,U=N-a,O=G-a,b=U-a;I=2*a,s=2*a,p.points[0]=O,p.points[1]=b,p.points[2]=I,p.points[3]=s,t.addSegment(this,"Arc",{loopback:!0,x1:l-O+4,y1:N-b,startAngle:0,endAngle:2*Math.PI,r:a,ac:!E,x2:l-O-4,y2:N-b,cx:G-O,cy:U-b})}},t=c.Connectors.AbstractConnector.apply(this,arguments),t},H.extend(c.Connectors.AbstractBezierConnector,c.Connectors.AbstractConnector);let Q=function(J){J=J||{},this.type="Bezier";let W=c.Connectors.AbstractBezierConnector.apply(this,arguments),r=J.curviness||150,E=10;this.getCurviness=function(){return r},this._findControlPoint=function(a,t,p,x,j,S,I){let s=S[0]!==I[0]||S[1]===I[1],l=[];return s?(I[0]===0?l.push(p[0]<t[0]?a[0]+E:a[0]-E):l.push(a[0]+r*I[0]),I[1]===0?l.push(p[1]<t[1]?a[1]+E:a[1]-E):l.push(a[1]+r*S[1])):(S[0]===0?l.push(t[0]<p[0]?a[0]+E:a[0]-E):l.push(a[0]-r*S[0]),S[1]===0?l.push(t[1]<p[1]?a[1]+E:a[1]-E):l.push(a[1]+r*I[1])),l},this._computeBezier=function(a,t,p,x,j,S){let I,s,l=p[0]<x[0]?j:0,N=p[1]<x[1]?S:0,G=p[0]<x[0]?0:j,U=p[1]<x[1]?0:S;I=this._findControlPoint([l,N],p,x,t.sourceEndpoint,t.targetEndpoint,a.so,a.to),s=this._findControlPoint([G,U],x,p,t.targetEndpoint,t.sourceEndpoint,a.to,a.so),W.addSegment(this,"Bezier",{x1:l,y1:N,x2:G,y2:U,cp1x:I[0],cp1y:I[1],cp2x:s[0],cp2y:s[1]})}};c.Connectors.Bezier=Q,H.extend(Q,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=function(r,E,a,t){return r<=a&&t<=E?1:r<=a&&E<=t?2:a<=r&&t>=E?3:4},J=function(r,E,a,t,p,x,j,S,I){if(S<=I)return[r,E];if(a===1)return t[3]<=0&&p[3]>=1?[r+(t[2]<.5?-1*x:x),E]:t[2]>=1&&p[2]<=0?[r,E+(t[3]<.5?-1*j:j)]:[r+-1*x,E+-1*j];if(a===2)return t[3]>=1&&p[3]<=0?[r+(t[2]<.5?-1*x:x),E]:t[2]>=1&&p[2]<=0?[r,E+(t[3]<.5?-1*j:j)]:[r+x,E+-1*j];if(a===3)return t[3]>=1&&p[3]<=0?[r+(t[2]<.5?-1*x:x),E]:t[2]<=0&&p[2]>=1?[r,E+(t[3]<.5?-1*j:j)]:[r+-1*x,E+-1*j];if(a===4)return t[3]<=0&&p[3]>=1?[r+(t[2]<.5?-1*x:x),E]:t[2]<=0&&p[2]>=1?[r,E+(t[3]<.5?-1*j:j)]:[r+x,E+-1*j]},W=function(r){r=r||{},this.type="StateMachine";let E=c.Connectors.AbstractBezierConnector.apply(this,arguments),a=r.curviness||10,t=r.margin||5,p=r.proximityLimit||80;r.orientation&&r.orientation;let x;this._computeBezier=function(j,S,I,s,l,N){let G=S.sourcePos[0]<S.targetPos[0]?0:l,U=S.sourcePos[1]<S.targetPos[1]?0:N,O=S.sourcePos[0]<S.targetPos[0]?l:0,b=S.sourcePos[1]<S.targetPos[1]?N:0;S.sourcePos[2]===0&&(G-=t),S.sourcePos[2]===1&&(G+=t),S.sourcePos[3]===0&&(U-=t),S.sourcePos[3]===1&&(U+=t),S.targetPos[2]===0&&(O-=t),S.targetPos[2]===1&&(O+=t),S.targetPos[3]===0&&(b-=t),S.targetPos[3]===1&&(b+=t);let n=(G+O)/2,y=(U+b)/2,h=Q(G,U,O,b),D=Math.sqrt(Math.pow(O-G,2)+Math.pow(b-U,2)),M,f,v,_;x=J(n,y,h,S.sourcePos,S.targetPos,a,a,D,p),M=x[0],f=x[0],v=x[1],_=x[1],E.addSegment(this,"Bezier",{x1:O,y1:b,x2:G,y2:U,cp1x:M,cp1y:v,cp2x:f,cp2y:_})}};c.Connectors.StateMachine=W,H.extend(W,c.Connectors.AbstractBezierConnector)}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q="Straight",J=function(W){this.type=Q;let r=c.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(E,a){r.addSegment(this,Q,{x1:E.sx,y1:E.sy,x2:E.startStubX,y2:E.startStubY}),r.addSegment(this,Q,{x1:E.startStubX,y1:E.startStubY,x2:E.endStubX,y2:E.endStubY}),r.addSegment(this,Q,{x1:E.endStubX,y1:E.endStubY,x2:E.tx,y2:E.ty})}};c.Connectors.Straight=J,H.extend(J,c.Connectors.AbstractConnector)}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},J="stroke-dasharray",W="dashstyle",r="linearGradient",E="radialGradient",a="defs",t="fill",p="stop",x="stroke",j="stroke-width",S="style",I="none",s="jsplumb_gradient_",l="strokeWidth",N={svg:"http://www.w3.org/2000/svg"},G=function(v,_){for(let L in _)v.setAttribute(L,""+_[L])},U=function(v,_){return _=_||{},_.version="1.1",_.xmlns=N.svg,c.createElementNS(N.svg,v,null,null,_)},O=function(v){return"position:absolute;left:"+v[0]+"px;top:"+v[1]+"px"},b=function(v){let _=v.querySelectorAll(" defs,linearGradient,radialGradient");for(let L=0;L<_.length;L++)_[L].parentNode.removeChild(_[L])},n=function(v,_,L,g,u){let m=s+u._jsPlumb.instance.idstamp();b(v);let A;L.gradient.offset?A=U(E,{id:m}):A=U(r,{id:m,gradientUnits:"userSpaceOnUse"});let F=U(a);v.appendChild(F),F.appendChild(A);for(let e=0;e<L.gradient.stops.length;e++){let d=u.segment===1||u.segment===2?e:L.gradient.stops.length-1-e,C=L.gradient.stops[d][1],w=U(p,{offset:Math.floor(L.gradient.stops[e][0]*100)+"%","stop-color":C});A.appendChild(w)}let i=L.stroke?x:t;_.setAttribute(i,"url(#"+m+")")},y=function(v,_,L,g,u){if(_.setAttribute(t,L.fill?L.fill:I),_.setAttribute(x,L.stroke?L.stroke:I),L.gradient?n(v,_,L,g,u):(b(v),_.setAttribute(S,"")),L.strokeWidth&&_.setAttribute(j,L.strokeWidth),L[W]&&L[l]&&!L[J]){let m=L[W].indexOf(",")===-1?" ":",",A=L[W].split(m),F="";A.forEach(function(i){F+=Math.floor(i*L.strokeWidth)+m}),_.setAttribute(J,F)}else L[J]&&_.setAttribute(J,L[J]);for(let m in Q)L[m]&&_.setAttribute(Q[m],L[m])},h=function(v,_,L){v.childNodes.length>L?v.insertBefore(_,v.childNodes[L]):v.appendChild(_)};H.svg={node:U,attr:G,pos:O};let D=function(v){let _=v.pointerEventsSpec||"all",L={};c.jsPlumbUIComponent.apply(this,v.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;let g=v.cssClass+" "+(v.originalArgs[0].cssClass||""),u={style:"",width:0,height:0,"pointer-events":_,position:"absolute"};this.svg=U("svg",u),v.useDivWrapper?(this.canvas=c.createElement("div",{position:"absolute"}),H.sizeElement(this.canvas,0,0,1,1),this.canvas.className=g):(G(this.svg,{class:g}),this.canvas=this.svg),v._jsPlumb.appendElement(this.canvas,v.originalArgs[0].parent),v.useDivWrapper&&this.canvas.appendChild(this.svg);let m=[this.canvas];return this.getDisplayElements=function(){return m},this.appendDisplayElement=function(A){m.push(A)},this.paint=function(A,F,i){if(A!=null){let e=[this.x,this.y],d=[this.w,this.h],C;i!=null&&(i.xmin<0&&(e[0]+=i.xmin),i.ymin<0&&(e[1]+=i.ymin),d[0]=i.xmax+(i.xmin<0?-i.xmin:0),d[1]=i.ymax+(i.ymin<0?-i.ymin:0)),v.useDivWrapper?(H.sizeElement(this.canvas,e[0],e[1],d[0],d[1]),e[0]=0,e[1]=0,C=O([0,0])):C=O([e[0],e[1]]),L.paint.apply(this,arguments),G(this.svg,{style:C,width:d[0]||0,height:d[1]||0})}},{renderer:L}};H.extend(D,c.jsPlumbUIComponent,{cleanup:function(v){v||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(v){let _=v.getContainer();this.canvas&&this.canvas.parentNode==null&&_.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&_.appendChild(this.bgCanvas)},setVisible:function(v){this.canvas&&(this.canvas.style.display=v?"block":"none")}}),c.ConnectorRenderers.svg=function(v){let _=this,L=D.apply(this,[{cssClass:v._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:v._jsPlumb}]);L.renderer.paint=function(g,u,m){let A=_.getSegments(),F="",i=[0,0];if(m.xmin<0&&(i[0]=-m.xmin),m.ymin<0&&(i[1]=-m.ymin),A.length>0){F=_.getPathData();let e={d:F,transform:"translate("+i[0]+","+i[1]+")","pointer-events":v["pointer-events"]||"visibleStroke"},d=null,C=[_.x,_.y,_.w,_.h];if(g.outlineStroke){let w=g.outlineWidth||1,B=g.strokeWidth+2*w;d=c.extend({},g),delete d.gradient,d.stroke=g.outlineStroke,d.strokeWidth=B,_.bgPath==null?(_.bgPath=U("path",e),c.addClass(_.bgPath,c.connectorOutlineClass),h(_.svg,_.bgPath,0)):G(_.bgPath,e),y(_.svg,_.bgPath,d,C,_)}_.path==null?(_.path=U("path",e),h(_.svg,_.path,g.outlineStroke?1:0)):G(_.path,e),y(_.svg,_.path,g,C,_)}}},H.extend(c.ConnectorRenderers.svg,D);let M=c.SvgEndpoint=function(v){let _=D.apply(this,[{cssClass:v._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:v._jsPlumb}]);_.renderer.paint=(function(L){let g=c.extend({},L);g.outlineStroke&&(g.stroke=g.outlineStroke),this.node==null?(this.node=this.makeNode(g),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),y(this.svg,this.node,g,[this.x,this.y,this.w,this.h],this),O(this.node,[this.x,this.y])}).bind(this)};H.extend(M,D),c.Endpoints.svg.Dot=function(){c.Endpoints.Dot.apply(this,arguments),M.apply(this,arguments),this.makeNode=function(v){return U("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(v){G(v,{cx:this.w/2,cy:this.h/2,r:this.radius})}},H.extend(c.Endpoints.svg.Dot,[c.Endpoints.Dot,M]),c.Endpoints.svg.Rectangle=function(){c.Endpoints.Rectangle.apply(this,arguments),M.apply(this,arguments),this.makeNode=function(v){return U("rect",{width:this.w,height:this.h})},this.updateNode=function(v){G(v,{width:this.w,height:this.h})}},H.extend(c.Endpoints.svg.Rectangle,[c.Endpoints.Rectangle,M]),c.Endpoints.svg.Image=c.Endpoints.Image,c.Endpoints.svg.Blank=c.Endpoints.Blank,c.Overlays.svg.Label=c.Overlays.Label,c.Overlays.svg.Custom=c.Overlays.Custom;let f=function(v,_){v.apply(this,_),c.jsPlumbUIComponent.apply(this,_),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(g,u){if(g.component.svg&&u){this.path==null&&(this.path=U("path",{"pointer-events":"all"}),g.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,g.component),this.canvas=g.component.svg);let m=_&&_.length===1&&_[0].cssClass||"",A=[0,0];u.xmin<0&&(A[0]=-u.xmin),u.ymin<0&&(A[1]=-u.ymin),G(this.path,{d:L(g.d),class:m,stroke:g.stroke?g.stroke:null,fill:g.fill?g.fill:null,transform:"translate("+A[0]+","+A[1]+")"})}};var L=function(g){return isNaN(g.cxy.x)||isNaN(g.cxy.y)?"":"M"+g.hxy.x+","+g.hxy.y+" L"+g.tail[0].x+","+g.tail[0].y+" L"+g.cxy.x+","+g.cxy.y+" L"+g.tail[1].x+","+g.tail[1].y+" L"+g.hxy.x+","+g.hxy.y};this.transfer=function(g){g.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),g.canvas.appendChild(this.path))}};H.extend(f,[c.jsPlumbUIComponent,c.Overlays.AbstractOverlay],{cleanup:function(v){this.path!=null&&(v?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(v,_){this.path&&_.canvas&&_.canvas.appendChild(this.path)},setVisible:function(v){this.path!=null&&(this.path.style.display=v?"block":"none")}}),c.Overlays.svg.Arrow=function(){f.apply(this,[c.Overlays.Arrow,arguments])},H.extend(c.Overlays.svg.Arrow,[c.Overlays.Arrow,f]),c.Overlays.svg.PlainArrow=function(){f.apply(this,[c.Overlays.PlainArrow,arguments])},H.extend(c.Overlays.svg.PlainArrow,[c.Overlays.PlainArrow,f]),c.Overlays.svg.Diamond=function(){f.apply(this,[c.Overlays.Diamond,arguments])},H.extend(c.Overlays.svg.Diamond,[c.Overlays.Diamond,f]),c.Overlays.svg.GuideLines=function(){let v=null,_=this,L,g;c.Overlays.GuideLines.apply(this,arguments),this.paint=function(m,A){v==null&&(v=U("path"),m.connector.svg.appendChild(v),_.attachListeners(v,m.connector),_.attachListeners(v,_),L=U("path"),m.connector.svg.appendChild(L),_.attachListeners(L,m.connector),_.attachListeners(L,_),g=U("path"),m.connector.svg.appendChild(g),_.attachListeners(g,m.connector),_.attachListeners(g,_));let F=[0,0];A.xmin<0&&(F[0]=-A.xmin),A.ymin<0&&(F[1]=-A.ymin),G(v,{d:u(m.head,m.tail),stroke:"red",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),G(L,{d:u(m.tailLine[0],m.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+F[0]+","+F[1]+")"}),G(g,{d:u(m.headLine[0],m.headLine[1]),stroke:"green",fill:null,transform:"translate("+F[0]+","+F[1]+")"})};var u=function(m,A){return"M "+m.x+","+m.y+" L"+A.x+","+A.y}},H.extend(c.Overlays.svg.GuideLines,c.Overlays.GuideLines)}).call(typeof window<"u"?window:void 0);(function(){let X=this,c=X.jsPlumb,H=X.jsPlumbUtil,Q=X.Katavorio,J=X.Biltong,W=function(n){let y=n._mottle;return y||(y=n._mottle=new X.Mottle),y},r=function(n,y){y=y||"main";let h="_katavorio_"+y,D=n[h],M=n.getEventManager();return D||(D=new Q({bind:M.on,unbind:M.off,getSize:c.getSize,getConstrainingRectangle:function(f){return[f.parentNode.scrollWidth,f.parentNode.scrollHeight]},getPosition:function(f,v){let _=n.getOffset(f,v,f._katavorioDrag?f.offsetParent:null);return[_.left,_.top]},setPosition:function(f,v){f.style.left=v[0]+"px",f.style.top=v[1]+"px"},addClass:c.addClass,removeClass:c.removeClass,intersects:J.intersects,indexOf:function(f,v){return f.indexOf(v)},scope:n.getDefaultScope(),css:{noSelect:n.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),D.setZoom(n.getZoom()),n[h]=D,n.bind("zoom",D.setZoom)),D},E=function(n){let y=n.el._jsPlumbDragOptions,h=!0;return y.canDrag&&(h=y.canDrag()),h&&(this.setHoverSuspended(!0),this.select({source:n.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:n.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),h},a=function(n){let y=this.getUIPosition(arguments,this.getZoom());if(y!=null){let h=n.el._jsPlumbDragOptions;this.draw(n.el,y,null,!0),h._dragging&&this.addClass(n.el,"jtk-dragged"),h._dragging=!0}},t=function(n){let y=n.selection,h,D=(function(M){M[1]!=null&&(h=this.getUIPosition([{el:M[2].el,pos:[M[1].left,M[1].top]}]),this.draw(M[2].el,h)),M[0]._jsPlumbDragOptions!=null&&delete M[0]._jsPlumbDragOptions._dragging,this.removeClass(M[0],"jtk-dragged"),this.select({source:M[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:M[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.getDragManager().dragEnded(M[2].el)}).bind(this);for(let M=0;M<y.length;M++)D(y[M]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},p=function(n,y){let h=function(D){if(y[D]!=null)if(H.isString(y[D])){let M=y[D].match(/-=/)?-1:1,f=y[D].substring(2);return n[D]+M*f}else return y[D];else return n[D]};return[h("left"),h("top")]};var x=function(n,y){if(y==null)return[0,0];let h=l(y),D=s(h,0);return[D[n+"X"],D[n+"Y"]]},j=x.bind(this,"page"),S=x.bind(this,"screen"),I=x.bind(this,"client"),s=function(n,y){return n.item?n.item(y):n[y]},l=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]};let N=function(n){let y={},h=[],D={},M={},f={};this.register=function(v){let _=n.getId(v),L;y[_]||(y[_]=v,h.push(v),D[_]={});let g=function(u){if(u){for(let m=0;m<u.childNodes.length;m++)if(u.childNodes[m].nodeType!==3&&u.childNodes[m].nodeType!==8){let A=jsPlumb.getElement(u.childNodes[m]),F=n.getId(u.childNodes[m],null,!0);if(F&&M[F]&&M[F]>0){L||(L=n.getOffset(v));let i=n.getOffset(A);D[_][F]={id:F,offset:{left:i.left-L.left,top:i.top-L.top}},f[F]=_}g(u.childNodes[m])}}};g(v)},this.updateOffsets=function(v,_){if(v!=null){_=_||{};let L=jsPlumb.getElement(v),g=n.getId(L),u=D[g],m;if(u){for(let A in u)if(u.hasOwnProperty(A)){let F=jsPlumb.getElement(A),i=_[A]||n.getOffset(F);if(F.offsetParent==null&&D[g][A]!=null)continue;m||(m=n.getOffset(L)),D[g][A]={id:A,offset:{left:i.left-m.left,top:i.top-m.top}},f[A]=g}}}},this.endpointAdded=function(v,_){_=_||n.getId(v);let L=document.body,g=v.parentNode;for(M[_]=M[_]?M[_]+1:1;g!=null&&g!==L;){let u=n.getId(g,null,!0);if(u&&y[u]){let m=n.getOffset(g);if(D[u][_]==null){let A=n.getOffset(v);D[u][_]={id:_,offset:{left:A.left-m.left,top:A.top-m.top}},f[_]=u}break}g=g.parentNode}},this.endpointDeleted=function(v){if(M[v.elementId]&&(M[v.elementId]--,M[v.elementId]<=0))for(let _ in D)D.hasOwnProperty(_)&&D[_]&&(delete D[_][v.elementId],delete f[v.elementId])},this.changeId=function(v,_){D[_]=D[v],D[v]={},f[_]=f[v],f[v]=null},this.getElementsForDraggable=function(v){return D[v]},this.elementRemoved=function(v){let _=f[v];_&&(delete D[_][v],delete f[v])},this.reset=function(){y={},h=[],D={},M={}},this.dragEnded=function(v){if(v.offsetParent!=null){let _=n.getId(v),L=f[_];L&&this.updateOffsets(L)}},this.setParent=function(v,_,L,g,u){let m=f[_];D[g]||(D[g]={});let A=n.getOffset(L),F=u||n.getOffset(v);m&&D[m]&&delete D[m][_],D[g][_]={id:_,offset:{left:F.left-A.left,top:F.top-A.top}},f[_]=g},this.clearParent=function(v,_){let L=f[_];L&&(delete D[L][_],delete f[_])},this.revalidateParent=function(v,_,L){let g=f[_];if(g){let u={};u[_]=L,this.updateOffsets(g,u),n.revalidate(g)}},this.getDragAncestor=function(v){let _=jsPlumb.getElement(v),L=n.getId(_),g=f[L];return g?jsPlumb.getElement(g):null}},G=function(n,y,h){y=H.fastTrim(y),typeof n.className.baseVal<"u"?n.className.baseVal=y:n.className=y;try{let D=n.classList;if(D!=null){for(;D.length>0;)D.remove(D.item(0));for(let M=0;M<h.length;M++)h[M]&&D.add(h[M])}}catch(D){H.log("JSPLUMB: cannot set class list",D)}},U=function(n){return typeof n.className.baseVal>"u"?n.className:n.className.baseVal},O=function(n,y,h){y=y==null?[]:H.isArray(y)?y:y.split(/\s+/),h=h==null?[]:H.isArray(h)?h:h.split(/\s+/);let D=U(n),M=D.split(/\s+/),f=function(v,_){for(let L=0;L<_.length;L++)if(v)M.indexOf(_[L])===-1&&M.push(_[L]);else{let g=M.indexOf(_[L]);g!==-1&&M.splice(g,1)}};f(!0,y),f(!1,h),G(n,M.join(" "),M)};X.jsPlumb.extend(X.jsPlumbInstance.prototype,{headless:!1,pageLocation:j,screenLocation:S,clientLocation:I,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new N(this)),this.dragManager},recalculateOffsets:function(n){this.getDragManager().updateOffsets(n)},createElement:function(n,y,h,D){return this.createElementNS(null,n,y,h,D)},createElementNS:function(n,y,h,D,M){let f=n==null?document.createElement(y):document.createElementNS(n,y),v;h=h||{};for(v in h)f.style[v]=h[v];D&&(f.className=D),M=M||{};for(v in M)f.setAttribute(v,""+M[v]);return f},getAttribute:function(n,y){return n.getAttribute!=null?n.getAttribute(y):null},setAttribute:function(n,y,h){n.setAttribute!=null&&n.setAttribute(y,h)},setAttributes:function(n,y){for(let h in y)y.hasOwnProperty(h)&&n.setAttribute(h,y[h])},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["svg"]},getClass:U,addClass:function(n,y){jsPlumb.each(n,function(h){O(h,y)})},hasClass:function(n,y){return n=jsPlumb.getElement(n),n.classList?n.classList.contains(y):U(n).indexOf(y)!==-1},removeClass:function(n,y){jsPlumb.each(n,function(h){O(h,null,y)})},toggleClass:function(n,y){jsPlumb.hasClass(n,y)?jsPlumb.removeClass(n,y):jsPlumb.addClass(n,y)},updateClasses:function(n,y,h){jsPlumb.each(n,function(D){O(D,y,h)})},setClass:function(n,y){y!=null&&jsPlumb.each(n,function(h){G(h,y,y.split(/\s+/))})},setPosition:function(n,y){n.style.left=y.left+"px",n.style.top=y.top+"px"},getPosition:function(n){let y=function(h){let D=n.style[h];return D?D.substring(0,D.length-2):0};return{left:y("left"),top:y("top")}},getStyle:function(n,y){return typeof window.getComputedStyle<"u"?getComputedStyle(n,null).getPropertyValue(y):n.currentStyle[y]},getSelector:function(n,y){let h=null;return arguments.length===1?h=n.nodeType!=null?n:document.querySelectorAll(n):h=n.querySelectorAll(y),h},getOffset:function(n,y,h){n=jsPlumb.getElement(n),h=h||this.getContainer();let D={left:n.offsetLeft,top:n.offsetTop},M=y||h!=null&&n!==h&&n.offsetParent!==h?n.offsetParent:null,f=(function(v){v!=null&&v!==document.body&&(v.scrollTop>0||v.scrollLeft>0)&&(D.left-=v.scrollLeft,D.top-=v.scrollTop)}).bind(this);for(;M!=null;)D.left+=M.offsetLeft,D.top+=M.offsetTop,f(M),M=y?M.offsetParent:M.offsetParent===h?null:M.offsetParent;if(h!=null&&!y&&(h.scrollTop>0||h.scrollLeft>0)){let v=n.offsetParent!=null?this.getStyle(n.offsetParent,"position"):"static",_=this.getStyle(n,"position");_!=="absolute"&&_!=="fixed"&&v!=="absolute"&&v!=="fixed"&&(D.left-=h.scrollLeft,D.top-=h.scrollTop)}return D},getPositionOnElement:function(n,y,h){let D=typeof y.getBoundingClientRect<"u"?y.getBoundingClientRect():{left:0,top:0,width:0,height:0},M=document.body,f=document.documentElement,v=window.pageYOffset||f.scrollTop||M.scrollTop,_=window.pageXOffset||f.scrollLeft||M.scrollLeft,L=f.clientTop||M.clientTop||0,g=f.clientLeft||M.clientLeft||0,u=0,m=0,A=D.top+v-L+u*h,F=D.left+_-g+m*h,i=jsPlumb.pageLocation(n),e=D.width||y.offsetWidth*h,d=D.height||y.offsetHeight*h,C=(i[0]-F)/e,w=(i[1]-A)/d;return[C,w]},getAbsolutePosition:function(n){let y=function(h){let D=n.style[h];if(D)return parseFloat(D.substring(0,D.length-2))};return[y("left"),y("top")]},setAbsolutePosition:function(n,y,h,D){h?this.animate(n,{left:"+="+(y[0]-h[0]),top:"+="+(y[1]-h[1])},D):(n.style.left=y[0]+"px",n.style.top=y[1]+"px")},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(n,y){let h;return n=H.isArray(n)||n.length!=null&&!H.isString(n)?n:[n],Array.prototype.slice.call(n).forEach((function(D){h=this.info(D),h.el&&this._initDraggableIfNecessary(h.el,!0,y,h.id,!0)}).bind(this)),this},snapToGrid:function(n,y,h){let D=[],M=(function(f){let v=this.info(f);if(v.el!=null&&v.el._katavorioDrag){let _=v.el._katavorioDrag.snap(y,h);this.revalidate(v.el),D.push([v.el,_])}}).bind(this);if(arguments.length===1||arguments.length===3)M(n,y,h);else{let f=this.getManagedElements();for(let v in f)M(v,arguments[0],arguments[1])}return D},initDraggable:function(n,y,h){r(this,h).draggable(n,y),n._jsPlumbDragOptions=y},destroyDraggable:function(n,y){r(this,y).destroyDraggable(n),delete n._jsPlumbDragOptions},unbindDraggable:function(n,y,h,D){r(this,D).destroyDraggable(n,y,h)},setDraggable:function(n,y){return jsPlumb.each(n,(function(h){this.isDragSupported(h)&&(this._draggableStates[this.getAttribute(h,"id")]=y,this.setElementDraggable(h,y))}).bind(this))},_draggableStates:{},toggleDraggable:function(n){let y;return jsPlumb.each(n,(function(h){let D=this.getAttribute(h,"id");return y=this._draggableStates[D]==null?!1:this._draggableStates[D],y=!y,this._draggableStates[D]=y,this.setDraggable(h,y),y}).bind(this)),y},_initDraggableIfNecessary:function(n,y,h,D,M){if(!jsPlumb.headless&&(y??!1)&&jsPlumb.isDragSupported(n,this)){let v=h||this.Defaults.DragOptions;if(v=jsPlumb.extend({},v),jsPlumb.isAlreadyDraggable(n,this))h.force&&this.initDraggable(n,v);else{let _=jsPlumb.dragEvents.drag,L=jsPlumb.dragEvents.stop,g=jsPlumb.dragEvents.start;this.manage(D,n),v[g]=H.wrap(v[g],E.bind(this)),v[_]=H.wrap(v[_],a.bind(this)),v[L]=H.wrap(v[L],t.bind(this));let u=this.getId(n);this._draggableStates[u]=!0;let m=this._draggableStates[u];v.disabled=m==null?!1:!m,this.initDraggable(n,v),this.getDragManager().register(n),M&&this.fire("elementDraggable",{el:n,options:v})}}},animationSupported:!0,getElement:function(n){return n==null?null:(n=typeof n=="string"?n:n.length!=null&&n.enctype==null?n[0]:n,typeof n=="string"?document.getElementById(n):n)},removeElement:function(n){r(this).elementRemoved(n),this.getEventManager().remove(n)},doAnimate:function(n,y,h){h=h||{};var D=this.getOffset(n),M=p(D,y),f=M[0]-D.left,v=M[1]-D.top,_=h.duration||250,L=15,g=_/L,u=L/_*f,m=L/_*v,A=0,F=setInterval(function(){c.setPosition(n,{left:D.left+u*(A+1),top:D.top+m*(A+1)}),h.step!=null&&h.step(A,Math.ceil(g)),A++,A>=g&&(window.clearInterval(F),h.complete!=null&&h.complete())},L)},destroyDroppable:function(n,y){r(this,y).destroyDroppable(n)},unbindDroppable:function(n,y,h,D){r(this,D).destroyDroppable(n,y,h)},droppable:function(n,y){n=H.isArray(n)||n.length!=null&&!H.isString(n)?n:[n];let h;return y=y||{},y.allowLoopback=!1,Array.prototype.slice.call(n).forEach((function(D){h=this.info(D),h.el&&this.initDroppable(h.el,y)}).bind(this)),this},initDroppable:function(n,y,h){r(this,h).droppable(n,y)},isAlreadyDraggable:function(n){return n._katavorioDrag!=null},isDragSupported:function(n,y){return!0},isDropSupported:function(n,y){return!0},isElementDraggable:function(n){return n=c.getElement(n),n._katavorioDrag&&n._katavorioDrag.isEnabled()},getDragObject:function(n){return n[0].drag.getDragElement()},getDragScope:function(n){return n._katavorioDrag&&n._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(n){return n[0].e},getUIPosition:function(n,y){let h=n[0].el;if(h.offsetParent==null)return null;let D=n[0].finalPos||n[0].pos,M={left:D[0],top:D[1]};if(h._katavorioDrag&&h.offsetParent!==this.getContainer()){let f=this.getOffset(h.offsetParent);M.left+=f.left,M.top+=f.top}return M},setDragFilter:function(n,y,h){n._katavorioDrag&&n._katavorioDrag.setFilter(y,h)},setElementDraggable:function(n,y){n=c.getElement(n),n._katavorioDrag&&n._katavorioDrag.setEnabled(y)},setDragScope:function(n,y){n._katavorioDrag&&n._katavorioDrag.k.setDragScope(n,y)},setDropScope:function(n,y){n._katavorioDrop&&n._katavorioDrop.length>0&&n._katavorioDrop[0].k.setDropScope(n,y)},addToPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(n,function(M){M=[c.getElement(M)],M.push.apply(M,h),D.addToPosse.apply(D,M)})},setPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(n,function(M){M=[c.getElement(M)],M.push.apply(M,h),D.setPosse.apply(D,M)})},removeFromPosse:function(n,y){let h=Array.prototype.slice.call(arguments,1),D=r(this);c.each(n,function(M){M=[c.getElement(M)],M.push.apply(M,h),D.removeFromPosse.apply(D,M)})},removeFromAllPosses:function(n){let y=r(this);c.each(n,function(h){y.removeFromAllPosses(c.getElement(h))})},setPosseState:function(n,y,h){let D=r(this);c.each(n,function(M){D.setPosseState(c.getElement(M),y,h)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(n){n._katavorioDrag&&n._katavorioDrag.abort()},addToDragSelection:function(n){r(this).select(n)},removeFromDragSelection:function(n){r(this).deselect(n)},clearDragSelection:function(){r(this).deselectAll()},trigger:function(n,y,h,D){this.getEventManager().trigger(n,y,h,D)},doReset:function(){for(let n in this)n.indexOf("_katavorio_")===0&&this[n].reset()},getEventManager:function(){return W(this)},on:function(n,y,h){return this.getEventManager().on.apply(this,arguments),this},off:function(n,y,h){return this.getEventManager().off.apply(this,arguments),this}}),function(n){let y=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?n():setTimeout(y,9)};y()}(c.init)}).call(typeof window<"u"?window:void 0);const ge={jsplumbSetting:{Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"efContainer",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.1,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},Scope:"jsPlumb_DefaultScope"},jsplumbConnectOptions:{isSource:!0,isTarget:!0,anchor:"Continuous",labelStyle:{cssClass:"flowLabel"},emptyLabelStyle:{cssClass:"emptyFlowLabel"}},jsplumbSourceOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!1,connectorStyle:{stroke:"#b1b1b1",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#999999",strokeWidth:1.5}},jsplumbSourceOptions2:{filter:".flow-node-drag",filterExclude:!1,allowLoopback:!0,connector:["Flowchart",{curviness:50}],connectorStyle:{stroke:"#1089ff",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"#0d6ecc",strokeWidth:1.5}},jsplumbTargetOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}}};class Yn{constructor(c){this.loadEasyFlowFinish=!1,this.jsplumb=jsPlumb.getInstance(),this.init(c)}init(c){this.jsplumb.ready(()=>{this.jsplumb.importDefaults(ge.jsplumbSetting),this.jsplumb.setSuspendDrawing(!1,!0),this.loadEasyFlow(c),this.loadEasyFlowFinish=!0,this.jsplumb.setContainer(document.querySelector("#efContainer"))})}loadEasyFlow(c){const{nodeList:H,lineList:Q}=c,J=je(ce(ge.jsplumbSourceOptions),{}),W=je(ce(ge.jsplumbTargetOptions),{});for(let r=0;r<H.length;r++){let E=H[r];this.jsplumb.makeSource(E.id,J),this.jsplumb.makeTarget(E.id,W),E.viewOnly||this.jsplumb.draggable(E.id,{containment:"parent"})}for(let r=0;r<Q.length;r++){let E=Q[r],a={source:E.from,target:E.to,label:E.label?E.label:"",connector:E.connector?E.connector:"",anchors:E.anchors?E.anchors:void 0,paintStyle:E.paintStyle?E.paintStyle:void 0};this.jsplumb.connect(a,ge.jsplumbConnectOptions)}}getConnections(c,H){return this.jsplumb.getConnections({source:c,target:H})[0]}deleteConnection(c,H){const Q=this.getConnections(c,H);this.jsplumb.deleteConnection(Q)}removeAllEndpoints(c){this.jsplumb.removeAllEndpoints(c)}addNode(c){const H=je(ce(ge.jsplumbSourceOptions),{}),Q=je(ce(ge.jsplumbTargetOptions),{});this.jsplumb.makeSource(c,H),this.jsplumb.makeTarget(c,Q),this.jsplumb.draggable(c,{containment:"parent"})}repaint(){this.jsplumb.repaint()}}let Xn={name:"流程A",nodeList:[{id:"nodeA",name:"流程A-节点A",type:"switch",left:"26px",top:"161px"},{id:"nodeB",name:"流程A-节点B",type:"common",left:"340px",top:"161px"},{id:"nodeC",name:"流程A-节点C",type:"common",left:"739px",top:"161px"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},Wn={name:"流程B",nodeList:[{id:"nodeA",name:"节点A-不可拖拽",type:"common",left:"18px",top:"223px",ico:"user",state:"success",viewOnly:!0},{id:"nodeB",type:"common",name:"流程B-节点B",left:"351px",top:"96px",ico:"bug",state:"error"},{id:"nodeC",name:"流程B-节点C",type:"common",left:"354px",top:"351px",ico:"index",state:"warning"},{id:"nodeD",name:"流程B-节点D",type:"common",left:"723px",top:"215px",ico:"printer",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"条件A"},{from:"nodeA",to:"nodeC",label:"条件B"},{from:"nodeB",to:"nodeD"},{from:"nodeC",to:"nodeD"}]},zn={name:"流程C",nodeList:[{id:"nodeA",name:"流程C-节点A",type:"common",left:"400px",top:"15px",ico:"smile"},{id:"nodeB",name:"流程C-节点B",type:"common",left:"400px",top:"200px",ico:"smile"},{id:"nodeC",name:"流程C-节点C",type:"common",left:"400px",top:"378px",ico:"smile"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},qn={name:"流程D",nodeList:[{id:"nodeA",name:"流程D-节点A",type:"common",left:"18px",top:"223px",ico:"smile",state:"success"},{id:"nodeB",type:"common",name:"流程D-节点B",left:"351px",top:"96px",ico:"smile",state:"error"},{id:"nodeC",name:"流程D-节点C",type:"common",left:"354px",top:"351px",ico:"smile",state:"warning"},{id:"nodeD",name:"流程D-节点D",type:"common",left:"723px",top:"215px",ico:"smile",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"直线,自定义线样式,固定锚点",connector:"Straight",anchors:["Top","Bottom"],paintStyle:{strokeWidth:2,stroke:"#1879FF"}},{from:"nodeA",to:"nodeC",label:"贝塞尔曲线,固定锚点",connector:"Bezier",anchors:["Bottom","Left"]},{from:"nodeB",to:"nodeD",label:"流程图线,动态锚点",connector:["Flowchart",{curviness:50}]},{from:"nodeC",to:"nodeD",label:"状态机,动态锚点",connector:["StateMachine",{margin:8,curviness:10,proximityLimit:80}]},{from:"nodeC",to:"nodeC",label:"自连接"}]};function $n(X="dataB"){return ce({dataA:Xn,dataB:Wn,dataC:zn,dataD:qn}[X])}const Jn=X=>(Ae("data-v-afc1a08e"),X=X(),ke(),X),Zn={class:"ef-toolbar"},Kn={style:{float:"right","margin-right":"5px"}},Qn={key:0,class:"easy-flow"},ti={class:"left-side"},ei=Jn(()=>Et("div",{class:"move-grid",style:{position:"absolute",top:"2000px",left:"2000px"}}," ",-1)),ni={class:"right-side"},ii={name:"EasyFlow"},si=Object.assign(ii,{props:{height:{type:String,default:"100%"},repeat:{type:Boolean,default:!0}},setup(X){const c=X,H=Jt(!1),Q=Jt(null),J=Jt(null),W=Jt(!1),r=Jt(!1),E=Jt({nodeList:[],lineList:[]}),a=Jt({type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}),t=Be({show:!1,type:"",left:0,top:0});let p;Xe(()=>{S("dataA")});function x(u,m){const{lineList:A}=E.value;return A.findIndex(F=>F.from===u&&F.to===m)>-1}function j(u,m){return x(m,u)}async function S(u){const m=$n(u);a.value.type="node",a.value.nodeId="",H.value=!1,E.value={nodeList:[],lineList:[]},await we(),H.value=!0,E.value=ce(m),await we(),I()}function I(){p=new Yn(E.value),p.jsplumb.bind("click",h),p.jsplumb.bind("connection",M),p.jsplumb.bind("connectionDetached",f),p.jsplumb.bind("connectionMoved",v),p.jsplumb.bind("contextmenu",(u,m)=>{m.preventDefault(),n(u,m)}),p.jsplumb.bind("beforeDrop",D),console.log("----------new plumb----------",p)}function s(){}function l(u){a.value.type="node",a.value.nodeId=u,Q.value.nodeInit(E.value,u)}function N(u){const{nodeList:m}=E.value;for(let A=0;A<m.length;A++){let F=m[A];F.id===u.nodeId&&(F.left=u.left,F.top=u.top)}}function G(u){const m=E.value.nodeList.findIndex(A=>A.id===u);E.value.nodeList.splice(m,1),we(()=>{p.removeAllEndpoints(u)})}function U(){const{type:u,nodeId:m,sourceId:A,targetId:F}=a.value;qe.confirm({type:"warning",title:"提示",message:`确定删除当前选中的${u==="node"?"节点":"连接线"}吗?`}).then(()=>{u==="node"?G(m):u==="line"&&p.deleteConnection(A,F)}).catch(()=>{})}function O(u){u.preventDefault();let m=u.dataTransfer.getData("node"),A={};try{A=JSON.parse(m)}catch{console.log("drag data is not right json!");return}const F=J.value.getBoundingClientRect(),i=u.clientX,e=u.clientY,d=i-F.x+J.value.scrollLeft-85,C=e-F.y+J.value.scrollTop-16;let w=A.name,B=w,z=A.id;if(c.repeat){let V=1;for(;V<1e4;){let ot=!1;for(let ct=0;ct<E.value.nodeList.length;ct++)E.value.nodeList[ct].name===B&&(B=w+V,ot=!0);if(ot){V++;continue}break}z=ze()}const Y={id:z,name:B,type:A.type,left:d+"px",top:C+"px",ico:A.ico};E.value.nodeList.push(Y),we(()=>p.addNode(z))}function b(u,m){l(u),t.show=!0,t.type="node",t.left=m.clientX+"px",t.top=m.clientY+"px"}function n(u,m){h(u),t.show=!0,t.type="line",t.left=m.clientX+"px",t.top=m.clientY+"px"}function y(){t.show=!1}Ue(()=>t.show,u=>{u?document.body.addEventListener("click",y):document.body.removeEventListener("click",y)});function h(u){a.value.type="line",a.value.sourceId=u.sourceId,a.value.targetId=u.targetId,Q.value.lineInit(E.value,{from:u.sourceId,to:u.targetId,label:u.getLabel()})}function D(u){const{sourceId:m,targetId:A}=u;return m===A?!1:x(m,A)?(Oe.error("该关系已存在,不允许重复创建"),!1):j(m,A)?(Oe.error("不支持两个节点之间连线回环"),!1):(Oe.success("连接成功"),!0)}function M(u){const{sourceId:m,targetId:A}=u;p.loadEasyFlowFinish&&E.value.lineList.push({from:m,to:A})}function f(u){const{sourceId:m,targetId:A}=u,F=E.value.lineList.findIndex(i=>i.from===m&&i.to===A);E.value.lineList.splice(F,1)}function v(u){const{originalSourceId:m,originalTargetId:A}=u,F=E.value.lineList.findIndex(i=>i.from===m&&i.to===A);E.value.lineList.splice(F,1)}function _({from:u,to:m,label:A}){let F=p.getConnections(u,m);!A||A===""?(F.removeClass("flowLabel"),F.addClass("emptyFlowLabel")):F.addClass("flowLabel"),F.setLabel({label:A}),E.value.lineList.forEach(i=>{i.from===u&&i.to===m&&(i.label=A)})}function L(){p.repaint()}function g(){a.value={type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0}}return(u,m)=>{const A=Ot("b-button"),F=Ot("b-divider"),i=Ot("b-dropdown-item"),e=Ot("b-dropdown-menu"),d=Ot("b-dropdown"),C=We("flow-drag");return wt(),At("div",{class:"easy-flow-container",style:Le({height:X.height})},[Et("div",Zn,[bt(A,{type:"text"},{default:xt(()=>[Nt(oe(E.value.name),1)]),_:1}),bt(F,{type:"vertical"}),bt(A,{type:"text",icon:"delete",onClick:U,disabled:!a.value.type},null,8,["disabled"]),Et("div",Kn,[bt(A,{size:"small",type:"info",plain:"",icon:"filedone",onClick:m[0]||(m[0]=w=>W.value=!0)},{default:xt(()=>[Nt(" 流程信息 ")]),_:1}),bt(d,{trigger:"click",style:{margin:"0 10px"},onCommand:S},{dropdown:xt(()=>[bt(e,null,{default:xt(()=>[bt(i,{name:"dataA"},{default:xt(()=>[Nt("dataA")]),_:1}),bt(i,{name:"dataB"},{default:xt(()=>[Nt("dataB")]),_:1}),bt(i,{name:"dataC"},{default:xt(()=>[Nt("dataC")]),_:1}),bt(i,{name:"dataD"},{default:xt(()=>[Nt("dataD")]),_:1})]),_:1})]),default:xt(()=>[bt(A,{size:"small",type:"info",plain:"",icon:"database"},{default:xt(()=>[Nt("数据源")]),_:1})]),_:1}),bt(A,{size:"small",type:"info",plain:"",icon:"book",onClick:m[1]||(m[1]=w=>r.value=!0)},{default:xt(()=>[Nt(" 帮助 ")]),_:1})])]),H.value?(wt(),At("div",Qn,[Et("div",ti,[bt(Pn,{repeat:X.repeat,data:E.value},null,8,["repeat","data"])]),Rt((wt(),At("div",{class:"canvas-side",id:"efContainer",ref_key:"efContainer",ref:J,onClick:Me(s,["self"]),onDragover:m[2]||(m[2]=Me(()=>{},["prevent"])),onDrop:O},[(wt(!0),At(ie,null,ye(E.value.nodeList,w=>(wt(),he(rn,{key:w.id,id:w.id,node:w,activeElement:a.value,onClickNode:l,onChangeNodeSite:N,onNodeRightMenu:b},null,8,["id","node","activeElement"]))),128)),ei],32)),[[C]]),Et("div",ni,[bt(Mn,{ref_key:"nodeFormRef",ref:Q,onSetLineLabel:_,onSaveNode:L,onCancelSelect:g},null,512)]),bt(Fn,{modelValue:W.value,"onUpdate:modelValue":m[3]||(m[3]=w=>W.value=w),data:E.value},null,8,["modelValue","data"]),bt(Tn,{data:t,onDelete:U},null,8,["data"])])):se("",!0),bt(Vn,{modelValue:r.value,"onUpdate:modelValue":m[4]||(m[4]=w=>r.value=w)},null,8,["modelValue"])],4)}}}),oi=be(si,[["__scopeId","data-v-afc1a08e"]]),li={class:"p16 wrapper"},di={__name:"index",setup(X){return(c,H)=>(wt(),At("div",li,[bt(oi)]))}};export{di as default};
