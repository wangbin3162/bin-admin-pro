import{a8 as j,r as z,n as P,Q as c,o as _,a as b,b as l,K as o,w as s,f as V,i as y,a9 as G,aa as H,l as W,F as q,R as x,j as S,t as A,H as Y}from"./vendor-B29aizbt.js";import"./chunk-bin-ui-design-CMJ2EfEK.js";import{D as X,q as Z}from"./index-C63pl2jy.js";import"./chunk-brace-BklEY0pF.js";import"./chunk-mockjs-CGXE1Baq.js";const T={name:"styles-editor",props:{modelValue:{type:String,default:""},showAction:{type:Boolean,default:!0},simple:{type:Boolean,default:!0},height:{type:String,default:"100px"}},emits:["update:modelValue","change"],setup(h,{emit:i}){const r=z(""),e=z("25%");function L(){i("update:modelValue",r.value),i("change",r.value)}function U(){r.value="width: 25%;",L()}function g(){const u=h.modelValue;u.includes("width: 25%;")?e.value="25%":u.includes("width: 50%;")?e.value="50%":u.includes("width: 75%;")?e.value="75%":u.includes("width: 100%;")?e.value="100%":e.value=""}return P(()=>h.modelValue,u=>{if(u===""){U();return}g(),r.value=u},{immediate:!0}),P(()=>e.value,u=>{r.value=`width: ${u};`,L()}),{width:e,styleValue:r,emitValue:L,resetStyle:U}}},B=h=>(G("data-v-e6669812"),h=h(),H(),h),$={key:0,class:"styles-editor-simple-wrap"},ee={class:"mb-5",flex:"cross:center"},oe=B(()=>l("span",{class:"ml-5"},"/ 4",-1)),le={key:1,class:"styles-editor-wrap"},ae={flex:"main:justify"},ne={class:"editor-box"},te={key:0,class:"action-box"},se={class:"mb-5",flex:"main:justify cross:center"},ie=B(()=>l("div",null,"样式显示",-1)),de=B(()=>l("div",{class:"mb-5"},[l("div",null,"宽度设置")],-1)),ce={class:"mb-5",flex:"cross:center"},re=B(()=>l("span",{class:"ml-5"},"/ 4",-1));function ue(h,i,r,e,L,U){const g=c("b-radio"),u=c("b-radio-group"),R=c("b-ace-editor"),w=c("b-icon"),D=c("b-tooltip"),E=c("b-space");return r.simple?(_(),b("div",$,[l("div",ee,[o(u,{modelValue:e.width,"onUpdate:modelValue":i[0]||(i[0]=v=>e.width=v),type:"button",size:"mini"},{default:s(()=>[o(g,{label:"25%"},{default:s(()=>[V("1")]),_:1}),o(g,{label:"50%"},{default:s(()=>[V("2")]),_:1}),o(g,{label:"75%"},{default:s(()=>[V("3")]),_:1}),o(g,{label:"100%"},{default:s(()=>[V("4")]),_:1})]),_:1},8,["modelValue"]),oe])])):(_(),b("div",le,[l("div",ae,[l("div",ne,[o(R,{modelValue:e.styleValue,"onUpdate:modelValue":i[1]||(i[1]=v=>e.styleValue=v),lang:"stylus",height:r.height,"font-size":14,onBlur:e.emitValue},null,8,["modelValue","height","onBlur"])]),r.showAction?(_(),b("div",te,[l("div",se,[ie,o(E,null,{default:s(()=>[o(D,{content:"输入样式表，默认控件宽度皆为25%"},{default:s(()=>[o(w,{name:"question-circle",size:18})]),_:1}),o(D,{content:"重置样式"},{default:s(()=>[o(w,{name:"sync",size:18,type:"button",onClick:e.resetStyle},null,8,["onClick"])]),_:1})]),_:1})]),de,l("div",ce,[o(u,{modelValue:e.width,"onUpdate:modelValue":i[2]||(i[2]=v=>e.width=v),type:"button",size:"mini"},{default:s(()=>[o(g,{label:"25%"},{default:s(()=>[V("1")]),_:1}),o(g,{label:"50%"},{default:s(()=>[V("2")]),_:1}),o(g,{label:"75%"},{default:s(()=>[V("3")]),_:1}),o(g,{label:"100%"},{default:s(()=>[V("4")]),_:1})]),_:1},8,["modelValue"]),re])])):y("",!0)])]))}const me=j(T,[["render",ue],["__scopeId","data-v-e6669812"]]),O=["blur","change"],J=["string","number"],K={length:"$length",email:"$email",phone:"$phone",idCode:"$idCode",unifiedCode:"$unifiedCode",orgInstCode:"$orgInstCode",regNo:"$regNo"},M={regexp:"$regexp",conditionRequired:"$conditionRequired",conditionNotRequired:"$conditionNotRequired",conditionNotBe:"$conditionNotBe",notSame:"$notSame",timeBound:"$timeBound"},m={required:"$required",...K,...M},_e={$required:"必填项",$length:"长度参数",$email:"邮箱参数",$phone:"手机号码",$regexp:"正则匹配",$idCode:"身份证",$unifiedCode:"统一社会信用代码",$orgInstCode:"组织机构代码",$regNo:"工商注册号",$conditionRequired:"条件必填",$conditionNotRequired:"条件必不填",$conditionNotBe:"条件不为某值",$notSame:"值不能相同",$timeBound:"日期区间"},he={name:"async-validator",components:{DragHandle:X},props:{modelValue:{type:String,default:""},dataLength:Number,originalRules:{type:String},showLog:Boolean},emits:["update:modelValue","change"],setup(h,{emit:i}){const r=z(!1),e=z([]),{listRef:L}=Z(e,C),U=W(()=>!!g(m.required)),g=n=>e.value.find(d=>d.name===n);function u(n){return M[n]?!1:!!g(n)}function R(n){return n===m.required?"is-required":M[n.slice(1)]?"is-multiple":"is-normal"}function w(n){n.preventDefault()}function D(n,d){e.value[d].hasOwnProperty("preField")&&(e.value[d].preField=n.dataTransfer.getData("index")),e.value[d].hasOwnProperty("time")&&(e.value[d].time=n.dataTransfer.getData("index")),C(),n.preventDefault()}function E(n){n?v(m.required):(e.value=e.value.filter(d=>d.name!==m.required),C())}function v(n){if(n===m.required&&U.value)return;const d=I=>({name:I,type:J[0],trigger:O[0]});switch(n){case m.required:e.value.unshift({...d(n),message:"必填项"});break;case m.length:e.value.push({...d(n),min:1,max:h.dataLength||1/0,message:"长度必须在指定的范围内"});break;case m.email:e.value.push({...d(n),message:"邮箱格式不正确"});break;case m.phone:e.value.push({...d(n),message:"手机号格式不正确"});break;case m.idCode:e.value.push({...d(n),preField:"",message:"身份证格式不正确",ignoreCase:!0});break;case m.unifiedCode:e.value.push({...d(n),preField:"",message:"统一社会信用代码格式不正确",ignoreCase:!0});break;case m.orgInstCode:e.value.push({...d(n),preField:"",message:"组织机构代码格式不正确",ignoreCase:!0});break;case m.regNo:e.value.push({...d(n),preField:"",message:"工商注册号格式不正确",ignoreCase:!0});break;case m.regexp:e.value.push({...d(n),regexp:"",message:"正则表达式不匹配"});break;case m.conditionRequired:e.value.push({...d(n),preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下必填"});break;case m.conditionNotRequired:e.value.push({...d(n),preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下不可填写"});break;case m.conditionNotBe:e.value.push({...d(n),preField:"",preFieldValue:"",notValue:"",message:"当前字段在前置字段条件达成下不能为某值"});break;case m.notSame:e.value.push({...d(n),preField:"",message:"不能和前置字段值相同"});break;case m.timeBound:e.value.push({...d(n),time:"$now",compareMode:"gt",message:"日期不符合区间设置"});break}C()}function N(n){e.value.splice(n,1),C()}function k(){h.originalRules&&(i("update:modelValue",h.originalRules),i("change",h.originalRules))}function F(){e.value=[],r.value=!1,C()}function C(){const n=e.value.length?JSON.stringify(e.value):"";i("update:modelValue",n),i("change",n)}return P(()=>h.modelValue,n=>{if(n===""){F();return}try{e.value=JSON.parse(n),r.value=U.value}catch{console.warn("async-validator: model-value is not a right json，rules is reset"),F()}},{immediate:!0}),{rulesRef:L,SIMPLE_RULE:K,MULTIPLE_RULE:M,RULE:m,RULE_NAME_MAP:_e,TRIGGER:O,TYPE:J,hasRequiredRule:U,isRequired:r,checkRules:e,rulesClass:R,requiredChange:E,setRules:v,removeRules:N,hasSameRule:u,emitValue:C,allowDrop:w,onDrop:D,reload:k,refreshRules:F}}},f=h=>(G("data-v-2f120c01"),h=h(),H(),h),pe={class:"validator-wrap"},ge={class:"mb-10",style:{padding:"0 4px"}},fe={style:{width:"100%","line-height":"32px"},flex:"main:justify"},be={style:{cursor:"pointer",color:"#13c2c2"}},Ve={style:{cursor:"pointer",color:"#52c41a"}},ve=f(()=>l("i",{class:"b-iconfont b-icon-reload"},null,-1)),Re=f(()=>l("i",{class:"b-iconfont b-icon-mr"},null,-1)),ke={class:"check-rules-wrap",ref:"rulesRef"},Ce={class:"rules-params"},ye={class:"title-box",title:"触发条件"},Ue=f(()=>l("span",{title:"输入框为失焦事件，其余控件为改变事件"},"触发条件",-1)),we={class:"title-box",title:"取值类型"},De=f(()=>l("span",{title:"非数字类型选择字符"},"取值类型",-1)),Le={class:"rules-cfg"},Ee={key:0,class:"title-box is-message",title:"正则规则"},qe=f(()=>l("span",null,"正则规则",-1)),Fe={class:"title-box",title:"最小值"},Ne=f(()=>l("span",{style:{width:"60px"}},"最小值",-1)),Se={class:"title-box",title:"最大值"},Me=f(()=>l("span",{style:{width:"60px"}},"最大值",-1)),ze=["onDrop"],Be=f(()=>l("span",null,"前置字段",-1)),Ie=["onDrop"],xe=f(()=>l("span",null,"前置字段",-1)),Ae={class:"title-box",title:"前置字段值"},Pe=f(()=>l("span",null,"前置字段值",-1)),je=["onDrop"],Oe=f(()=>l("span",null,"前置字段",-1)),Je={class:"title-box",title:"前置字段值"},Ge=f(()=>l("span",null,"前置字段值",-1)),He={class:"title-box",title:"不是某值"},Ke=f(()=>l("span",null,"不是某值",-1)),Qe=["onDrop"],We=f(()=>l("span",null,"前置字段",-1)),Ye={class:"title-box",title:"比较模式"},Xe=f(()=>l("span",null,"比较模式",-1)),Ze=["onDrop"],Te=f(()=>l("span",{title:"比较值(yyyy-MM-dd)，可以是字段名，也可以填写$now取得当前时间"}," 比较取值 ",-1)),$e={class:"rules-message"},eo={class:"title-box is-message",title:"错误提示"},oo=f(()=>l("span",null,"错误提示",-1)),lo={class:"delete"},ao={key:0};function no(h,i,r,e,L,U){const g=c("b-checkbox"),u=c("b-divider"),R=c("b-icon"),w=c("b-dropdown-item"),D=c("b-dropdown-menu"),E=c("b-dropdown"),v=c("b-button"),N=c("b-tooltip"),k=c("b-option"),F=c("b-select"),C=c("b-space"),n=c("b-input"),d=c("b-input-number"),I=c("drag-handle"),Q=c("b-ace-editor");return _(),b("div",pe,[l("div",ge,[l("div",fe,[l("div",null,[o(g,{modelValue:e.isRequired,"onUpdate:modelValue":i[0]||(i[0]=p=>e.isRequired=p),onChange:e.requiredChange,style:{"margin-right":"0"}},{default:s(()=>[V(" 必填项 ")]),_:1},8,["modelValue","onChange"]),o(u,{type:"vertical"}),o(E,{onCommand:e.setRules},{dropdown:s(()=>[o(D,null,{default:s(()=>[(_(!0),b(q,null,x(e.SIMPLE_RULE,(p,t)=>(_(),S(w,{key:t,name:p,disabled:e.hasSameRule(p)},{default:s(()=>[V(A(e.RULE_NAME_MAP[p]),1)]),_:2},1032,["name","disabled"]))),128))]),_:1})]),default:s(()=>[l("span",be,[V(" 静态规则 "),o(R,{name:"down"})])]),_:1},8,["onCommand"]),o(u,{type:"vertical"}),o(E,{onCommand:e.setRules},{dropdown:s(()=>[o(D,null,{default:s(()=>[(_(!0),b(q,null,x(e.MULTIPLE_RULE,(p,t)=>(_(),S(w,{key:t,name:p},{default:s(()=>[V(A(e.RULE_NAME_MAP[p]),1)]),_:2},1032,["name"]))),128))]),_:1})]),default:s(()=>[l("span",Ve,[V(" 动态规则 "),o(R,{name:"down"})])]),_:1},8,["onCommand"])]),l("div",null,[o(N,{content:"初始化校验"},{default:s(()=>[o(v,{background:"",size:"mini",onClick:e.refreshRules},{default:s(()=>[ve]),_:1},8,["onClick"])]),_:1}),r.originalRules?(_(),S(N,{key:0,content:"恢复修改前校验"},{default:s(()=>[o(v,{background:"",size:"mini",onClick:e.reload},{default:s(()=>[Re]),_:1},8,["onClick"])]),_:1})):y("",!0)])])]),l("ul",ke,[(_(!0),b(q,null,x(e.checkRules,(p,t)=>(_(),b("li",{key:t,class:"rules-list-item"},[l("div",Ce,[o(C,null,{default:s(()=>[l("div",{class:Y(["role-name",e.rulesClass(p.name)])},A(e.RULE_NAME_MAP[p.name]),3),l("div",ye,[Ue,o(F,{modelValue:e.checkRules[t].trigger,"onUpdate:modelValue":a=>e.checkRules[t].trigger=a,size:"small","append-to-body":"",onChange:e.emitValue},{default:s(()=>[o(k,{label:"失焦",value:"blur"}),o(k,{label:"改变",value:"change"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),l("div",we,[De,o(F,{modelValue:e.checkRules[t].type,"onUpdate:modelValue":a=>e.checkRules[t].type=a,size:"small","append-to-body":"",onChange:e.emitValue},{default:s(()=>[o(k,{label:"字符",value:"string"}),o(k,{label:"数字",value:"number"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])]),_:2},1024)]),l("div",Le,[p.name===e.RULE.regexp?(_(),b("div",Ee,[qe,o(n,{modelValue:e.checkRules[t].regexp,"onUpdate:modelValue":a=>e.checkRules[t].regexp=a,modelModifiers:{trim:!0},size:"small",placeholder:"需输入字符格式",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])):y("",!0),o(C,null,{default:s(()=>[p.name===e.RULE.length?(_(),b(q,{key:0},[l("div",Fe,[Ne,o(d,{modelValue:e.checkRules[t].min,"onUpdate:modelValue":a=>e.checkRules[t].min=a,min:1,max:r.dataLength,precision:0,size:"small",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])]),l("div",Se,[Me,o(d,{modelValue:e.checkRules[t].max,"onUpdate:modelValue":a=>e.checkRules[t].max=a,min:1,max:r.dataLength,precision:0,size:"small",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])])],64)):y("",!0),[e.RULE.idCode,e.RULE.unifiedCode,e.RULE.orgInstCode,e.RULE.regNo].includes(p.name)?(_(),b(q,{key:1},[l("div",{class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,t),onDragover:i[1]||(i[1]=a=>e.allowDrop(a))},[Be,o(n,{modelValue:e.checkRules[t].preField,"onUpdate:modelValue":a=>e.checkRules[t].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,ze),o(g,{modelValue:e.checkRules[t].ignoreCase,"onUpdate:modelValue":a=>e.checkRules[t].ignoreCase=a,onChange:e.emitValue},{default:s(()=>[V(" 忽略大小写 ")]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])],64)):y("",!0),p.name===e.RULE.conditionRequired||p.name===e.RULE.conditionNotRequired?(_(),b(q,{key:2},[l("div",{class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,t),onDragover:i[2]||(i[2]=a=>e.allowDrop(a))},[xe,o(n,{modelValue:e.checkRules[t].preField,"onUpdate:modelValue":a=>e.checkRules[t].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Ie),l("div",Ae,[Pe,o(n,{modelValue:e.checkRules[t].preFieldValue,"onUpdate:modelValue":a=>e.checkRules[t].preFieldValue=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):y("",!0),p.name===e.RULE.conditionNotBe?(_(),b(q,{key:3},[l("div",{class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,t),onDragover:i[3]||(i[3]=a=>e.allowDrop(a))},[Oe,o(n,{modelValue:e.checkRules[t].preField,"onUpdate:modelValue":a=>e.checkRules[t].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,je),l("div",Je,[Ge,o(n,{modelValue:e.checkRules[t].preFieldValue,"onUpdate:modelValue":a=>e.checkRules[t].preFieldValue=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])]),l("div",He,[Ke,o(n,{modelValue:e.checkRules[t].notValue,"onUpdate:modelValue":a=>e.checkRules[t].notValue=a,modelModifiers:{trim:!0},size:"small",placeholder:"不是某值",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):y("",!0),p.name===e.RULE.notSame?(_(),b("div",{key:4,class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,t),onDragover:i[4]||(i[4]=a=>e.allowDrop(a))},[We,o(n,{modelValue:e.checkRules[t].preField,"onUpdate:modelValue":a=>e.checkRules[t].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Qe)):y("",!0),p.name===e.RULE.timeBound?(_(),b(q,{key:5},[l("div",Ye,[Xe,o(F,{modelValue:e.checkRules[t].compareMode,"onUpdate:modelValue":a=>e.checkRules[t].compareMode=a,"append-to-body":"",size:"small",onChange:e.emitValue},{default:s(()=>[o(k,{value:"gt",label:">"}),o(k,{value:"ge",label:"≥"}),o(k,{value:"lt",label:"<"}),o(k,{value:"le",label:"≤"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),l("div",{class:"title-box",onDrop:a=>e.onDrop(a,t),onDragover:i[5]||(i[5]=a=>e.allowDrop(a))},[Te,o(n,{modelValue:e.checkRules[t].time,"onUpdate:modelValue":a=>e.checkRules[t].time=a,modelModifiers:{trim:!0},size:"small",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Ze)],64)):y("",!0)]),_:2},1024)]),l("div",$e,[l("div",eo,[oo,o(n,{modelValue:e.checkRules[t].message,"onUpdate:modelValue":a=>e.checkRules[t].message=a,modelModifiers:{trim:!0},size:"small",placeholder:"错误提示",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),o(I,{icon:"drag-drop-line"}),l("div",lo,[o(R,{title:"移除",color:"#f5222d",name:"minus-circle",size:"20",type:"button",onClick:a=>e.removeRules(t)},null,8,["onClick"])])]))),128))],512),r.showLog?(_(),b("div",ao,[o(Q,{"model-value":JSON.stringify(e.checkRules,null,2),readonly:""},null,8,["model-value"])])):y("",!0)])}const to=j(he,[["render",no],["__scopeId","data-v-2f120c01"]]),so={name:"FuncService",components:{AsyncValidator:to,StylesEditor:me}},io={class:"p10",style:{"min-height":"200px"}},co={class:"p10"};function ro(h,i,r,e,L,U){const g=c("async-validator"),u=c("b-collapse-wrap"),R=c("b-col"),w=c("styles-editor"),D=c("b-row"),E=c("page-wrapper");return _(),S(E,{desc:"业务相关的独立组件，包含通用校验配置，字段样式配置等，可参考进行扩展或实现新的业务组件。"},{default:s(()=>[o(D,{gutter:16},{default:s(()=>[o(R,{span:"12"},{default:s(()=>[o(u,{title:"表单校验",shadow:"none"},{default:s(()=>[l("div",io,[o(g)])]),_:1})]),_:1}),o(R,{span:"12"},{default:s(()=>[o(u,{title:"字段样式配置",shadow:"none"},{default:s(()=>[l("div",co,[o(w,{simple:!1})])]),_:1})]),_:1})]),_:1})]),_:1})}const go=j(so,[["render",ro]]);export{go as default};
