var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{i as d,g as u}from"./index-c2ebc9d7.js";import{_ as i}from"./page-wrapper-ea777216.js";import{_ as s}from"./index-60e21d33.js";import{_ as c}from"./iconfont-5bbc32b2.js";import{f as p,J as m,o as f,c as b,w as h,B as v,u as y,T as g,d as _,z as N,A as w,q as j,t as V,a as C,a7 as S,a8 as k}from"./vendor-b1b195f8.js";import{u as O}from"./useForm-1a257857.js";import{a as P}from"./chunk-bin-ui-next-f06badfa.js";import"./chunk-brace-7f859248.js";function x(){return d({url:"/menu/tree",method:"get"})}const F={name:"Menu",components:{Iconfont:c,BaseTree:s,PageWrapper:i},setup(){const e=p(null),d=p(null),i=p({}),s=p({}),{formRef:c,editStatus:m,pageStatus:f,editLoading:b,openCreate:h,openEdit:v,backNormal:y,submitForm:g,resetForm:_}=O();function N(e="edit"){if("edit"!==e){var c,p;i.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}else{const e=s.value,m=d.value,f=e[m.nodeKey].parent,b=f||0===f?e[f].node:{};i.value=m?(c=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))r.call(a,t)&&n(e,t,a[t]);return e})({},u(m)),p={parentPath:0===f?"":b.path,parentName:b.title},a(c,t(p))):{}}}function w(){N("create"),h()}return{treeRef:e,getMenuTree:x,currentNode:d,copyNode:i,handleSelect:function(e,a){e.selected?(d.value=e,s.value=a,N("edit"),v()):(d.value=null,s.value=null,i.value={},y())},handleSubmit:function(){g((()=>{b.value=!0;const a=f.value;setTimeout((()=>{P.success((a.isCreate?"新增":"修改")+"成功！"),y();const t=d.value?[d.value.nodeKey]:[];e.value&&e.value.reloadTree(t),b.value=!1}),1e3)}))},handleResetForm:function(){N(m.value),_()},handleCommand:function(e){if("root"===e&&w(),"child"===e){w();const e=d.value;i.value.parentPath=e.path,i.value.parentName=e.title}},formRef:c,pageStatus:f,editLoading:b,submitForm:g,resetForm:_,ruleValidate:{path:[{required:!0,message:"菜单路径必填",trigger:"blur"}],title:[{required:!0,message:"菜单名称必填",trigger:"blur"}]}}}},R=e=>(S("data-v-12ed773d"),e=e(),k(),e),T={class:"table-menu"},M=j("增加根节点"),U=j("增加子节点"),q={class:"table-menu-right"},I={flex:"main:justify cross:center",style:{"font-weight":"normal"}},L={class:"top"},B=R((()=>v("span",{class:"ml-5"},"编辑菜单",-1))),E={style:{position:"relative","min-height":"100px",overflow:"hidden"}},K={style:{position:"absolute",width:"100%"}},z=j("点选左侧部门，进行编辑操作"),A={key:0,class:"pt-8"},D=j("重置"),J=j("系统菜单根节点不可编辑");F.render=function(e,a,t,l,o,r){const n=m("b-dropdown-item"),d=m("base-tree"),u=m("iconfont"),i=m("b-alert"),s=m("b-input"),c=m("b-form-item"),p=m("b-icon-select"),S=m("b-button"),k=m("b-form"),O=m("b-col"),P=m("b-row"),x=m("b-card"),F=m("page-wrapper");return f(),b(F,{desc:"页面内容为Mock数据，仅作示例使用。"},{default:h((()=>[v("div",T,[y(d,{ref:"treeRef","tree-title":"菜单列表","show-filter":"","title-key":"title",fetch:l.getMenuTree,onSelectChange:l.handleSelect,onCommand:l.handleCommand},{ctrl:h((()=>[y(n,{name:"root",divided:""},{default:h((()=>[M])),_:1}),y(n,{name:"child",disabled:!l.currentNode},{default:h((()=>[U])),_:1},8,["disabled"])])),_:1},8,["fetch","onSelectChange","onCommand"]),v("div",q,[y(x,{bordered:!1,class:"card-panel",shadow:"never"},{header:h((()=>[v("div",I,[v("div",L,[y(u,{icon:"menu",color:"primary",bg:"",round:""}),B])])])),default:h((()=>[v("div",E,[y(g,{name:"fade-in"},{default:h((()=>[v("div",K,[_(y(i,null,{default:h((()=>[z])),_:1},512),[[N,l.pageStatus.isNormal]])])])),_:1}),y(g,{name:"fade-transverse"},{default:h((()=>[l.pageStatus.isNormal?C("",!0):(f(),w("div",A,["root"!==l.copyNode.path?(f(),b(P,{key:0},{default:h((()=>[y(O,{span:"14"},{default:h((()=>[y(k,{ref:"formRef",model:l.copyNode,rules:l.ruleValidate,"label-width":"100px","label-suffix":":"},{default:h((()=>[y(c,{label:"父级菜单"},{default:h((()=>[y(s,{modelValue:l.copyNode.parentName,"onUpdate:modelValue":a[0]||(a[0]=e=>l.copyNode.parentName=e),disabled:""},null,8,["modelValue"])])),_:1}),y(c,{label:"菜单名称",prop:"title"},{default:h((()=>[y(s,{modelValue:l.copyNode.title,"onUpdate:modelValue":a[1]||(a[1]=e=>l.copyNode.title=e),placeholder:"输入菜单名称",clearable:""},null,8,["modelValue"])])),_:1}),y(c,{label:"菜单路径",prop:"path"},{default:h((()=>[y(s,{modelValue:l.copyNode.path,"onUpdate:modelValue":a[2]||(a[2]=e=>l.copyNode.path=e),placeholder:"输入菜单路径",clearable:""},null,8,["modelValue"])])),_:1}),y(c,{label:"菜单图标"},{default:h((()=>[y(p,{modelValue:l.copyNode.icon,"onUpdate:modelValue":a[3]||(a[3]=e=>l.copyNode.icon=e)},null,8,["modelValue"])])),_:1}),y(c,null,{default:h((()=>[y(S,{type:"primary",onClick:l.handleSubmit,loading:l.editLoading},{default:h((()=>[j(V(l.pageStatus.isCreate?"提交数据":"更新数据"),1)])),_:1},8,["onClick","loading"]),y(S,{onClick:l.handleResetForm},{default:h((()=>[D])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})):(f(),b(i,{key:1,type:"error","show-icon":""},{default:h((()=>[J])),_:1}))]))])),_:1})])])),_:1})])])])),_:1})},F.__scopeId="data-v-12ed773d";export{F as default};
