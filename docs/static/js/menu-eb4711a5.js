var K=Object.defineProperty,L=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var P=(n,e,l)=>e in n?K(n,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[e]=l,D=(n,e)=>{for(var l in e||(e={}))z.call(e,l)&&P(n,l,e[l]);if(M)for(var l of M(e))A.call(e,l)&&P(n,l,e[l]);return n},U=(n,e)=>L(n,j(e));import{k as J,h as W}from"./index-29e89477.js";import{P as G}from"./page-wrapper-4e694ef0.js";import{B as H}from"./index-2e920e3f.js";import{I as O}from"./iconfont-389a0ea1.js";import{a5 as Q,f as w,J as r,o as C,c as T,w as a,B as u,u as o,T as q,d as X,z as Y,A as Z,q as _,t as $,a as ee,a9 as te,aa as oe}from"./vendor-9f2db7f5.js";import{u as ae}from"./useForm-a0f70d6e.js";import{a as ne}from"./chunk-bin-ui-next-39e3ad1f.js";import"./chunk-brace-f547fd93.js";function le(){return J({url:"/menu/tree",method:"get"})}const re={name:"Menu",components:{Iconfont:O,BaseTree:H,PageWrapper:G},setup(){const n=w(null),e=w(null),l=w({}),t=w({}),{formRef:F,editStatus:I,pageStatus:p,editLoading:f,openCreate:S,openEdit:b,backNormal:m,submitForm:i,resetForm:v}=ae();function y(s,c){s.selected?(e.value=s,t.value=c,x()):k()}function V(s){if(s==="root"&&g(),s==="child"){g();const c=e.value;l.value.parentPath=c.path,l.value.parentName=c.title}}function h(s="edit"){if(s==="edit"){const c=t.value,B=e.value,N=c[B.nodeKey].parent,R=N||N===0?c[N].node:{};l.value=B?U(D({},W(B)),{parentPath:N===0?"":R.path,parentName:R.title}):{};return}l.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function k(){e.value=null,t.value=null,l.value={},m()}function g(){h("create"),S()}function x(){h("edit"),b()}function d(){i(()=>{f.value=!0;const s=p.value;setTimeout(()=>{ne.success(`${s.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),m();const c=e.value?[e.value.nodeKey]:[];n.value&&n.value.reloadTree(c),f.value=!1},1e3)})}function E(){h(I.value),v()}return{treeRef:n,getMenuTree:le,currentNode:e,copyNode:l,handleSelect:y,handleSubmit:d,handleResetForm:E,handleCommand:V,formRef:F,pageStatus:p,editLoading:f,submitForm:i,resetForm:v,ruleValidate:{path:[{required:!0,message:"\u83DC\u5355\u8DEF\u5F84\u5FC5\u586B",trigger:"blur"}],title:[{required:!0,message:"\u83DC\u5355\u540D\u79F0\u5FC5\u586B",trigger:"blur"}]}}}},de=n=>(te("data-v-12ed773d"),n=n(),oe(),n),se={class:"table-menu"},ce=_("\u589E\u52A0\u6839\u8282\u70B9"),ie=_("\u589E\u52A0\u5B50\u8282\u70B9"),ue={class:"table-menu-right"},me={flex:"main:justify cross:center",style:{"font-weight":"normal"}},_e={class:"top"},pe=de(()=>u("span",{class:"ml-5"},"\u7F16\u8F91\u83DC\u5355",-1)),fe={style:{position:"relative","min-height":"100px",overflow:"hidden"}},he={style:{position:"absolute",width:"100%"}},be=_("\u70B9\u9009\u5DE6\u4FA7\u90E8\u95E8\uFF0C\u8FDB\u884C\u7F16\u8F91\u64CD\u4F5C"),ve={key:0,class:"pt-8"},ye=_("\u91CD\u7F6E"),ge=_("\u7CFB\u7EDF\u83DC\u5355\u6839\u8282\u70B9\u4E0D\u53EF\u7F16\u8F91");function Ne(n,e,l,t,F,I){const p=r("b-dropdown-item"),f=r("base-tree"),S=r("iconfont"),b=r("b-alert"),m=r("b-input"),i=r("b-form-item"),v=r("b-icon-select"),y=r("b-button"),V=r("b-form"),h=r("b-col"),k=r("b-row"),g=r("b-card"),x=r("page-wrapper");return C(),T(x,{desc:"\u9875\u9762\u5185\u5BB9\u4E3AMock\u6570\u636E\uFF0C\u4EC5\u4F5C\u793A\u4F8B\u4F7F\u7528\u3002"},{default:a(()=>[u("div",se,[o(f,{ref:"treeRef","tree-title":"\u83DC\u5355\u5217\u8868","show-filter":"","title-key":"title",fetch:t.getMenuTree,onSelectChange:t.handleSelect,onCommand:t.handleCommand},{ctrl:a(()=>[o(p,{name:"root",divided:""},{default:a(()=>[ce]),_:1}),o(p,{name:"child",disabled:!t.currentNode},{default:a(()=>[ie]),_:1},8,["disabled"])]),_:1},8,["fetch","onSelectChange","onCommand"]),u("div",ue,[o(g,{bordered:!1,class:"card-panel",shadow:"never"},{header:a(()=>[u("div",me,[u("div",_e,[o(S,{icon:"menu",color:"primary",bg:"",round:""}),pe])])]),default:a(()=>[u("div",fe,[o(q,{name:"fade-in"},{default:a(()=>[u("div",he,[X(o(b,null,{default:a(()=>[be]),_:1},512),[[Y,t.pageStatus.isNormal]])])]),_:1}),o(q,{name:"fade-transverse"},{default:a(()=>[t.pageStatus.isNormal?ee("",!0):(C(),Z("div",ve,[t.copyNode.path!=="root"?(C(),T(k,{key:0},{default:a(()=>[o(h,{span:"14"},{default:a(()=>[o(V,{ref:"formRef",model:t.copyNode,rules:t.ruleValidate,"label-width":"100px","label-suffix":":"},{default:a(()=>[o(i,{label:"\u7236\u7EA7\u83DC\u5355"},{default:a(()=>[o(m,{modelValue:t.copyNode.parentName,"onUpdate:modelValue":e[0]||(e[0]=d=>t.copyNode.parentName=d),disabled:""},null,8,["modelValue"])]),_:1}),o(i,{label:"\u83DC\u5355\u540D\u79F0",prop:"title"},{default:a(()=>[o(m,{modelValue:t.copyNode.title,"onUpdate:modelValue":e[1]||(e[1]=d=>t.copyNode.title=d),placeholder:"\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),o(i,{label:"\u83DC\u5355\u8DEF\u5F84",prop:"path"},{default:a(()=>[o(m,{modelValue:t.copyNode.path,"onUpdate:modelValue":e[2]||(e[2]=d=>t.copyNode.path=d),placeholder:"\u8F93\u5165\u83DC\u5355\u8DEF\u5F84",clearable:""},null,8,["modelValue"])]),_:1}),o(i,{label:"\u83DC\u5355\u56FE\u6807"},{default:a(()=>[o(v,{modelValue:t.copyNode.icon,"onUpdate:modelValue":e[3]||(e[3]=d=>t.copyNode.icon=d)},null,8,["modelValue"])]),_:1}),o(i,null,{default:a(()=>[o(y,{type:"primary",onClick:t.handleSubmit,loading:t.editLoading},{default:a(()=>[_($(t.pageStatus.isCreate?"\u63D0\u4EA4\u6570\u636E":"\u66F4\u65B0\u6570\u636E"),1)]),_:1},8,["onClick","loading"]),o(y,{onClick:t.handleResetForm},{default:a(()=>[ye]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})):(C(),T(b,{key:1,type:"error","show-icon":""},{default:a(()=>[ge]),_:1}))]))]),_:1})])]),_:1})])])]),_:1})}var Ie=Q(re,[["render",Ne],["__scopeId","data-v-12ed773d"]]);export{Ie as default};
