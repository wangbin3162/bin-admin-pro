var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,d=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{g as n}from"./depart.api-ca603c17.js";import{f as s,a7 as u,a8 as i,J as p,o as c,c as m,w as f,B as b,u as v,a as g,T as h,d as y,z as _,A as N,q as C,t as V}from"./vendor-76eb7e0b.js";import{g as j}from"./index-7b29aec0.js";import{M as w}from"./chunk-bin-ui-next-077811e2.js";import{u as x}from"./useForm-297a8dc7.js";import{_ as S}from"./page-wrapper-42302154.js";import{_ as k}from"./index-582bb500.js";import{_ as O}from"./iconfont-79fff6f9.js";import"./chunk-brace-7f859248.js";const F={name:"Depart",components:{Iconfont:O,BaseTree:k,PageWrapper:S},setup(){const e=s(null),u=s(null),i=s({}),p=s({}),{formRef:c,editStatus:m,pageStatus:f,editLoading:b,openCreate:v,openEdit:g,backNormal:h,submitForm:y,resetForm:_}=x();function N(e="edit"){if("edit"!==e){var n,s;i.value={text:"",deptCode:"",status:"1",desc:"",parentId:"",parentName:void 0}}else{const e=p.value,c=u.value,m=e[c.nodeKey].parent,f=m||0===m?e[m].node:{};i.value=c?(n=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&d(e,t,a[t]);if(l)for(var t of l(a))r.call(a,t)&&d(e,t,a[t]);return e})({},j(c)),s={parentId:0===m?"":f.id,parentName:f.title},a(n,t(s))):{}}}function C(){N("create"),v()}return{treeRef:e,getDepartTree:n,currentNode:u,copyNode:i,handleSelect:function(e,a){e.selected?(u.value=e,p.value=a,N("edit"),g()):(u.value=null,p.value=null,i.value={},h())},handleSubmit:function(){y((()=>{b.value=!0;const a=f.value;setTimeout((()=>{w.success((a.isCreate?"新增":"修改")+"成功！"),h();const t=u.value?[u.value.nodeKey]:[];e.value&&e.value.reloadTree(t),b.value=!1}),1e3)}))},handleResetForm:function(){N(m.value),_()},handleCommand:function(e){if("root"===e&&C(),"child"===e){C();const e=u.value;i.value.parentId=e.id,i.value.parentName=e.text}},formRef:c,pageStatus:f,editLoading:b,submitForm:y,resetForm:_,ruleValidate:{text:[{required:!0,message:"部门名称必填",trigger:"blur"}],deptCode:[{required:!0,message:"部门编码必填",trigger:"blur"}]}}}};u("data-v-7207f23c");const R={class:"table-depart"},I=C("增加根节点"),P=C("增加子节点"),T={class:"table-depart-right"},U={flex:"main:justify cross:center",style:{"font-weight":"normal"}},D={class:"top"},q=b("span",{class:"ml-5"},"编辑部门",-1),z={class:"right"},L=C("新增子部门"),B={style:{position:"relative","min-height":"100px",overflow:"hidden"}},E={style:{position:"absolute",width:"100%"}},K=C("点选左侧部门，进行编辑操作"),M={key:0,class:"pt-8"},A=b("span",null,"启用",-1),J=b("span",null,"禁用",-1),W=C("重置");i(),F.render=function(e,a,t,l,o,r){const d=p("b-dropdown-item"),n=p("base-tree"),s=p("iconfont"),u=p("b-button"),i=p("b-alert"),j=p("b-input"),w=p("b-form-item"),x=p("b-switch"),S=p("b-form"),k=p("b-col"),O=p("b-row"),F=p("b-card"),G=p("page-wrapper");return c(),m(G,{desc:"页面内容为Mock数据，仅作示例使用。"},{default:f((()=>[b("div",R,[v(n,{ref:"treeRef","tree-title":"部门列表","show-filter":"",fetch:l.getDepartTree,onSelectChange:l.handleSelect,onCommand:l.handleCommand},{ctrl:f((()=>[v(d,{name:"root",divided:""},{default:f((()=>[I])),_:1}),v(d,{name:"child",disabled:!l.currentNode},{default:f((()=>[P])),_:1},8,["disabled"])])),_:1},8,["fetch","onSelectChange","onCommand"]),b("div",T,[v(F,{bordered:!1,class:"card-panel",shadow:"never"},{header:f((()=>[b("div",U,[b("div",D,[v(s,{icon:"apartment",color:"primary",bg:"",round:""}),q]),b("div",z,[l.currentNode?(c(),m(u,{key:0,type:"text",size:"small",onClick:a[0]||(a[0]=e=>l.handleCommand("child"))},{default:f((()=>[L])),_:1})):g("",!0)])])])),default:f((()=>[b("div",B,[v(h,{name:"fade-in"},{default:f((()=>[b("div",E,[y(v(i,null,{default:f((()=>[K])),_:1},512),[[_,l.pageStatus.isNormal]])])])),_:1}),v(h,{name:"fade-transverse"},{default:f((()=>[l.pageStatus.isNormal?g("",!0):(c(),N("div",M,[v(O,null,{default:f((()=>[v(k,{span:"14"},{default:f((()=>[v(S,{ref:"formRef",model:l.copyNode,rules:l.ruleValidate,"label-width":"100px","label-suffix":":"},{default:f((()=>[v(w,{label:"父级组织"},{default:f((()=>[v(j,{modelValue:l.copyNode.parentName,"onUpdate:modelValue":a[1]||(a[1]=e=>l.copyNode.parentName=e),disabled:""},null,8,["modelValue"])])),_:1}),v(w,{label:"部门名称",prop:"text"},{default:f((()=>[v(j,{modelValue:l.copyNode.text,"onUpdate:modelValue":a[2]||(a[2]=e=>l.copyNode.text=e),placeholder:"输入部门名称",clearable:""},null,8,["modelValue"])])),_:1}),v(w,{label:"部门编码",prop:"deptCode"},{default:f((()=>[v(j,{modelValue:l.copyNode.deptCode,"onUpdate:modelValue":a[3]||(a[3]=e=>l.copyNode.deptCode=e),placeholder:"输入部门编码",clearable:""},null,8,["modelValue"])])),_:1}),v(w,{label:"部门状态"},{default:f((()=>[v(x,{size:"large",modelValue:l.copyNode.status,"onUpdate:modelValue":a[4]||(a[4]=e=>l.copyNode.status=e),"true-value":"1","false-value":"0"},{open:f((()=>[A])),close:f((()=>[J])),_:1},8,["modelValue"])])),_:1}),v(w,{label:"部门描述"},{default:f((()=>[v(j,{modelValue:l.copyNode.desc,"onUpdate:modelValue":a[5]||(a[5]=e=>l.copyNode.desc=e),type:"textarea",placeholder:"输入部门描述"},null,8,["modelValue"])])),_:1}),v(w,null,{default:f((()=>[v(u,{type:"primary",onClick:l.handleSubmit,loading:l.editLoading},{default:f((()=>[C(V(l.pageStatus.isCreate?"提交数据":"更新数据"),1)])),_:1},8,["onClick","loading"]),v(u,{onClick:l.handleResetForm},{default:f((()=>[W])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})]))])),_:1})])])),_:1})])])])),_:1})},F.__scopeId="data-v-7207f23c";export{F as default};
