import{j,m as E}from"./index-c2794864.js";import{a9 as K,l as C,G as n,o as V,e as R,w as t,c as o,m as u,b as m,T as U,g as P,v as q,a as L,t as G,j as z}from"./vendor-c8b7a369.js";import{u as A}from"./useForm-d84957e4.js";import{a as H}from"./chunk-bin-ui-next-c8e5f3af.js";import"./chunk-brace-3ad28406.js";import"./chunk-mockjs-f396cf70.js";function I(){return j({url:"/menu/tree",method:"get"})}const J={name:"Menu",setup(){const b=C(null),a=C(null),i=C({}),e=C({}),{formRef:B,editStatus:D,pageStatus:p,editLoading:_,openCreate:w,openEdit:h,backNormal:s,submitForm:c,resetForm:v}=A();function g(r,d){r.selected?(a.value=r,e.value=d,x()):k()}function S(r){if(r==="root"&&y(),r==="child"){y();const d=a.value;i.value.parentPath=d.path,i.value.parentName=d.title}}function f(r="edit"){if(r==="edit"){const d=e.value,F=a.value,N=d[F.nodeKey].parent,M=N||N===0?d[N].node:{};i.value=F?{...E(F),parentPath:N===0?"":M.path,parentName:M.title}:{};return}i.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function k(){a.value=null,e.value=null,i.value={},s()}function y(){f("create"),w()}function x(){f("edit"),h()}function T(){c(()=>{_.value=!0;const r=p.value;setTimeout(()=>{H.success(`${r.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),s();const d=a.value?[a.value.nodeKey]:[];b.value&&b.value.reloadTree(d),_.value=!1},1e3)})}function l(){f(D.value),v()}return{treeRef:b,getMenuTree:I,currentNode:a,copyNode:i,handleSelect:g,handleSubmit:T,handleResetForm:l,handleCommand:S,formRef:B,pageStatus:p,editLoading:_,submitForm:c,resetForm:v,ruleValidate:{path:[{required:!0,message:"\u83DC\u5355\u8DEF\u5F84\u5FC5\u586B",trigger:"blur"}],title:[{required:!0,message:"\u83DC\u5355\u540D\u79F0\u5FC5\u586B",trigger:"blur"}]}}}},O={class:"pl-16"},Q={flex:"main:justify cross:center",style:{"font-weight":"normal"}},W={class:"top"},X=m("span",{class:"ml-5"},"\u7F16\u8F91\u83DC\u5355",-1),Y={style:{position:"relative","min-height":"100px",overflow:"hidden"}},Z={style:{position:"absolute",width:"100%"}},$={key:0,class:"pt-8"};function ee(b,a,i,e,B,D){const p=n("b-dropdown-item"),_=n("base-tree"),w=n("iconfont"),h=n("b-alert"),s=n("b-input"),c=n("b-form-item"),v=n("b-icon-select"),g=n("b-button"),S=n("b-form"),f=n("b-col"),k=n("b-row"),y=n("b-card"),x=n("page-cube-wrapper"),T=n("page-container");return V(),R(T,{"inner-scroll":"","hide-header":""},{default:t(()=>[o(x,null,{left:t(()=>[o(_,{ref:"treeRef","tree-title":"\u83DC\u5355\u5217\u8868","show-filter":"","title-key":"title",fetch:e.getMenuTree,onSelectChange:e.handleSelect,onCommand:e.handleCommand},{ctrl:t(()=>[o(p,{name:"root",divided:""},{default:t(()=>[u("\u589E\u52A0\u6839\u8282\u70B9")]),_:1}),o(p,{name:"child",disabled:!e.currentNode},{default:t(()=>[u("\u589E\u52A0\u5B50\u8282\u70B9")]),_:1},8,["disabled"])]),_:1},8,["fetch","onSelectChange","onCommand"])]),default:t(()=>[m("div",O,[o(y,{bordered:!1,class:"card-panel",shadow:"never"},{header:t(()=>[m("div",Q,[m("div",W,[o(w,{icon:"menu",color:"primary",bg:"",round:""}),X])])]),default:t(()=>[m("div",Y,[o(U,{name:"fade-in"},{default:t(()=>[m("div",Z,[P(o(h,null,{default:t(()=>[u("\u70B9\u9009\u5DE6\u4FA7\u90E8\u95E8\uFF0C\u8FDB\u884C\u7F16\u8F91\u64CD\u4F5C")]),_:1},512),[[q,e.pageStatus.isNormal]])])]),_:1}),o(U,{name:"fade-transverse"},{default:t(()=>[e.pageStatus.isNormal?z("",!0):(V(),L("div",$,[e.copyNode.path!=="root"?(V(),R(k,{key:0},{default:t(()=>[o(f,{span:"14"},{default:t(()=>[o(S,{ref:"formRef",model:e.copyNode,rules:e.ruleValidate,"label-width":"100px","label-suffix":":"},{default:t(()=>[o(c,{label:"\u7236\u7EA7\u83DC\u5355"},{default:t(()=>[o(s,{modelValue:e.copyNode.parentName,"onUpdate:modelValue":a[0]||(a[0]=l=>e.copyNode.parentName=l),disabled:""},null,8,["modelValue"])]),_:1}),o(c,{label:"\u83DC\u5355\u540D\u79F0",prop:"title"},{default:t(()=>[o(s,{modelValue:e.copyNode.title,"onUpdate:modelValue":a[1]||(a[1]=l=>e.copyNode.title=l),placeholder:"\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),o(c,{label:"\u83DC\u5355\u8DEF\u5F84",prop:"path"},{default:t(()=>[o(s,{modelValue:e.copyNode.path,"onUpdate:modelValue":a[2]||(a[2]=l=>e.copyNode.path=l),placeholder:"\u8F93\u5165\u83DC\u5355\u8DEF\u5F84",clearable:""},null,8,["modelValue"])]),_:1}),o(c,{label:"\u83DC\u5355\u56FE\u6807"},{default:t(()=>[o(v,{modelValue:e.copyNode.icon,"onUpdate:modelValue":a[3]||(a[3]=l=>e.copyNode.icon=l)},null,8,["modelValue"])]),_:1}),o(c,null,{default:t(()=>[o(g,{type:"primary",onClick:e.handleSubmit,loading:e.editLoading},{default:t(()=>[u(G(e.pageStatus.isCreate?"\u63D0\u4EA4\u6570\u636E":"\u66F4\u65B0\u6570\u636E"),1)]),_:1},8,["onClick","loading"]),o(g,{onClick:e.handleResetForm},{default:t(()=>[u("\u91CD\u7F6E")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})):(V(),R(h,{key:1,type:"error","show-icon":""},{default:t(()=>[u("\u7CFB\u7EDF\u83DC\u5355\u6839\u8282\u70B9\u4E0D\u53EF\u7F16\u8F91")]),_:1}))]))]),_:1})])]),_:1})])]),_:1})]),_:1})}const de=K(J,[["render",ee]]);export{de as default};
