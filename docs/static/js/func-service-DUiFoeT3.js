import{a8 as A,r as z,n as I,R as r,o as p,a as f,b as n,K as o,w as s,f as b,i as C,l as G,F as E,Q as B,j as q,t as x,H}from"./vendor-B7whOB5j.js";import"./chunk-bin-ui-design-QY08qtjO.js";import{D as K,j as Q}from"./index-CnBue4Tw.js";import"./chunk-brace-DF1jSkZr.js";const W={name:"styles-editor",props:{modelValue:{type:String,default:""},showAction:{type:Boolean,default:!0},simple:{type:Boolean,default:!0},height:{type:String,default:"100px"}},emits:["update:modelValue","change"],setup(V,{emit:l}){const u=z(""),e=z("25%");function D(){l("update:modelValue",u.value),l("change",u.value)}function y(){u.value="width: 25%;",D()}function _(){const m=V.modelValue;m.includes("width: 25%;")?e.value="25%":m.includes("width: 50%;")?e.value="50%":m.includes("width: 75%;")?e.value="75%":m.includes("width: 100%;")?e.value="100%":e.value=""}return I(()=>V.modelValue,m=>{if(m===""){y();return}_(),u.value=m},{immediate:!0}),I(()=>e.value,m=>{u.value=`width: ${m};`,D()}),{width:e,styleValue:u,emitValue:D,resetStyle:y}}},Y={key:0,class:"styles-editor-simple-wrap"},X={class:"mb-5",flex:"cross:center"},Z={key:1,class:"styles-editor-wrap"},T={flex:"main:justify"},$={class:"editor-box"},ee={key:0,class:"action-box"},le={class:"mb-5",flex:"main:justify cross:center"},oe={class:"mb-5",flex:"cross:center"};function ne(V,l,u,e,D,y){const _=r("b-radio"),m=r("b-radio-group"),v=r("b-ace-editor"),U=r("b-icon"),w=r("b-tooltip"),L=r("b-space");return u.simple?(p(),f("div",Y,[n("div",X,[o(m,{modelValue:e.width,"onUpdate:modelValue":l[0]||(l[0]=h=>e.width=h),type:"button",size:"mini"},{default:s(()=>[o(_,{label:"25%"},{default:s(()=>l[3]||(l[3]=[b("1")])),_:1}),o(_,{label:"50%"},{default:s(()=>l[4]||(l[4]=[b("2")])),_:1}),o(_,{label:"75%"},{default:s(()=>l[5]||(l[5]=[b("3")])),_:1}),o(_,{label:"100%"},{default:s(()=>l[6]||(l[6]=[b("4")])),_:1})]),_:1},8,["modelValue"]),l[7]||(l[7]=n("span",{class:"ml-5"},"/ 4",-1))])])):(p(),f("div",Z,[n("div",T,[n("div",$,[o(v,{modelValue:e.styleValue,"onUpdate:modelValue":l[1]||(l[1]=h=>e.styleValue=h),lang:"stylus",height:u.height,"font-size":14,onBlur:e.emitValue},null,8,["modelValue","height","onBlur"])]),u.showAction?(p(),f("div",ee,[n("div",le,[l[8]||(l[8]=n("div",null,"样式显示",-1)),o(L,null,{default:s(()=>[o(w,{content:"输入样式表，默认控件宽度皆为25%"},{default:s(()=>[o(U,{name:"question-circle",size:18})]),_:1}),o(w,{content:"重置样式"},{default:s(()=>[o(U,{name:"sync",size:18,type:"button",onClick:e.resetStyle},null,8,["onClick"])]),_:1})]),_:1})]),l[14]||(l[14]=n("div",{class:"mb-5"},[n("div",null,"宽度设置")],-1)),n("div",oe,[o(m,{modelValue:e.width,"onUpdate:modelValue":l[2]||(l[2]=h=>e.width=h),type:"button",size:"mini"},{default:s(()=>[o(_,{label:"25%"},{default:s(()=>l[9]||(l[9]=[b("1")])),_:1}),o(_,{label:"50%"},{default:s(()=>l[10]||(l[10]=[b("2")])),_:1}),o(_,{label:"75%"},{default:s(()=>l[11]||(l[11]=[b("3")])),_:1}),o(_,{label:"100%"},{default:s(()=>l[12]||(l[12]=[b("4")])),_:1})]),_:1},8,["modelValue"]),l[13]||(l[13]=n("span",{class:"ml-5"},"/ 4",-1))])])):C("",!0)])]))}const ae=A(W,[["render",ne],["__scopeId","data-v-e6669812"]]),P=["blur","change"],j=["string","number"],O={length:"$length",email:"$email",phone:"$phone",idCode:"$idCode",unifiedCode:"$unifiedCode",orgInstCode:"$orgInstCode",regNo:"$regNo"},M={regexp:"$regexp",conditionRequired:"$conditionRequired",conditionNotRequired:"$conditionNotRequired",conditionNotBe:"$conditionNotBe",notSame:"$notSame",timeBound:"$timeBound"},c={required:"$required",...O,...M},te={$required:"必填项",$length:"长度参数",$email:"邮箱参数",$phone:"手机号码",$regexp:"正则匹配",$idCode:"身份证",$unifiedCode:"统一社会信用代码",$orgInstCode:"组织机构代码",$regNo:"工商注册号",$conditionRequired:"条件必填",$conditionNotRequired:"条件必不填",$conditionNotBe:"条件不为某值",$notSame:"值不能相同",$timeBound:"日期区间"},ie={name:"async-validator",components:{DragHandle:K},props:{modelValue:{type:String,default:""},dataLength:Number,originalRules:{type:String},showLog:Boolean},emits:["update:modelValue","change"],setup(V,{emit:l}){const u=z(!1),e=z([]),{listRef:D}=Q(e,k),y=G(()=>!!_(c.required)),_=t=>e.value.find(d=>d.name===t);function m(t){return M[t]?!1:!!_(t)}function v(t){return t===c.required?"is-required":M[t.slice(1)]?"is-multiple":"is-normal"}function U(t){t.preventDefault()}function w(t,d){e.value[d].hasOwnProperty("preField")&&(e.value[d].preField=t.dataTransfer.getData("index")),e.value[d].hasOwnProperty("time")&&(e.value[d].time=t.dataTransfer.getData("index")),k(),t.preventDefault()}function L(t){t?h(c.required):(e.value=e.value.filter(d=>d.name!==c.required),k())}function h(t){if(t===c.required&&y.value)return;const d=S=>({name:S,type:j[0],trigger:P[0]});switch(t){case c.required:e.value.unshift({...d(t),message:"必填项"});break;case c.length:e.value.push({...d(t),min:1,max:V.dataLength||1/0,message:"长度必须在指定的范围内"});break;case c.email:e.value.push({...d(t),message:"邮箱格式不正确"});break;case c.phone:e.value.push({...d(t),message:"手机号格式不正确"});break;case c.idCode:e.value.push({...d(t),preField:"",message:"身份证格式不正确",ignoreCase:!0});break;case c.unifiedCode:e.value.push({...d(t),preField:"",message:"统一社会信用代码格式不正确",ignoreCase:!0});break;case c.orgInstCode:e.value.push({...d(t),preField:"",message:"组织机构代码格式不正确",ignoreCase:!0});break;case c.regNo:e.value.push({...d(t),preField:"",message:"工商注册号格式不正确",ignoreCase:!0});break;case c.regexp:e.value.push({...d(t),regexp:"",message:"正则表达式不匹配"});break;case c.conditionRequired:e.value.push({...d(t),preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下必填"});break;case c.conditionNotRequired:e.value.push({...d(t),preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下不可填写"});break;case c.conditionNotBe:e.value.push({...d(t),preField:"",preFieldValue:"",notValue:"",message:"当前字段在前置字段条件达成下不能为某值"});break;case c.notSame:e.value.push({...d(t),preField:"",message:"不能和前置字段值相同"});break;case c.timeBound:e.value.push({...d(t),time:"$now",compareMode:"gt",message:"日期不符合区间设置"});break}k()}function N(t){e.value.splice(t,1),k()}function R(){V.originalRules&&(l("update:modelValue",V.originalRules),l("change",V.originalRules))}function F(){e.value=[],u.value=!1,k()}function k(){const t=e.value.length?JSON.stringify(e.value):"";l("update:modelValue",t),l("change",t)}return I(()=>V.modelValue,t=>{if(t===""){F();return}try{e.value=JSON.parse(t),u.value=y.value}catch{console.warn("async-validator: model-value is not a right json，rules is reset"),F()}},{immediate:!0}),{rulesRef:D,SIMPLE_RULE:O,MULTIPLE_RULE:M,RULE:c,RULE_NAME_MAP:te,TRIGGER:P,TYPE:j,hasRequiredRule:y,isRequired:u,checkRules:e,rulesClass:v,requiredChange:L,setRules:h,removeRules:N,hasSameRule:m,emitValue:k,allowDrop:U,onDrop:w,reload:R,refreshRules:F}}},se={class:"validator-wrap"},de={class:"mb-10",style:{padding:"0 4px"}},re={style:{width:"100%","line-height":"32px"},flex:"main:justify"},ue={style:{cursor:"pointer",color:"#13c2c2"}},me={style:{cursor:"pointer",color:"#52c41a"}},ce={class:"check-rules-wrap",ref:"rulesRef"},pe={class:"rules-params"},ge={class:"title-box",title:"触发条件"},_e={class:"title-box",title:"取值类型"},fe={class:"rules-cfg"},be={key:0,class:"title-box is-message",title:"正则规则"},Ve={class:"title-box",title:"最小值"},he={class:"title-box",title:"最大值"},ve=["onDrop"],Re=["onDrop"],ke={class:"title-box",title:"前置字段值"},Ce=["onDrop"],ye={class:"title-box",title:"前置字段值"},Ue={class:"title-box",title:"不是某值"},we=["onDrop"],De={class:"title-box",title:"比较模式"},Le=["onDrop"],Ee={class:"rules-message"},Fe={class:"title-box is-message",title:"错误提示"},Ne={class:"delete"},qe={key:0};function Me(V,l,u,e,D,y){const _=r("b-checkbox"),m=r("b-divider"),v=r("b-icon"),U=r("b-dropdown-item"),w=r("b-dropdown-menu"),L=r("b-dropdown"),h=r("b-button"),N=r("b-tooltip"),R=r("b-option"),F=r("b-select"),k=r("b-space"),t=r("b-input"),d=r("b-input-number"),S=r("drag-handle"),J=r("b-ace-editor");return p(),f("div",se,[n("div",de,[n("div",re,[n("div",null,[o(_,{modelValue:e.isRequired,"onUpdate:modelValue":l[0]||(l[0]=g=>e.isRequired=g),onChange:e.requiredChange,style:{"margin-right":"0"}},{default:s(()=>l[6]||(l[6]=[b(" 必填项 ")])),_:1},8,["modelValue","onChange"]),o(m,{type:"vertical"}),o(L,{onCommand:e.setRules},{dropdown:s(()=>[o(w,null,{default:s(()=>[(p(!0),f(E,null,B(e.SIMPLE_RULE,(g,i)=>(p(),q(U,{key:i,name:g,disabled:e.hasSameRule(g)},{default:s(()=>[b(x(e.RULE_NAME_MAP[g]),1)]),_:2},1032,["name","disabled"]))),128))]),_:1})]),default:s(()=>[n("span",ue,[l[7]||(l[7]=b(" 静态规则 ")),o(v,{name:"down"})])]),_:1},8,["onCommand"]),o(m,{type:"vertical"}),o(L,{onCommand:e.setRules},{dropdown:s(()=>[o(w,null,{default:s(()=>[(p(!0),f(E,null,B(e.MULTIPLE_RULE,(g,i)=>(p(),q(U,{key:i,name:g},{default:s(()=>[b(x(e.RULE_NAME_MAP[g]),1)]),_:2},1032,["name"]))),128))]),_:1})]),default:s(()=>[n("span",me,[l[8]||(l[8]=b(" 动态规则 ")),o(v,{name:"down"})])]),_:1},8,["onCommand"])]),n("div",null,[o(N,{content:"初始化校验"},{default:s(()=>[o(h,{background:"",size:"mini",onClick:e.refreshRules},{default:s(()=>l[9]||(l[9]=[n("i",{class:"b-iconfont b-icon-reload"},null,-1)])),_:1},8,["onClick"])]),_:1}),u.originalRules?(p(),q(N,{key:0,content:"恢复修改前校验"},{default:s(()=>[o(h,{background:"",size:"mini",onClick:e.reload},{default:s(()=>l[10]||(l[10]=[n("i",{class:"b-iconfont b-icon-mr"},null,-1)])),_:1},8,["onClick"])]),_:1})):C("",!0)])])]),n("ul",ce,[(p(!0),f(E,null,B(e.checkRules,(g,i)=>(p(),f("li",{key:i,class:"rules-list-item"},[n("div",pe,[o(k,null,{default:s(()=>[n("div",{class:H(["role-name",e.rulesClass(g.name)])},x(e.RULE_NAME_MAP[g.name]),3),n("div",ge,[l[11]||(l[11]=n("span",{title:"输入框为失焦事件，其余控件为改变事件"},"触发条件",-1)),o(F,{modelValue:e.checkRules[i].trigger,"onUpdate:modelValue":a=>e.checkRules[i].trigger=a,size:"small","append-to-body":"",onChange:e.emitValue},{default:s(()=>[o(R,{label:"失焦",value:"blur"}),o(R,{label:"改变",value:"change"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),n("div",_e,[l[12]||(l[12]=n("span",{title:"非数字类型选择字符"},"取值类型",-1)),o(F,{modelValue:e.checkRules[i].type,"onUpdate:modelValue":a=>e.checkRules[i].type=a,size:"small","append-to-body":"",onChange:e.emitValue},{default:s(()=>[o(R,{label:"字符",value:"string"}),o(R,{label:"数字",value:"number"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])]),_:2},1024)]),n("div",fe,[g.name===e.RULE.regexp?(p(),f("div",be,[l[13]||(l[13]=n("span",null,"正则规则",-1)),o(t,{modelValue:e.checkRules[i].regexp,"onUpdate:modelValue":a=>e.checkRules[i].regexp=a,modelModifiers:{trim:!0},size:"small",placeholder:"需输入字符格式",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])):C("",!0),o(k,null,{default:s(()=>[g.name===e.RULE.length?(p(),f(E,{key:0},[n("div",Ve,[l[14]||(l[14]=n("span",{style:{width:"60px"}},"最小值",-1)),o(d,{modelValue:e.checkRules[i].min,"onUpdate:modelValue":a=>e.checkRules[i].min=a,min:1,max:u.dataLength,precision:0,size:"small",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])]),n("div",he,[l[15]||(l[15]=n("span",{style:{width:"60px"}},"最大值",-1)),o(d,{modelValue:e.checkRules[i].max,"onUpdate:modelValue":a=>e.checkRules[i].max=a,min:1,max:u.dataLength,precision:0,size:"small",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","max","onChange"])])],64)):C("",!0),[e.RULE.idCode,e.RULE.unifiedCode,e.RULE.orgInstCode,e.RULE.regNo].includes(g.name)?(p(),f(E,{key:1},[n("div",{class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,i),onDragover:l[1]||(l[1]=a=>e.allowDrop(a))},[l[16]||(l[16]=n("span",null,"前置字段",-1)),o(t,{modelValue:e.checkRules[i].preField,"onUpdate:modelValue":a=>e.checkRules[i].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,ve),o(_,{modelValue:e.checkRules[i].ignoreCase,"onUpdate:modelValue":a=>e.checkRules[i].ignoreCase=a,onChange:e.emitValue},{default:s(()=>l[17]||(l[17]=[b(" 忽略大小写 ")])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])],64)):C("",!0),g.name===e.RULE.conditionRequired||g.name===e.RULE.conditionNotRequired?(p(),f(E,{key:2},[n("div",{class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,i),onDragover:l[2]||(l[2]=a=>e.allowDrop(a))},[l[18]||(l[18]=n("span",null,"前置字段",-1)),o(t,{modelValue:e.checkRules[i].preField,"onUpdate:modelValue":a=>e.checkRules[i].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Re),n("div",ke,[l[19]||(l[19]=n("span",null,"前置字段值",-1)),o(t,{modelValue:e.checkRules[i].preFieldValue,"onUpdate:modelValue":a=>e.checkRules[i].preFieldValue=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):C("",!0),g.name===e.RULE.conditionNotBe?(p(),f(E,{key:3},[n("div",{class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,i),onDragover:l[3]||(l[3]=a=>e.allowDrop(a))},[l[20]||(l[20]=n("span",null,"前置字段",-1)),o(t,{modelValue:e.checkRules[i].preField,"onUpdate:modelValue":a=>e.checkRules[i].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Ce),n("div",ye,[l[21]||(l[21]=n("span",null,"前置字段值",-1)),o(t,{modelValue:e.checkRules[i].preFieldValue,"onUpdate:modelValue":a=>e.checkRules[i].preFieldValue=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段值",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])]),n("div",Ue,[l[22]||(l[22]=n("span",null,"不是某值",-1)),o(t,{modelValue:e.checkRules[i].notValue,"onUpdate:modelValue":a=>e.checkRules[i].notValue=a,modelModifiers:{trim:!0},size:"small",placeholder:"不是某值",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])],64)):C("",!0),g.name===e.RULE.notSame?(p(),f("div",{key:4,class:"title-box",title:"前置字段",onDrop:a=>e.onDrop(a,i),onDragover:l[4]||(l[4]=a=>e.allowDrop(a))},[l[23]||(l[23]=n("span",null,"前置字段",-1)),o(t,{modelValue:e.checkRules[i].preField,"onUpdate:modelValue":a=>e.checkRules[i].preField=a,modelModifiers:{trim:!0},size:"small",placeholder:"前置字段",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,we)):C("",!0),g.name===e.RULE.timeBound?(p(),f(E,{key:5},[n("div",De,[l[24]||(l[24]=n("span",null,"比较模式",-1)),o(F,{modelValue:e.checkRules[i].compareMode,"onUpdate:modelValue":a=>e.checkRules[i].compareMode=a,"append-to-body":"",size:"small",onChange:e.emitValue},{default:s(()=>[o(R,{value:"gt",label:">"}),o(R,{value:"ge",label:"≥"}),o(R,{value:"lt",label:"<"}),o(R,{value:"le",label:"≤"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),n("div",{class:"title-box",onDrop:a=>e.onDrop(a,i),onDragover:l[5]||(l[5]=a=>e.allowDrop(a))},[l[25]||(l[25]=n("span",{title:"比较值(yyyy-MM-dd)，可以是字段名，也可以填写$now取得当前时间"}," 比较取值 ",-1)),o(t,{modelValue:e.checkRules[i].time,"onUpdate:modelValue":a=>e.checkRules[i].time=a,modelModifiers:{trim:!0},size:"small",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])],40,Le)],64)):C("",!0)]),_:2},1024)]),n("div",Ee,[n("div",Fe,[l[26]||(l[26]=n("span",null,"错误提示",-1)),o(t,{modelValue:e.checkRules[i].message,"onUpdate:modelValue":a=>e.checkRules[i].message=a,modelModifiers:{trim:!0},size:"small",placeholder:"错误提示",onChange:e.emitValue},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),o(S,{icon:"drag-drop-line"}),n("div",Ne,[o(v,{title:"移除",color:"#f5222d",name:"minus-circle",size:"20",type:"button",onClick:a=>e.removeRules(i)},null,8,["onClick"])])]))),128))],512),u.showLog?(p(),f("div",qe,[o(J,{"model-value":JSON.stringify(e.checkRules,null,2),readonly:""},null,8,["model-value"])])):C("",!0)])}const ze=A(ie,[["render",Me],["__scopeId","data-v-2f120c01"]]),Se={name:"FuncService",components:{AsyncValidator:ze,StylesEditor:ae}},Be={class:"p10",style:{"min-height":"200px"}},xe={class:"p10"};function Ie(V,l,u,e,D,y){const _=r("async-validator"),m=r("b-collapse-wrap"),v=r("b-col"),U=r("styles-editor"),w=r("b-row"),L=r("page-wrapper");return p(),q(L,{desc:"业务相关的独立组件，包含通用校验配置，字段样式配置等，可参考进行扩展或实现新的业务组件。"},{default:s(()=>[o(w,{gutter:16},{default:s(()=>[o(v,{span:"12"},{default:s(()=>[o(m,{title:"表单校验",shadow:"none"},{default:s(()=>[n("div",Be,[o(_)])]),_:1})]),_:1}),o(v,{span:"12"},{default:s(()=>[o(m,{title:"字段样式配置",shadow:"none"},{default:s(()=>[n("div",xe,[o(U,{simple:!1})])]),_:1})]),_:1})]),_:1})]),_:1})}const Je=A(Se,[["render",Ie]]);export{Je as default};
