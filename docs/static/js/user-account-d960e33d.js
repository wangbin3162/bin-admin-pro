import{u as $}from"./useTable-e2a415f0.js";import{g as ee}from"./user.api-48ce0fc9.js";import{B as te}from"./index-3e1b1254.js";import{P as le}from"./page-wrapper-16ef4118.js";import{A as ae}from"./index-ba5811a1.js";import{B as oe,u as ne}from"./index-fb33e742.js";import{g as J}from"./depart.api-37f41a4f.js";import{u as re}from"./useForm-6954fee6.js";import{a as Y}from"./chunk-bin-ui-next-cc573c7a.js";import{a5 as O,a as x,y as Q,b as j,E as ie,I as r,o as c,z as w,A as u,D as T,u as t,w as de,M as se,r as P,c as q,n as ue,f as A,d as a,J as G,F,q as g,t as K}from"./vendor-e04737d2.js";import"./index-80424e34.js";import"./chunk-brace-34d79ec3.js";const ce={name:"page-cube-wrapper",props:{leftDefaultWidth:{type:String,default:"240px"},leftExpandText:{type:String,default:"\u5C55\u5F00"},leftCollapseText:{type:String,default:"\u6536\u8D77"},defaultHeight:{type:Number,default:280},defaultMinHeight:{type:Number,default:12},draggableMinHeight:{type:Number,default:48}},setup(n,{slots:l}){const m=x(null),e=Q({active:!1,hasMoved:!1,height:n.defaultHeight,wrapHeight:0}),f=x(!0),_=j(()=>f.value?n.leftDefaultWidth:"12px"),h=j(()=>l.left&&f.value?`calc(100% - ${n.leftDefaultWidth})`:"100%"),i=()=>{f.value=!f.value},s=d=>{if(d==="default")e.height=n.defaultHeight;else if(d==="maximum")e.height=n.defaultMinHeight;else{if(!m.value)return;e.height=m.value.clientHeight-n.draggableMinHeight}},v=()=>{!l.draggable||(e.active=!0,e.hasMoved=!1)},k=()=>{!l.draggable||(e.active=!1)},y=d=>{if(!!l.draggable&&((d.buttons===0||d.which===0)&&(e.active=!1),e.active)){let M=0,b=d.currentTarget;for(e.wrapHeight=b.clientHeight;b;)M+=b.offsetTop,b=b.offsetParent;const C=d.pageY-M;C>n.defaultMinHeight&&C<e.wrapHeight-n.draggableMinHeight&&(e.height=C),e.hasMoved=!0}};return{cubeRef:m,...ie(e),leftExpand:f,leftWidth:_,rightWidth:h,toggleLeft:i,changeDragStatus:s,onResizeMouseDown:v,onResizeMouseUp:k,onResizeMouseMove:y}}},me={class:"page-cube-wrapper",ref:"cubeRef"},fe={class:"page-cube"},ge=["title"],be={class:"cube-left-content"},pe={class:"toggle"};function _e(n,l,m,e,f,_){const h=r("b-icon");return c(),w("div",me,[u("div",fe,[n.$slots.left?(c(),w("div",{key:0,class:"page-cube-left",style:T({width:e.leftWidth})},[u("div",{class:"toggle",style:T({left:e.leftWidth,opacity:e.leftExpand?null:1}),title:e.leftExpand?m.leftCollapseText:m.leftExpandText,onClick:l[0]||(l[0]=(...i)=>e.toggleLeft&&e.toggleLeft(...i))},[t(h,{name:e.leftExpand?"caret-left":"caret-right"},null,8,["name"])],12,ge),de(u("div",be,[P(n.$slots,"left",{},void 0,!0)],512),[[se,e.leftExpand]])],4)):q("",!0),u("div",{class:"page-cube-content",onMouseup:l[5]||(l[5]=(...i)=>e.onResizeMouseUp&&e.onResizeMouseUp(...i)),onMousemove:l[6]||(l[6]=(...i)=>e.onResizeMouseMove&&e.onResizeMouseMove(...i)),style:T({width:e.rightWidth,cursor:n.active?"col-resize":"",userSelect:n.active?"none":""})},[n.$slots.default?(c(),w("div",{key:0,style:T({height:n.$slots.draggable?n.height+"px":"100%"})},[P(n.$slots,"default",{},void 0,!0)],4)):q("",!0),n.$slots.draggable?(c(),w("div",{key:1,class:"draggable-content",style:T({height:`calc(100% - ${n.height}px)`})},[u("div",pe,[u("i",{class:"b-iconfont b-icon-caret-up",title:"\u5C55\u5F00",onClick:l[1]||(l[1]=i=>e.changeDragStatus("maximum"))}),u("i",{class:"b-iconfont b-icon-caret-down",title:"\u6536\u8D77",onClick:l[2]||(l[2]=i=>e.changeDragStatus("minimum"))}),u("i",{class:"b-iconfont b-icon-creditcard-fill",title:"\u9ED8\u8BA4\u9AD8\u5EA6",onClick:l[3]||(l[3]=i=>e.changeDragStatus("default"))})]),u("div",{class:"drag-handler",draggable:"true",onMousedown:l[4]||(l[4]=(...i)=>e.onResizeMouseDown&&e.onResizeMouseDown(...i))},null,32),P(n.$slots,"draggable",{},void 0,!0)],4)):q("",!0)],36)])],512)}var he=O(ce,[["render",_e],["__scopeId","data-v-1e5a8cea"]]);const ve={name:"UserAccount",components:{PageCubeWrapper:he,BaseTree:oe,ActionButton:ae,BaseTable:te,PageWrapper:le},setup(){const n=x(null),l=x({}),m=Q({page:1,size:10,name:"",roles:"",status:"",date:"",email:""}),e=x(!1),f=x([]),_=x({}),{treeData:h,getTreeData:i}=ne(J);i().then(()=>console.log(h.value));const{loading:s,list:v,total:k,getListData:y,pageChange:d,pageSizeChange:M}=$(ee,m),{formRef:b,editStatus:S,pageStatus:C,editLoading:H,openCreate:D,openEdit:R,backNormal:z,submitForm:N,resetForm:E,setBtnLoading:U,modalVisible:L}=re();ue(v,V=>{f.value=V.map(I=>({...I,expand:!1}))});function W(V,I){V.selected&&(l.value=V)}function B(){_.value={realName:"",username:"",email:"",roles:"",depart:""},D()}function o(V){_.value={...V,depart:""},R()}function p(){_.value={},z()}function X(){Y.success("\u5220\u9664\u6210\u529F\uFF01"),y()}function Z(){N(()=>{U(!0);const V=C.value;setTimeout(()=>{Y.success(`${V.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u6210\u529F\uFF01`),U(!1),z(),y()},1e3)})}return y(),{treeRef:n,currentTreeNode:l,handleSelect:W,getDepartTree:J,deptTree:h,expand:e,query:m,loading:s,roleMap:{admin:"\u7BA1\u7406\u5458",user:"\u666E\u901A\u7528\u6237",op:"\u5B9E\u65BD\u4EBA\u5458"},total:k,copyList:f,getListData:y,pageChange:d,pageSizeChange:M,columns:[{title:"\u59D3\u540D",key:"realName"},{title:"\u767B\u5F55\u540D",key:"username"},{title:"\u90AE\u7BB1",key:"email"},{title:"\u89D2\u8272",slot:"roles"},{title:"\u51FA\u751F\u65E5\u671F",key:"createDate"},{title:"\u64CD\u4F5C",width:100,align:"center",slot:"action"}],user:_,formRef:b,editStatus:S,pageStatus:C,editLoading:H,openCreate:D,openEdit:R,backNormal:z,submitForm:N,resetForm:E,ruleValidate:{realName:[{required:!0,message:"\u771F\u5B9E\u540D\u79F0\u5FC5\u586B",trigger:"blur"}],username:[{required:!0,message:"\u7528\u6237\u540D\u5FC5\u586B",trigger:"blur"}]},modalVisible:L,handleCreate:B,handleCancel:p,handleEdit:o,handleSubmit:Z,handleDelete:X}}},ye={class:"pl-16"},Ce=g("\u91CD\u7F6E"),Ve=g("\u67E5\u8BE2"),we=g("\u65B0\u589E"),ke=g(" \u66F4\u591A\u64CD\u4F5C "),Me=g("\u5237\u65B0"),xe=g("\u5220\u9664"),Se={key:0},De=g("\u53D6 \u6D88"),ze=g("\u786E \u5B9A");function Te(n,l,m,e,f,_){const h=r("base-tree"),i=r("b-input"),s=r("b-form-item"),v=r("b-option"),k=r("b-select"),y=r("b-date-picker"),d=r("b-button"),M=r("b-form"),b=r("b-icon"),S=r("b-dropdown-item"),C=r("b-dropdown-menu"),H=r("b-dropdown"),D=r("action-button"),R=r("b-divider"),z=r("b-table"),N=r("b-page"),E=r("base-table"),U=r("page-cube-wrapper"),L=r("b-tree-select"),W=r("b-modal"),B=r("page-wrapper");return c(),A(B,{desc:"\u9875\u9762\u6570\u636E\u4E3AMock\u6570\u636E\uFF0C\u64CD\u4F5C\u65F6\u4E0D\u4F1A\u8FDB\u884C\u771F\u5B9E\u64CD\u4F5C\u3002\u4EC5\u4E3A\u6A21\u62DF\u5B9E\u73B0\u3002"},{default:a(()=>[t(U,null,{left:a(()=>[t(h,{ref:"treeRef","tree-title":"\u90E8\u95E8\u5217\u8868","show-filter":"",fetch:e.getDepartTree,onSelectChange:e.handleSelect,width:"240px"},null,8,["fetch","onSelectChange"])]),default:a(()=>[u("div",ye,[t(E,null,{filter:a(()=>[t(M,{"label-width":"95px"},{default:a(()=>[t(s,{label:"\u7528\u6237\u540D\u79F0"},{default:a(()=>[t(i,{modelValue:e.query.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.query.name=o),clearable:""},null,8,["modelValue"])]),_:1}),t(s,{label:"\u7528\u6237\u89D2\u8272"},{default:a(()=>[t(k,{modelValue:e.query.roles,"onUpdate:modelValue":l[1]||(l[1]=o=>e.query.roles=o),clearable:""},{default:a(()=>[(c(!0),w(F,null,G(e.roleMap,(o,p)=>(c(),A(v,{key:p,label:o,value:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.expand?(c(),w(F,{key:0},[t(s,{label:"\u72B6\u6001"},{default:a(()=>[t(k,{modelValue:e.query.status,"onUpdate:modelValue":l[2]||(l[2]=o=>e.query.status=o),clearable:""},{default:a(()=>[t(v,{label:"\u542F\u7528",value:"1"}),t(v,{label:"\u7981\u7528",value:"0"})]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"\u90AE\u7BB1"},{default:a(()=>[t(i,{modelValue:e.query.email,"onUpdate:modelValue":l[3]||(l[3]=o=>e.query.email=o),clearable:""},null,8,["modelValue"])]),_:1}),t(s,{label:"\u65E5\u671F"},{default:a(()=>[t(y,{modelValue:e.query.date,"onUpdate:modelValue":l[4]||(l[4]=o=>e.query.date=o),clearable:""},null,8,["modelValue"])]),_:1})],64)):q("",!0),t(s,null,{default:a(()=>[t(d,null,{default:a(()=>[Ce]),_:1}),t(d,{type:"primary",loading:e.loading,onClick:e.getListData},{default:a(()=>[Ve]),_:1},8,["loading","onClick"]),t(d,{type:"text",icon:e.expand?"up":"down",onClick:l[5]||(l[5]=o=>e.expand=!e.expand)},{default:a(()=>[g(K(e.expand?"\u6536\u8D77":"\u5C55\u5F00"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),action:a(()=>[t(d,{type:"primary",icon:"plus-circle",onClick:e.handleCreate},{default:a(()=>[we]),_:1},8,["onClick"])]),actionRight:a(()=>[t(H,{style:{"margin-left":"20px"}},{dropdown:a(()=>[t(C,null,{default:a(()=>[t(S,null,{default:a(()=>[Me]),_:1}),t(S,null,{default:a(()=>[xe]),_:1})]),_:1})]),default:a(()=>[t(d,null,{default:a(()=>[ke,t(b,{name:"down"})]),_:1})]),_:1})]),page:a(()=>[t(N,{total:e.total,current:e.query.page,"page-size":e.query.size,"show-sizer":"","show-total":"",onChange:e.pageChange,onSizeChange:e.pageSizeChange},null,8,["total","current","page-size","onChange","onSizeChange"])]),default:a(()=>[t(z,{columns:e.columns,data:e.copyList,loading:e.loading,border:""},{roles:a(({row:o})=>[g(K(e.roleMap[o.roles]),1)]),action:a(({row:o})=>[t(D,{type:"text",icon:"edit-square","is-icon":"",tooltip:"\u7F16\u8F91",onClick:p=>e.handleEdit(o)},null,8,["onClick"]),t(R,{type:"vertical"}),t(D,{type:"text",icon:"delete",color:"danger","is-icon":"",tooltip:"\u5220\u9664",confirm:"",onClick:p=>e.handleDelete(o)},null,8,["onClick"])]),_:1},8,["columns","data","loading"])]),_:1})])]),_:1}),t(W,{"model-value":e.modalVisible,title:`${e.pageStatus.isCreate?"\u65B0\u589E":"\u4FEE\u6539"}\u89D2\u8272`,onClosed:e.handleCancel},{footer:a(()=>[u("div",null,[t(d,{onClick:e.handleCancel},{default:a(()=>[De]),_:1},8,["onClick"]),t(d,{type:"primary",loading:e.editLoading,onClick:e.handleSubmit},{default:a(()=>[ze]),_:1},8,["loading","onClick"])])]),default:a(()=>[e.modalVisible?(c(),w("div",Se,[t(M,{ref:"formRef",model:e.user,rules:e.ruleValidate,"label-width":"100px","label-suffix":":"},{default:a(()=>[t(s,{label:"\u6240\u5C5E\u90E8\u95E8"},{default:a(()=>[t(L,{modelValue:e.user.depart,"onUpdate:modelValue":l[6]||(l[6]=o=>e.user.depart=o),data:e.deptTree,"title-key":"text"},null,8,["modelValue","data"])]),_:1}),t(s,{label:"\u59D3\u540D",prop:"realName"},{default:a(()=>[t(i,{modelValue:e.user.realName,"onUpdate:modelValue":l[7]||(l[7]=o=>e.user.realName=o),placeholder:"\u8F93\u5165\u59D3\u540D",clearable:""},null,8,["modelValue"])]),_:1}),t(s,{label:"\u7528\u6237\u540D",prop:"username"},{default:a(()=>[t(i,{modelValue:e.user.username,"onUpdate:modelValue":l[8]||(l[8]=o=>e.user.username=o),placeholder:"\u8F93\u5165\u767B\u5F55\u540D",clearable:""},null,8,["modelValue"])]),_:1}),t(s,{label:"\u90AE\u7BB1"},{default:a(()=>[t(i,{modelValue:e.user.email,"onUpdate:modelValue":l[9]||(l[9]=o=>e.user.email=o),placeholder:"\u8F93\u5165\u90AE\u7BB1",clearable:""},null,8,["modelValue"])]),_:1}),t(s,{label:"\u89D2\u8272"},{default:a(()=>[t(k,{modelValue:e.user.roles,"onUpdate:modelValue":l[10]||(l[10]=o=>e.user.roles=o),placeholder:"\u9009\u62E9\u89D2\u8272",clearable:""},{default:a(()=>[(c(!0),w(F,null,G(e.roleMap,(o,p)=>(c(),A(v,{key:p,label:o,value:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])):q("",!0)]),_:1},8,["model-value","title","onClosed"])]),_:1})}var Ie=O(ve,[["render",Te]]);export{Ie as default};
