import{_ as e}from"./page-wrapper-17a7ae57.js";import"./index-22ae5226.js";import{f as a,n as t,J as l,o as r,A as n,u as d,w as i,B as o,r as s,t as u,F as c,q as y,K as g,a as f,c as p,a7 as m,a8 as v,av as h,y as b,g as w,D as S,Y as k,$ as F,aw as x,M as V,E as C}from"./vendor-4890bdfb.js";import"./chunk-bin-ui-next-e393e6f7.js";import"./chunk-brace-7f859248.js";const A={name:"field-label",props:{fieldValues:{type:Array,default:()=>[]},field:{type:Object,default:()=>({headers:{}})},variant:{type:String,default:"primary"}},setup(e,{emit:l}){const r=a(!0),n=a(!1);function d(){const a=e.fieldValues.reduce(((e,a)=>a.checked?e+=1:e),0);a===e.fieldValues.length?(r.value=!1,n.value=!0):a>0?(r.value=!0,n.value=!1):(r.value=!1,n.value=!1)}return t((()=>e.fieldValues),(()=>{d()}),{immediate:!0}),{indeterminate:r,checkAll:n,handleCheckAll:function(a){e.fieldValues.forEach((e=>{e.checked=a})),r.value=!1},handleCheckChange:function(){d()}}}},K={class:"field-label-button"},E=o("svg",{"aria-hidden":"true",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 270 512",class:"svg-inline--fa fa-grip-vertical fa-w-10",style:{position:"relative",top:"3px",width:"10px",height:"16px"}},[o("path",{fill:"currentColor",d:"M64 208c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48zM16 104c0 26.5 21.5 48 48 48s48-21.5 48-48-21.5-48-48-48-48 21.5-48 48zm0 304c0 26.5 21.5 48 48 48s48-21.5 48-48-21.5-48-48-48-48 21.5-48 48z M204 208c26.5 0 48 21.5 48 48s-21.5 48 -48 48 -48 -21.5 -48 -48 21.5 -48 48 -48zM156 104c0 26.5 21.5 48 48 48s48 -21.5 48 -48 -21.5 -48 -48 -48 -48 21.5 -48 48zm0 304c0 26.5 21.5 48 48 48s48 -21.5 48 -48 -21.5 -48 -48 -48 -48 21.5 -48 48z",class:""})],-1),N={style:{"margin-left":"8px"}},_=y(" Missing slot "),U={style:{width:"160px"}},$=o("h6",{class:"dropdown-header"},"Attributes",-1),I={class:"dropdown-list"},z=o("h6",{class:"dropdown-header"},"Values",-1),T={style:{"border-bottom":"1px solid #e9e9e9",padding:"0 10px 2px"}},M=y("全选 "),L={class:"dropdown-list"},W=y(" Missing slot ");function j(e,a){let t,l,r=/(^([+\\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,n=/(^[ ]*|[ ]*$)/g,d=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\\/\\-]\d{1,4}[\\/\\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,i=/^0x[0-9a-f]+$/i,o=/^0/,s=function(e){return j.insensitive&&(""+e).toLowerCase()||""+e},u=s(e).replace(n,"")||"",c=s(a).replace(n,"")||"",y=u.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=c.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),f=parseInt(u.match(i),16)||1!==y.length&&u.match(d)&&Date.parse(u),p=parseInt(c.match(i),16)||f&&c.match(d)&&Date.parse(c)||null;if(p){if(f<p)return-1;if(f>p)return 1}let m=0,v=Math.max(y.length,g.length);for(;m<v;m++){if(t=!(y[m]||"").match(o)&&parseFloat(y[m])||y[m]||0,l=!(g[m]||"").match(o)&&parseFloat(g[m])||g[m]||0,isNaN(t)!==isNaN(l))return isNaN(t)?1:-1;if(typeof t!=typeof l&&(t+="",l+=""),t<l)return-1;if(t>l)return 1}return 0}A.render=function(e,a,t,m,v,h){const b=l("b-button"),w=l("b-checkbox"),S=l("b-divider"),k=l("b-popper"),F=l("b-button-group");return r(),n("div",K,[d(F,null,{default:i((()=>[d(b,{type:t.variant,class:"btn-draggable"},{default:i((()=>[E,o("span",N,[t.field.labelSlotName?s(e.$slots,t.field.labelSlotName,{key:0},(()=>[_,o("code",null,u(t.field.labelSlotName),1)])):(r(),n(c,{key:1},[y(u(t.field.label),1)],64))])])),_:3},8,["type"]),d(k,{trigger:"click",theme:"light","show-arrow":!1,offset:4,placement:"bottom",transition:"zoom-in-top","popper-class":"bin-select__popper field-label-popper","gpu-acceleration":!1},{trigger:i((()=>[d(b,{type:t.variant,icon:"caret-down",style:{padding:"0 6px"}},null,8,["type"])])),default:i((()=>[o("div",U,[t.field.headerAttributeFilter?(r(),n(c,{key:0},[$,o("div",I,[(r(!0),n(c,null,g(t.field.headers,((e,a)=>(r(),n("div",{key:a,style:{padding:"2px 10px"}},[d(w,{modelValue:e.checked,"onUpdate:modelValue":a=>e.checked=a},{default:i((()=>[y(u(e.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])))),128))])],64)):f("",!0),t.field.headerAttributeFilter&&t.field.valueFilter?(r(),p(S,{key:1,style:{margin:"8px 0"}})):f("",!0),t.field.valueFilter?(r(),n(c,{key:2},[z,o("div",T,[d(w,{indeterminate:m.indeterminate,modelValue:m.checkAll,"onUpdate:modelValue":a[0]||(a[0]=e=>m.checkAll=e),onChange:m.handleCheckAll},{default:i((()=>[M])),_:1},8,["indeterminate","modelValue","onChange"])]),o("div",L,[(r(!0),n(c,null,g(t.fieldValues,((a,l)=>(r(),n("div",{key:l,style:{padding:"2px 10px"}},[d(w,{modelValue:a.checked,"onUpdate:modelValue":e=>a.checked=e,onChange:m.handleCheckChange},{default:i((()=>[t.field.valueFilterSlotName?s(e.$slots,t.field.valueFilterSlotName,{key:0,value:a.value},(()=>[W,o("code",null,u(t.field.valueFilterSlotName),1)])):(r(),n(c,{key:1},[y(u(a.value),1)],64))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])))),128))])],64)):f("",!0)])])),_:3})])),_:3})])};const D={name:"pivot",components:{draggable:h,FieldLabel:A},props:{data:{type:Array,default:()=>[]},fields:{type:Array,default:()=>[]},availableFieldKeys:{type:Array,default:()=>[]},rowFieldKeys:{type:Array,default:()=>[]},colFieldKeys:{type:Array,default:()=>[]},reducer:{type:Function,default:e=>e+1},reducerInitialValue:{default:0},defaultShowSettings:{type:Boolean,default:!0},availableFieldsLabelText:{type:String,default:"Available fields"},colsLabelText:{type:String,default:"Columns"},rowsLabelText:{type:String,default:"Rows"},hideSettingsText:{type:String,default:"Hide settings"},showSettingsText:{type:String,default:"Show settings"},noDataWarningText:{type:String,default:"No data to display."},isDataLoading:{type:Boolean,default:!1}},setup(e,{emit:l}){const r=b({availableFieldKeys:e.availableFieldKeys,rowFieldKeys:e.rowFieldKeys,colFieldKeys:e.colFieldKeys}),n=a(e.defaultShowSettings);const d=a({}),i=w((()=>{const a=e.fields,t={};a.forEach((e=>{t[e.key]=e}));const l=a.filter((e=>e.valueFilter));return l.forEach((e=>{t[e.key].valuesSet=new Set})),e.data.forEach((e=>{l.forEach((a=>{t[a.key].valuesSet.add(a.getter(e))}))})),l.forEach((e=>{t[e.key].values=Array.from(t[e.key].valuesSet).sort(e.sort||j)})),t}));function o(){for(let[e,a]of Object.entries(i.value))a.valueFilter&&(d.value[e]=[],a.values.forEach((a=>{d.value[e].push({value:a,checked:!0})})))}const s=a(!1),u=w((()=>s.value?"drag-area-highlight":null));const c=w((()=>({width:n.value?"calc(100% - 200px - 2rem)":"100%"})));return t((()=>e.fields),(e=>{e.filter((e=>e.valueFilter)).forEach((e=>{d.value[e.key]={}})),o()}),{immediate:!0}),t((()=>e.data),(()=>{o()})),{internal:r,showSettings:n,toggleShowSettings:function(){n.value=!n.value},fieldValues:d,fieldsWithValues:i,dragging:s,dragAreaClass:u,dragStart:function(){s.value=!0},dragEnd:function(){s.value=!1},tableWrapperStyle:c}}};m("data-v-7751ef0c");const H={class:"bin-pivot-table"},P={class:"top-row"},B={class:"left-col"},O={key:0,class:"right-col"},J={class:"drag-area-title"},G={class:"field"},Y={key:0,class:"top-row mt-16"},q=o("div",{class:"left-col"},null,-1),R={class:"right-col"},Q={class:"drag-area-title"},X={class:"field"},Z={class:"bottom-row",flex:""},ee={key:0,class:"left-col"},ae={class:"drag-area-title"},te={class:"field"},le=y(" table "),re={class:"mt-20",flex:"box:mean"},ne=o("div",null,"fieldValues",-1),de=o("div",null,"fieldsWithValues",-1);v(),D.render=function(e,a,t,c,p,m){const v=l("b-button"),h=l("field-label"),b=l("draggable"),w=l("b-ace-editor");return r(),n("div",H,[o("div",P,[o("div",B,[d(v,{type:"primary","animation-type":"waves",onClick:c.toggleShowSettings},{default:i((()=>[y(u(t.hideSettingsText),1)])),_:1},8,["onClick"])]),c.showSettings?(r(),n("div",O,[o("div",{class:S(["drag-area",c.dragAreaClass])},[o("div",J,u(t.availableFieldsLabelText),1),d(b,V({modelValue:c.internal.availableFieldKeys,"onUpdate:modelValue":a[0]||(a[0]=e=>c.internal.availableFieldKeys=e),class:"drag-area-zone","item-key":"key"},{animation:200,group:"fields",ghostClass:"sortable-ghost",handle:".btn-draggable"},{onStart:c.dragStart,onEnd:c.dragEnd}),{item:i((({element:a})=>[o("div",G,[d(h,{"field-values":c.fieldValues[a],field:c.fieldsWithValues[a],variant:"warning"},k({_:2},[g(e.$slots,((a,t)=>({name:t,fn:i((a=>[s(e.$slots,t,F(x(a)),void 0,!0)]))})))]),1032,["field-values","field"])])])),_:3},16,["modelValue","onStart","onEnd"])],2)])):f("",!0)]),c.showSettings?(r(),n("div",Y,[q,o("div",R,[o("div",{class:S(["drag-area border-primary",c.dragAreaClass])},[o("div",Q,u(t.colsLabelText),1),d(b,V({modelValue:c.internal.colFieldKeys,"onUpdate:modelValue":a[1]||(a[1]=e=>c.internal.colFieldKeys=e),class:"drag-area-zone","item-key":"key"},{animation:200,group:"fields",ghostClass:"sortable-ghost",handle:".btn-draggable"},{onStart:c.dragStart,onEnd:c.dragEnd}),{item:i((({element:a})=>[o("div",X,[d(h,{"field-values":c.fieldValues[a],field:c.fieldsWithValues[a]},k({_:2},[g(e.$slots,((a,t)=>({name:t,fn:i((a=>[s(e.$slots,t,F(x(a)),void 0,!0)]))})))]),1032,["field-values","field"])])])),_:3},16,["modelValue","onStart","onEnd"])],2)])])):f("",!0),o("div",Z,[c.showSettings?(r(),n("div",ee,[o("div",{class:S(["drag-area border-primary",c.dragAreaClass])},[o("div",ae,u(t.rowsLabelText),1),d(b,V({modelValue:c.internal.rowFieldKeys,"onUpdate:modelValue":a[2]||(a[2]=e=>c.internal.rowFieldKeys=e),class:"drag-area-zone","item-key":"key"},{animation:200,group:"fields",ghostClass:"sortable-ghost",handle:".btn-draggable"},{onStart:c.dragStart,onEnd:c.dragEnd}),{item:i((({element:a})=>[o("div",te,[d(h,{"field-values":c.fieldValues[a],field:c.fieldsWithValues[a]},k({_:2},[g(e.$slots,((a,t)=>({name:t,fn:i((a=>[s(e.$slots,t,F(x(a)),void 0,!0)]))})))]),1032,["field-values","field"])])])),_:3},16,["modelValue","onStart","onEnd"])],2)])):f("",!0),o("div",{class:"right-col",style:C(c.tableWrapperStyle)},[le,d(w,{"model-value":JSON.stringify(c.internal.rowFieldKeys,null,2)},null,8,["model-value"])],4)]),o("div",re,[o("div",null,[ne,d(w,{"model-value":JSON.stringify(c.fieldValues,null,2)},null,8,["model-value"])]),o("div",null,[de,d(w,{"model-value":JSON.stringify(c.fieldsWithValues,null,2)},null,8,["model-value"])])])])},D.__scopeId="data-v-7751ef0c";var ie=[{country:"United States",year:2010,gender:"male",count:153295220},{country:"United States",year:2010,gender:"female",count:156588400},{country:"United States",year:2011,gender:"male",count:154591960},{country:"United States",year:2011,gender:"female",count:157800200},{country:"United States",year:2012,gender:"male",count:155851840},{country:"United States",year:2012,gender:"female",count:158944800},{country:"China",year:2010,gender:"male",count:690256342},{country:"China",year:2010,gender:"female",count:650712406},{country:"China",year:2011,gender:"male",count:694106441},{country:"China",year:2011,gender:"female",count:654068030},{country:"China",year:2012,gender:"male",count:697964288},{country:"China",year:2012,gender:"female",count:657422649},{country:"India",year:2010,gender:"male",count:638354751},{country:"India",year:2010,gender:"female",count:592629727},{country:"India",year:2011,gender:"male",count:646873890},{country:"India",year:2011,gender:"female",count:600572093},{country:"India",year:2012,gender:"male",count:655193693},{country:"India",year:2012,gender:"female",count:608395922},{country:"France",year:2010,gender:"male",count:30675773},{country:"France",year:2010,gender:"female",count:32285363},{country:"France",year:2011,gender:"male",count:30815839},{country:"France",year:2011,gender:"female",count:32452566},{country:"France",year:2012,gender:"male",count:30948916},{country:"France",year:2012,gender:"female",count:32612882},{country:"Australia",year:2010,gender:"male",count:11124254},{country:"Australia",year:2010,gender:"female",count:11218144},{country:"Australia",year:2011,gender:"male",count:11260747},{country:"Australia",year:2011,gender:"female",count:11359807},{country:"Australia",year:2012,gender:"male",count:11280804},{country:"Australia",year:2012,gender:"female",count:11402769}];const oe=[];[{country:"United States",year:2010,count:309883620,gdp:0xda29bfa2cd8},{country:"United States",year:2011,count:312392160,gdp:15224554803574.9},{country:"United States",year:2012,count:311703680,gdp:15567038144703.4},{country:"China",year:2010,count:1340968748,gdp:6087163874510.73},{country:"China",year:2011,count:1348174471,gdp:6668538680617.58},{country:"China",year:2012,count:1355386937,gdp:7192934987438.43},{country:"India",year:2010,count:1230984478,gdp:1675615335600.56},{country:"India",year:2011,count:1247445983,gdp:1763439613551.83},{country:"India",year:2012,count:1263589615,gdp:1859659734290.44},{country:"France",year:2010,count:62961136,gdp:2642609548930.36},{country:"France",year:2011,count:63268405,gdp:2700554065228.66},{country:"France",year:2012,count:63561798,gdp:2709010438478.52},{country:"Australia",year:2010,count:22342398,gdp:1146138465603.81},{country:"Australia",year:2011,count:22620554,gdp:1174365063005.45},{country:"Australia",year:2012,count:22683573,gdp:1220378598873.43}].forEach((e=>{oe.push({country:e.country,year:e.year,type:"count",count:e.count}),oe.push({country:e.country,year:e.year,type:"gdp",gdp:e.gdp})}));const se={name:"PivotDemo",components:{Pivot:D,PageWrapper:e},data:()=>({data:ie,asyncData:[],dataGdpFlattened:oe,fields:[{key:"country",getter:e=>e.country,label:"Country",headers:[{slotName:"countryFlagHeader",label:"Flag",checked:!0},{slotName:"countryNameHeader",label:"Name",checked:!0}],headerAttributeFilter:!0,valueFilter:!0},{key:"gender",getter:e=>e.gender,label:"Gender",headerSlotName:"genderHeader",valueFilter:!0,valueFilterSlotName:"genderHeader"},{key:"year",getter:e=>e.year,label:"Year",valueFilter:!0}],availableFieldKeys:[],rowFieldKeys:["country","gender"],colFieldKeys:["year"],reducer:(e,a)=>e+a.count,defaultShowSettings:!0,isDataLoading:!1}),methods:{countryCode(e){switch(e){case"Australia":return"au";case"China":return"cn";case"France":return"fr";case"India":return"in";case"United States":return"us"}},countryEmoji(e){const a=this.countryCode(e).toUpperCase().split("").map((e=>127397+e.charCodeAt()));return String.fromCodePoint(...a)}}},ue={class:"p16",style:{"--bin-border-base-radius":"0"}},ce={key:0,"aria-hidden":"true","data-prefix":"fas","data-icon":"venus",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 288 512",class:"svg-inline--fa fa-venus fa-fw",style:{width:"15px",height:"15px",position:"relative",top:"2px"}},ye=[o("path",{fill:"currentColor",d:"M288 176c0-79.5-64.5-144-144-144S0 96.5 0 176c0 68.5 47.9 125.9 112 140.4V368H76c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h36v36c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-36h36c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-36v-51.6c64.1-14.5 112-71.9 112-140.4zm-224 0c0-44.1 35.9-80 80-80s80 35.9 80 80-35.9 80-80 80-80-35.9-80-80z",class:""},null,-1)],ge={key:1,"aria-hidden":"true","data-prefix":"fas","data-icon":"mars",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",class:"svg-inline--fa fa-mars fa-fw",style:{width:"15px",height:"15px",position:"relative",top:"2px"}},fe=[o("path",{fill:"currentColor",d:"M372 64h-79c-10.7 0-16 12.9-8.5 20.5l16.9 16.9-80.7 80.7c-22.2-14-48.5-22.1-76.7-22.1C64.5 160 0 224.5 0 304s64.5 144 144 144 144-64.5 144-144c0-28.2-8.1-54.5-22.1-76.7l80.7-80.7 16.9 16.9c7.6 7.6 20.5 2.2 20.5-8.5V76c0-6.6-5.4-12-12-12zM144 384c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z",class:""},null,-1)];se.render=function(e,a,t,s,c,g){const m=l("pivot"),v=l("b-collapse-wrap"),h=l("page-wrapper");return r(),p(h,{title:"Pivot Table",desc:"交叉表，根据不同配置动态获取不同的表格显示。"},{default:i((()=>[d(v,{title:"Pivot (drag & drop UI + PivotTable)",shadow:"none"},{default:i((()=>[o("div",ue,[d(m,{data:c.data,fields:c.fields,"available-field-keys":c.availableFieldKeys,"row-field-keys":c.rowFieldKeys,"col-field-keys":c.colFieldKeys,reducer:c.reducer},{genderHeader:i((({value:e})=>["female"===e?(r(),n("svg",ce,ye)):"male"===e?(r(),n("svg",ge,fe)):f("",!0),y(" "+u(e),1)])),_:1},8,["data","fields","available-field-keys","row-field-keys","col-field-keys","reducer"])])])),_:1})])),_:1})};export{se as default};
