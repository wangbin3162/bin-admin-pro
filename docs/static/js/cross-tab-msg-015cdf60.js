import{a9 as m}from"./vendor-a6c5ad11.js";import{m as i,n as p}from"./index-92c56bc9.js";class _{constructor(e,s="indexDB"){this.store=m.createInstance({name:e,driver:s!=="indexDB"?m.LOCALSTORAGE:m.INDEXEDDB})}async getStorage(e){if(!e){console.warn("storeKey or key is null!");return}return await this.store.getItem(e)}async setStorage(e,s){if(!e){console.warn("storeKey or key is null!");return}return await this.store.setItem(e,i(s)),await this.getStorage(e)}}const D={appversion:"",company:"",createdTime:"",creator:"",lastmodifiedby:"",modifiedTime:"",name:""},L=[{id:"0001",name:"\u5DE5\u8D44\u586B\u62A5",isPublish:"1",reportCount:1,records:1,jsonData:{info:{name:"\u5DE5\u8D44\u586B\u62A5"},sheets:[{name:"Sheet1",index:0,config:{columnlen:{1:100,2:100,3:109,4:94,5:98},customWidth:{1:1,2:1,3:1,4:1,5:1},rowlen:{0:45,1:45},customHeight:{0:1,1:1},borderInfo:[{rangeType:"cell",value:{row_index:0,col_index:0,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:1,l:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:2,r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:3,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:4,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:0,col_index:5,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:0,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:1,l:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:2,r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:3,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:4,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}},{rangeType:"cell",value:{row_index:1,col_index:5,l:{style:1,color:"#000000"},r:{style:1,color:"#000000"},t:{style:1,color:"#000000"},b:{style:1,color:"#000000"}}}],merge:{"0_4":{r:0,c:4,rs:1,cs:2},"1_4":{r:1,c:4,rs:1,cs:2},"0_1":{r:0,c:1,rs:1,cs:2},"1_1":{r:1,c:1,rs:1,cs:2}}},celldata:[{r:0,c:0,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u59D3\u540D",qp:1,m:"\u59D3\u540D"}},{r:0,c:1,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:1,rs:1,cs:2}}},{r:0,c:2,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:1}}},{r:0,c:3,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u5E74\u9F84",qp:1,m:"\u5E74\u9F84"}},{r:0,c:4,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:4,rs:1,cs:2}}},{r:0,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:0,c:4}}},{r:1,c:0,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u5DE5\u8D44",qp:1,m:"\u5DE5\u8D44"}},{r:1,c:1,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:1,rs:1,cs:2}}},{r:1,c:2,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:1}}},{r:1,c:3,v:{ct:{fa:"@",t:"s"},bg:"#C6EFCE",fs:11,fc:"#006100",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,v:"\u6027\u522B",qp:1,m:"\u6027\u522B"}},{r:1,c:4,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:4,rs:1,cs:2}}},{r:1,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1,mc:{r:1,c:4}}},{r:2,c:5,v:{ct:{fa:"General"},fs:11,fc:"#000000",ff:"\u5B8B\u4F53",ht:0,vt:0,tb:1}}]}]},mapping:[{cellIndex:{row:0,column:1},cellRange:{row:[0,0],column:[1,2]},cellPosition:{start:"B1",end:"C1"},fieldName:"name",fieldTitle:"\u59D3\u540D",dataType:"string"},{cellIndex:{row:0,column:4},cellRange:{row:[0,0],column:[4,5]},cellPosition:{start:"E1",end:"F1"},fieldName:"age",fieldTitle:"\u5E74\u9F84",dataType:"number"},{cellIndex:{row:1,column:1},cellRange:{row:[1,1],column:[1,2]},cellPosition:{start:"B2",end:"C2"},fieldName:"gongzi",fieldTitle:"\u5DE5\u8D44",dataType:"number"},{cellIndex:{row:1,column:4},cellRange:{row:[1,1],column:[4,5]},cellPosition:{start:"E2",end:"F2"},fieldName:"sex",fieldTitle:"\u6027\u522B",dataType:"string"}]}];function $(t,e=!0){console.log(t);const s=t.row[0],o=t.row[1],l=t.column[0],n=t.column[1];if(e){const r=`\u5F00\u59CB\u5355\u5143\u683C\uFF1Arow\uFF1A${s+1} col\uFF1A${l+1}`,f=`\u7ED3\u675F\u5355\u5143\u683C\uFF1Arow\uFF1A${o+1} col\uFF1A${n+1}`,u=`\u9009\u4E2D\u5355\u5143\u683C\u6570\u91CF\uFF1A${o-s+1}\u884C ${n-l+1}\u5217`;console.log(`${r} | ${f} | ${u}`)}return{cellIndex:{row:s,column:l},cellRange:t,cellPosition:{start:`${w(l)}${s+1}`,end:`${w(n)}${o+1}`}}}const w=t=>String.fromCharCode(65+t),y=new _("__EXCEL_DATASOURCE__"),v="__excel_data__",I={excelList:i(L),dataList:[{id:"8452b2e4f3124589b13e14a658099f9a",tempId:"0001",tempName:"\u5DE5\u8D44\u586B\u62A5",data:{name:"\u674E\u96F7",age:26,gongzi:234523,sex:"\u7537"}}]};async function c(t=v){const e=await y.getStorage(t);return e||await y.setStorage(t,I)}async function d(t,e=v){return await y.setStorage(e,t)}async function G(t){const{excelList:e}=await c();return new Promise(s=>{const{page:o,size:l,name:n,isPublish:r}=t,f=e.filter(a=>a.name.includes(n)&&(a.isPublish===r||r==="")),u=[];let h=Math.ceil(f.length/l);for(let a=0;a<h;a++){let x=a*l,b=x+l,T=f.slice(x,b);u.push(T)}setTimeout(()=>{s({rows:u[o-1],total:f.length})},200)})}async function R(t){const e=await c();return new Promise(s=>{const o=i(t);o.id=p(),o.isPublish="0",o.reportCount=0,o.records=0,e.excelList.unshift(o),d(e),setTimeout(()=>{s(o.id)},200)})}async function C(t){const e=await c();return new Promise(s=>{const o=e.excelList.findIndex(l=>l.id===t.id);o>-1&&e.excelList.splice(o,1,t),d(e),setTimeout(()=>{s(!0)},200)})}async function N(t){const e=await c();return new Promise(s=>{const o=e.excelList.findIndex(l=>l.id===t);o>-1&&e.excelList.splice(o,1),d(e),setTimeout(()=>{s(!0)},200)})}async function A(t){const e=await E(t);return e.isPublish="1",C(e)}async function E(t){const e=await c();return new Promise(s=>{const o=e.excelList.findIndex(l=>l.id===t);setTimeout(()=>{const l=o>-1?i(e.excelList[o]):null;s(l)},200)})}async function B(t){const e=await c();return e.dataList||(e.dataList=[]),new Promise(s=>{const o=i(t);o.id=p(),e.dataList.unshift(o);const l=e.excelList.findIndex(n=>n.id===o.tempId);if(l>-1){const n=e.dataList.filter(r=>r.tempId===o.tempId).length;e.excelList[l].reportCount=e.excelList[l].records=n,console.log(e)}d(e),setTimeout(()=>{s(o.id)},200)})}async function F(t){const{dataList:e}=await c();return new Promise(s=>{const{tempId:o}=t,l=e.filter(n=>n.tempId===o);setTimeout(()=>{s({rows:l,total:l.length})},200)})}async function j(t){const e=await c();return new Promise(s=>{const o=e.dataList.findIndex(l=>l.id===t);o>-1&&e.dataList.splice(o,1),d(e),setTimeout(()=>{s(!0)},200)})}async function q(t){const e=await c();return new Promise(s=>{const o=e.dataList.findIndex(l=>l.id===t);setTimeout(()=>{const l=o>-1?i(e.dataList[o]):null;s(l)},200)})}async function M(t){const e=await c();return new Promise(s=>{const o=e.dataList.findIndex(l=>l.id===t.id);o>-1&&e.dataList.splice(o,1,t),d(e),setTimeout(()=>{s(!0)},200)})}const g=new BroadcastChannel("ExcelChannel");function z(t,e){g.postMessage({type:t,content:e})}function K(t){const e=s=>t&&t(s.data);return g.addEventListener("message",e),()=>g.removeEventListener("message",e)}export{R as a,B as b,M as c,D as d,q as e,$ as f,E as g,G as h,F as i,N as j,K as l,C as m,A as p,j as r,z as s};
